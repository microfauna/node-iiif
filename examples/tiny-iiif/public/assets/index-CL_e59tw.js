function SN(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function Wc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function AN(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var Zm={exports:{}},Xl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sS;function wN(){if(sS)return Xl;sS=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,r,s){var a=null;if(s!==void 0&&(a=""+s),r.key!==void 0&&(a=""+r.key),"key"in r){s={};for(var o in r)o!=="key"&&(s[o]=r[o])}else s=r;return r=s.ref,{$$typeof:t,type:i,key:a,ref:r!==void 0?r:null,props:s}}return Xl.Fragment=e,Xl.jsx=n,Xl.jsxs=n,Xl}var aS;function CN(){return aS||(aS=1,Zm.exports=wN()),Zm.exports}var Ce=CN(),Jm={exports:{}},yt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oS;function RN(){if(oS)return yt;oS=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function p(P){return P===null||typeof P!="object"?null:(P=f&&P[f]||P["@@iterator"],typeof P=="function"?P:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function E(P,ie,le){this.props=P,this.context=ie,this.refs=b,this.updater=le||m}E.prototype.isReactComponent={},E.prototype.setState=function(P,ie){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,ie,"setState")},E.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function T(){}T.prototype=E.prototype;function x(P,ie,le){this.props=P,this.context=ie,this.refs=b,this.updater=le||m}var S=x.prototype=new T;S.constructor=x,y(S,E.prototype),S.isPureReactComponent=!0;var w=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function L(P,ie,le,q,ye,Pe){return le=Pe.ref,{$$typeof:t,type:P,key:ie,ref:le!==void 0?le:null,props:Pe}}function N(P,ie){return L(P.type,ie,void 0,void 0,void 0,P.props)}function G(P){return typeof P=="object"&&P!==null&&P.$$typeof===t}function O(P){var ie={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(le){return ie[le]})}var D=/\/+/g;function V(P,ie){return typeof P=="object"&&P!==null&&P.key!=null?O(""+P.key):ie.toString(36)}function $(){}function J(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then($,$):(P.status="pending",P.then(function(ie){P.status==="pending"&&(P.status="fulfilled",P.value=ie)},function(ie){P.status==="pending"&&(P.status="rejected",P.reason=ie)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function K(P,ie,le,q,ye){var Pe=typeof P;(Pe==="undefined"||Pe==="boolean")&&(P=null);var we=!1;if(P===null)we=!0;else switch(Pe){case"bigint":case"string":case"number":we=!0;break;case"object":switch(P.$$typeof){case t:case e:we=!0;break;case d:return we=P._init,K(we(P._payload),ie,le,q,ye)}}if(we)return ye=ye(P),we=q===""?"."+V(P,0):q,w(ye)?(le="",we!=null&&(le=we.replace(D,"$&/")+"/"),K(ye,ie,le,"",function($e){return $e})):ye!=null&&(G(ye)&&(ye=N(ye,le+(ye.key==null||P&&P.key===ye.key?"":(""+ye.key).replace(D,"$&/")+"/")+we)),ie.push(ye)),1;we=0;var Me=q===""?".":q+":";if(w(P))for(var Fe=0;Fe<P.length;Fe++)q=P[Fe],Pe=Me+V(q,Fe),we+=K(q,ie,le,Pe,ye);else if(Fe=p(P),typeof Fe=="function")for(P=Fe.call(P),Fe=0;!(q=P.next()).done;)q=q.value,Pe=Me+V(q,Fe++),we+=K(q,ie,le,Pe,ye);else if(Pe==="object"){if(typeof P.then=="function")return K(J(P),ie,le,q,ye);throw ie=String(P),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return we}function j(P,ie,le){if(P==null)return P;var q=[],ye=0;return K(P,q,"","",function(Pe){return ie.call(le,Pe,ye++)}),q}function te(P){if(P._status===-1){var ie=P._result;ie=ie(),ie.then(function(le){(P._status===0||P._status===-1)&&(P._status=1,P._result=le)},function(le){(P._status===0||P._status===-1)&&(P._status=2,P._result=le)}),P._status===-1&&(P._status=0,P._result=ie)}if(P._status===1)return P._result.default;throw P._result}var ne=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function oe(){}return yt.Children={map:j,forEach:function(P,ie,le){j(P,function(){ie.apply(this,arguments)},le)},count:function(P){var ie=0;return j(P,function(){ie++}),ie},toArray:function(P){return j(P,function(ie){return ie})||[]},only:function(P){if(!G(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},yt.Component=E,yt.Fragment=n,yt.Profiler=r,yt.PureComponent=x,yt.StrictMode=i,yt.Suspense=l,yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,yt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return C.H.useMemoCache(P)}},yt.cache=function(P){return function(){return P.apply(null,arguments)}},yt.cloneElement=function(P,ie,le){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var q=y({},P.props),ye=P.key,Pe=void 0;if(ie!=null)for(we in ie.ref!==void 0&&(Pe=void 0),ie.key!==void 0&&(ye=""+ie.key),ie)!I.call(ie,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&ie.ref===void 0||(q[we]=ie[we]);var we=arguments.length-2;if(we===1)q.children=le;else if(1<we){for(var Me=Array(we),Fe=0;Fe<we;Fe++)Me[Fe]=arguments[Fe+2];q.children=Me}return L(P.type,ye,void 0,void 0,Pe,q)},yt.createContext=function(P){return P={$$typeof:a,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:s,_context:P},P},yt.createElement=function(P,ie,le){var q,ye={},Pe=null;if(ie!=null)for(q in ie.key!==void 0&&(Pe=""+ie.key),ie)I.call(ie,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(ye[q]=ie[q]);var we=arguments.length-2;if(we===1)ye.children=le;else if(1<we){for(var Me=Array(we),Fe=0;Fe<we;Fe++)Me[Fe]=arguments[Fe+2];ye.children=Me}if(P&&P.defaultProps)for(q in we=P.defaultProps,we)ye[q]===void 0&&(ye[q]=we[q]);return L(P,Pe,void 0,void 0,null,ye)},yt.createRef=function(){return{current:null}},yt.forwardRef=function(P){return{$$typeof:o,render:P}},yt.isValidElement=G,yt.lazy=function(P){return{$$typeof:d,_payload:{_status:-1,_result:P},_init:te}},yt.memo=function(P,ie){return{$$typeof:u,type:P,compare:ie===void 0?null:ie}},yt.startTransition=function(P){var ie=C.T,le={};C.T=le;try{var q=P(),ye=C.S;ye!==null&&ye(le,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(oe,ne)}catch(Pe){ne(Pe)}finally{C.T=ie}},yt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},yt.use=function(P){return C.H.use(P)},yt.useActionState=function(P,ie,le){return C.H.useActionState(P,ie,le)},yt.useCallback=function(P,ie){return C.H.useCallback(P,ie)},yt.useContext=function(P){return C.H.useContext(P)},yt.useDebugValue=function(){},yt.useDeferredValue=function(P,ie){return C.H.useDeferredValue(P,ie)},yt.useEffect=function(P,ie,le){var q=C.H;if(typeof le=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return q.useEffect(P,ie)},yt.useId=function(){return C.H.useId()},yt.useImperativeHandle=function(P,ie,le){return C.H.useImperativeHandle(P,ie,le)},yt.useInsertionEffect=function(P,ie){return C.H.useInsertionEffect(P,ie)},yt.useLayoutEffect=function(P,ie){return C.H.useLayoutEffect(P,ie)},yt.useMemo=function(P,ie){return C.H.useMemo(P,ie)},yt.useOptimistic=function(P,ie){return C.H.useOptimistic(P,ie)},yt.useReducer=function(P,ie,le){return C.H.useReducer(P,ie,le)},yt.useRef=function(P){return C.H.useRef(P)},yt.useState=function(P){return C.H.useState(P)},yt.useSyncExternalStore=function(P,ie,le){return C.H.useSyncExternalStore(P,ie,le)},yt.useTransition=function(){return C.H.useTransition()},yt.version="19.1.1",yt}var uS;function Ov(){return uS||(uS=1,Jm.exports=RN()),Jm.exports}var H=Ov();const U=Wc(H),Pv=SN({__proto__:null,default:U},[H]);var eg={exports:{}},Ql={},tg={exports:{}},ng={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lS;function _N(){return lS||(lS=1,(function(t){function e(j,te){var ne=j.length;j.push(te);e:for(;0<ne;){var oe=ne-1>>>1,P=j[oe];if(0<r(P,te))j[oe]=te,j[ne]=P,ne=oe;else break e}}function n(j){return j.length===0?null:j[0]}function i(j){if(j.length===0)return null;var te=j[0],ne=j.pop();if(ne!==te){j[0]=ne;e:for(var oe=0,P=j.length,ie=P>>>1;oe<ie;){var le=2*(oe+1)-1,q=j[le],ye=le+1,Pe=j[ye];if(0>r(q,ne))ye<P&&0>r(Pe,q)?(j[oe]=Pe,j[ye]=ne,oe=ye):(j[oe]=q,j[le]=ne,oe=le);else if(ye<P&&0>r(Pe,ne))j[oe]=Pe,j[ye]=ne,oe=ye;else break e}}return te}function r(j,te){var ne=j.sortIndex-te.sortIndex;return ne!==0?ne:j.id-te.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,f=null,p=3,m=!1,y=!1,b=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function w(j){for(var te=n(u);te!==null;){if(te.callback===null)i(u);else if(te.startTime<=j)i(u),te.sortIndex=te.expirationTime,e(l,te);else break;te=n(u)}}function C(j){if(b=!1,w(j),!y)if(n(l)!==null)y=!0,I||(I=!0,V());else{var te=n(u);te!==null&&K(C,te.startTime-j)}}var I=!1,L=-1,N=5,G=-1;function O(){return E?!0:!(t.unstable_now()-G<N)}function D(){if(E=!1,I){var j=t.unstable_now();G=j;var te=!0;try{e:{y=!1,b&&(b=!1,x(L),L=-1),m=!0;var ne=p;try{t:{for(w(j),f=n(l);f!==null&&!(f.expirationTime>j&&O());){var oe=f.callback;if(typeof oe=="function"){f.callback=null,p=f.priorityLevel;var P=oe(f.expirationTime<=j);if(j=t.unstable_now(),typeof P=="function"){f.callback=P,w(j),te=!0;break t}f===n(l)&&i(l),w(j)}else i(l);f=n(l)}if(f!==null)te=!0;else{var ie=n(u);ie!==null&&K(C,ie.startTime-j),te=!1}}break e}finally{f=null,p=ne,m=!1}te=void 0}}finally{te?V():I=!1}}}var V;if(typeof S=="function")V=function(){S(D)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,J=$.port2;$.port1.onmessage=D,V=function(){J.postMessage(null)}}else V=function(){T(D,0)};function K(j,te){L=T(function(){j(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(j){switch(p){case 1:case 2:case 3:var te=3;break;default:te=p}var ne=p;p=te;try{return j()}finally{p=ne}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(j,te){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var ne=p;p=j;try{return te()}finally{p=ne}},t.unstable_scheduleCallback=function(j,te,ne){var oe=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?oe+ne:oe):ne=oe,j){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=ne+P,j={id:d++,callback:te,priorityLevel:j,startTime:ne,expirationTime:P,sortIndex:-1},ne>oe?(j.sortIndex=ne,e(u,j),n(l)===null&&j===n(u)&&(b?(x(L),L=-1):b=!0,K(C,ne-oe))):(j.sortIndex=P,e(l,j),y||m||(y=!0,I||(I=!0,V()))),j},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(j){var te=p;return function(){var ne=p;p=te;try{return j.apply(this,arguments)}finally{p=ne}}}})(ng)),ng}var cS;function IN(){return cS||(cS=1,tg.exports=_N()),tg.exports}var ig={exports:{}},Vn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dS;function LN(){if(dS)return Vn;dS=1;var t=Ov();function e(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(l,u,d){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:f==null?null:""+f,children:l,containerInfo:u,implementation:d}}var a=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,u){if(l==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Vn.createPortal=function(l,u){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return s(l,u,null,d)},Vn.flushSync=function(l){var u=a.T,d=i.p;try{if(a.T=null,i.p=2,l)return l()}finally{a.T=u,i.p=d,i.d.f()}},Vn.preconnect=function(l,u){typeof l=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,i.d.C(l,u))},Vn.prefetchDNS=function(l){typeof l=="string"&&i.d.D(l)},Vn.preinit=function(l,u){if(typeof l=="string"&&u&&typeof u.as=="string"){var d=u.as,f=o(d,u.crossOrigin),p=typeof u.integrity=="string"?u.integrity:void 0,m=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;d==="style"?i.d.S(l,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:f,integrity:p,fetchPriority:m}):d==="script"&&i.d.X(l,{crossOrigin:f,integrity:p,fetchPriority:m,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Vn.preinitModule=function(l,u){if(typeof l=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var d=o(u.as,u.crossOrigin);i.d.M(l,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&i.d.M(l)},Vn.preload=function(l,u){if(typeof l=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var d=u.as,f=o(d,u.crossOrigin);i.d.L(l,d,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Vn.preloadModule=function(l,u){if(typeof l=="string")if(u){var d=o(u.as,u.crossOrigin);i.d.m(l,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else i.d.m(l)},Vn.requestFormReset=function(l){i.d.r(l)},Vn.unstable_batchedUpdates=function(l,u){return l(u)},Vn.useFormState=function(l,u,d){return a.H.useFormState(l,u,d)},Vn.useFormStatus=function(){return a.H.useHostTransitionStatus()},Vn.version="19.1.1",Vn}var fS;function BR(){if(fS)return ig.exports;fS=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ig.exports=LN(),ig.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hS;function DN(){if(hS)return Ql;hS=1;var t=IN(),e=Ov(),n=BR();function i(c){var h="https://react.dev/errors/"+c;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function s(c){var h=c,g=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,(h.flags&4098)!==0&&(g=h.return),c=h.return;while(c)}return h.tag===3?g:null}function a(c){if(c.tag===13){var h=c.memoizedState;if(h===null&&(c=c.alternate,c!==null&&(h=c.memoizedState)),h!==null)return h.dehydrated}return null}function o(c){if(s(c)!==c)throw Error(i(188))}function l(c){var h=c.alternate;if(!h){if(h=s(c),h===null)throw Error(i(188));return h!==c?null:c}for(var g=c,v=h;;){var A=g.return;if(A===null)break;var R=A.alternate;if(R===null){if(v=A.return,v!==null){g=v;continue}break}if(A.child===R.child){for(R=A.child;R;){if(R===g)return o(A),c;if(R===v)return o(A),h;R=R.sibling}throw Error(i(188))}if(g.return!==v.return)g=A,v=R;else{for(var z=!1,W=A.child;W;){if(W===g){z=!0,g=A,v=R;break}if(W===v){z=!0,v=A,g=R;break}W=W.sibling}if(!z){for(W=R.child;W;){if(W===g){z=!0,g=R,v=A;break}if(W===v){z=!0,v=R,g=A;break}W=W.sibling}if(!z)throw Error(i(189))}}if(g.alternate!==v)throw Error(i(190))}if(g.tag!==3)throw Error(i(188));return g.stateNode.current===g?c:h}function u(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c;for(c=c.child;c!==null;){if(h=u(c),h!==null)return h;c=c.sibling}return null}var d=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),S=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function V(c){return c===null||typeof c!="object"?null:(c=D&&c[D]||c["@@iterator"],typeof c=="function"?c:null)}var $=Symbol.for("react.client.reference");function J(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===$?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case y:return"Fragment";case E:return"Profiler";case b:return"StrictMode";case C:return"Suspense";case I:return"SuspenseList";case G:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case m:return"Portal";case S:return(c.displayName||"Context")+".Provider";case x:return(c._context.displayName||"Context")+".Consumer";case w:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case L:return h=c.displayName||null,h!==null?h:J(c.type)||"Memo";case N:h=c._payload,c=c._init;try{return J(c(h))}catch{}}return null}var K=Array.isArray,j=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},oe=[],P=-1;function ie(c){return{current:c}}function le(c){0>P||(c.current=oe[P],oe[P]=null,P--)}function q(c,h){P++,oe[P]=c.current,c.current=h}var ye=ie(null),Pe=ie(null),we=ie(null),Me=ie(null);function Fe(c,h){switch(q(we,h),q(Pe,c),q(ye,null),h.nodeType){case 9:case 11:c=(c=h.documentElement)&&(c=c.namespaceURI)?Px(c):0;break;default:if(c=h.tagName,h=h.namespaceURI)h=Px(h),c=kx(h,c);else switch(c){case"svg":c=1;break;case"math":c=2;break;default:c=0}}le(ye),q(ye,c)}function $e(){le(ye),le(Pe),le(we)}function Ye(c){c.memoizedState!==null&&q(Me,c);var h=ye.current,g=kx(h,c.type);h!==g&&(q(Pe,c),q(ye,g))}function fe(c){Pe.current===c&&(le(ye),le(Pe)),Me.current===c&&(le(Me),jl._currentValue=ne)}var Ie=Object.prototype.hasOwnProperty,Le=t.unstable_scheduleCallback,Ke=t.unstable_cancelCallback,Lt=t.unstable_shouldYield,Qe=t.unstable_requestPaint,k=t.unstable_now,X=t.unstable_getCurrentPriorityLevel,ue=t.unstable_ImmediatePriority,Se=t.unstable_UserBlockingPriority,Oe=t.unstable_NormalPriority,ze=t.unstable_LowPriority,Ne=t.unstable_IdlePriority,dt=t.log,mt=t.unstable_setDisableYieldValue,he=null,Te=null;function je(c){if(typeof dt=="function"&&mt(c),Te&&typeof Te.setStrictMode=="function")try{Te.setStrictMode(he,c)}catch{}}var B=Math.clz32?Math.clz32:Z,F=Math.log,Y=Math.LN2;function Z(c){return c>>>=0,c===0?32:31-(F(c)/Y|0)|0}var xe=256,Be=4194304;function Ze(c){var h=c&42;if(h!==0)return h;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function lt(c,h,g){var v=c.pendingLanes;if(v===0)return 0;var A=0,R=c.suspendedLanes,z=c.pingedLanes;c=c.warmLanes;var W=v&134217727;return W!==0?(v=W&~R,v!==0?A=Ze(v):(z&=W,z!==0?A=Ze(z):g||(g=W&~c,g!==0&&(A=Ze(g))))):(W=v&~R,W!==0?A=Ze(W):z!==0?A=Ze(z):g||(g=v&~c,g!==0&&(A=Ze(g)))),A===0?0:h!==0&&h!==A&&(h&R)===0&&(R=A&-A,g=h&-h,R>=g||R===32&&(g&4194048)!==0)?h:A}function tt(c,h){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&h)===0}function Zt(c,h){switch(c){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cn(){var c=xe;return xe<<=1,(xe&4194048)===0&&(xe=256),c}function Fr(){var c=Be;return Be<<=1,(Be&62914560)===0&&(Be=4194304),c}function To(c){for(var h=[],g=0;31>g;g++)h.push(c);return h}function xs(c,h){c.pendingLanes|=h,h!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function od(c,h,g,v,A,R){var z=c.pendingLanes;c.pendingLanes=g,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=g,c.entangledLanes&=g,c.errorRecoveryDisabledLanes&=g,c.shellSuspendCounter=0;var W=c.entanglements,se=c.expirationTimes,ve=c.hiddenUpdates;for(g=z&~g;0<g;){var Re=31-B(g),ke=1<<Re;W[Re]=0,se[Re]=-1;var be=ve[Re];if(be!==null)for(ve[Re]=null,Re=0;Re<be.length;Re++){var Ee=be[Re];Ee!==null&&(Ee.lane&=-536870913)}g&=~ke}v!==0&&vE(c,v,0),R!==0&&A===0&&c.tag!==0&&(c.suspendedLanes|=R&~(z&~h))}function vE(c,h,g){c.pendingLanes|=h,c.suspendedLanes&=~h;var v=31-B(h);c.entangledLanes|=h,c.entanglements[v]=c.entanglements[v]|1073741824|g&4194090}function bE(c,h){var g=c.entangledLanes|=h;for(c=c.entanglements;g;){var v=31-B(g),A=1<<v;A&h|c[v]&h&&(c[v]|=h),g&=~A}}function q0(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function V0(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function EE(){var c=te.p;return c!==0?c:(c=window.event,c===void 0?32:Jx(c.type))}function fP(c,h){var g=te.p;try{return te.p=c,h()}finally{te.p=g}}var Ss=Math.random().toString(36).slice(2),zn="__reactFiber$"+Ss,ei="__reactProps$"+Ss,xo="__reactContainer$"+Ss,G0="__reactEvents$"+Ss,hP="__reactListeners$"+Ss,pP="__reactHandles$"+Ss,TE="__reactResources$"+Ss,nl="__reactMarker$"+Ss;function j0(c){delete c[zn],delete c[ei],delete c[G0],delete c[hP],delete c[pP]}function So(c){var h=c[zn];if(h)return h;for(var g=c.parentNode;g;){if(h=g[xo]||g[zn]){if(g=h.alternate,h.child!==null||g!==null&&g.child!==null)for(c=Fx(c);c!==null;){if(g=c[zn])return g;c=Fx(c)}return h}c=g,g=c.parentNode}return null}function Ao(c){if(c=c[zn]||c[xo]){var h=c.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return c}return null}function il(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c.stateNode;throw Error(i(33))}function wo(c){var h=c[TE];return h||(h=c[TE]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Rn(c){c[nl]=!0}var xE=new Set,SE={};function Ta(c,h){Co(c,h),Co(c+"Capture",h)}function Co(c,h){for(SE[c]=h,c=0;c<h.length;c++)xE.add(h[c])}var mP=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),AE={},wE={};function gP(c){return Ie.call(wE,c)?!0:Ie.call(AE,c)?!1:mP.test(c)?wE[c]=!0:(AE[c]=!0,!1)}function ud(c,h,g){if(gP(h))if(g===null)c.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":c.removeAttribute(h);return;case"boolean":var v=h.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){c.removeAttribute(h);return}}c.setAttribute(h,""+g)}}function ld(c,h,g){if(g===null)c.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(h);return}c.setAttribute(h,""+g)}}function Ur(c,h,g,v){if(v===null)c.removeAttribute(g);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(g);return}c.setAttributeNS(h,g,""+v)}}var W0,CE;function Ro(c){if(W0===void 0)try{throw Error()}catch(g){var h=g.stack.trim().match(/\n( *(at )?)/);W0=h&&h[1]||"",CE=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+W0+c+CE}var $0=!1;function Y0(c,h){if(!c||$0)return"";$0=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(h){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(Ee){var be=Ee}Reflect.construct(c,[],ke)}else{try{ke.call()}catch(Ee){be=Ee}c.call(ke.prototype)}}else{try{throw Error()}catch(Ee){be=Ee}(ke=c())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(Ee){if(Ee&&be&&typeof Ee.stack=="string")return[Ee.stack,be.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var R=v.DetermineComponentFrameRoot(),z=R[0],W=R[1];if(z&&W){var se=z.split(`
`),ve=W.split(`
`);for(A=v=0;v<se.length&&!se[v].includes("DetermineComponentFrameRoot");)v++;for(;A<ve.length&&!ve[A].includes("DetermineComponentFrameRoot");)A++;if(v===se.length||A===ve.length)for(v=se.length-1,A=ve.length-1;1<=v&&0<=A&&se[v]!==ve[A];)A--;for(;1<=v&&0<=A;v--,A--)if(se[v]!==ve[A]){if(v!==1||A!==1)do if(v--,A--,0>A||se[v]!==ve[A]){var Re=`
`+se[v].replace(" at new "," at ");return c.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",c.displayName)),Re}while(1<=v&&0<=A);break}}}finally{$0=!1,Error.prepareStackTrace=g}return(g=c?c.displayName||c.name:"")?Ro(g):""}function yP(c){switch(c.tag){case 26:case 27:case 5:return Ro(c.type);case 16:return Ro("Lazy");case 13:return Ro("Suspense");case 19:return Ro("SuspenseList");case 0:case 15:return Y0(c.type,!1);case 11:return Y0(c.type.render,!1);case 1:return Y0(c.type,!0);case 31:return Ro("Activity");default:return""}}function RE(c){try{var h="";do h+=yP(c),c=c.return;while(c);return h}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function Di(c){switch(typeof c){case"bigint":case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function _E(c){var h=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function vP(c){var h=_E(c)?"checked":"value",g=Object.getOwnPropertyDescriptor(c.constructor.prototype,h),v=""+c[h];if(!c.hasOwnProperty(h)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var A=g.get,R=g.set;return Object.defineProperty(c,h,{configurable:!0,get:function(){return A.call(this)},set:function(z){v=""+z,R.call(this,z)}}),Object.defineProperty(c,h,{enumerable:g.enumerable}),{getValue:function(){return v},setValue:function(z){v=""+z},stopTracking:function(){c._valueTracker=null,delete c[h]}}}}function cd(c){c._valueTracker||(c._valueTracker=vP(c))}function IE(c){if(!c)return!1;var h=c._valueTracker;if(!h)return!0;var g=h.getValue(),v="";return c&&(v=_E(c)?c.checked?"true":"false":c.value),c=v,c!==g?(h.setValue(c),!0):!1}function dd(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}var bP=/[\n"\\]/g;function Oi(c){return c.replace(bP,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function K0(c,h,g,v,A,R,z,W){c.name="",z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?c.type=z:c.removeAttribute("type"),h!=null?z==="number"?(h===0&&c.value===""||c.value!=h)&&(c.value=""+Di(h)):c.value!==""+Di(h)&&(c.value=""+Di(h)):z!=="submit"&&z!=="reset"||c.removeAttribute("value"),h!=null?X0(c,z,Di(h)):g!=null?X0(c,z,Di(g)):v!=null&&c.removeAttribute("value"),A==null&&R!=null&&(c.defaultChecked=!!R),A!=null&&(c.checked=A&&typeof A!="function"&&typeof A!="symbol"),W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?c.name=""+Di(W):c.removeAttribute("name")}function LE(c,h,g,v,A,R,z,W){if(R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(c.type=R),h!=null||g!=null){if(!(R!=="submit"&&R!=="reset"||h!=null))return;g=g!=null?""+Di(g):"",h=h!=null?""+Di(h):g,W||h===c.value||(c.value=h),c.defaultValue=h}v=v??A,v=typeof v!="function"&&typeof v!="symbol"&&!!v,c.checked=W?c.checked:!!v,c.defaultChecked=!!v,z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(c.name=z)}function X0(c,h,g){h==="number"&&dd(c.ownerDocument)===c||c.defaultValue===""+g||(c.defaultValue=""+g)}function _o(c,h,g,v){if(c=c.options,h){h={};for(var A=0;A<g.length;A++)h["$"+g[A]]=!0;for(g=0;g<c.length;g++)A=h.hasOwnProperty("$"+c[g].value),c[g].selected!==A&&(c[g].selected=A),A&&v&&(c[g].defaultSelected=!0)}else{for(g=""+Di(g),h=null,A=0;A<c.length;A++){if(c[A].value===g){c[A].selected=!0,v&&(c[A].defaultSelected=!0);return}h!==null||c[A].disabled||(h=c[A])}h!==null&&(h.selected=!0)}}function DE(c,h,g){if(h!=null&&(h=""+Di(h),h!==c.value&&(c.value=h),g==null)){c.defaultValue!==h&&(c.defaultValue=h);return}c.defaultValue=g!=null?""+Di(g):""}function OE(c,h,g,v){if(h==null){if(v!=null){if(g!=null)throw Error(i(92));if(K(v)){if(1<v.length)throw Error(i(93));v=v[0]}g=v}g==null&&(g=""),h=g}g=Di(h),c.defaultValue=g,v=c.textContent,v===g&&v!==""&&v!==null&&(c.value=v)}function Io(c,h){if(h){var g=c.firstChild;if(g&&g===c.lastChild&&g.nodeType===3){g.nodeValue=h;return}}c.textContent=h}var EP=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function PE(c,h,g){var v=h.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?v?c.setProperty(h,""):h==="float"?c.cssFloat="":c[h]="":v?c.setProperty(h,g):typeof g!="number"||g===0||EP.has(h)?h==="float"?c.cssFloat=g:c[h]=(""+g).trim():c[h]=g+"px"}function kE(c,h,g){if(h!=null&&typeof h!="object")throw Error(i(62));if(c=c.style,g!=null){for(var v in g)!g.hasOwnProperty(v)||h!=null&&h.hasOwnProperty(v)||(v.indexOf("--")===0?c.setProperty(v,""):v==="float"?c.cssFloat="":c[v]="");for(var A in h)v=h[A],h.hasOwnProperty(A)&&g[A]!==v&&PE(c,A,v)}else for(var R in h)h.hasOwnProperty(R)&&PE(c,R,h[R])}function Q0(c){if(c.indexOf("-")===-1)return!1;switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var TP=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xP=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function fd(c){return xP.test(""+c)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":c}var Z0=null;function J0(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Lo=null,Do=null;function NE(c){var h=Ao(c);if(h&&(c=h.stateNode)){var g=c[ei]||null;e:switch(c=h.stateNode,h.type){case"input":if(K0(c,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),h=g.name,g.type==="radio"&&h!=null){for(g=c;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Oi(""+h)+'"][type="radio"]'),h=0;h<g.length;h++){var v=g[h];if(v!==c&&v.form===c.form){var A=v[ei]||null;if(!A)throw Error(i(90));K0(v,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(h=0;h<g.length;h++)v=g[h],v.form===c.form&&IE(v)}break e;case"textarea":DE(c,g.value,g.defaultValue);break e;case"select":h=g.value,h!=null&&_o(c,!!g.multiple,h,!1)}}}var ep=!1;function ME(c,h,g){if(ep)return c(h,g);ep=!0;try{var v=c(h);return v}finally{if(ep=!1,(Lo!==null||Do!==null)&&(Qd(),Lo&&(h=Lo,c=Do,Do=Lo=null,NE(h),c)))for(h=0;h<c.length;h++)NE(c[h])}}function rl(c,h){var g=c.stateNode;if(g===null)return null;var v=g[ei]||null;if(v===null)return null;g=v[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(c=c.type,v=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!v;break e;default:c=!1}if(c)return null;if(g&&typeof g!="function")throw Error(i(231,h,typeof g));return g}var Hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tp=!1;if(Hr)try{var sl={};Object.defineProperty(sl,"passive",{get:function(){tp=!0}}),window.addEventListener("test",sl,sl),window.removeEventListener("test",sl,sl)}catch{tp=!1}var As=null,np=null,hd=null;function BE(){if(hd)return hd;var c,h=np,g=h.length,v,A="value"in As?As.value:As.textContent,R=A.length;for(c=0;c<g&&h[c]===A[c];c++);var z=g-c;for(v=1;v<=z&&h[g-v]===A[R-v];v++);return hd=A.slice(c,1<v?1-v:void 0)}function pd(c){var h=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&h===13&&(c=13)):c=h,c===10&&(c=13),32<=c||c===13?c:0}function md(){return!0}function FE(){return!1}function ti(c){function h(g,v,A,R,z){this._reactName=g,this._targetInst=A,this.type=v,this.nativeEvent=R,this.target=z,this.currentTarget=null;for(var W in c)c.hasOwnProperty(W)&&(g=c[W],this[W]=g?g(R):R[W]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?md:FE,this.isPropagationStopped=FE,this}return d(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=md)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=md)},persist:function(){},isPersistent:md}),h}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gd=ti(xa),al=d({},xa,{view:0,detail:0}),SP=ti(al),ip,rp,ol,yd=d({},al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ap,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==ol&&(ol&&c.type==="mousemove"?(ip=c.screenX-ol.screenX,rp=c.screenY-ol.screenY):rp=ip=0,ol=c),ip)},movementY:function(c){return"movementY"in c?c.movementY:rp}}),UE=ti(yd),AP=d({},yd,{dataTransfer:0}),wP=ti(AP),CP=d({},al,{relatedTarget:0}),sp=ti(CP),RP=d({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),_P=ti(RP),IP=d({},xa,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),LP=ti(IP),DP=d({},xa,{data:0}),HE=ti(DP),OP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},PP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NP(c){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(c):(c=kP[c])?!!h[c]:!1}function ap(){return NP}var MP=d({},al,{key:function(c){if(c.key){var h=OP[c.key]||c.key;if(h!=="Unidentified")return h}return c.type==="keypress"?(c=pd(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?PP[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ap,charCode:function(c){return c.type==="keypress"?pd(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?pd(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),BP=ti(MP),FP=d({},yd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zE=ti(FP),UP=d({},al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ap}),HP=ti(UP),zP=d({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),qP=ti(zP),VP=d({},yd,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),GP=ti(VP),jP=d({},xa,{newState:0,oldState:0}),WP=ti(jP),$P=[9,13,27,32],op=Hr&&"CompositionEvent"in window,ul=null;Hr&&"documentMode"in document&&(ul=document.documentMode);var YP=Hr&&"TextEvent"in window&&!ul,qE=Hr&&(!op||ul&&8<ul&&11>=ul),VE=" ",GE=!1;function jE(c,h){switch(c){case"keyup":return $P.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WE(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Oo=!1;function KP(c,h){switch(c){case"compositionend":return WE(h);case"keypress":return h.which!==32?null:(GE=!0,VE);case"textInput":return c=h.data,c===VE&&GE?null:c;default:return null}}function XP(c,h){if(Oo)return c==="compositionend"||!op&&jE(c,h)?(c=BE(),hd=np=As=null,Oo=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return qE&&h.locale!=="ko"?null:h.data;default:return null}}var QP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $E(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h==="input"?!!QP[c.type]:h==="textarea"}function YE(c,h,g,v){Lo?Do?Do.push(v):Do=[v]:Lo=v,h=rf(h,"onChange"),0<h.length&&(g=new gd("onChange","change",null,g,v),c.push({event:g,listeners:h}))}var ll=null,cl=null;function ZP(c){_x(c,0)}function vd(c){var h=il(c);if(IE(h))return c}function KE(c,h){if(c==="change")return h}var XE=!1;if(Hr){var up;if(Hr){var lp="oninput"in document;if(!lp){var QE=document.createElement("div");QE.setAttribute("oninput","return;"),lp=typeof QE.oninput=="function"}up=lp}else up=!1;XE=up&&(!document.documentMode||9<document.documentMode)}function ZE(){ll&&(ll.detachEvent("onpropertychange",JE),cl=ll=null)}function JE(c){if(c.propertyName==="value"&&vd(cl)){var h=[];YE(h,cl,c,J0(c)),ME(ZP,h)}}function JP(c,h,g){c==="focusin"?(ZE(),ll=h,cl=g,ll.attachEvent("onpropertychange",JE)):c==="focusout"&&ZE()}function ek(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return vd(cl)}function tk(c,h){if(c==="click")return vd(h)}function nk(c,h){if(c==="input"||c==="change")return vd(h)}function ik(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var pi=typeof Object.is=="function"?Object.is:ik;function dl(c,h){if(pi(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var g=Object.keys(c),v=Object.keys(h);if(g.length!==v.length)return!1;for(v=0;v<g.length;v++){var A=g[v];if(!Ie.call(h,A)||!pi(c[A],h[A]))return!1}return!0}function eT(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function tT(c,h){var g=eT(c);c=0;for(var v;g;){if(g.nodeType===3){if(v=c+g.textContent.length,c<=h&&v>=h)return{node:g,offset:h-c};c=v}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=eT(g)}}function nT(c,h){return c&&h?c===h?!0:c&&c.nodeType===3?!1:h&&h.nodeType===3?nT(c,h.parentNode):"contains"in c?c.contains(h):c.compareDocumentPosition?!!(c.compareDocumentPosition(h)&16):!1:!1}function iT(c){c=c!=null&&c.ownerDocument!=null&&c.ownerDocument.defaultView!=null?c.ownerDocument.defaultView:window;for(var h=dd(c.document);h instanceof c.HTMLIFrameElement;){try{var g=typeof h.contentWindow.location.href=="string"}catch{g=!1}if(g)c=h.contentWindow;else break;h=dd(c.document)}return h}function cp(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h&&(h==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||h==="textarea"||c.contentEditable==="true")}var rk=Hr&&"documentMode"in document&&11>=document.documentMode,Po=null,dp=null,fl=null,fp=!1;function rT(c,h,g){var v=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;fp||Po==null||Po!==dd(v)||(v=Po,"selectionStart"in v&&cp(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),fl&&dl(fl,v)||(fl=v,v=rf(dp,"onSelect"),0<v.length&&(h=new gd("onSelect","select",null,h,g),c.push({event:h,listeners:v}),h.target=Po)))}function Sa(c,h){var g={};return g[c.toLowerCase()]=h.toLowerCase(),g["Webkit"+c]="webkit"+h,g["Moz"+c]="moz"+h,g}var ko={animationend:Sa("Animation","AnimationEnd"),animationiteration:Sa("Animation","AnimationIteration"),animationstart:Sa("Animation","AnimationStart"),transitionrun:Sa("Transition","TransitionRun"),transitionstart:Sa("Transition","TransitionStart"),transitioncancel:Sa("Transition","TransitionCancel"),transitionend:Sa("Transition","TransitionEnd")},hp={},sT={};Hr&&(sT=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function Aa(c){if(hp[c])return hp[c];if(!ko[c])return c;var h=ko[c],g;for(g in h)if(h.hasOwnProperty(g)&&g in sT)return hp[c]=h[g];return c}var aT=Aa("animationend"),oT=Aa("animationiteration"),uT=Aa("animationstart"),sk=Aa("transitionrun"),ak=Aa("transitionstart"),ok=Aa("transitioncancel"),lT=Aa("transitionend"),cT=new Map,pp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pp.push("scrollEnd");function Yi(c,h){cT.set(c,h),Ta(h,[c])}var dT=new WeakMap;function Pi(c,h){if(typeof c=="object"&&c!==null){var g=dT.get(c);return g!==void 0?g:(h={value:c,source:h,stack:RE(h)},dT.set(c,h),h)}return{value:c,source:h,stack:RE(h)}}var ki=[],No=0,mp=0;function bd(){for(var c=No,h=mp=No=0;h<c;){var g=ki[h];ki[h++]=null;var v=ki[h];ki[h++]=null;var A=ki[h];ki[h++]=null;var R=ki[h];if(ki[h++]=null,v!==null&&A!==null){var z=v.pending;z===null?A.next=A:(A.next=z.next,z.next=A),v.pending=A}R!==0&&fT(g,A,R)}}function Ed(c,h,g,v){ki[No++]=c,ki[No++]=h,ki[No++]=g,ki[No++]=v,mp|=v,c.lanes|=v,c=c.alternate,c!==null&&(c.lanes|=v)}function gp(c,h,g,v){return Ed(c,h,g,v),Td(c)}function Mo(c,h){return Ed(c,null,null,h),Td(c)}function fT(c,h,g){c.lanes|=g;var v=c.alternate;v!==null&&(v.lanes|=g);for(var A=!1,R=c.return;R!==null;)R.childLanes|=g,v=R.alternate,v!==null&&(v.childLanes|=g),R.tag===22&&(c=R.stateNode,c===null||c._visibility&1||(A=!0)),c=R,R=R.return;return c.tag===3?(R=c.stateNode,A&&h!==null&&(A=31-B(g),c=R.hiddenUpdates,v=c[A],v===null?c[A]=[h]:v.push(h),h.lane=g|536870912),R):null}function Td(c){if(50<Bl)throw Bl=0,xm=null,Error(i(185));for(var h=c.return;h!==null;)c=h,h=c.return;return c.tag===3?c.stateNode:null}var Bo={};function uk(c,h,g,v){this.tag=c,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mi(c,h,g,v){return new uk(c,h,g,v)}function yp(c){return c=c.prototype,!(!c||!c.isReactComponent)}function zr(c,h){var g=c.alternate;return g===null?(g=mi(c.tag,h,c.key,c.mode),g.elementType=c.elementType,g.type=c.type,g.stateNode=c.stateNode,g.alternate=c,c.alternate=g):(g.pendingProps=h,g.type=c.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=c.flags&65011712,g.childLanes=c.childLanes,g.lanes=c.lanes,g.child=c.child,g.memoizedProps=c.memoizedProps,g.memoizedState=c.memoizedState,g.updateQueue=c.updateQueue,h=c.dependencies,g.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},g.sibling=c.sibling,g.index=c.index,g.ref=c.ref,g.refCleanup=c.refCleanup,g}function hT(c,h){c.flags&=65011714;var g=c.alternate;return g===null?(c.childLanes=0,c.lanes=h,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=g.childLanes,c.lanes=g.lanes,c.child=g.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=g.memoizedProps,c.memoizedState=g.memoizedState,c.updateQueue=g.updateQueue,c.type=g.type,h=g.dependencies,c.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),c}function xd(c,h,g,v,A,R){var z=0;if(v=c,typeof c=="function")yp(c)&&(z=1);else if(typeof c=="string")z=cN(c,g,ye.current)?26:c==="html"||c==="head"||c==="body"?27:5;else e:switch(c){case G:return c=mi(31,g,h,A),c.elementType=G,c.lanes=R,c;case y:return wa(g.children,A,R,h);case b:z=8,A|=24;break;case E:return c=mi(12,g,h,A|2),c.elementType=E,c.lanes=R,c;case C:return c=mi(13,g,h,A),c.elementType=C,c.lanes=R,c;case I:return c=mi(19,g,h,A),c.elementType=I,c.lanes=R,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case T:case S:z=10;break e;case x:z=9;break e;case w:z=11;break e;case L:z=14;break e;case N:z=16,v=null;break e}z=29,g=Error(i(130,c===null?"null":typeof c,"")),v=null}return h=mi(z,g,h,A),h.elementType=c,h.type=v,h.lanes=R,h}function wa(c,h,g,v){return c=mi(7,c,v,h),c.lanes=g,c}function vp(c,h,g){return c=mi(6,c,null,h),c.lanes=g,c}function bp(c,h,g){return h=mi(4,c.children!==null?c.children:[],c.key,h),h.lanes=g,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}var Fo=[],Uo=0,Sd=null,Ad=0,Ni=[],Mi=0,Ca=null,qr=1,Vr="";function Ra(c,h){Fo[Uo++]=Ad,Fo[Uo++]=Sd,Sd=c,Ad=h}function pT(c,h,g){Ni[Mi++]=qr,Ni[Mi++]=Vr,Ni[Mi++]=Ca,Ca=c;var v=qr;c=Vr;var A=32-B(v)-1;v&=~(1<<A),g+=1;var R=32-B(h)+A;if(30<R){var z=A-A%5;R=(v&(1<<z)-1).toString(32),v>>=z,A-=z,qr=1<<32-B(h)+A|g<<A|v,Vr=R+c}else qr=1<<R|g<<A|v,Vr=c}function Ep(c){c.return!==null&&(Ra(c,1),pT(c,1,0))}function Tp(c){for(;c===Sd;)Sd=Fo[--Uo],Fo[Uo]=null,Ad=Fo[--Uo],Fo[Uo]=null;for(;c===Ca;)Ca=Ni[--Mi],Ni[Mi]=null,Vr=Ni[--Mi],Ni[Mi]=null,qr=Ni[--Mi],Ni[Mi]=null}var Yn=null,on=null,kt=!1,_a=null,dr=!1,xp=Error(i(519));function Ia(c){var h=Error(i(418,""));throw ml(Pi(h,c)),xp}function mT(c){var h=c.stateNode,g=c.type,v=c.memoizedProps;switch(h[zn]=c,h[ei]=v,g){case"dialog":_t("cancel",h),_t("close",h);break;case"iframe":case"object":case"embed":_t("load",h);break;case"video":case"audio":for(g=0;g<Ul.length;g++)_t(Ul[g],h);break;case"source":_t("error",h);break;case"img":case"image":case"link":_t("error",h),_t("load",h);break;case"details":_t("toggle",h);break;case"input":_t("invalid",h),LE(h,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),cd(h);break;case"select":_t("invalid",h);break;case"textarea":_t("invalid",h),OE(h,v.value,v.defaultValue,v.children),cd(h)}g=v.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||h.textContent===""+g||v.suppressHydrationWarning===!0||Ox(h.textContent,g)?(v.popover!=null&&(_t("beforetoggle",h),_t("toggle",h)),v.onScroll!=null&&_t("scroll",h),v.onScrollEnd!=null&&_t("scrollend",h),v.onClick!=null&&(h.onclick=sf),h=!0):h=!1,h||Ia(c)}function gT(c){for(Yn=c.return;Yn;)switch(Yn.tag){case 5:case 13:dr=!1;return;case 27:case 3:dr=!0;return;default:Yn=Yn.return}}function hl(c){if(c!==Yn)return!1;if(!kt)return gT(c),kt=!0,!1;var h=c.tag,g;if((g=h!==3&&h!==27)&&((g=h===5)&&(g=c.type,g=!(g!=="form"&&g!=="button")||Fm(c.type,c.memoizedProps)),g=!g),g&&on&&Ia(c),gT(c),h===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));e:{for(c=c.nextSibling,h=0;c;){if(c.nodeType===8)if(g=c.data,g==="/$"){if(h===0){on=Xi(c.nextSibling);break e}h--}else g!=="$"&&g!=="$!"&&g!=="$?"||h++;c=c.nextSibling}on=null}}else h===27?(h=on,Hs(c.type)?(c=qm,qm=null,on=c):on=h):on=Yn?Xi(c.stateNode.nextSibling):null;return!0}function pl(){on=Yn=null,kt=!1}function yT(){var c=_a;return c!==null&&(ri===null?ri=c:ri.push.apply(ri,c),_a=null),c}function ml(c){_a===null?_a=[c]:_a.push(c)}var Sp=ie(null),La=null,Gr=null;function ws(c,h,g){q(Sp,h._currentValue),h._currentValue=g}function jr(c){c._currentValue=Sp.current,le(Sp)}function Ap(c,h,g){for(;c!==null;){var v=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,v!==null&&(v.childLanes|=h)):v!==null&&(v.childLanes&h)!==h&&(v.childLanes|=h),c===g)break;c=c.return}}function wp(c,h,g,v){var A=c.child;for(A!==null&&(A.return=c);A!==null;){var R=A.dependencies;if(R!==null){var z=A.child;R=R.firstContext;e:for(;R!==null;){var W=R;R=A;for(var se=0;se<h.length;se++)if(W.context===h[se]){R.lanes|=g,W=R.alternate,W!==null&&(W.lanes|=g),Ap(R.return,g,c),v||(z=null);break e}R=W.next}}else if(A.tag===18){if(z=A.return,z===null)throw Error(i(341));z.lanes|=g,R=z.alternate,R!==null&&(R.lanes|=g),Ap(z,g,c),z=null}else z=A.child;if(z!==null)z.return=A;else for(z=A;z!==null;){if(z===c){z=null;break}if(A=z.sibling,A!==null){A.return=z.return,z=A;break}z=z.return}A=z}}function gl(c,h,g,v){c=null;for(var A=h,R=!1;A!==null;){if(!R){if((A.flags&524288)!==0)R=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var z=A.alternate;if(z===null)throw Error(i(387));if(z=z.memoizedProps,z!==null){var W=A.type;pi(A.pendingProps.value,z.value)||(c!==null?c.push(W):c=[W])}}else if(A===Me.current){if(z=A.alternate,z===null)throw Error(i(387));z.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(c!==null?c.push(jl):c=[jl])}A=A.return}c!==null&&wp(h,c,g,v),h.flags|=262144}function wd(c){for(c=c.firstContext;c!==null;){if(!pi(c.context._currentValue,c.memoizedValue))return!0;c=c.next}return!1}function Da(c){La=c,Gr=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function qn(c){return vT(La,c)}function Cd(c,h){return La===null&&Da(c),vT(c,h)}function vT(c,h){var g=h._currentValue;if(h={context:h,memoizedValue:g,next:null},Gr===null){if(c===null)throw Error(i(308));Gr=h,c.dependencies={lanes:0,firstContext:h},c.flags|=524288}else Gr=Gr.next=h;return g}var lk=typeof AbortController<"u"?AbortController:function(){var c=[],h=this.signal={aborted:!1,addEventListener:function(g,v){c.push(v)}};this.abort=function(){h.aborted=!0,c.forEach(function(g){return g()})}},ck=t.unstable_scheduleCallback,dk=t.unstable_NormalPriority,Tn={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Cp(){return{controller:new lk,data:new Map,refCount:0}}function yl(c){c.refCount--,c.refCount===0&&ck(dk,function(){c.controller.abort()})}var vl=null,Rp=0,Ho=0,zo=null;function fk(c,h){if(vl===null){var g=vl=[];Rp=0,Ho=Im(),zo={status:"pending",value:void 0,then:function(v){g.push(v)}}}return Rp++,h.then(bT,bT),h}function bT(){if(--Rp===0&&vl!==null){zo!==null&&(zo.status="fulfilled");var c=vl;vl=null,Ho=0,zo=null;for(var h=0;h<c.length;h++)(0,c[h])()}}function hk(c,h){var g=[],v={status:"pending",value:null,reason:null,then:function(A){g.push(A)}};return c.then(function(){v.status="fulfilled",v.value=h;for(var A=0;A<g.length;A++)(0,g[A])(h)},function(A){for(v.status="rejected",v.reason=A,A=0;A<g.length;A++)(0,g[A])(void 0)}),v}var ET=j.S;j.S=function(c,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&fk(c,h),ET!==null&&ET(c,h)};var Oa=ie(null);function _p(){var c=Oa.current;return c!==null?c:Kt.pooledCache}function Rd(c,h){h===null?q(Oa,Oa.current):q(Oa,h.pool)}function TT(){var c=_p();return c===null?null:{parent:Tn._currentValue,pool:c}}var bl=Error(i(460)),xT=Error(i(474)),_d=Error(i(542)),Ip={then:function(){}};function ST(c){return c=c.status,c==="fulfilled"||c==="rejected"}function Id(){}function AT(c,h,g){switch(g=c[g],g===void 0?c.push(h):g!==h&&(h.then(Id,Id),h=g),h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,CT(c),c;default:if(typeof h.status=="string")h.then(Id,Id);else{if(c=Kt,c!==null&&100<c.shellSuspendCounter)throw Error(i(482));c=h,c.status="pending",c.then(function(v){if(h.status==="pending"){var A=h;A.status="fulfilled",A.value=v}},function(v){if(h.status==="pending"){var A=h;A.status="rejected",A.reason=v}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,CT(c),c}throw El=h,bl}}var El=null;function wT(){if(El===null)throw Error(i(459));var c=El;return El=null,c}function CT(c){if(c===bl||c===_d)throw Error(i(483))}var Cs=!1;function Lp(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dp(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function Rs(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function _s(c,h,g){var v=c.updateQueue;if(v===null)return null;if(v=v.shared,(Nt&2)!==0){var A=v.pending;return A===null?h.next=h:(h.next=A.next,A.next=h),v.pending=h,h=Td(c),fT(c,null,g),h}return Ed(c,v,h,g),Td(c)}function Tl(c,h,g){if(h=h.updateQueue,h!==null&&(h=h.shared,(g&4194048)!==0)){var v=h.lanes;v&=c.pendingLanes,g|=v,h.lanes=g,bE(c,g)}}function Op(c,h){var g=c.updateQueue,v=c.alternate;if(v!==null&&(v=v.updateQueue,g===v)){var A=null,R=null;if(g=g.firstBaseUpdate,g!==null){do{var z={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};R===null?A=R=z:R=R.next=z,g=g.next}while(g!==null);R===null?A=R=h:R=R.next=h}else A=R=h;g={baseState:v.baseState,firstBaseUpdate:A,lastBaseUpdate:R,shared:v.shared,callbacks:v.callbacks},c.updateQueue=g;return}c=g.lastBaseUpdate,c===null?g.firstBaseUpdate=h:c.next=h,g.lastBaseUpdate=h}var Pp=!1;function xl(){if(Pp){var c=zo;if(c!==null)throw c}}function Sl(c,h,g,v){Pp=!1;var A=c.updateQueue;Cs=!1;var R=A.firstBaseUpdate,z=A.lastBaseUpdate,W=A.shared.pending;if(W!==null){A.shared.pending=null;var se=W,ve=se.next;se.next=null,z===null?R=ve:z.next=ve,z=se;var Re=c.alternate;Re!==null&&(Re=Re.updateQueue,W=Re.lastBaseUpdate,W!==z&&(W===null?Re.firstBaseUpdate=ve:W.next=ve,Re.lastBaseUpdate=se))}if(R!==null){var ke=A.baseState;z=0,Re=ve=se=null,W=R;do{var be=W.lane&-536870913,Ee=be!==W.lane;if(Ee?(Dt&be)===be:(v&be)===be){be!==0&&be===Ho&&(Pp=!0),Re!==null&&(Re=Re.next={lane:0,tag:W.tag,payload:W.payload,callback:null,next:null});e:{var ct=c,ot=W;be=h;var zt=g;switch(ot.tag){case 1:if(ct=ot.payload,typeof ct=="function"){ke=ct.call(zt,ke,be);break e}ke=ct;break e;case 3:ct.flags=ct.flags&-65537|128;case 0:if(ct=ot.payload,be=typeof ct=="function"?ct.call(zt,ke,be):ct,be==null)break e;ke=d({},ke,be);break e;case 2:Cs=!0}}be=W.callback,be!==null&&(c.flags|=64,Ee&&(c.flags|=8192),Ee=A.callbacks,Ee===null?A.callbacks=[be]:Ee.push(be))}else Ee={lane:be,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Re===null?(ve=Re=Ee,se=ke):Re=Re.next=Ee,z|=be;if(W=W.next,W===null){if(W=A.shared.pending,W===null)break;Ee=W,W=Ee.next,Ee.next=null,A.lastBaseUpdate=Ee,A.shared.pending=null}}while(!0);Re===null&&(se=ke),A.baseState=se,A.firstBaseUpdate=ve,A.lastBaseUpdate=Re,R===null&&(A.shared.lanes=0),Ms|=z,c.lanes=z,c.memoizedState=ke}}function RT(c,h){if(typeof c!="function")throw Error(i(191,c));c.call(h)}function _T(c,h){var g=c.callbacks;if(g!==null)for(c.callbacks=null,c=0;c<g.length;c++)RT(g[c],h)}var qo=ie(null),Ld=ie(0);function IT(c,h){c=Zr,q(Ld,c),q(qo,h),Zr=c|h.baseLanes}function kp(){q(Ld,Zr),q(qo,qo.current)}function Np(){Zr=Ld.current,le(qo),le(Ld)}var Is=0,Et=null,Ut=null,pn=null,Dd=!1,Vo=!1,Pa=!1,Od=0,Al=0,Go=null,pk=0;function dn(){throw Error(i(321))}function Mp(c,h){if(h===null)return!1;for(var g=0;g<h.length&&g<c.length;g++)if(!pi(c[g],h[g]))return!1;return!0}function Bp(c,h,g,v,A,R){return Is=R,Et=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,j.H=c===null||c.memoizedState===null?f2:h2,Pa=!1,R=g(v,A),Pa=!1,Vo&&(R=DT(h,g,v,A)),LT(c),R}function LT(c){j.H=Fd;var h=Ut!==null&&Ut.next!==null;if(Is=0,pn=Ut=Et=null,Dd=!1,Al=0,Go=null,h)throw Error(i(300));c===null||_n||(c=c.dependencies,c!==null&&wd(c)&&(_n=!0))}function DT(c,h,g,v){Et=c;var A=0;do{if(Vo&&(Go=null),Al=0,Vo=!1,25<=A)throw Error(i(301));if(A+=1,pn=Ut=null,c.updateQueue!=null){var R=c.updateQueue;R.lastEffect=null,R.events=null,R.stores=null,R.memoCache!=null&&(R.memoCache.index=0)}j.H=Tk,R=h(g,v)}while(Vo);return R}function mk(){var c=j.H,h=c.useState()[0];return h=typeof h.then=="function"?wl(h):h,c=c.useState()[0],(Ut!==null?Ut.memoizedState:null)!==c&&(Et.flags|=1024),h}function Fp(){var c=Od!==0;return Od=0,c}function Up(c,h,g){h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~g}function Hp(c){if(Dd){for(c=c.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}Dd=!1}Is=0,pn=Ut=Et=null,Vo=!1,Al=Od=0,Go=null}function ni(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Et.memoizedState=pn=c:pn=pn.next=c,pn}function mn(){if(Ut===null){var c=Et.alternate;c=c!==null?c.memoizedState:null}else c=Ut.next;var h=pn===null?Et.memoizedState:pn.next;if(h!==null)pn=h,Ut=c;else{if(c===null)throw Et.alternate===null?Error(i(467)):Error(i(310));Ut=c,c={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},pn===null?Et.memoizedState=pn=c:pn=pn.next=c}return pn}function zp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wl(c){var h=Al;return Al+=1,Go===null&&(Go=[]),c=AT(Go,c,h),h=Et,(pn===null?h.memoizedState:pn.next)===null&&(h=h.alternate,j.H=h===null||h.memoizedState===null?f2:h2),c}function Pd(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return wl(c);if(c.$$typeof===S)return qn(c)}throw Error(i(438,String(c)))}function qp(c){var h=null,g=Et.updateQueue;if(g!==null&&(h=g.memoCache),h==null){var v=Et.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(h={data:v.data.map(function(A){return A.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),g===null&&(g=zp(),Et.updateQueue=g),g.memoCache=h,g=h.data[h.index],g===void 0)for(g=h.data[h.index]=Array(c),v=0;v<c;v++)g[v]=O;return h.index++,g}function Wr(c,h){return typeof h=="function"?h(c):h}function kd(c){var h=mn();return Vp(h,Ut,c)}function Vp(c,h,g){var v=c.queue;if(v===null)throw Error(i(311));v.lastRenderedReducer=g;var A=c.baseQueue,R=v.pending;if(R!==null){if(A!==null){var z=A.next;A.next=R.next,R.next=z}h.baseQueue=A=R,v.pending=null}if(R=c.baseState,A===null)c.memoizedState=R;else{h=A.next;var W=z=null,se=null,ve=h,Re=!1;do{var ke=ve.lane&-536870913;if(ke!==ve.lane?(Dt&ke)===ke:(Is&ke)===ke){var be=ve.revertLane;if(be===0)se!==null&&(se=se.next={lane:0,revertLane:0,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null}),ke===Ho&&(Re=!0);else if((Is&be)===be){ve=ve.next,be===Ho&&(Re=!0);continue}else ke={lane:0,revertLane:ve.revertLane,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},se===null?(W=se=ke,z=R):se=se.next=ke,Et.lanes|=be,Ms|=be;ke=ve.action,Pa&&g(R,ke),R=ve.hasEagerState?ve.eagerState:g(R,ke)}else be={lane:ke,revertLane:ve.revertLane,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},se===null?(W=se=be,z=R):se=se.next=be,Et.lanes|=ke,Ms|=ke;ve=ve.next}while(ve!==null&&ve!==h);if(se===null?z=R:se.next=W,!pi(R,c.memoizedState)&&(_n=!0,Re&&(g=zo,g!==null)))throw g;c.memoizedState=R,c.baseState=z,c.baseQueue=se,v.lastRenderedState=R}return A===null&&(v.lanes=0),[c.memoizedState,v.dispatch]}function Gp(c){var h=mn(),g=h.queue;if(g===null)throw Error(i(311));g.lastRenderedReducer=c;var v=g.dispatch,A=g.pending,R=h.memoizedState;if(A!==null){g.pending=null;var z=A=A.next;do R=c(R,z.action),z=z.next;while(z!==A);pi(R,h.memoizedState)||(_n=!0),h.memoizedState=R,h.baseQueue===null&&(h.baseState=R),g.lastRenderedState=R}return[R,v]}function OT(c,h,g){var v=Et,A=mn(),R=kt;if(R){if(g===void 0)throw Error(i(407));g=g()}else g=h();var z=!pi((Ut||A).memoizedState,g);z&&(A.memoizedState=g,_n=!0),A=A.queue;var W=NT.bind(null,v,A,c);if(Cl(2048,8,W,[c]),A.getSnapshot!==h||z||pn!==null&&pn.memoizedState.tag&1){if(v.flags|=2048,jo(9,Nd(),kT.bind(null,v,A,g,h),null),Kt===null)throw Error(i(349));R||(Is&124)!==0||PT(v,h,g)}return g}function PT(c,h,g){c.flags|=16384,c={getSnapshot:h,value:g},h=Et.updateQueue,h===null?(h=zp(),Et.updateQueue=h,h.stores=[c]):(g=h.stores,g===null?h.stores=[c]:g.push(c))}function kT(c,h,g,v){h.value=g,h.getSnapshot=v,MT(h)&&BT(c)}function NT(c,h,g){return g(function(){MT(h)&&BT(c)})}function MT(c){var h=c.getSnapshot;c=c.value;try{var g=h();return!pi(c,g)}catch{return!0}}function BT(c){var h=Mo(c,2);h!==null&&Ei(h,c,2)}function jp(c){var h=ni();if(typeof c=="function"){var g=c;if(c=g(),Pa){je(!0);try{g()}finally{je(!1)}}}return h.memoizedState=h.baseState=c,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wr,lastRenderedState:c},h}function FT(c,h,g,v){return c.baseState=g,Vp(c,Ut,typeof v=="function"?v:Wr)}function gk(c,h,g,v,A){if(Bd(c))throw Error(i(485));if(c=h.action,c!==null){var R={payload:A,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(z){R.listeners.push(z)}};j.T!==null?g(!0):R.isTransition=!1,v(R),g=h.pending,g===null?(R.next=h.pending=R,UT(h,R)):(R.next=g.next,h.pending=g.next=R)}}function UT(c,h){var g=h.action,v=h.payload,A=c.state;if(h.isTransition){var R=j.T,z={};j.T=z;try{var W=g(A,v),se=j.S;se!==null&&se(z,W),HT(c,h,W)}catch(ve){Wp(c,h,ve)}finally{j.T=R}}else try{R=g(A,v),HT(c,h,R)}catch(ve){Wp(c,h,ve)}}function HT(c,h,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(v){zT(c,h,v)},function(v){return Wp(c,h,v)}):zT(c,h,g)}function zT(c,h,g){h.status="fulfilled",h.value=g,qT(h),c.state=g,h=c.pending,h!==null&&(g=h.next,g===h?c.pending=null:(g=g.next,h.next=g,UT(c,g)))}function Wp(c,h,g){var v=c.pending;if(c.pending=null,v!==null){v=v.next;do h.status="rejected",h.reason=g,qT(h),h=h.next;while(h!==v)}c.action=null}function qT(c){c=c.listeners;for(var h=0;h<c.length;h++)(0,c[h])()}function VT(c,h){return h}function GT(c,h){if(kt){var g=Kt.formState;if(g!==null){e:{var v=Et;if(kt){if(on){t:{for(var A=on,R=dr;A.nodeType!==8;){if(!R){A=null;break t}if(A=Xi(A.nextSibling),A===null){A=null;break t}}R=A.data,A=R==="F!"||R==="F"?A:null}if(A){on=Xi(A.nextSibling),v=A.data==="F!";break e}}Ia(v)}v=!1}v&&(h=g[0])}}return g=ni(),g.memoizedState=g.baseState=h,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:VT,lastRenderedState:h},g.queue=v,g=l2.bind(null,Et,v),v.dispatch=g,v=jp(!1),R=Qp.bind(null,Et,!1,v.queue),v=ni(),A={state:h,dispatch:null,action:c,pending:null},v.queue=A,g=gk.bind(null,Et,A,R,g),A.dispatch=g,v.memoizedState=c,[h,g,!1]}function jT(c){var h=mn();return WT(h,Ut,c)}function WT(c,h,g){if(h=Vp(c,h,VT)[0],c=kd(Wr)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var v=wl(h)}catch(z){throw z===bl?_d:z}else v=h;h=mn();var A=h.queue,R=A.dispatch;return g!==h.memoizedState&&(Et.flags|=2048,jo(9,Nd(),yk.bind(null,A,g),null)),[v,R,c]}function yk(c,h){c.action=h}function $T(c){var h=mn(),g=Ut;if(g!==null)return WT(h,g,c);mn(),h=h.memoizedState,g=mn();var v=g.queue.dispatch;return g.memoizedState=c,[h,v,!1]}function jo(c,h,g,v){return c={tag:c,create:g,deps:v,inst:h,next:null},h=Et.updateQueue,h===null&&(h=zp(),Et.updateQueue=h),g=h.lastEffect,g===null?h.lastEffect=c.next=c:(v=g.next,g.next=c,c.next=v,h.lastEffect=c),c}function Nd(){return{destroy:void 0,resource:void 0}}function YT(){return mn().memoizedState}function Md(c,h,g,v){var A=ni();v=v===void 0?null:v,Et.flags|=c,A.memoizedState=jo(1|h,Nd(),g,v)}function Cl(c,h,g,v){var A=mn();v=v===void 0?null:v;var R=A.memoizedState.inst;Ut!==null&&v!==null&&Mp(v,Ut.memoizedState.deps)?A.memoizedState=jo(h,R,g,v):(Et.flags|=c,A.memoizedState=jo(1|h,R,g,v))}function KT(c,h){Md(8390656,8,c,h)}function XT(c,h){Cl(2048,8,c,h)}function QT(c,h){return Cl(4,2,c,h)}function ZT(c,h){return Cl(4,4,c,h)}function JT(c,h){if(typeof h=="function"){c=c();var g=h(c);return function(){typeof g=="function"?g():h(null)}}if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function e2(c,h,g){g=g!=null?g.concat([c]):null,Cl(4,4,JT.bind(null,h,c),g)}function $p(){}function t2(c,h){var g=mn();h=h===void 0?null:h;var v=g.memoizedState;return h!==null&&Mp(h,v[1])?v[0]:(g.memoizedState=[c,h],c)}function n2(c,h){var g=mn();h=h===void 0?null:h;var v=g.memoizedState;if(h!==null&&Mp(h,v[1]))return v[0];if(v=c(),Pa){je(!0);try{c()}finally{je(!1)}}return g.memoizedState=[v,h],v}function Yp(c,h,g){return g===void 0||(Is&1073741824)!==0?c.memoizedState=h:(c.memoizedState=g,c=sx(),Et.lanes|=c,Ms|=c,g)}function i2(c,h,g,v){return pi(g,h)?g:qo.current!==null?(c=Yp(c,g,v),pi(c,h)||(_n=!0),c):(Is&42)===0?(_n=!0,c.memoizedState=g):(c=sx(),Et.lanes|=c,Ms|=c,h)}function r2(c,h,g,v,A){var R=te.p;te.p=R!==0&&8>R?R:8;var z=j.T,W={};j.T=W,Qp(c,!1,h,g);try{var se=A(),ve=j.S;if(ve!==null&&ve(W,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var Re=hk(se,v);Rl(c,h,Re,bi(c))}else Rl(c,h,v,bi(c))}catch(ke){Rl(c,h,{then:function(){},status:"rejected",reason:ke},bi())}finally{te.p=R,j.T=z}}function vk(){}function Kp(c,h,g,v){if(c.tag!==5)throw Error(i(476));var A=s2(c).queue;r2(c,A,h,ne,g===null?vk:function(){return a2(c),g(v)})}function s2(c){var h=c.memoizedState;if(h!==null)return h;h={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wr,lastRenderedState:ne},next:null};var g={};return h.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wr,lastRenderedState:g},next:null},c.memoizedState=h,c=c.alternate,c!==null&&(c.memoizedState=h),h}function a2(c){var h=s2(c).next.queue;Rl(c,h,{},bi())}function Xp(){return qn(jl)}function o2(){return mn().memoizedState}function u2(){return mn().memoizedState}function bk(c){for(var h=c.return;h!==null;){switch(h.tag){case 24:case 3:var g=bi();c=Rs(g);var v=_s(h,c,g);v!==null&&(Ei(v,h,g),Tl(v,h,g)),h={cache:Cp()},c.payload=h;return}h=h.return}}function Ek(c,h,g){var v=bi();g={lane:v,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},Bd(c)?c2(h,g):(g=gp(c,h,g,v),g!==null&&(Ei(g,c,v),d2(g,h,v)))}function l2(c,h,g){var v=bi();Rl(c,h,g,v)}function Rl(c,h,g,v){var A={lane:v,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(Bd(c))c2(h,A);else{var R=c.alternate;if(c.lanes===0&&(R===null||R.lanes===0)&&(R=h.lastRenderedReducer,R!==null))try{var z=h.lastRenderedState,W=R(z,g);if(A.hasEagerState=!0,A.eagerState=W,pi(W,z))return Ed(c,h,A,0),Kt===null&&bd(),!1}catch{}finally{}if(g=gp(c,h,A,v),g!==null)return Ei(g,c,v),d2(g,h,v),!0}return!1}function Qp(c,h,g,v){if(v={lane:2,revertLane:Im(),action:v,hasEagerState:!1,eagerState:null,next:null},Bd(c)){if(h)throw Error(i(479))}else h=gp(c,g,v,2),h!==null&&Ei(h,c,2)}function Bd(c){var h=c.alternate;return c===Et||h!==null&&h===Et}function c2(c,h){Vo=Dd=!0;var g=c.pending;g===null?h.next=h:(h.next=g.next,g.next=h),c.pending=h}function d2(c,h,g){if((g&4194048)!==0){var v=h.lanes;v&=c.pendingLanes,g|=v,h.lanes=g,bE(c,g)}}var Fd={readContext:qn,use:Pd,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useLayoutEffect:dn,useInsertionEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useSyncExternalStore:dn,useId:dn,useHostTransitionStatus:dn,useFormState:dn,useActionState:dn,useOptimistic:dn,useMemoCache:dn,useCacheRefresh:dn},f2={readContext:qn,use:Pd,useCallback:function(c,h){return ni().memoizedState=[c,h===void 0?null:h],c},useContext:qn,useEffect:KT,useImperativeHandle:function(c,h,g){g=g!=null?g.concat([c]):null,Md(4194308,4,JT.bind(null,h,c),g)},useLayoutEffect:function(c,h){return Md(4194308,4,c,h)},useInsertionEffect:function(c,h){Md(4,2,c,h)},useMemo:function(c,h){var g=ni();h=h===void 0?null:h;var v=c();if(Pa){je(!0);try{c()}finally{je(!1)}}return g.memoizedState=[v,h],v},useReducer:function(c,h,g){var v=ni();if(g!==void 0){var A=g(h);if(Pa){je(!0);try{g(h)}finally{je(!1)}}}else A=h;return v.memoizedState=v.baseState=A,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:A},v.queue=c,c=c.dispatch=Ek.bind(null,Et,c),[v.memoizedState,c]},useRef:function(c){var h=ni();return c={current:c},h.memoizedState=c},useState:function(c){c=jp(c);var h=c.queue,g=l2.bind(null,Et,h);return h.dispatch=g,[c.memoizedState,g]},useDebugValue:$p,useDeferredValue:function(c,h){var g=ni();return Yp(g,c,h)},useTransition:function(){var c=jp(!1);return c=r2.bind(null,Et,c.queue,!0,!1),ni().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,h,g){var v=Et,A=ni();if(kt){if(g===void 0)throw Error(i(407));g=g()}else{if(g=h(),Kt===null)throw Error(i(349));(Dt&124)!==0||PT(v,h,g)}A.memoizedState=g;var R={value:g,getSnapshot:h};return A.queue=R,KT(NT.bind(null,v,R,c),[c]),v.flags|=2048,jo(9,Nd(),kT.bind(null,v,R,g,h),null),g},useId:function(){var c=ni(),h=Kt.identifierPrefix;if(kt){var g=Vr,v=qr;g=(v&~(1<<32-B(v)-1)).toString(32)+g,h=""+h+"R"+g,g=Od++,0<g&&(h+="H"+g.toString(32)),h+=""}else g=pk++,h=""+h+"r"+g.toString(32)+"";return c.memoizedState=h},useHostTransitionStatus:Xp,useFormState:GT,useActionState:GT,useOptimistic:function(c){var h=ni();h.memoizedState=h.baseState=c;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=g,h=Qp.bind(null,Et,!0,g),g.dispatch=h,[c,h]},useMemoCache:qp,useCacheRefresh:function(){return ni().memoizedState=bk.bind(null,Et)}},h2={readContext:qn,use:Pd,useCallback:t2,useContext:qn,useEffect:XT,useImperativeHandle:e2,useInsertionEffect:QT,useLayoutEffect:ZT,useMemo:n2,useReducer:kd,useRef:YT,useState:function(){return kd(Wr)},useDebugValue:$p,useDeferredValue:function(c,h){var g=mn();return i2(g,Ut.memoizedState,c,h)},useTransition:function(){var c=kd(Wr)[0],h=mn().memoizedState;return[typeof c=="boolean"?c:wl(c),h]},useSyncExternalStore:OT,useId:o2,useHostTransitionStatus:Xp,useFormState:jT,useActionState:jT,useOptimistic:function(c,h){var g=mn();return FT(g,Ut,c,h)},useMemoCache:qp,useCacheRefresh:u2},Tk={readContext:qn,use:Pd,useCallback:t2,useContext:qn,useEffect:XT,useImperativeHandle:e2,useInsertionEffect:QT,useLayoutEffect:ZT,useMemo:n2,useReducer:Gp,useRef:YT,useState:function(){return Gp(Wr)},useDebugValue:$p,useDeferredValue:function(c,h){var g=mn();return Ut===null?Yp(g,c,h):i2(g,Ut.memoizedState,c,h)},useTransition:function(){var c=Gp(Wr)[0],h=mn().memoizedState;return[typeof c=="boolean"?c:wl(c),h]},useSyncExternalStore:OT,useId:o2,useHostTransitionStatus:Xp,useFormState:$T,useActionState:$T,useOptimistic:function(c,h){var g=mn();return Ut!==null?FT(g,Ut,c,h):(g.baseState=c,[c,g.queue.dispatch])},useMemoCache:qp,useCacheRefresh:u2},Wo=null,_l=0;function Ud(c){var h=_l;return _l+=1,Wo===null&&(Wo=[]),AT(Wo,c,h)}function Il(c,h){h=h.props.ref,c.ref=h!==void 0?h:null}function Hd(c,h){throw h.$$typeof===f?Error(i(525)):(c=Object.prototype.toString.call(h),Error(i(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c)))}function p2(c){var h=c._init;return h(c._payload)}function m2(c){function h(ce,ae){if(c){var me=ce.deletions;me===null?(ce.deletions=[ae],ce.flags|=16):me.push(ae)}}function g(ce,ae){if(!c)return null;for(;ae!==null;)h(ce,ae),ae=ae.sibling;return null}function v(ce){for(var ae=new Map;ce!==null;)ce.key!==null?ae.set(ce.key,ce):ae.set(ce.index,ce),ce=ce.sibling;return ae}function A(ce,ae){return ce=zr(ce,ae),ce.index=0,ce.sibling=null,ce}function R(ce,ae,me){return ce.index=me,c?(me=ce.alternate,me!==null?(me=me.index,me<ae?(ce.flags|=67108866,ae):me):(ce.flags|=67108866,ae)):(ce.flags|=1048576,ae)}function z(ce){return c&&ce.alternate===null&&(ce.flags|=67108866),ce}function W(ce,ae,me,De){return ae===null||ae.tag!==6?(ae=vp(me,ce.mode,De),ae.return=ce,ae):(ae=A(ae,me),ae.return=ce,ae)}function se(ce,ae,me,De){var et=me.type;return et===y?Re(ce,ae,me.props.children,De,me.key):ae!==null&&(ae.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===N&&p2(et)===ae.type)?(ae=A(ae,me.props),Il(ae,me),ae.return=ce,ae):(ae=xd(me.type,me.key,me.props,null,ce.mode,De),Il(ae,me),ae.return=ce,ae)}function ve(ce,ae,me,De){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==me.containerInfo||ae.stateNode.implementation!==me.implementation?(ae=bp(me,ce.mode,De),ae.return=ce,ae):(ae=A(ae,me.children||[]),ae.return=ce,ae)}function Re(ce,ae,me,De,et){return ae===null||ae.tag!==7?(ae=wa(me,ce.mode,De,et),ae.return=ce,ae):(ae=A(ae,me),ae.return=ce,ae)}function ke(ce,ae,me){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=vp(""+ae,ce.mode,me),ae.return=ce,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case p:return me=xd(ae.type,ae.key,ae.props,null,ce.mode,me),Il(me,ae),me.return=ce,me;case m:return ae=bp(ae,ce.mode,me),ae.return=ce,ae;case N:var De=ae._init;return ae=De(ae._payload),ke(ce,ae,me)}if(K(ae)||V(ae))return ae=wa(ae,ce.mode,me,null),ae.return=ce,ae;if(typeof ae.then=="function")return ke(ce,Ud(ae),me);if(ae.$$typeof===S)return ke(ce,Cd(ce,ae),me);Hd(ce,ae)}return null}function be(ce,ae,me,De){var et=ae!==null?ae.key:null;if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return et!==null?null:W(ce,ae,""+me,De);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case p:return me.key===et?se(ce,ae,me,De):null;case m:return me.key===et?ve(ce,ae,me,De):null;case N:return et=me._init,me=et(me._payload),be(ce,ae,me,De)}if(K(me)||V(me))return et!==null?null:Re(ce,ae,me,De,null);if(typeof me.then=="function")return be(ce,ae,Ud(me),De);if(me.$$typeof===S)return be(ce,ae,Cd(ce,me),De);Hd(ce,me)}return null}function Ee(ce,ae,me,De,et){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return ce=ce.get(me)||null,W(ae,ce,""+De,et);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case p:return ce=ce.get(De.key===null?me:De.key)||null,se(ae,ce,De,et);case m:return ce=ce.get(De.key===null?me:De.key)||null,ve(ae,ce,De,et);case N:var St=De._init;return De=St(De._payload),Ee(ce,ae,me,De,et)}if(K(De)||V(De))return ce=ce.get(me)||null,Re(ae,ce,De,et,null);if(typeof De.then=="function")return Ee(ce,ae,me,Ud(De),et);if(De.$$typeof===S)return Ee(ce,ae,me,Cd(ae,De),et);Hd(ae,De)}return null}function ct(ce,ae,me,De){for(var et=null,St=null,rt=ae,ut=ae=0,Ln=null;rt!==null&&ut<me.length;ut++){rt.index>ut?(Ln=rt,rt=null):Ln=rt.sibling;var Pt=be(ce,rt,me[ut],De);if(Pt===null){rt===null&&(rt=Ln);break}c&&rt&&Pt.alternate===null&&h(ce,rt),ae=R(Pt,ae,ut),St===null?et=Pt:St.sibling=Pt,St=Pt,rt=Ln}if(ut===me.length)return g(ce,rt),kt&&Ra(ce,ut),et;if(rt===null){for(;ut<me.length;ut++)rt=ke(ce,me[ut],De),rt!==null&&(ae=R(rt,ae,ut),St===null?et=rt:St.sibling=rt,St=rt);return kt&&Ra(ce,ut),et}for(rt=v(rt);ut<me.length;ut++)Ln=Ee(rt,ce,ut,me[ut],De),Ln!==null&&(c&&Ln.alternate!==null&&rt.delete(Ln.key===null?ut:Ln.key),ae=R(Ln,ae,ut),St===null?et=Ln:St.sibling=Ln,St=Ln);return c&&rt.forEach(function(js){return h(ce,js)}),kt&&Ra(ce,ut),et}function ot(ce,ae,me,De){if(me==null)throw Error(i(151));for(var et=null,St=null,rt=ae,ut=ae=0,Ln=null,Pt=me.next();rt!==null&&!Pt.done;ut++,Pt=me.next()){rt.index>ut?(Ln=rt,rt=null):Ln=rt.sibling;var js=be(ce,rt,Pt.value,De);if(js===null){rt===null&&(rt=Ln);break}c&&rt&&js.alternate===null&&h(ce,rt),ae=R(js,ae,ut),St===null?et=js:St.sibling=js,St=js,rt=Ln}if(Pt.done)return g(ce,rt),kt&&Ra(ce,ut),et;if(rt===null){for(;!Pt.done;ut++,Pt=me.next())Pt=ke(ce,Pt.value,De),Pt!==null&&(ae=R(Pt,ae,ut),St===null?et=Pt:St.sibling=Pt,St=Pt);return kt&&Ra(ce,ut),et}for(rt=v(rt);!Pt.done;ut++,Pt=me.next())Pt=Ee(rt,ce,ut,Pt.value,De),Pt!==null&&(c&&Pt.alternate!==null&&rt.delete(Pt.key===null?ut:Pt.key),ae=R(Pt,ae,ut),St===null?et=Pt:St.sibling=Pt,St=Pt);return c&&rt.forEach(function(xN){return h(ce,xN)}),kt&&Ra(ce,ut),et}function zt(ce,ae,me,De){if(typeof me=="object"&&me!==null&&me.type===y&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case p:e:{for(var et=me.key;ae!==null;){if(ae.key===et){if(et=me.type,et===y){if(ae.tag===7){g(ce,ae.sibling),De=A(ae,me.props.children),De.return=ce,ce=De;break e}}else if(ae.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===N&&p2(et)===ae.type){g(ce,ae.sibling),De=A(ae,me.props),Il(De,me),De.return=ce,ce=De;break e}g(ce,ae);break}else h(ce,ae);ae=ae.sibling}me.type===y?(De=wa(me.props.children,ce.mode,De,me.key),De.return=ce,ce=De):(De=xd(me.type,me.key,me.props,null,ce.mode,De),Il(De,me),De.return=ce,ce=De)}return z(ce);case m:e:{for(et=me.key;ae!==null;){if(ae.key===et)if(ae.tag===4&&ae.stateNode.containerInfo===me.containerInfo&&ae.stateNode.implementation===me.implementation){g(ce,ae.sibling),De=A(ae,me.children||[]),De.return=ce,ce=De;break e}else{g(ce,ae);break}else h(ce,ae);ae=ae.sibling}De=bp(me,ce.mode,De),De.return=ce,ce=De}return z(ce);case N:return et=me._init,me=et(me._payload),zt(ce,ae,me,De)}if(K(me))return ct(ce,ae,me,De);if(V(me)){if(et=V(me),typeof et!="function")throw Error(i(150));return me=et.call(me),ot(ce,ae,me,De)}if(typeof me.then=="function")return zt(ce,ae,Ud(me),De);if(me.$$typeof===S)return zt(ce,ae,Cd(ce,me),De);Hd(ce,me)}return typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint"?(me=""+me,ae!==null&&ae.tag===6?(g(ce,ae.sibling),De=A(ae,me),De.return=ce,ce=De):(g(ce,ae),De=vp(me,ce.mode,De),De.return=ce,ce=De),z(ce)):g(ce,ae)}return function(ce,ae,me,De){try{_l=0;var et=zt(ce,ae,me,De);return Wo=null,et}catch(rt){if(rt===bl||rt===_d)throw rt;var St=mi(29,rt,null,ce.mode);return St.lanes=De,St.return=ce,St}finally{}}}var $o=m2(!0),g2=m2(!1),Bi=ie(null),fr=null;function Ls(c){var h=c.alternate;q(xn,xn.current&1),q(Bi,c),fr===null&&(h===null||qo.current!==null||h.memoizedState!==null)&&(fr=c)}function y2(c){if(c.tag===22){if(q(xn,xn.current),q(Bi,c),fr===null){var h=c.alternate;h!==null&&h.memoizedState!==null&&(fr=c)}}else Ds()}function Ds(){q(xn,xn.current),q(Bi,Bi.current)}function $r(c){le(Bi),fr===c&&(fr=null),le(xn)}var xn=ie(0);function zd(c){for(var h=c;h!==null;){if(h.tag===13){var g=h.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||zm(g)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function Zp(c,h,g,v){h=c.memoizedState,g=g(v,h),g=g==null?h:d({},h,g),c.memoizedState=g,c.lanes===0&&(c.updateQueue.baseState=g)}var Jp={enqueueSetState:function(c,h,g){c=c._reactInternals;var v=bi(),A=Rs(v);A.payload=h,g!=null&&(A.callback=g),h=_s(c,A,v),h!==null&&(Ei(h,c,v),Tl(h,c,v))},enqueueReplaceState:function(c,h,g){c=c._reactInternals;var v=bi(),A=Rs(v);A.tag=1,A.payload=h,g!=null&&(A.callback=g),h=_s(c,A,v),h!==null&&(Ei(h,c,v),Tl(h,c,v))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var g=bi(),v=Rs(g);v.tag=2,h!=null&&(v.callback=h),h=_s(c,v,g),h!==null&&(Ei(h,c,g),Tl(h,c,g))}};function v2(c,h,g,v,A,R,z){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(v,R,z):h.prototype&&h.prototype.isPureReactComponent?!dl(g,v)||!dl(A,R):!0}function b2(c,h,g,v){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(g,v),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(g,v),h.state!==c&&Jp.enqueueReplaceState(h,h.state,null)}function ka(c,h){var g=h;if("ref"in h){g={};for(var v in h)v!=="ref"&&(g[v]=h[v])}if(c=c.defaultProps){g===h&&(g=d({},g));for(var A in c)g[A]===void 0&&(g[A]=c[A])}return g}var qd=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)};function E2(c){qd(c)}function T2(c){console.error(c)}function x2(c){qd(c)}function Vd(c,h){try{var g=c.onUncaughtError;g(h.value,{componentStack:h.stack})}catch(v){setTimeout(function(){throw v})}}function S2(c,h,g){try{var v=c.onCaughtError;v(g.value,{componentStack:g.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function em(c,h,g){return g=Rs(g),g.tag=3,g.payload={element:null},g.callback=function(){Vd(c,h)},g}function A2(c){return c=Rs(c),c.tag=3,c}function w2(c,h,g,v){var A=g.type.getDerivedStateFromError;if(typeof A=="function"){var R=v.value;c.payload=function(){return A(R)},c.callback=function(){S2(h,g,v)}}var z=g.stateNode;z!==null&&typeof z.componentDidCatch=="function"&&(c.callback=function(){S2(h,g,v),typeof A!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var W=v.stack;this.componentDidCatch(v.value,{componentStack:W!==null?W:""})})}function xk(c,h,g,v,A){if(g.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(h=g.alternate,h!==null&&gl(h,g,A,!0),g=Bi.current,g!==null){switch(g.tag){case 13:return fr===null?Am():g.alternate===null&&un===0&&(un=3),g.flags&=-257,g.flags|=65536,g.lanes=A,v===Ip?g.flags|=16384:(h=g.updateQueue,h===null?g.updateQueue=new Set([v]):h.add(v),Cm(c,v,A)),!1;case 22:return g.flags|=65536,v===Ip?g.flags|=16384:(h=g.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([v])},g.updateQueue=h):(g=h.retryQueue,g===null?h.retryQueue=new Set([v]):g.add(v)),Cm(c,v,A)),!1}throw Error(i(435,g.tag))}return Cm(c,v,A),Am(),!1}if(kt)return h=Bi.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=A,v!==xp&&(c=Error(i(422),{cause:v}),ml(Pi(c,g)))):(v!==xp&&(h=Error(i(423),{cause:v}),ml(Pi(h,g))),c=c.current.alternate,c.flags|=65536,A&=-A,c.lanes|=A,v=Pi(v,g),A=em(c.stateNode,v,A),Op(c,A),un!==4&&(un=2)),!1;var R=Error(i(520),{cause:v});if(R=Pi(R,g),Ml===null?Ml=[R]:Ml.push(R),un!==4&&(un=2),h===null)return!0;v=Pi(v,g),g=h;do{switch(g.tag){case 3:return g.flags|=65536,c=A&-A,g.lanes|=c,c=em(g.stateNode,v,c),Op(g,c),!1;case 1:if(h=g.type,R=g.stateNode,(g.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Bs===null||!Bs.has(R))))return g.flags|=65536,A&=-A,g.lanes|=A,A=A2(A),w2(A,c,g,v),Op(g,A),!1}g=g.return}while(g!==null);return!1}var C2=Error(i(461)),_n=!1;function kn(c,h,g,v){h.child=c===null?g2(h,null,g,v):$o(h,c.child,g,v)}function R2(c,h,g,v,A){g=g.render;var R=h.ref;if("ref"in v){var z={};for(var W in v)W!=="ref"&&(z[W]=v[W])}else z=v;return Da(h),v=Bp(c,h,g,z,R,A),W=Fp(),c!==null&&!_n?(Up(c,h,A),Yr(c,h,A)):(kt&&W&&Ep(h),h.flags|=1,kn(c,h,v,A),h.child)}function _2(c,h,g,v,A){if(c===null){var R=g.type;return typeof R=="function"&&!yp(R)&&R.defaultProps===void 0&&g.compare===null?(h.tag=15,h.type=R,I2(c,h,R,v,A)):(c=xd(g.type,null,v,h,h.mode,A),c.ref=h.ref,c.return=h,h.child=c)}if(R=c.child,!um(c,A)){var z=R.memoizedProps;if(g=g.compare,g=g!==null?g:dl,g(z,v)&&c.ref===h.ref)return Yr(c,h,A)}return h.flags|=1,c=zr(R,v),c.ref=h.ref,c.return=h,h.child=c}function I2(c,h,g,v,A){if(c!==null){var R=c.memoizedProps;if(dl(R,v)&&c.ref===h.ref)if(_n=!1,h.pendingProps=v=R,um(c,A))(c.flags&131072)!==0&&(_n=!0);else return h.lanes=c.lanes,Yr(c,h,A)}return tm(c,h,g,v,A)}function L2(c,h,g){var v=h.pendingProps,A=v.children,R=c!==null?c.memoizedState:null;if(v.mode==="hidden"){if((h.flags&128)!==0){if(v=R!==null?R.baseLanes|g:g,c!==null){for(A=h.child=c.child,R=0;A!==null;)R=R|A.lanes|A.childLanes,A=A.sibling;h.childLanes=R&~v}else h.childLanes=0,h.child=null;return D2(c,h,v,g)}if((g&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},c!==null&&Rd(h,R!==null?R.cachePool:null),R!==null?IT(h,R):kp(),y2(h);else return h.lanes=h.childLanes=536870912,D2(c,h,R!==null?R.baseLanes|g:g,g)}else R!==null?(Rd(h,R.cachePool),IT(h,R),Ds(),h.memoizedState=null):(c!==null&&Rd(h,null),kp(),Ds());return kn(c,h,A,g),h.child}function D2(c,h,g,v){var A=_p();return A=A===null?null:{parent:Tn._currentValue,pool:A},h.memoizedState={baseLanes:g,cachePool:A},c!==null&&Rd(h,null),kp(),y2(h),c!==null&&gl(c,h,v,!0),null}function Gd(c,h){var g=h.ref;if(g===null)c!==null&&c.ref!==null&&(h.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(i(284));(c===null||c.ref!==g)&&(h.flags|=4194816)}}function tm(c,h,g,v,A){return Da(h),g=Bp(c,h,g,v,void 0,A),v=Fp(),c!==null&&!_n?(Up(c,h,A),Yr(c,h,A)):(kt&&v&&Ep(h),h.flags|=1,kn(c,h,g,A),h.child)}function O2(c,h,g,v,A,R){return Da(h),h.updateQueue=null,g=DT(h,v,g,A),LT(c),v=Fp(),c!==null&&!_n?(Up(c,h,R),Yr(c,h,R)):(kt&&v&&Ep(h),h.flags|=1,kn(c,h,g,R),h.child)}function P2(c,h,g,v,A){if(Da(h),h.stateNode===null){var R=Bo,z=g.contextType;typeof z=="object"&&z!==null&&(R=qn(z)),R=new g(v,R),h.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,R.updater=Jp,h.stateNode=R,R._reactInternals=h,R=h.stateNode,R.props=v,R.state=h.memoizedState,R.refs={},Lp(h),z=g.contextType,R.context=typeof z=="object"&&z!==null?qn(z):Bo,R.state=h.memoizedState,z=g.getDerivedStateFromProps,typeof z=="function"&&(Zp(h,g,z,v),R.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(z=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),z!==R.state&&Jp.enqueueReplaceState(R,R.state,null),Sl(h,v,R,A),xl(),R.state=h.memoizedState),typeof R.componentDidMount=="function"&&(h.flags|=4194308),v=!0}else if(c===null){R=h.stateNode;var W=h.memoizedProps,se=ka(g,W);R.props=se;var ve=R.context,Re=g.contextType;z=Bo,typeof Re=="object"&&Re!==null&&(z=qn(Re));var ke=g.getDerivedStateFromProps;Re=typeof ke=="function"||typeof R.getSnapshotBeforeUpdate=="function",W=h.pendingProps!==W,Re||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(W||ve!==z)&&b2(h,R,v,z),Cs=!1;var be=h.memoizedState;R.state=be,Sl(h,v,R,A),xl(),ve=h.memoizedState,W||be!==ve||Cs?(typeof ke=="function"&&(Zp(h,g,ke,v),ve=h.memoizedState),(se=Cs||v2(h,g,se,v,be,ve,z))?(Re||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(h.flags|=4194308)):(typeof R.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=v,h.memoizedState=ve),R.props=v,R.state=ve,R.context=z,v=se):(typeof R.componentDidMount=="function"&&(h.flags|=4194308),v=!1)}else{R=h.stateNode,Dp(c,h),z=h.memoizedProps,Re=ka(g,z),R.props=Re,ke=h.pendingProps,be=R.context,ve=g.contextType,se=Bo,typeof ve=="object"&&ve!==null&&(se=qn(ve)),W=g.getDerivedStateFromProps,(ve=typeof W=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(z!==ke||be!==se)&&b2(h,R,v,se),Cs=!1,be=h.memoizedState,R.state=be,Sl(h,v,R,A),xl();var Ee=h.memoizedState;z!==ke||be!==Ee||Cs||c!==null&&c.dependencies!==null&&wd(c.dependencies)?(typeof W=="function"&&(Zp(h,g,W,v),Ee=h.memoizedState),(Re=Cs||v2(h,g,Re,v,be,Ee,se)||c!==null&&c.dependencies!==null&&wd(c.dependencies))?(ve||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(v,Ee,se),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(v,Ee,se)),typeof R.componentDidUpdate=="function"&&(h.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof R.componentDidUpdate!="function"||z===c.memoizedProps&&be===c.memoizedState||(h.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||z===c.memoizedProps&&be===c.memoizedState||(h.flags|=1024),h.memoizedProps=v,h.memoizedState=Ee),R.props=v,R.state=Ee,R.context=se,v=Re):(typeof R.componentDidUpdate!="function"||z===c.memoizedProps&&be===c.memoizedState||(h.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||z===c.memoizedProps&&be===c.memoizedState||(h.flags|=1024),v=!1)}return R=v,Gd(c,h),v=(h.flags&128)!==0,R||v?(R=h.stateNode,g=v&&typeof g.getDerivedStateFromError!="function"?null:R.render(),h.flags|=1,c!==null&&v?(h.child=$o(h,c.child,null,A),h.child=$o(h,null,g,A)):kn(c,h,g,A),h.memoizedState=R.state,c=h.child):c=Yr(c,h,A),c}function k2(c,h,g,v){return pl(),h.flags|=256,kn(c,h,g,v),h.child}var nm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function im(c){return{baseLanes:c,cachePool:TT()}}function rm(c,h,g){return c=c!==null?c.childLanes&~g:0,h&&(c|=Fi),c}function N2(c,h,g){var v=h.pendingProps,A=!1,R=(h.flags&128)!==0,z;if((z=R)||(z=c!==null&&c.memoizedState===null?!1:(xn.current&2)!==0),z&&(A=!0,h.flags&=-129),z=(h.flags&32)!==0,h.flags&=-33,c===null){if(kt){if(A?Ls(h):Ds(),kt){var W=on,se;if(se=W){e:{for(se=W,W=dr;se.nodeType!==8;){if(!W){W=null;break e}if(se=Xi(se.nextSibling),se===null){W=null;break e}}W=se}W!==null?(h.memoizedState={dehydrated:W,treeContext:Ca!==null?{id:qr,overflow:Vr}:null,retryLane:536870912,hydrationErrors:null},se=mi(18,null,null,0),se.stateNode=W,se.return=h,h.child=se,Yn=h,on=null,se=!0):se=!1}se||Ia(h)}if(W=h.memoizedState,W!==null&&(W=W.dehydrated,W!==null))return zm(W)?h.lanes=32:h.lanes=536870912,null;$r(h)}return W=v.children,v=v.fallback,A?(Ds(),A=h.mode,W=jd({mode:"hidden",children:W},A),v=wa(v,A,g,null),W.return=h,v.return=h,W.sibling=v,h.child=W,A=h.child,A.memoizedState=im(g),A.childLanes=rm(c,z,g),h.memoizedState=nm,v):(Ls(h),sm(h,W))}if(se=c.memoizedState,se!==null&&(W=se.dehydrated,W!==null)){if(R)h.flags&256?(Ls(h),h.flags&=-257,h=am(c,h,g)):h.memoizedState!==null?(Ds(),h.child=c.child,h.flags|=128,h=null):(Ds(),A=v.fallback,W=h.mode,v=jd({mode:"visible",children:v.children},W),A=wa(A,W,g,null),A.flags|=2,v.return=h,A.return=h,v.sibling=A,h.child=v,$o(h,c.child,null,g),v=h.child,v.memoizedState=im(g),v.childLanes=rm(c,z,g),h.memoizedState=nm,h=A);else if(Ls(h),zm(W)){if(z=W.nextSibling&&W.nextSibling.dataset,z)var ve=z.dgst;z=ve,v=Error(i(419)),v.stack="",v.digest=z,ml({value:v,source:null,stack:null}),h=am(c,h,g)}else if(_n||gl(c,h,g,!1),z=(g&c.childLanes)!==0,_n||z){if(z=Kt,z!==null&&(v=g&-g,v=(v&42)!==0?1:q0(v),v=(v&(z.suspendedLanes|g))!==0?0:v,v!==0&&v!==se.retryLane))throw se.retryLane=v,Mo(c,v),Ei(z,c,v),C2;W.data==="$?"||Am(),h=am(c,h,g)}else W.data==="$?"?(h.flags|=192,h.child=c.child,h=null):(c=se.treeContext,on=Xi(W.nextSibling),Yn=h,kt=!0,_a=null,dr=!1,c!==null&&(Ni[Mi++]=qr,Ni[Mi++]=Vr,Ni[Mi++]=Ca,qr=c.id,Vr=c.overflow,Ca=h),h=sm(h,v.children),h.flags|=4096);return h}return A?(Ds(),A=v.fallback,W=h.mode,se=c.child,ve=se.sibling,v=zr(se,{mode:"hidden",children:v.children}),v.subtreeFlags=se.subtreeFlags&65011712,ve!==null?A=zr(ve,A):(A=wa(A,W,g,null),A.flags|=2),A.return=h,v.return=h,v.sibling=A,h.child=v,v=A,A=h.child,W=c.child.memoizedState,W===null?W=im(g):(se=W.cachePool,se!==null?(ve=Tn._currentValue,se=se.parent!==ve?{parent:ve,pool:ve}:se):se=TT(),W={baseLanes:W.baseLanes|g,cachePool:se}),A.memoizedState=W,A.childLanes=rm(c,z,g),h.memoizedState=nm,v):(Ls(h),g=c.child,c=g.sibling,g=zr(g,{mode:"visible",children:v.children}),g.return=h,g.sibling=null,c!==null&&(z=h.deletions,z===null?(h.deletions=[c],h.flags|=16):z.push(c)),h.child=g,h.memoizedState=null,g)}function sm(c,h){return h=jd({mode:"visible",children:h},c.mode),h.return=c,c.child=h}function jd(c,h){return c=mi(22,c,null,h),c.lanes=0,c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},c}function am(c,h,g){return $o(h,c.child,null,g),c=sm(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function M2(c,h,g){c.lanes|=h;var v=c.alternate;v!==null&&(v.lanes|=h),Ap(c.return,h,g)}function om(c,h,g,v,A){var R=c.memoizedState;R===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:v,tail:g,tailMode:A}:(R.isBackwards=h,R.rendering=null,R.renderingStartTime=0,R.last=v,R.tail=g,R.tailMode=A)}function B2(c,h,g){var v=h.pendingProps,A=v.revealOrder,R=v.tail;if(kn(c,h,v.children,g),v=xn.current,(v&2)!==0)v=v&1|2,h.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&M2(c,g,h);else if(c.tag===19)M2(c,g,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}v&=1}switch(q(xn,v),A){case"forwards":for(g=h.child,A=null;g!==null;)c=g.alternate,c!==null&&zd(c)===null&&(A=g),g=g.sibling;g=A,g===null?(A=h.child,h.child=null):(A=g.sibling,g.sibling=null),om(h,!1,A,g,R);break;case"backwards":for(g=null,A=h.child,h.child=null;A!==null;){if(c=A.alternate,c!==null&&zd(c)===null){h.child=A;break}c=A.sibling,A.sibling=g,g=A,A=c}om(h,!0,g,null,R);break;case"together":om(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Yr(c,h,g){if(c!==null&&(h.dependencies=c.dependencies),Ms|=h.lanes,(g&h.childLanes)===0)if(c!==null){if(gl(c,h,g,!1),(g&h.childLanes)===0)return null}else return null;if(c!==null&&h.child!==c.child)throw Error(i(153));if(h.child!==null){for(c=h.child,g=zr(c,c.pendingProps),h.child=g,g.return=h;c.sibling!==null;)c=c.sibling,g=g.sibling=zr(c,c.pendingProps),g.return=h;g.sibling=null}return h.child}function um(c,h){return(c.lanes&h)!==0?!0:(c=c.dependencies,!!(c!==null&&wd(c)))}function Sk(c,h,g){switch(h.tag){case 3:Fe(h,h.stateNode.containerInfo),ws(h,Tn,c.memoizedState.cache),pl();break;case 27:case 5:Ye(h);break;case 4:Fe(h,h.stateNode.containerInfo);break;case 10:ws(h,h.type,h.memoizedProps.value);break;case 13:var v=h.memoizedState;if(v!==null)return v.dehydrated!==null?(Ls(h),h.flags|=128,null):(g&h.child.childLanes)!==0?N2(c,h,g):(Ls(h),c=Yr(c,h,g),c!==null?c.sibling:null);Ls(h);break;case 19:var A=(c.flags&128)!==0;if(v=(g&h.childLanes)!==0,v||(gl(c,h,g,!1),v=(g&h.childLanes)!==0),A){if(v)return B2(c,h,g);h.flags|=128}if(A=h.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),q(xn,xn.current),v)break;return null;case 22:case 23:return h.lanes=0,L2(c,h,g);case 24:ws(h,Tn,c.memoizedState.cache)}return Yr(c,h,g)}function F2(c,h,g){if(c!==null)if(c.memoizedProps!==h.pendingProps)_n=!0;else{if(!um(c,g)&&(h.flags&128)===0)return _n=!1,Sk(c,h,g);_n=(c.flags&131072)!==0}else _n=!1,kt&&(h.flags&1048576)!==0&&pT(h,Ad,h.index);switch(h.lanes=0,h.tag){case 16:e:{c=h.pendingProps;var v=h.elementType,A=v._init;if(v=A(v._payload),h.type=v,typeof v=="function")yp(v)?(c=ka(v,c),h.tag=1,h=P2(null,h,v,c,g)):(h.tag=0,h=tm(null,h,v,c,g));else{if(v!=null){if(A=v.$$typeof,A===w){h.tag=11,h=R2(null,h,v,c,g);break e}else if(A===L){h.tag=14,h=_2(null,h,v,c,g);break e}}throw h=J(v)||v,Error(i(306,h,""))}}return h;case 0:return tm(c,h,h.type,h.pendingProps,g);case 1:return v=h.type,A=ka(v,h.pendingProps),P2(c,h,v,A,g);case 3:e:{if(Fe(h,h.stateNode.containerInfo),c===null)throw Error(i(387));v=h.pendingProps;var R=h.memoizedState;A=R.element,Dp(c,h),Sl(h,v,null,g);var z=h.memoizedState;if(v=z.cache,ws(h,Tn,v),v!==R.cache&&wp(h,[Tn],g,!0),xl(),v=z.element,R.isDehydrated)if(R={element:v,isDehydrated:!1,cache:z.cache},h.updateQueue.baseState=R,h.memoizedState=R,h.flags&256){h=k2(c,h,v,g);break e}else if(v!==A){A=Pi(Error(i(424)),h),ml(A),h=k2(c,h,v,g);break e}else{switch(c=h.stateNode.containerInfo,c.nodeType){case 9:c=c.body;break;default:c=c.nodeName==="HTML"?c.ownerDocument.body:c}for(on=Xi(c.firstChild),Yn=h,kt=!0,_a=null,dr=!0,g=g2(h,null,v,g),h.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(pl(),v===A){h=Yr(c,h,g);break e}kn(c,h,v,g)}h=h.child}return h;case 26:return Gd(c,h),c===null?(g=qx(h.type,null,h.pendingProps,null))?h.memoizedState=g:kt||(g=h.type,c=h.pendingProps,v=af(we.current).createElement(g),v[zn]=h,v[ei]=c,Mn(v,g,c),Rn(v),h.stateNode=v):h.memoizedState=qx(h.type,c.memoizedProps,h.pendingProps,c.memoizedState),null;case 27:return Ye(h),c===null&&kt&&(v=h.stateNode=Ux(h.type,h.pendingProps,we.current),Yn=h,dr=!0,A=on,Hs(h.type)?(qm=A,on=Xi(v.firstChild)):on=A),kn(c,h,h.pendingProps.children,g),Gd(c,h),c===null&&(h.flags|=4194304),h.child;case 5:return c===null&&kt&&((A=v=on)&&(v=Qk(v,h.type,h.pendingProps,dr),v!==null?(h.stateNode=v,Yn=h,on=Xi(v.firstChild),dr=!1,A=!0):A=!1),A||Ia(h)),Ye(h),A=h.type,R=h.pendingProps,z=c!==null?c.memoizedProps:null,v=R.children,Fm(A,R)?v=null:z!==null&&Fm(A,z)&&(h.flags|=32),h.memoizedState!==null&&(A=Bp(c,h,mk,null,null,g),jl._currentValue=A),Gd(c,h),kn(c,h,v,g),h.child;case 6:return c===null&&kt&&((c=g=on)&&(g=Zk(g,h.pendingProps,dr),g!==null?(h.stateNode=g,Yn=h,on=null,c=!0):c=!1),c||Ia(h)),null;case 13:return N2(c,h,g);case 4:return Fe(h,h.stateNode.containerInfo),v=h.pendingProps,c===null?h.child=$o(h,null,v,g):kn(c,h,v,g),h.child;case 11:return R2(c,h,h.type,h.pendingProps,g);case 7:return kn(c,h,h.pendingProps,g),h.child;case 8:return kn(c,h,h.pendingProps.children,g),h.child;case 12:return kn(c,h,h.pendingProps.children,g),h.child;case 10:return v=h.pendingProps,ws(h,h.type,v.value),kn(c,h,v.children,g),h.child;case 9:return A=h.type._context,v=h.pendingProps.children,Da(h),A=qn(A),v=v(A),h.flags|=1,kn(c,h,v,g),h.child;case 14:return _2(c,h,h.type,h.pendingProps,g);case 15:return I2(c,h,h.type,h.pendingProps,g);case 19:return B2(c,h,g);case 31:return v=h.pendingProps,g=h.mode,v={mode:v.mode,children:v.children},c===null?(g=jd(v,g),g.ref=h.ref,h.child=g,g.return=h,h=g):(g=zr(c.child,v),g.ref=h.ref,h.child=g,g.return=h,h=g),h;case 22:return L2(c,h,g);case 24:return Da(h),v=qn(Tn),c===null?(A=_p(),A===null&&(A=Kt,R=Cp(),A.pooledCache=R,R.refCount++,R!==null&&(A.pooledCacheLanes|=g),A=R),h.memoizedState={parent:v,cache:A},Lp(h),ws(h,Tn,A)):((c.lanes&g)!==0&&(Dp(c,h),Sl(h,null,null,g),xl()),A=c.memoizedState,R=h.memoizedState,A.parent!==v?(A={parent:v,cache:v},h.memoizedState=A,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=A),ws(h,Tn,v)):(v=R.cache,ws(h,Tn,v),v!==A.cache&&wp(h,[Tn],g,!0))),kn(c,h,h.pendingProps.children,g),h.child;case 29:throw h.pendingProps}throw Error(i(156,h.tag))}function Kr(c){c.flags|=4}function U2(c,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)c.flags&=-16777217;else if(c.flags|=16777216,!$x(h)){if(h=Bi.current,h!==null&&((Dt&4194048)===Dt?fr!==null:(Dt&62914560)!==Dt&&(Dt&536870912)===0||h!==fr))throw El=Ip,xT;c.flags|=8192}}function Wd(c,h){h!==null&&(c.flags|=4),c.flags&16384&&(h=c.tag!==22?Fr():536870912,c.lanes|=h,Qo|=h)}function Ll(c,h){if(!kt)switch(c.tailMode){case"hidden":h=c.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?c.tail=null:g.sibling=null;break;case"collapsed":g=c.tail;for(var v=null;g!==null;)g.alternate!==null&&(v=g),g=g.sibling;v===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:v.sibling=null}}function rn(c){var h=c.alternate!==null&&c.alternate.child===c.child,g=0,v=0;if(h)for(var A=c.child;A!==null;)g|=A.lanes|A.childLanes,v|=A.subtreeFlags&65011712,v|=A.flags&65011712,A.return=c,A=A.sibling;else for(A=c.child;A!==null;)g|=A.lanes|A.childLanes,v|=A.subtreeFlags,v|=A.flags,A.return=c,A=A.sibling;return c.subtreeFlags|=v,c.childLanes=g,h}function Ak(c,h,g){var v=h.pendingProps;switch(Tp(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(h),null;case 1:return rn(h),null;case 3:return g=h.stateNode,v=null,c!==null&&(v=c.memoizedState.cache),h.memoizedState.cache!==v&&(h.flags|=2048),jr(Tn),$e(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(c===null||c.child===null)&&(hl(h)?Kr(h):c===null||c.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,yT())),rn(h),null;case 26:return g=h.memoizedState,c===null?(Kr(h),g!==null?(rn(h),U2(h,g)):(rn(h),h.flags&=-16777217)):g?g!==c.memoizedState?(Kr(h),rn(h),U2(h,g)):(rn(h),h.flags&=-16777217):(c.memoizedProps!==v&&Kr(h),rn(h),h.flags&=-16777217),null;case 27:fe(h),g=we.current;var A=h.type;if(c!==null&&h.stateNode!=null)c.memoizedProps!==v&&Kr(h);else{if(!v){if(h.stateNode===null)throw Error(i(166));return rn(h),null}c=ye.current,hl(h)?mT(h):(c=Ux(A,v,g),h.stateNode=c,Kr(h))}return rn(h),null;case 5:if(fe(h),g=h.type,c!==null&&h.stateNode!=null)c.memoizedProps!==v&&Kr(h);else{if(!v){if(h.stateNode===null)throw Error(i(166));return rn(h),null}if(c=ye.current,hl(h))mT(h);else{switch(A=af(we.current),c){case 1:c=A.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:c=A.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":c=A.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":c=A.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":c=A.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild);break;case"select":c=typeof v.is=="string"?A.createElement("select",{is:v.is}):A.createElement("select"),v.multiple?c.multiple=!0:v.size&&(c.size=v.size);break;default:c=typeof v.is=="string"?A.createElement(g,{is:v.is}):A.createElement(g)}}c[zn]=h,c[ei]=v;e:for(A=h.child;A!==null;){if(A.tag===5||A.tag===6)c.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===h)break e;for(;A.sibling===null;){if(A.return===null||A.return===h)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}h.stateNode=c;e:switch(Mn(c,g,v),g){case"button":case"input":case"select":case"textarea":c=!!v.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Kr(h)}}return rn(h),h.flags&=-16777217,null;case 6:if(c&&h.stateNode!=null)c.memoizedProps!==v&&Kr(h);else{if(typeof v!="string"&&h.stateNode===null)throw Error(i(166));if(c=we.current,hl(h)){if(c=h.stateNode,g=h.memoizedProps,v=null,A=Yn,A!==null)switch(A.tag){case 27:case 5:v=A.memoizedProps}c[zn]=h,c=!!(c.nodeValue===g||v!==null&&v.suppressHydrationWarning===!0||Ox(c.nodeValue,g)),c||Ia(h)}else c=af(c).createTextNode(v),c[zn]=h,h.stateNode=c}return rn(h),null;case 13:if(v=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(A=hl(h),v!==null&&v.dehydrated!==null){if(c===null){if(!A)throw Error(i(318));if(A=h.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(i(317));A[zn]=h}else pl(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;rn(h),A=!1}else A=yT(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=A),A=!0;if(!A)return h.flags&256?($r(h),h):($r(h),null)}if($r(h),(h.flags&128)!==0)return h.lanes=g,h;if(g=v!==null,c=c!==null&&c.memoizedState!==null,g){v=h.child,A=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(A=v.alternate.memoizedState.cachePool.pool);var R=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(R=v.memoizedState.cachePool.pool),R!==A&&(v.flags|=2048)}return g!==c&&g&&(h.child.flags|=8192),Wd(h,h.updateQueue),rn(h),null;case 4:return $e(),c===null&&Pm(h.stateNode.containerInfo),rn(h),null;case 10:return jr(h.type),rn(h),null;case 19:if(le(xn),A=h.memoizedState,A===null)return rn(h),null;if(v=(h.flags&128)!==0,R=A.rendering,R===null)if(v)Ll(A,!1);else{if(un!==0||c!==null&&(c.flags&128)!==0)for(c=h.child;c!==null;){if(R=zd(c),R!==null){for(h.flags|=128,Ll(A,!1),c=R.updateQueue,h.updateQueue=c,Wd(h,c),h.subtreeFlags=0,c=g,g=h.child;g!==null;)hT(g,c),g=g.sibling;return q(xn,xn.current&1|2),h.child}c=c.sibling}A.tail!==null&&k()>Kd&&(h.flags|=128,v=!0,Ll(A,!1),h.lanes=4194304)}else{if(!v)if(c=zd(R),c!==null){if(h.flags|=128,v=!0,c=c.updateQueue,h.updateQueue=c,Wd(h,c),Ll(A,!0),A.tail===null&&A.tailMode==="hidden"&&!R.alternate&&!kt)return rn(h),null}else 2*k()-A.renderingStartTime>Kd&&g!==536870912&&(h.flags|=128,v=!0,Ll(A,!1),h.lanes=4194304);A.isBackwards?(R.sibling=h.child,h.child=R):(c=A.last,c!==null?c.sibling=R:h.child=R,A.last=R)}return A.tail!==null?(h=A.tail,A.rendering=h,A.tail=h.sibling,A.renderingStartTime=k(),h.sibling=null,c=xn.current,q(xn,v?c&1|2:c&1),h):(rn(h),null);case 22:case 23:return $r(h),Np(),v=h.memoizedState!==null,c!==null?c.memoizedState!==null!==v&&(h.flags|=8192):v&&(h.flags|=8192),v?(g&536870912)!==0&&(h.flags&128)===0&&(rn(h),h.subtreeFlags&6&&(h.flags|=8192)):rn(h),g=h.updateQueue,g!==null&&Wd(h,g.retryQueue),g=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),v=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(v=h.memoizedState.cachePool.pool),v!==g&&(h.flags|=2048),c!==null&&le(Oa),null;case 24:return g=null,c!==null&&(g=c.memoizedState.cache),h.memoizedState.cache!==g&&(h.flags|=2048),jr(Tn),rn(h),null;case 25:return null;case 30:return null}throw Error(i(156,h.tag))}function wk(c,h){switch(Tp(h),h.tag){case 1:return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return jr(Tn),$e(),c=h.flags,(c&65536)!==0&&(c&128)===0?(h.flags=c&-65537|128,h):null;case 26:case 27:case 5:return fe(h),null;case 13:if($r(h),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(i(340));pl()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return le(xn),null;case 4:return $e(),null;case 10:return jr(h.type),null;case 22:case 23:return $r(h),Np(),c!==null&&le(Oa),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 24:return jr(Tn),null;case 25:return null;default:return null}}function H2(c,h){switch(Tp(h),h.tag){case 3:jr(Tn),$e();break;case 26:case 27:case 5:fe(h);break;case 4:$e();break;case 13:$r(h);break;case 19:le(xn);break;case 10:jr(h.type);break;case 22:case 23:$r(h),Np(),c!==null&&le(Oa);break;case 24:jr(Tn)}}function Dl(c,h){try{var g=h.updateQueue,v=g!==null?g.lastEffect:null;if(v!==null){var A=v.next;g=A;do{if((g.tag&c)===c){v=void 0;var R=g.create,z=g.inst;v=R(),z.destroy=v}g=g.next}while(g!==A)}}catch(W){Gt(h,h.return,W)}}function Os(c,h,g){try{var v=h.updateQueue,A=v!==null?v.lastEffect:null;if(A!==null){var R=A.next;v=R;do{if((v.tag&c)===c){var z=v.inst,W=z.destroy;if(W!==void 0){z.destroy=void 0,A=h;var se=g,ve=W;try{ve()}catch(Re){Gt(A,se,Re)}}}v=v.next}while(v!==R)}}catch(Re){Gt(h,h.return,Re)}}function z2(c){var h=c.updateQueue;if(h!==null){var g=c.stateNode;try{_T(h,g)}catch(v){Gt(c,c.return,v)}}}function q2(c,h,g){g.props=ka(c.type,c.memoizedProps),g.state=c.memoizedState;try{g.componentWillUnmount()}catch(v){Gt(c,h,v)}}function Ol(c,h){try{var g=c.ref;if(g!==null){switch(c.tag){case 26:case 27:case 5:var v=c.stateNode;break;case 30:v=c.stateNode;break;default:v=c.stateNode}typeof g=="function"?c.refCleanup=g(v):g.current=v}}catch(A){Gt(c,h,A)}}function hr(c,h){var g=c.ref,v=c.refCleanup;if(g!==null)if(typeof v=="function")try{v()}catch(A){Gt(c,h,A)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(A){Gt(c,h,A)}else g.current=null}function V2(c){var h=c.type,g=c.memoizedProps,v=c.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":g.autoFocus&&v.focus();break e;case"img":g.src?v.src=g.src:g.srcSet&&(v.srcset=g.srcSet)}}catch(A){Gt(c,c.return,A)}}function lm(c,h,g){try{var v=c.stateNode;Wk(v,c.type,g,h),v[ei]=h}catch(A){Gt(c,c.return,A)}}function G2(c){return c.tag===5||c.tag===3||c.tag===26||c.tag===27&&Hs(c.type)||c.tag===4}function cm(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||G2(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.tag===27&&Hs(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function dm(c,h,g){var v=c.tag;if(v===5||v===6)c=c.stateNode,h?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(c,h):(h=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,h.appendChild(c),g=g._reactRootContainer,g!=null||h.onclick!==null||(h.onclick=sf));else if(v!==4&&(v===27&&Hs(c.type)&&(g=c.stateNode,h=null),c=c.child,c!==null))for(dm(c,h,g),c=c.sibling;c!==null;)dm(c,h,g),c=c.sibling}function $d(c,h,g){var v=c.tag;if(v===5||v===6)c=c.stateNode,h?g.insertBefore(c,h):g.appendChild(c);else if(v!==4&&(v===27&&Hs(c.type)&&(g=c.stateNode),c=c.child,c!==null))for($d(c,h,g),c=c.sibling;c!==null;)$d(c,h,g),c=c.sibling}function j2(c){var h=c.stateNode,g=c.memoizedProps;try{for(var v=c.type,A=h.attributes;A.length;)h.removeAttributeNode(A[0]);Mn(h,v,g),h[zn]=c,h[ei]=g}catch(R){Gt(c,c.return,R)}}var Xr=!1,fn=!1,fm=!1,W2=typeof WeakSet=="function"?WeakSet:Set,In=null;function Ck(c,h){if(c=c.containerInfo,Mm=ff,c=iT(c),cp(c)){if("selectionStart"in c)var g={start:c.selectionStart,end:c.selectionEnd};else e:{g=(g=c.ownerDocument)&&g.defaultView||window;var v=g.getSelection&&g.getSelection();if(v&&v.rangeCount!==0){g=v.anchorNode;var A=v.anchorOffset,R=v.focusNode;v=v.focusOffset;try{g.nodeType,R.nodeType}catch{g=null;break e}var z=0,W=-1,se=-1,ve=0,Re=0,ke=c,be=null;t:for(;;){for(var Ee;ke!==g||A!==0&&ke.nodeType!==3||(W=z+A),ke!==R||v!==0&&ke.nodeType!==3||(se=z+v),ke.nodeType===3&&(z+=ke.nodeValue.length),(Ee=ke.firstChild)!==null;)be=ke,ke=Ee;for(;;){if(ke===c)break t;if(be===g&&++ve===A&&(W=z),be===R&&++Re===v&&(se=z),(Ee=ke.nextSibling)!==null)break;ke=be,be=ke.parentNode}ke=Ee}g=W===-1||se===-1?null:{start:W,end:se}}else g=null}g=g||{start:0,end:0}}else g=null;for(Bm={focusedElem:c,selectionRange:g},ff=!1,In=h;In!==null;)if(h=In,c=h.child,(h.subtreeFlags&1024)!==0&&c!==null)c.return=h,In=c;else for(;In!==null;){switch(h=In,R=h.alternate,c=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((c&1024)!==0&&R!==null){c=void 0,g=h,A=R.memoizedProps,R=R.memoizedState,v=g.stateNode;try{var ct=ka(g.type,A,g.elementType===g.type);c=v.getSnapshotBeforeUpdate(ct,R),v.__reactInternalSnapshotBeforeUpdate=c}catch(ot){Gt(g,g.return,ot)}}break;case 3:if((c&1024)!==0){if(c=h.stateNode.containerInfo,g=c.nodeType,g===9)Hm(c);else if(g===1)switch(c.nodeName){case"HEAD":case"HTML":case"BODY":Hm(c);break;default:c.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(i(163))}if(c=h.sibling,c!==null){c.return=h.return,In=c;break}In=h.return}}function $2(c,h,g){var v=g.flags;switch(g.tag){case 0:case 11:case 15:Ps(c,g),v&4&&Dl(5,g);break;case 1:if(Ps(c,g),v&4)if(c=g.stateNode,h===null)try{c.componentDidMount()}catch(z){Gt(g,g.return,z)}else{var A=ka(g.type,h.memoizedProps);h=h.memoizedState;try{c.componentDidUpdate(A,h,c.__reactInternalSnapshotBeforeUpdate)}catch(z){Gt(g,g.return,z)}}v&64&&z2(g),v&512&&Ol(g,g.return);break;case 3:if(Ps(c,g),v&64&&(c=g.updateQueue,c!==null)){if(h=null,g.child!==null)switch(g.child.tag){case 27:case 5:h=g.child.stateNode;break;case 1:h=g.child.stateNode}try{_T(c,h)}catch(z){Gt(g,g.return,z)}}break;case 27:h===null&&v&4&&j2(g);case 26:case 5:Ps(c,g),h===null&&v&4&&V2(g),v&512&&Ol(g,g.return);break;case 12:Ps(c,g);break;case 13:Ps(c,g),v&4&&X2(c,g),v&64&&(c=g.memoizedState,c!==null&&(c=c.dehydrated,c!==null&&(g=Nk.bind(null,g),Jk(c,g))));break;case 22:if(v=g.memoizedState!==null||Xr,!v){h=h!==null&&h.memoizedState!==null||fn,A=Xr;var R=fn;Xr=v,(fn=h)&&!R?ks(c,g,(g.subtreeFlags&8772)!==0):Ps(c,g),Xr=A,fn=R}break;case 30:break;default:Ps(c,g)}}function Y2(c){var h=c.alternate;h!==null&&(c.alternate=null,Y2(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&j0(h)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}var en=null,ii=!1;function Qr(c,h,g){for(g=g.child;g!==null;)K2(c,h,g),g=g.sibling}function K2(c,h,g){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(he,g)}catch{}switch(g.tag){case 26:fn||hr(g,h),Qr(c,h,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:fn||hr(g,h);var v=en,A=ii;Hs(g.type)&&(en=g.stateNode,ii=!1),Qr(c,h,g),zl(g.stateNode),en=v,ii=A;break;case 5:fn||hr(g,h);case 6:if(v=en,A=ii,en=null,Qr(c,h,g),en=v,ii=A,en!==null)if(ii)try{(en.nodeType===9?en.body:en.nodeName==="HTML"?en.ownerDocument.body:en).removeChild(g.stateNode)}catch(R){Gt(g,h,R)}else try{en.removeChild(g.stateNode)}catch(R){Gt(g,h,R)}break;case 18:en!==null&&(ii?(c=en,Bx(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,g.stateNode),Kl(c)):Bx(en,g.stateNode));break;case 4:v=en,A=ii,en=g.stateNode.containerInfo,ii=!0,Qr(c,h,g),en=v,ii=A;break;case 0:case 11:case 14:case 15:fn||Os(2,g,h),fn||Os(4,g,h),Qr(c,h,g);break;case 1:fn||(hr(g,h),v=g.stateNode,typeof v.componentWillUnmount=="function"&&q2(g,h,v)),Qr(c,h,g);break;case 21:Qr(c,h,g);break;case 22:fn=(v=fn)||g.memoizedState!==null,Qr(c,h,g),fn=v;break;default:Qr(c,h,g)}}function X2(c,h){if(h.memoizedState===null&&(c=h.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{Kl(c)}catch(g){Gt(h,h.return,g)}}function Rk(c){switch(c.tag){case 13:case 19:var h=c.stateNode;return h===null&&(h=c.stateNode=new W2),h;case 22:return c=c.stateNode,h=c._retryCache,h===null&&(h=c._retryCache=new W2),h;default:throw Error(i(435,c.tag))}}function hm(c,h){var g=Rk(c);h.forEach(function(v){var A=Mk.bind(null,c,v);g.has(v)||(g.add(v),v.then(A,A))})}function gi(c,h){var g=h.deletions;if(g!==null)for(var v=0;v<g.length;v++){var A=g[v],R=c,z=h,W=z;e:for(;W!==null;){switch(W.tag){case 27:if(Hs(W.type)){en=W.stateNode,ii=!1;break e}break;case 5:en=W.stateNode,ii=!1;break e;case 3:case 4:en=W.stateNode.containerInfo,ii=!0;break e}W=W.return}if(en===null)throw Error(i(160));K2(R,z,A),en=null,ii=!1,R=A.alternate,R!==null&&(R.return=null),A.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)Q2(h,c),h=h.sibling}var Ki=null;function Q2(c,h){var g=c.alternate,v=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:gi(h,c),yi(c),v&4&&(Os(3,c,c.return),Dl(3,c),Os(5,c,c.return));break;case 1:gi(h,c),yi(c),v&512&&(fn||g===null||hr(g,g.return)),v&64&&Xr&&(c=c.updateQueue,c!==null&&(v=c.callbacks,v!==null&&(g=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=g===null?v:g.concat(v))));break;case 26:var A=Ki;if(gi(h,c),yi(c),v&512&&(fn||g===null||hr(g,g.return)),v&4){var R=g!==null?g.memoizedState:null;if(v=c.memoizedState,g===null)if(v===null)if(c.stateNode===null){e:{v=c.type,g=c.memoizedProps,A=A.ownerDocument||A;t:switch(v){case"title":R=A.getElementsByTagName("title")[0],(!R||R[nl]||R[zn]||R.namespaceURI==="http://www.w3.org/2000/svg"||R.hasAttribute("itemprop"))&&(R=A.createElement(v),A.head.insertBefore(R,A.querySelector("head > title"))),Mn(R,v,g),R[zn]=c,Rn(R),v=R;break e;case"link":var z=jx("link","href",A).get(v+(g.href||""));if(z){for(var W=0;W<z.length;W++)if(R=z[W],R.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&R.getAttribute("rel")===(g.rel==null?null:g.rel)&&R.getAttribute("title")===(g.title==null?null:g.title)&&R.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){z.splice(W,1);break t}}R=A.createElement(v),Mn(R,v,g),A.head.appendChild(R);break;case"meta":if(z=jx("meta","content",A).get(v+(g.content||""))){for(W=0;W<z.length;W++)if(R=z[W],R.getAttribute("content")===(g.content==null?null:""+g.content)&&R.getAttribute("name")===(g.name==null?null:g.name)&&R.getAttribute("property")===(g.property==null?null:g.property)&&R.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&R.getAttribute("charset")===(g.charSet==null?null:g.charSet)){z.splice(W,1);break t}}R=A.createElement(v),Mn(R,v,g),A.head.appendChild(R);break;default:throw Error(i(468,v))}R[zn]=c,Rn(R),v=R}c.stateNode=v}else Wx(A,c.type,c.stateNode);else c.stateNode=Gx(A,v,c.memoizedProps);else R!==v?(R===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):R.count--,v===null?Wx(A,c.type,c.stateNode):Gx(A,v,c.memoizedProps)):v===null&&c.stateNode!==null&&lm(c,c.memoizedProps,g.memoizedProps)}break;case 27:gi(h,c),yi(c),v&512&&(fn||g===null||hr(g,g.return)),g!==null&&v&4&&lm(c,c.memoizedProps,g.memoizedProps);break;case 5:if(gi(h,c),yi(c),v&512&&(fn||g===null||hr(g,g.return)),c.flags&32){A=c.stateNode;try{Io(A,"")}catch(Ee){Gt(c,c.return,Ee)}}v&4&&c.stateNode!=null&&(A=c.memoizedProps,lm(c,A,g!==null?g.memoizedProps:A)),v&1024&&(fm=!0);break;case 6:if(gi(h,c),yi(c),v&4){if(c.stateNode===null)throw Error(i(162));v=c.memoizedProps,g=c.stateNode;try{g.nodeValue=v}catch(Ee){Gt(c,c.return,Ee)}}break;case 3:if(lf=null,A=Ki,Ki=of(h.containerInfo),gi(h,c),Ki=A,yi(c),v&4&&g!==null&&g.memoizedState.isDehydrated)try{Kl(h.containerInfo)}catch(Ee){Gt(c,c.return,Ee)}fm&&(fm=!1,Z2(c));break;case 4:v=Ki,Ki=of(c.stateNode.containerInfo),gi(h,c),yi(c),Ki=v;break;case 12:gi(h,c),yi(c);break;case 13:gi(h,c),yi(c),c.child.flags&8192&&c.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(bm=k()),v&4&&(v=c.updateQueue,v!==null&&(c.updateQueue=null,hm(c,v)));break;case 22:A=c.memoizedState!==null;var se=g!==null&&g.memoizedState!==null,ve=Xr,Re=fn;if(Xr=ve||A,fn=Re||se,gi(h,c),fn=Re,Xr=ve,yi(c),v&8192)e:for(h=c.stateNode,h._visibility=A?h._visibility&-2:h._visibility|1,A&&(g===null||se||Xr||fn||Na(c)),g=null,h=c;;){if(h.tag===5||h.tag===26){if(g===null){se=g=h;try{if(R=se.stateNode,A)z=R.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{W=se.stateNode;var ke=se.memoizedProps.style,be=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;W.style.display=be==null||typeof be=="boolean"?"":(""+be).trim()}}catch(Ee){Gt(se,se.return,Ee)}}}else if(h.tag===6){if(g===null){se=h;try{se.stateNode.nodeValue=A?"":se.memoizedProps}catch(Ee){Gt(se,se.return,Ee)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===c)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break e;for(;h.sibling===null;){if(h.return===null||h.return===c)break e;g===h&&(g=null),h=h.return}g===h&&(g=null),h.sibling.return=h.return,h=h.sibling}v&4&&(v=c.updateQueue,v!==null&&(g=v.retryQueue,g!==null&&(v.retryQueue=null,hm(c,g))));break;case 19:gi(h,c),yi(c),v&4&&(v=c.updateQueue,v!==null&&(c.updateQueue=null,hm(c,v)));break;case 30:break;case 21:break;default:gi(h,c),yi(c)}}function yi(c){var h=c.flags;if(h&2){try{for(var g,v=c.return;v!==null;){if(G2(v)){g=v;break}v=v.return}if(g==null)throw Error(i(160));switch(g.tag){case 27:var A=g.stateNode,R=cm(c);$d(c,R,A);break;case 5:var z=g.stateNode;g.flags&32&&(Io(z,""),g.flags&=-33);var W=cm(c);$d(c,W,z);break;case 3:case 4:var se=g.stateNode.containerInfo,ve=cm(c);dm(c,ve,se);break;default:throw Error(i(161))}}catch(Re){Gt(c,c.return,Re)}c.flags&=-3}h&4096&&(c.flags&=-4097)}function Z2(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var h=c;Z2(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),c=c.sibling}}function Ps(c,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)$2(c,h.alternate,h),h=h.sibling}function Na(c){for(c=c.child;c!==null;){var h=c;switch(h.tag){case 0:case 11:case 14:case 15:Os(4,h,h.return),Na(h);break;case 1:hr(h,h.return);var g=h.stateNode;typeof g.componentWillUnmount=="function"&&q2(h,h.return,g),Na(h);break;case 27:zl(h.stateNode);case 26:case 5:hr(h,h.return),Na(h);break;case 22:h.memoizedState===null&&Na(h);break;case 30:Na(h);break;default:Na(h)}c=c.sibling}}function ks(c,h,g){for(g=g&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var v=h.alternate,A=c,R=h,z=R.flags;switch(R.tag){case 0:case 11:case 15:ks(A,R,g),Dl(4,R);break;case 1:if(ks(A,R,g),v=R,A=v.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(ve){Gt(v,v.return,ve)}if(v=R,A=v.updateQueue,A!==null){var W=v.stateNode;try{var se=A.shared.hiddenCallbacks;if(se!==null)for(A.shared.hiddenCallbacks=null,A=0;A<se.length;A++)RT(se[A],W)}catch(ve){Gt(v,v.return,ve)}}g&&z&64&&z2(R),Ol(R,R.return);break;case 27:j2(R);case 26:case 5:ks(A,R,g),g&&v===null&&z&4&&V2(R),Ol(R,R.return);break;case 12:ks(A,R,g);break;case 13:ks(A,R,g),g&&z&4&&X2(A,R);break;case 22:R.memoizedState===null&&ks(A,R,g),Ol(R,R.return);break;case 30:break;default:ks(A,R,g)}h=h.sibling}}function pm(c,h){var g=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),c=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(c=h.memoizedState.cachePool.pool),c!==g&&(c!=null&&c.refCount++,g!=null&&yl(g))}function mm(c,h){c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&yl(c))}function pr(c,h,g,v){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)J2(c,h,g,v),h=h.sibling}function J2(c,h,g,v){var A=h.flags;switch(h.tag){case 0:case 11:case 15:pr(c,h,g,v),A&2048&&Dl(9,h);break;case 1:pr(c,h,g,v);break;case 3:pr(c,h,g,v),A&2048&&(c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&yl(c)));break;case 12:if(A&2048){pr(c,h,g,v),c=h.stateNode;try{var R=h.memoizedProps,z=R.id,W=R.onPostCommit;typeof W=="function"&&W(z,h.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(se){Gt(h,h.return,se)}}else pr(c,h,g,v);break;case 13:pr(c,h,g,v);break;case 23:break;case 22:R=h.stateNode,z=h.alternate,h.memoizedState!==null?R._visibility&2?pr(c,h,g,v):Pl(c,h):R._visibility&2?pr(c,h,g,v):(R._visibility|=2,Yo(c,h,g,v,(h.subtreeFlags&10256)!==0)),A&2048&&pm(z,h);break;case 24:pr(c,h,g,v),A&2048&&mm(h.alternate,h);break;default:pr(c,h,g,v)}}function Yo(c,h,g,v,A){for(A=A&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var R=c,z=h,W=g,se=v,ve=z.flags;switch(z.tag){case 0:case 11:case 15:Yo(R,z,W,se,A),Dl(8,z);break;case 23:break;case 22:var Re=z.stateNode;z.memoizedState!==null?Re._visibility&2?Yo(R,z,W,se,A):Pl(R,z):(Re._visibility|=2,Yo(R,z,W,se,A)),A&&ve&2048&&pm(z.alternate,z);break;case 24:Yo(R,z,W,se,A),A&&ve&2048&&mm(z.alternate,z);break;default:Yo(R,z,W,se,A)}h=h.sibling}}function Pl(c,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var g=c,v=h,A=v.flags;switch(v.tag){case 22:Pl(g,v),A&2048&&pm(v.alternate,v);break;case 24:Pl(g,v),A&2048&&mm(v.alternate,v);break;default:Pl(g,v)}h=h.sibling}}var kl=8192;function Ko(c){if(c.subtreeFlags&kl)for(c=c.child;c!==null;)ex(c),c=c.sibling}function ex(c){switch(c.tag){case 26:Ko(c),c.flags&kl&&c.memoizedState!==null&&fN(Ki,c.memoizedState,c.memoizedProps);break;case 5:Ko(c);break;case 3:case 4:var h=Ki;Ki=of(c.stateNode.containerInfo),Ko(c),Ki=h;break;case 22:c.memoizedState===null&&(h=c.alternate,h!==null&&h.memoizedState!==null?(h=kl,kl=16777216,Ko(c),kl=h):Ko(c));break;default:Ko(c)}}function tx(c){var h=c.alternate;if(h!==null&&(c=h.child,c!==null)){h.child=null;do h=c.sibling,c.sibling=null,c=h;while(c!==null)}}function Nl(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var v=h[g];In=v,ix(v,c)}tx(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)nx(c),c=c.sibling}function nx(c){switch(c.tag){case 0:case 11:case 15:Nl(c),c.flags&2048&&Os(9,c,c.return);break;case 3:Nl(c);break;case 12:Nl(c);break;case 22:var h=c.stateNode;c.memoizedState!==null&&h._visibility&2&&(c.return===null||c.return.tag!==13)?(h._visibility&=-3,Yd(c)):Nl(c);break;default:Nl(c)}}function Yd(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var g=0;g<h.length;g++){var v=h[g];In=v,ix(v,c)}tx(c)}for(c=c.child;c!==null;){switch(h=c,h.tag){case 0:case 11:case 15:Os(8,h,h.return),Yd(h);break;case 22:g=h.stateNode,g._visibility&2&&(g._visibility&=-3,Yd(h));break;default:Yd(h)}c=c.sibling}}function ix(c,h){for(;In!==null;){var g=In;switch(g.tag){case 0:case 11:case 15:Os(8,g,h);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var v=g.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:yl(g.memoizedState.cache)}if(v=g.child,v!==null)v.return=g,In=v;else e:for(g=c;In!==null;){v=In;var A=v.sibling,R=v.return;if(Y2(v),v===g){In=null;break e}if(A!==null){A.return=R,In=A;break e}In=R}}}var _k={getCacheForType:function(c){var h=qn(Tn),g=h.data.get(c);return g===void 0&&(g=c(),h.data.set(c,g)),g}},Ik=typeof WeakMap=="function"?WeakMap:Map,Nt=0,Kt=null,Rt=null,Dt=0,Mt=0,vi=null,Ns=!1,Xo=!1,gm=!1,Zr=0,un=0,Ms=0,Ma=0,ym=0,Fi=0,Qo=0,Ml=null,ri=null,vm=!1,bm=0,Kd=1/0,Xd=null,Bs=null,Nn=0,Fs=null,Zo=null,Jo=0,Em=0,Tm=null,rx=null,Bl=0,xm=null;function bi(){if((Nt&2)!==0&&Dt!==0)return Dt&-Dt;if(j.T!==null){var c=Ho;return c!==0?c:Im()}return EE()}function sx(){Fi===0&&(Fi=(Dt&536870912)===0||kt?cn():536870912);var c=Bi.current;return c!==null&&(c.flags|=32),Fi}function Ei(c,h,g){(c===Kt&&(Mt===2||Mt===9)||c.cancelPendingCommit!==null)&&(eu(c,0),Us(c,Dt,Fi,!1)),xs(c,g),((Nt&2)===0||c!==Kt)&&(c===Kt&&((Nt&2)===0&&(Ma|=g),un===4&&Us(c,Dt,Fi,!1)),mr(c))}function ax(c,h,g){if((Nt&6)!==0)throw Error(i(327));var v=!g&&(h&124)===0&&(h&c.expiredLanes)===0||tt(c,h),A=v?Ok(c,h):wm(c,h,!0),R=v;do{if(A===0){Xo&&!v&&Us(c,h,0,!1);break}else{if(g=c.current.alternate,R&&!Lk(g)){A=wm(c,h,!1),R=!1;continue}if(A===2){if(R=h,c.errorRecoveryDisabledLanes&R)var z=0;else z=c.pendingLanes&-536870913,z=z!==0?z:z&536870912?536870912:0;if(z!==0){h=z;e:{var W=c;A=Ml;var se=W.current.memoizedState.isDehydrated;if(se&&(eu(W,z).flags|=256),z=wm(W,z,!1),z!==2){if(gm&&!se){W.errorRecoveryDisabledLanes|=R,Ma|=R,A=4;break e}R=ri,ri=A,R!==null&&(ri===null?ri=R:ri.push.apply(ri,R))}A=z}if(R=!1,A!==2)continue}}if(A===1){eu(c,0),Us(c,h,0,!0);break}e:{switch(v=c,R=A,R){case 0:case 1:throw Error(i(345));case 4:if((h&4194048)!==h)break;case 6:Us(v,h,Fi,!Ns);break e;case 2:ri=null;break;case 3:case 5:break;default:throw Error(i(329))}if((h&62914560)===h&&(A=bm+300-k(),10<A)){if(Us(v,h,Fi,!Ns),lt(v,0,!0)!==0)break e;v.timeoutHandle=Nx(ox.bind(null,v,g,ri,Xd,vm,h,Fi,Ma,Qo,Ns,R,2,-0,0),A);break e}ox(v,g,ri,Xd,vm,h,Fi,Ma,Qo,Ns,R,0,-0,0)}}break}while(!0);mr(c)}function ox(c,h,g,v,A,R,z,W,se,ve,Re,ke,be,Ee){if(c.timeoutHandle=-1,ke=h.subtreeFlags,(ke&8192||(ke&16785408)===16785408)&&(Gl={stylesheets:null,count:0,unsuspend:dN},ex(h),ke=hN(),ke!==null)){c.cancelPendingCommit=ke(px.bind(null,c,h,R,g,v,A,z,W,se,Re,1,be,Ee)),Us(c,R,z,!ve);return}px(c,h,R,g,v,A,z,W,se)}function Lk(c){for(var h=c;;){var g=h.tag;if((g===0||g===11||g===15)&&h.flags&16384&&(g=h.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var v=0;v<g.length;v++){var A=g[v],R=A.getSnapshot;A=A.value;try{if(!pi(R(),A))return!1}catch{return!1}}if(g=h.child,h.subtreeFlags&16384&&g!==null)g.return=h,h=g;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Us(c,h,g,v){h&=~ym,h&=~Ma,c.suspendedLanes|=h,c.pingedLanes&=~h,v&&(c.warmLanes|=h),v=c.expirationTimes;for(var A=h;0<A;){var R=31-B(A),z=1<<R;v[R]=-1,A&=~z}g!==0&&vE(c,g,h)}function Qd(){return(Nt&6)===0?(Fl(0),!1):!0}function Sm(){if(Rt!==null){if(Mt===0)var c=Rt.return;else c=Rt,Gr=La=null,Hp(c),Wo=null,_l=0,c=Rt;for(;c!==null;)H2(c.alternate,c),c=c.return;Rt=null}}function eu(c,h){var g=c.timeoutHandle;g!==-1&&(c.timeoutHandle=-1,Yk(g)),g=c.cancelPendingCommit,g!==null&&(c.cancelPendingCommit=null,g()),Sm(),Kt=c,Rt=g=zr(c.current,null),Dt=h,Mt=0,vi=null,Ns=!1,Xo=tt(c,h),gm=!1,Qo=Fi=ym=Ma=Ms=un=0,ri=Ml=null,vm=!1,(h&8)!==0&&(h|=h&32);var v=c.entangledLanes;if(v!==0)for(c=c.entanglements,v&=h;0<v;){var A=31-B(v),R=1<<A;h|=c[A],v&=~R}return Zr=h,bd(),g}function ux(c,h){Et=null,j.H=Fd,h===bl||h===_d?(h=wT(),Mt=3):h===xT?(h=wT(),Mt=4):Mt=h===C2?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,vi=h,Rt===null&&(un=1,Vd(c,Pi(h,c.current)))}function lx(){var c=j.H;return j.H=Fd,c===null?Fd:c}function cx(){var c=j.A;return j.A=_k,c}function Am(){un=4,Ns||(Dt&4194048)!==Dt&&Bi.current!==null||(Xo=!0),(Ms&134217727)===0&&(Ma&134217727)===0||Kt===null||Us(Kt,Dt,Fi,!1)}function wm(c,h,g){var v=Nt;Nt|=2;var A=lx(),R=cx();(Kt!==c||Dt!==h)&&(Xd=null,eu(c,h)),h=!1;var z=un;e:do try{if(Mt!==0&&Rt!==null){var W=Rt,se=vi;switch(Mt){case 8:Sm(),z=6;break e;case 3:case 2:case 9:case 6:Bi.current===null&&(h=!0);var ve=Mt;if(Mt=0,vi=null,tu(c,W,se,ve),g&&Xo){z=0;break e}break;default:ve=Mt,Mt=0,vi=null,tu(c,W,se,ve)}}Dk(),z=un;break}catch(Re){ux(c,Re)}while(!0);return h&&c.shellSuspendCounter++,Gr=La=null,Nt=v,j.H=A,j.A=R,Rt===null&&(Kt=null,Dt=0,bd()),z}function Dk(){for(;Rt!==null;)dx(Rt)}function Ok(c,h){var g=Nt;Nt|=2;var v=lx(),A=cx();Kt!==c||Dt!==h?(Xd=null,Kd=k()+500,eu(c,h)):Xo=tt(c,h);e:do try{if(Mt!==0&&Rt!==null){h=Rt;var R=vi;t:switch(Mt){case 1:Mt=0,vi=null,tu(c,h,R,1);break;case 2:case 9:if(ST(R)){Mt=0,vi=null,fx(h);break}h=function(){Mt!==2&&Mt!==9||Kt!==c||(Mt=7),mr(c)},R.then(h,h);break e;case 3:Mt=7;break e;case 4:Mt=5;break e;case 7:ST(R)?(Mt=0,vi=null,fx(h)):(Mt=0,vi=null,tu(c,h,R,7));break;case 5:var z=null;switch(Rt.tag){case 26:z=Rt.memoizedState;case 5:case 27:var W=Rt;if(!z||$x(z)){Mt=0,vi=null;var se=W.sibling;if(se!==null)Rt=se;else{var ve=W.return;ve!==null?(Rt=ve,Zd(ve)):Rt=null}break t}}Mt=0,vi=null,tu(c,h,R,5);break;case 6:Mt=0,vi=null,tu(c,h,R,6);break;case 8:Sm(),un=6;break e;default:throw Error(i(462))}}Pk();break}catch(Re){ux(c,Re)}while(!0);return Gr=La=null,j.H=v,j.A=A,Nt=g,Rt!==null?0:(Kt=null,Dt=0,bd(),un)}function Pk(){for(;Rt!==null&&!Lt();)dx(Rt)}function dx(c){var h=F2(c.alternate,c,Zr);c.memoizedProps=c.pendingProps,h===null?Zd(c):Rt=h}function fx(c){var h=c,g=h.alternate;switch(h.tag){case 15:case 0:h=O2(g,h,h.pendingProps,h.type,void 0,Dt);break;case 11:h=O2(g,h,h.pendingProps,h.type.render,h.ref,Dt);break;case 5:Hp(h);default:H2(g,h),h=Rt=hT(h,Zr),h=F2(g,h,Zr)}c.memoizedProps=c.pendingProps,h===null?Zd(c):Rt=h}function tu(c,h,g,v){Gr=La=null,Hp(h),Wo=null,_l=0;var A=h.return;try{if(xk(c,A,h,g,Dt)){un=1,Vd(c,Pi(g,c.current)),Rt=null;return}}catch(R){if(A!==null)throw Rt=A,R;un=1,Vd(c,Pi(g,c.current)),Rt=null;return}h.flags&32768?(kt||v===1?c=!0:Xo||(Dt&536870912)!==0?c=!1:(Ns=c=!0,(v===2||v===9||v===3||v===6)&&(v=Bi.current,v!==null&&v.tag===13&&(v.flags|=16384))),hx(h,c)):Zd(h)}function Zd(c){var h=c;do{if((h.flags&32768)!==0){hx(h,Ns);return}c=h.return;var g=Ak(h.alternate,h,Zr);if(g!==null){Rt=g;return}if(h=h.sibling,h!==null){Rt=h;return}Rt=h=c}while(h!==null);un===0&&(un=5)}function hx(c,h){do{var g=wk(c.alternate,c);if(g!==null){g.flags&=32767,Rt=g;return}if(g=c.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!h&&(c=c.sibling,c!==null)){Rt=c;return}Rt=c=g}while(c!==null);un=6,Rt=null}function px(c,h,g,v,A,R,z,W,se){c.cancelPendingCommit=null;do Jd();while(Nn!==0);if((Nt&6)!==0)throw Error(i(327));if(h!==null){if(h===c.current)throw Error(i(177));if(R=h.lanes|h.childLanes,R|=mp,od(c,g,R,z,W,se),c===Kt&&(Rt=Kt=null,Dt=0),Zo=h,Fs=c,Jo=g,Em=R,Tm=A,rx=v,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,Bk(Oe,function(){return bx(),null})):(c.callbackNode=null,c.callbackPriority=0),v=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||v){v=j.T,j.T=null,A=te.p,te.p=2,z=Nt,Nt|=4;try{Ck(c,h,g)}finally{Nt=z,te.p=A,j.T=v}}Nn=1,mx(),gx(),yx()}}function mx(){if(Nn===1){Nn=0;var c=Fs,h=Zo,g=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||g){g=j.T,j.T=null;var v=te.p;te.p=2;var A=Nt;Nt|=4;try{Q2(h,c);var R=Bm,z=iT(c.containerInfo),W=R.focusedElem,se=R.selectionRange;if(z!==W&&W&&W.ownerDocument&&nT(W.ownerDocument.documentElement,W)){if(se!==null&&cp(W)){var ve=se.start,Re=se.end;if(Re===void 0&&(Re=ve),"selectionStart"in W)W.selectionStart=ve,W.selectionEnd=Math.min(Re,W.value.length);else{var ke=W.ownerDocument||document,be=ke&&ke.defaultView||window;if(be.getSelection){var Ee=be.getSelection(),ct=W.textContent.length,ot=Math.min(se.start,ct),zt=se.end===void 0?ot:Math.min(se.end,ct);!Ee.extend&&ot>zt&&(z=zt,zt=ot,ot=z);var ce=tT(W,ot),ae=tT(W,zt);if(ce&&ae&&(Ee.rangeCount!==1||Ee.anchorNode!==ce.node||Ee.anchorOffset!==ce.offset||Ee.focusNode!==ae.node||Ee.focusOffset!==ae.offset)){var me=ke.createRange();me.setStart(ce.node,ce.offset),Ee.removeAllRanges(),ot>zt?(Ee.addRange(me),Ee.extend(ae.node,ae.offset)):(me.setEnd(ae.node,ae.offset),Ee.addRange(me))}}}}for(ke=[],Ee=W;Ee=Ee.parentNode;)Ee.nodeType===1&&ke.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof W.focus=="function"&&W.focus(),W=0;W<ke.length;W++){var De=ke[W];De.element.scrollLeft=De.left,De.element.scrollTop=De.top}}ff=!!Mm,Bm=Mm=null}finally{Nt=A,te.p=v,j.T=g}}c.current=h,Nn=2}}function gx(){if(Nn===2){Nn=0;var c=Fs,h=Zo,g=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||g){g=j.T,j.T=null;var v=te.p;te.p=2;var A=Nt;Nt|=4;try{$2(c,h.alternate,h)}finally{Nt=A,te.p=v,j.T=g}}Nn=3}}function yx(){if(Nn===4||Nn===3){Nn=0,Qe();var c=Fs,h=Zo,g=Jo,v=rx;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Nn=5:(Nn=0,Zo=Fs=null,vx(c,c.pendingLanes));var A=c.pendingLanes;if(A===0&&(Bs=null),V0(g),h=h.stateNode,Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(he,h,void 0,(h.current.flags&128)===128)}catch{}if(v!==null){h=j.T,A=te.p,te.p=2,j.T=null;try{for(var R=c.onRecoverableError,z=0;z<v.length;z++){var W=v[z];R(W.value,{componentStack:W.stack})}}finally{j.T=h,te.p=A}}(Jo&3)!==0&&Jd(),mr(c),A=c.pendingLanes,(g&4194090)!==0&&(A&42)!==0?c===xm?Bl++:(Bl=0,xm=c):Bl=0,Fl(0)}}function vx(c,h){(c.pooledCacheLanes&=h)===0&&(h=c.pooledCache,h!=null&&(c.pooledCache=null,yl(h)))}function Jd(c){return mx(),gx(),yx(),bx()}function bx(){if(Nn!==5)return!1;var c=Fs,h=Em;Em=0;var g=V0(Jo),v=j.T,A=te.p;try{te.p=32>g?32:g,j.T=null,g=Tm,Tm=null;var R=Fs,z=Jo;if(Nn=0,Zo=Fs=null,Jo=0,(Nt&6)!==0)throw Error(i(331));var W=Nt;if(Nt|=4,nx(R.current),J2(R,R.current,z,g),Nt=W,Fl(0,!1),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(he,R)}catch{}return!0}finally{te.p=A,j.T=v,vx(c,h)}}function Ex(c,h,g){h=Pi(g,h),h=em(c.stateNode,h,2),c=_s(c,h,2),c!==null&&(xs(c,2),mr(c))}function Gt(c,h,g){if(c.tag===3)Ex(c,c,g);else for(;h!==null;){if(h.tag===3){Ex(h,c,g);break}else if(h.tag===1){var v=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Bs===null||!Bs.has(v))){c=Pi(g,c),g=A2(2),v=_s(h,g,2),v!==null&&(w2(g,v,h,c),xs(v,2),mr(v));break}}h=h.return}}function Cm(c,h,g){var v=c.pingCache;if(v===null){v=c.pingCache=new Ik;var A=new Set;v.set(h,A)}else A=v.get(h),A===void 0&&(A=new Set,v.set(h,A));A.has(g)||(gm=!0,A.add(g),c=kk.bind(null,c,h,g),h.then(c,c))}function kk(c,h,g){var v=c.pingCache;v!==null&&v.delete(h),c.pingedLanes|=c.suspendedLanes&g,c.warmLanes&=~g,Kt===c&&(Dt&g)===g&&(un===4||un===3&&(Dt&62914560)===Dt&&300>k()-bm?(Nt&2)===0&&eu(c,0):ym|=g,Qo===Dt&&(Qo=0)),mr(c)}function Tx(c,h){h===0&&(h=Fr()),c=Mo(c,h),c!==null&&(xs(c,h),mr(c))}function Nk(c){var h=c.memoizedState,g=0;h!==null&&(g=h.retryLane),Tx(c,g)}function Mk(c,h){var g=0;switch(c.tag){case 13:var v=c.stateNode,A=c.memoizedState;A!==null&&(g=A.retryLane);break;case 19:v=c.stateNode;break;case 22:v=c.stateNode._retryCache;break;default:throw Error(i(314))}v!==null&&v.delete(h),Tx(c,g)}function Bk(c,h){return Le(c,h)}var ef=null,nu=null,Rm=!1,tf=!1,_m=!1,Ba=0;function mr(c){c!==nu&&c.next===null&&(nu===null?ef=nu=c:nu=nu.next=c),tf=!0,Rm||(Rm=!0,Uk())}function Fl(c,h){if(!_m&&tf){_m=!0;do for(var g=!1,v=ef;v!==null;){if(c!==0){var A=v.pendingLanes;if(A===0)var R=0;else{var z=v.suspendedLanes,W=v.pingedLanes;R=(1<<31-B(42|c)+1)-1,R&=A&~(z&~W),R=R&201326741?R&201326741|1:R?R|2:0}R!==0&&(g=!0,wx(v,R))}else R=Dt,R=lt(v,v===Kt?R:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(R&3)===0||tt(v,R)||(g=!0,wx(v,R));v=v.next}while(g);_m=!1}}function Fk(){xx()}function xx(){tf=Rm=!1;var c=0;Ba!==0&&($k()&&(c=Ba),Ba=0);for(var h=k(),g=null,v=ef;v!==null;){var A=v.next,R=Sx(v,h);R===0?(v.next=null,g===null?ef=A:g.next=A,A===null&&(nu=g)):(g=v,(c!==0||(R&3)!==0)&&(tf=!0)),v=A}Fl(c)}function Sx(c,h){for(var g=c.suspendedLanes,v=c.pingedLanes,A=c.expirationTimes,R=c.pendingLanes&-62914561;0<R;){var z=31-B(R),W=1<<z,se=A[z];se===-1?((W&g)===0||(W&v)!==0)&&(A[z]=Zt(W,h)):se<=h&&(c.expiredLanes|=W),R&=~W}if(h=Kt,g=Dt,g=lt(c,c===h?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),v=c.callbackNode,g===0||c===h&&(Mt===2||Mt===9)||c.cancelPendingCommit!==null)return v!==null&&v!==null&&Ke(v),c.callbackNode=null,c.callbackPriority=0;if((g&3)===0||tt(c,g)){if(h=g&-g,h===c.callbackPriority)return h;switch(v!==null&&Ke(v),V0(g)){case 2:case 8:g=Se;break;case 32:g=Oe;break;case 268435456:g=Ne;break;default:g=Oe}return v=Ax.bind(null,c),g=Le(g,v),c.callbackPriority=h,c.callbackNode=g,h}return v!==null&&v!==null&&Ke(v),c.callbackPriority=2,c.callbackNode=null,2}function Ax(c,h){if(Nn!==0&&Nn!==5)return c.callbackNode=null,c.callbackPriority=0,null;var g=c.callbackNode;if(Jd()&&c.callbackNode!==g)return null;var v=Dt;return v=lt(c,c===Kt?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),v===0?null:(ax(c,v,h),Sx(c,k()),c.callbackNode!=null&&c.callbackNode===g?Ax.bind(null,c):null)}function wx(c,h){if(Jd())return null;ax(c,h,!0)}function Uk(){Kk(function(){(Nt&6)!==0?Le(ue,Fk):xx()})}function Im(){return Ba===0&&(Ba=cn()),Ba}function Cx(c){return c==null||typeof c=="symbol"||typeof c=="boolean"?null:typeof c=="function"?c:fd(""+c)}function Rx(c,h){var g=h.ownerDocument.createElement("input");return g.name=h.name,g.value=h.value,c.id&&g.setAttribute("form",c.id),h.parentNode.insertBefore(g,h),c=new FormData(c),g.parentNode.removeChild(g),c}function Hk(c,h,g,v,A){if(h==="submit"&&g&&g.stateNode===A){var R=Cx((A[ei]||null).action),z=v.submitter;z&&(h=(h=z[ei]||null)?Cx(h.formAction):z.getAttribute("formAction"),h!==null&&(R=h,z=null));var W=new gd("action","action",null,v,A);c.push({event:W,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(Ba!==0){var se=z?Rx(A,z):new FormData(A);Kp(g,{pending:!0,data:se,method:A.method,action:R},null,se)}}else typeof R=="function"&&(W.preventDefault(),se=z?Rx(A,z):new FormData(A),Kp(g,{pending:!0,data:se,method:A.method,action:R},R,se))},currentTarget:A}]})}}for(var Lm=0;Lm<pp.length;Lm++){var Dm=pp[Lm],zk=Dm.toLowerCase(),qk=Dm[0].toUpperCase()+Dm.slice(1);Yi(zk,"on"+qk)}Yi(aT,"onAnimationEnd"),Yi(oT,"onAnimationIteration"),Yi(uT,"onAnimationStart"),Yi("dblclick","onDoubleClick"),Yi("focusin","onFocus"),Yi("focusout","onBlur"),Yi(sk,"onTransitionRun"),Yi(ak,"onTransitionStart"),Yi(ok,"onTransitionCancel"),Yi(lT,"onTransitionEnd"),Co("onMouseEnter",["mouseout","mouseover"]),Co("onMouseLeave",["mouseout","mouseover"]),Co("onPointerEnter",["pointerout","pointerover"]),Co("onPointerLeave",["pointerout","pointerover"]),Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ul));function _x(c,h){h=(h&4)!==0;for(var g=0;g<c.length;g++){var v=c[g],A=v.event;v=v.listeners;e:{var R=void 0;if(h)for(var z=v.length-1;0<=z;z--){var W=v[z],se=W.instance,ve=W.currentTarget;if(W=W.listener,se!==R&&A.isPropagationStopped())break e;R=W,A.currentTarget=ve;try{R(A)}catch(Re){qd(Re)}A.currentTarget=null,R=se}else for(z=0;z<v.length;z++){if(W=v[z],se=W.instance,ve=W.currentTarget,W=W.listener,se!==R&&A.isPropagationStopped())break e;R=W,A.currentTarget=ve;try{R(A)}catch(Re){qd(Re)}A.currentTarget=null,R=se}}}}function _t(c,h){var g=h[G0];g===void 0&&(g=h[G0]=new Set);var v=c+"__bubble";g.has(v)||(Ix(h,c,2,!1),g.add(v))}function Om(c,h,g){var v=0;h&&(v|=4),Ix(g,c,v,h)}var nf="_reactListening"+Math.random().toString(36).slice(2);function Pm(c){if(!c[nf]){c[nf]=!0,xE.forEach(function(g){g!=="selectionchange"&&(Vk.has(g)||Om(g,!1,c),Om(g,!0,c))});var h=c.nodeType===9?c:c.ownerDocument;h===null||h[nf]||(h[nf]=!0,Om("selectionchange",!1,h))}}function Ix(c,h,g,v){switch(Jx(h)){case 2:var A=gN;break;case 8:A=yN;break;default:A=$m}g=A.bind(null,h,g,c),A=void 0,!tp||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(A=!0),v?A!==void 0?c.addEventListener(h,g,{capture:!0,passive:A}):c.addEventListener(h,g,!0):A!==void 0?c.addEventListener(h,g,{passive:A}):c.addEventListener(h,g,!1)}function km(c,h,g,v,A){var R=v;if((h&1)===0&&(h&2)===0&&v!==null)e:for(;;){if(v===null)return;var z=v.tag;if(z===3||z===4){var W=v.stateNode.containerInfo;if(W===A)break;if(z===4)for(z=v.return;z!==null;){var se=z.tag;if((se===3||se===4)&&z.stateNode.containerInfo===A)return;z=z.return}for(;W!==null;){if(z=So(W),z===null)return;if(se=z.tag,se===5||se===6||se===26||se===27){v=R=z;continue e}W=W.parentNode}}v=v.return}ME(function(){var ve=R,Re=J0(g),ke=[];e:{var be=cT.get(c);if(be!==void 0){var Ee=gd,ct=c;switch(c){case"keypress":if(pd(g)===0)break e;case"keydown":case"keyup":Ee=BP;break;case"focusin":ct="focus",Ee=sp;break;case"focusout":ct="blur",Ee=sp;break;case"beforeblur":case"afterblur":Ee=sp;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=UE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=wP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=HP;break;case aT:case oT:case uT:Ee=_P;break;case lT:Ee=qP;break;case"scroll":case"scrollend":Ee=SP;break;case"wheel":Ee=GP;break;case"copy":case"cut":case"paste":Ee=LP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=zE;break;case"toggle":case"beforetoggle":Ee=WP}var ot=(h&4)!==0,zt=!ot&&(c==="scroll"||c==="scrollend"),ce=ot?be!==null?be+"Capture":null:be;ot=[];for(var ae=ve,me;ae!==null;){var De=ae;if(me=De.stateNode,De=De.tag,De!==5&&De!==26&&De!==27||me===null||ce===null||(De=rl(ae,ce),De!=null&&ot.push(Hl(ae,De,me))),zt)break;ae=ae.return}0<ot.length&&(be=new Ee(be,ct,null,g,Re),ke.push({event:be,listeners:ot}))}}if((h&7)===0){e:{if(be=c==="mouseover"||c==="pointerover",Ee=c==="mouseout"||c==="pointerout",be&&g!==Z0&&(ct=g.relatedTarget||g.fromElement)&&(So(ct)||ct[xo]))break e;if((Ee||be)&&(be=Re.window===Re?Re:(be=Re.ownerDocument)?be.defaultView||be.parentWindow:window,Ee?(ct=g.relatedTarget||g.toElement,Ee=ve,ct=ct?So(ct):null,ct!==null&&(zt=s(ct),ot=ct.tag,ct!==zt||ot!==5&&ot!==27&&ot!==6)&&(ct=null)):(Ee=null,ct=ve),Ee!==ct)){if(ot=UE,De="onMouseLeave",ce="onMouseEnter",ae="mouse",(c==="pointerout"||c==="pointerover")&&(ot=zE,De="onPointerLeave",ce="onPointerEnter",ae="pointer"),zt=Ee==null?be:il(Ee),me=ct==null?be:il(ct),be=new ot(De,ae+"leave",Ee,g,Re),be.target=zt,be.relatedTarget=me,De=null,So(Re)===ve&&(ot=new ot(ce,ae+"enter",ct,g,Re),ot.target=me,ot.relatedTarget=zt,De=ot),zt=De,Ee&&ct)t:{for(ot=Ee,ce=ct,ae=0,me=ot;me;me=iu(me))ae++;for(me=0,De=ce;De;De=iu(De))me++;for(;0<ae-me;)ot=iu(ot),ae--;for(;0<me-ae;)ce=iu(ce),me--;for(;ae--;){if(ot===ce||ce!==null&&ot===ce.alternate)break t;ot=iu(ot),ce=iu(ce)}ot=null}else ot=null;Ee!==null&&Lx(ke,be,Ee,ot,!1),ct!==null&&zt!==null&&Lx(ke,zt,ct,ot,!0)}}e:{if(be=ve?il(ve):window,Ee=be.nodeName&&be.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&be.type==="file")var et=KE;else if($E(be))if(XE)et=nk;else{et=ek;var St=JP}else Ee=be.nodeName,!Ee||Ee.toLowerCase()!=="input"||be.type!=="checkbox"&&be.type!=="radio"?ve&&Q0(ve.elementType)&&(et=KE):et=tk;if(et&&(et=et(c,ve))){YE(ke,et,g,Re);break e}St&&St(c,be,ve),c==="focusout"&&ve&&be.type==="number"&&ve.memoizedProps.value!=null&&X0(be,"number",be.value)}switch(St=ve?il(ve):window,c){case"focusin":($E(St)||St.contentEditable==="true")&&(Po=St,dp=ve,fl=null);break;case"focusout":fl=dp=Po=null;break;case"mousedown":fp=!0;break;case"contextmenu":case"mouseup":case"dragend":fp=!1,rT(ke,g,Re);break;case"selectionchange":if(rk)break;case"keydown":case"keyup":rT(ke,g,Re)}var rt;if(op)e:{switch(c){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Oo?jE(c,g)&&(ut="onCompositionEnd"):c==="keydown"&&g.keyCode===229&&(ut="onCompositionStart");ut&&(qE&&g.locale!=="ko"&&(Oo||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Oo&&(rt=BE()):(As=Re,np="value"in As?As.value:As.textContent,Oo=!0)),St=rf(ve,ut),0<St.length&&(ut=new HE(ut,c,null,g,Re),ke.push({event:ut,listeners:St}),rt?ut.data=rt:(rt=WE(g),rt!==null&&(ut.data=rt)))),(rt=YP?KP(c,g):XP(c,g))&&(ut=rf(ve,"onBeforeInput"),0<ut.length&&(St=new HE("onBeforeInput","beforeinput",null,g,Re),ke.push({event:St,listeners:ut}),St.data=rt)),Hk(ke,c,ve,g,Re)}_x(ke,h)})}function Hl(c,h,g){return{instance:c,listener:h,currentTarget:g}}function rf(c,h){for(var g=h+"Capture",v=[];c!==null;){var A=c,R=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||R===null||(A=rl(c,g),A!=null&&v.unshift(Hl(c,A,R)),A=rl(c,h),A!=null&&v.push(Hl(c,A,R))),c.tag===3)return v;c=c.return}return[]}function iu(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5&&c.tag!==27);return c||null}function Lx(c,h,g,v,A){for(var R=h._reactName,z=[];g!==null&&g!==v;){var W=g,se=W.alternate,ve=W.stateNode;if(W=W.tag,se!==null&&se===v)break;W!==5&&W!==26&&W!==27||ve===null||(se=ve,A?(ve=rl(g,R),ve!=null&&z.unshift(Hl(g,ve,se))):A||(ve=rl(g,R),ve!=null&&z.push(Hl(g,ve,se)))),g=g.return}z.length!==0&&c.push({event:h,listeners:z})}var Gk=/\r\n?/g,jk=/\u0000|\uFFFD/g;function Dx(c){return(typeof c=="string"?c:""+c).replace(Gk,`
`).replace(jk,"")}function Ox(c,h){return h=Dx(h),Dx(c)===h}function sf(){}function Ht(c,h,g,v,A,R){switch(g){case"children":typeof v=="string"?h==="body"||h==="textarea"&&v===""||Io(c,v):(typeof v=="number"||typeof v=="bigint")&&h!=="body"&&Io(c,""+v);break;case"className":ld(c,"class",v);break;case"tabIndex":ld(c,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":ld(c,g,v);break;case"style":kE(c,v,R);break;case"data":if(h!=="object"){ld(c,"data",v);break}case"src":case"href":if(v===""&&(h!=="a"||g!=="href")){c.removeAttribute(g);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){c.removeAttribute(g);break}v=fd(""+v),c.setAttribute(g,v);break;case"action":case"formAction":if(typeof v=="function"){c.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof R=="function"&&(g==="formAction"?(h!=="input"&&Ht(c,h,"name",A.name,A,null),Ht(c,h,"formEncType",A.formEncType,A,null),Ht(c,h,"formMethod",A.formMethod,A,null),Ht(c,h,"formTarget",A.formTarget,A,null)):(Ht(c,h,"encType",A.encType,A,null),Ht(c,h,"method",A.method,A,null),Ht(c,h,"target",A.target,A,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){c.removeAttribute(g);break}v=fd(""+v),c.setAttribute(g,v);break;case"onClick":v!=null&&(c.onclick=sf);break;case"onScroll":v!=null&&_t("scroll",c);break;case"onScrollEnd":v!=null&&_t("scrollend",c);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(i(61));if(g=v.__html,g!=null){if(A.children!=null)throw Error(i(60));c.innerHTML=g}}break;case"multiple":c.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":c.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){c.removeAttribute("xlink:href");break}g=fd(""+v),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(g,""+v):c.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(g,""):c.removeAttribute(g);break;case"capture":case"download":v===!0?c.setAttribute(g,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(g,v):c.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?c.setAttribute(g,v):c.removeAttribute(g);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?c.removeAttribute(g):c.setAttribute(g,v);break;case"popover":_t("beforetoggle",c),_t("toggle",c),ud(c,"popover",v);break;case"xlinkActuate":Ur(c,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":Ur(c,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":Ur(c,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":Ur(c,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":Ur(c,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":Ur(c,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":Ur(c,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":Ur(c,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":Ur(c,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":ud(c,"is",v);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=TP.get(g)||g,ud(c,g,v))}}function Nm(c,h,g,v,A,R){switch(g){case"style":kE(c,v,R);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(i(61));if(g=v.__html,g!=null){if(A.children!=null)throw Error(i(60));c.innerHTML=g}}break;case"children":typeof v=="string"?Io(c,v):(typeof v=="number"||typeof v=="bigint")&&Io(c,""+v);break;case"onScroll":v!=null&&_t("scroll",c);break;case"onScrollEnd":v!=null&&_t("scrollend",c);break;case"onClick":v!=null&&(c.onclick=sf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!SE.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(A=g.endsWith("Capture"),h=g.slice(2,A?g.length-7:void 0),R=c[ei]||null,R=R!=null?R[g]:null,typeof R=="function"&&c.removeEventListener(h,R,A),typeof v=="function")){typeof R!="function"&&R!==null&&(g in c?c[g]=null:c.hasAttribute(g)&&c.removeAttribute(g)),c.addEventListener(h,v,A);break e}g in c?c[g]=v:v===!0?c.setAttribute(g,""):ud(c,g,v)}}}function Mn(c,h,g){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",c),_t("load",c);var v=!1,A=!1,R;for(R in g)if(g.hasOwnProperty(R)){var z=g[R];if(z!=null)switch(R){case"src":v=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,h));default:Ht(c,h,R,z,g,null)}}A&&Ht(c,h,"srcSet",g.srcSet,g,null),v&&Ht(c,h,"src",g.src,g,null);return;case"input":_t("invalid",c);var W=R=z=A=null,se=null,ve=null;for(v in g)if(g.hasOwnProperty(v)){var Re=g[v];if(Re!=null)switch(v){case"name":A=Re;break;case"type":z=Re;break;case"checked":se=Re;break;case"defaultChecked":ve=Re;break;case"value":R=Re;break;case"defaultValue":W=Re;break;case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(i(137,h));break;default:Ht(c,h,v,Re,g,null)}}LE(c,R,W,se,ve,z,A,!1),cd(c);return;case"select":_t("invalid",c),v=z=R=null;for(A in g)if(g.hasOwnProperty(A)&&(W=g[A],W!=null))switch(A){case"value":R=W;break;case"defaultValue":z=W;break;case"multiple":v=W;default:Ht(c,h,A,W,g,null)}h=R,g=z,c.multiple=!!v,h!=null?_o(c,!!v,h,!1):g!=null&&_o(c,!!v,g,!0);return;case"textarea":_t("invalid",c),R=A=v=null;for(z in g)if(g.hasOwnProperty(z)&&(W=g[z],W!=null))switch(z){case"value":v=W;break;case"defaultValue":A=W;break;case"children":R=W;break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(91));break;default:Ht(c,h,z,W,g,null)}OE(c,v,A,R),cd(c);return;case"option":for(se in g)if(g.hasOwnProperty(se)&&(v=g[se],v!=null))switch(se){case"selected":c.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:Ht(c,h,se,v,g,null)}return;case"dialog":_t("beforetoggle",c),_t("toggle",c),_t("cancel",c),_t("close",c);break;case"iframe":case"object":_t("load",c);break;case"video":case"audio":for(v=0;v<Ul.length;v++)_t(Ul[v],c);break;case"image":_t("error",c),_t("load",c);break;case"details":_t("toggle",c);break;case"embed":case"source":case"link":_t("error",c),_t("load",c);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ve in g)if(g.hasOwnProperty(ve)&&(v=g[ve],v!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,h));default:Ht(c,h,ve,v,g,null)}return;default:if(Q0(h)){for(Re in g)g.hasOwnProperty(Re)&&(v=g[Re],v!==void 0&&Nm(c,h,Re,v,g,void 0));return}}for(W in g)g.hasOwnProperty(W)&&(v=g[W],v!=null&&Ht(c,h,W,v,g,null))}function Wk(c,h,g,v){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,R=null,z=null,W=null,se=null,ve=null,Re=null;for(Ee in g){var ke=g[Ee];if(g.hasOwnProperty(Ee)&&ke!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":se=ke;default:v.hasOwnProperty(Ee)||Ht(c,h,Ee,null,v,ke)}}for(var be in v){var Ee=v[be];if(ke=g[be],v.hasOwnProperty(be)&&(Ee!=null||ke!=null))switch(be){case"type":R=Ee;break;case"name":A=Ee;break;case"checked":ve=Ee;break;case"defaultChecked":Re=Ee;break;case"value":z=Ee;break;case"defaultValue":W=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(i(137,h));break;default:Ee!==ke&&Ht(c,h,be,Ee,v,ke)}}K0(c,z,W,se,ve,Re,R,A);return;case"select":Ee=z=W=be=null;for(R in g)if(se=g[R],g.hasOwnProperty(R)&&se!=null)switch(R){case"value":break;case"multiple":Ee=se;default:v.hasOwnProperty(R)||Ht(c,h,R,null,v,se)}for(A in v)if(R=v[A],se=g[A],v.hasOwnProperty(A)&&(R!=null||se!=null))switch(A){case"value":be=R;break;case"defaultValue":W=R;break;case"multiple":z=R;default:R!==se&&Ht(c,h,A,R,v,se)}h=W,g=z,v=Ee,be!=null?_o(c,!!g,be,!1):!!v!=!!g&&(h!=null?_o(c,!!g,h,!0):_o(c,!!g,g?[]:"",!1));return;case"textarea":Ee=be=null;for(W in g)if(A=g[W],g.hasOwnProperty(W)&&A!=null&&!v.hasOwnProperty(W))switch(W){case"value":break;case"children":break;default:Ht(c,h,W,null,v,A)}for(z in v)if(A=v[z],R=g[z],v.hasOwnProperty(z)&&(A!=null||R!=null))switch(z){case"value":be=A;break;case"defaultValue":Ee=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:A!==R&&Ht(c,h,z,A,v,R)}DE(c,be,Ee);return;case"option":for(var ct in g)if(be=g[ct],g.hasOwnProperty(ct)&&be!=null&&!v.hasOwnProperty(ct))switch(ct){case"selected":c.selected=!1;break;default:Ht(c,h,ct,null,v,be)}for(se in v)if(be=v[se],Ee=g[se],v.hasOwnProperty(se)&&be!==Ee&&(be!=null||Ee!=null))switch(se){case"selected":c.selected=be&&typeof be!="function"&&typeof be!="symbol";break;default:Ht(c,h,se,be,v,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in g)be=g[ot],g.hasOwnProperty(ot)&&be!=null&&!v.hasOwnProperty(ot)&&Ht(c,h,ot,null,v,be);for(ve in v)if(be=v[ve],Ee=g[ve],v.hasOwnProperty(ve)&&be!==Ee&&(be!=null||Ee!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(i(137,h));break;default:Ht(c,h,ve,be,v,Ee)}return;default:if(Q0(h)){for(var zt in g)be=g[zt],g.hasOwnProperty(zt)&&be!==void 0&&!v.hasOwnProperty(zt)&&Nm(c,h,zt,void 0,v,be);for(Re in v)be=v[Re],Ee=g[Re],!v.hasOwnProperty(Re)||be===Ee||be===void 0&&Ee===void 0||Nm(c,h,Re,be,v,Ee);return}}for(var ce in g)be=g[ce],g.hasOwnProperty(ce)&&be!=null&&!v.hasOwnProperty(ce)&&Ht(c,h,ce,null,v,be);for(ke in v)be=v[ke],Ee=g[ke],!v.hasOwnProperty(ke)||be===Ee||be==null&&Ee==null||Ht(c,h,ke,be,v,Ee)}var Mm=null,Bm=null;function af(c){return c.nodeType===9?c:c.ownerDocument}function Px(c){switch(c){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function kx(c,h){if(c===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return c===1&&h==="foreignObject"?0:c}function Fm(c,h){return c==="textarea"||c==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Um=null;function $k(){var c=window.event;return c&&c.type==="popstate"?c===Um?!1:(Um=c,!0):(Um=null,!1)}var Nx=typeof setTimeout=="function"?setTimeout:void 0,Yk=typeof clearTimeout=="function"?clearTimeout:void 0,Mx=typeof Promise=="function"?Promise:void 0,Kk=typeof queueMicrotask=="function"?queueMicrotask:typeof Mx<"u"?function(c){return Mx.resolve(null).then(c).catch(Xk)}:Nx;function Xk(c){setTimeout(function(){throw c})}function Hs(c){return c==="head"}function Bx(c,h){var g=h,v=0,A=0;do{var R=g.nextSibling;if(c.removeChild(g),R&&R.nodeType===8)if(g=R.data,g==="/$"){if(0<v&&8>v){g=v;var z=c.ownerDocument;if(g&1&&zl(z.documentElement),g&2&&zl(z.body),g&4)for(g=z.head,zl(g),z=g.firstChild;z;){var W=z.nextSibling,se=z.nodeName;z[nl]||se==="SCRIPT"||se==="STYLE"||se==="LINK"&&z.rel.toLowerCase()==="stylesheet"||g.removeChild(z),z=W}}if(A===0){c.removeChild(R),Kl(h);return}A--}else g==="$"||g==="$?"||g==="$!"?A++:v=g.charCodeAt(0)-48;else v=0;g=R}while(g);Kl(h)}function Hm(c){var h=c.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var g=h;switch(h=h.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":Hm(g),j0(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}c.removeChild(g)}}function Qk(c,h,g,v){for(;c.nodeType===1;){var A=g;if(c.nodeName.toLowerCase()!==h.toLowerCase()){if(!v&&(c.nodeName!=="INPUT"||c.type!=="hidden"))break}else if(v){if(!c[nl])switch(h){case"meta":if(!c.hasAttribute("itemprop"))break;return c;case"link":if(R=c.getAttribute("rel"),R==="stylesheet"&&c.hasAttribute("data-precedence"))break;if(R!==A.rel||c.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||c.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||c.getAttribute("title")!==(A.title==null?null:A.title))break;return c;case"style":if(c.hasAttribute("data-precedence"))break;return c;case"script":if(R=c.getAttribute("src"),(R!==(A.src==null?null:A.src)||c.getAttribute("type")!==(A.type==null?null:A.type)||c.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&R&&c.hasAttribute("async")&&!c.hasAttribute("itemprop"))break;return c;default:return c}}else if(h==="input"&&c.type==="hidden"){var R=A.name==null?null:""+A.name;if(A.type==="hidden"&&c.getAttribute("name")===R)return c}else return c;if(c=Xi(c.nextSibling),c===null)break}return null}function Zk(c,h,g){if(h==="")return null;for(;c.nodeType!==3;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!g||(c=Xi(c.nextSibling),c===null))return null;return c}function zm(c){return c.data==="$!"||c.data==="$?"&&c.ownerDocument.readyState==="complete"}function Jk(c,h){var g=c.ownerDocument;if(c.data!=="$?"||g.readyState==="complete")h();else{var v=function(){h(),g.removeEventListener("DOMContentLoaded",v)};g.addEventListener("DOMContentLoaded",v),c._reactRetry=v}}function Xi(c){for(;c!=null;c=c.nextSibling){var h=c.nodeType;if(h===1||h===3)break;if(h===8){if(h=c.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return c}var qm=null;function Fx(c){c=c.previousSibling;for(var h=0;c;){if(c.nodeType===8){var g=c.data;if(g==="$"||g==="$!"||g==="$?"){if(h===0)return c;h--}else g==="/$"&&h++}c=c.previousSibling}return null}function Ux(c,h,g){switch(h=af(g),c){case"html":if(c=h.documentElement,!c)throw Error(i(452));return c;case"head":if(c=h.head,!c)throw Error(i(453));return c;case"body":if(c=h.body,!c)throw Error(i(454));return c;default:throw Error(i(451))}}function zl(c){for(var h=c.attributes;h.length;)c.removeAttributeNode(h[0]);j0(c)}var Ui=new Map,Hx=new Set;function of(c){return typeof c.getRootNode=="function"?c.getRootNode():c.nodeType===9?c:c.ownerDocument}var Jr=te.d;te.d={f:eN,r:tN,D:nN,C:iN,L:rN,m:sN,X:oN,S:aN,M:uN};function eN(){var c=Jr.f(),h=Qd();return c||h}function tN(c){var h=Ao(c);h!==null&&h.tag===5&&h.type==="form"?a2(h):Jr.r(c)}var ru=typeof document>"u"?null:document;function zx(c,h,g){var v=ru;if(v&&typeof h=="string"&&h){var A=Oi(h);A='link[rel="'+c+'"][href="'+A+'"]',typeof g=="string"&&(A+='[crossorigin="'+g+'"]'),Hx.has(A)||(Hx.add(A),c={rel:c,crossOrigin:g,href:h},v.querySelector(A)===null&&(h=v.createElement("link"),Mn(h,"link",c),Rn(h),v.head.appendChild(h)))}}function nN(c){Jr.D(c),zx("dns-prefetch",c,null)}function iN(c,h){Jr.C(c,h),zx("preconnect",c,h)}function rN(c,h,g){Jr.L(c,h,g);var v=ru;if(v&&c&&h){var A='link[rel="preload"][as="'+Oi(h)+'"]';h==="image"&&g&&g.imageSrcSet?(A+='[imagesrcset="'+Oi(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(A+='[imagesizes="'+Oi(g.imageSizes)+'"]')):A+='[href="'+Oi(c)+'"]';var R=A;switch(h){case"style":R=su(c);break;case"script":R=au(c)}Ui.has(R)||(c=d({rel:"preload",href:h==="image"&&g&&g.imageSrcSet?void 0:c,as:h},g),Ui.set(R,c),v.querySelector(A)!==null||h==="style"&&v.querySelector(ql(R))||h==="script"&&v.querySelector(Vl(R))||(h=v.createElement("link"),Mn(h,"link",c),Rn(h),v.head.appendChild(h)))}}function sN(c,h){Jr.m(c,h);var g=ru;if(g&&c){var v=h&&typeof h.as=="string"?h.as:"script",A='link[rel="modulepreload"][as="'+Oi(v)+'"][href="'+Oi(c)+'"]',R=A;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":R=au(c)}if(!Ui.has(R)&&(c=d({rel:"modulepreload",href:c},h),Ui.set(R,c),g.querySelector(A)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Vl(R)))return}v=g.createElement("link"),Mn(v,"link",c),Rn(v),g.head.appendChild(v)}}}function aN(c,h,g){Jr.S(c,h,g);var v=ru;if(v&&c){var A=wo(v).hoistableStyles,R=su(c);h=h||"default";var z=A.get(R);if(!z){var W={loading:0,preload:null};if(z=v.querySelector(ql(R)))W.loading=5;else{c=d({rel:"stylesheet",href:c,"data-precedence":h},g),(g=Ui.get(R))&&Vm(c,g);var se=z=v.createElement("link");Rn(se),Mn(se,"link",c),se._p=new Promise(function(ve,Re){se.onload=ve,se.onerror=Re}),se.addEventListener("load",function(){W.loading|=1}),se.addEventListener("error",function(){W.loading|=2}),W.loading|=4,uf(z,h,v)}z={type:"stylesheet",instance:z,count:1,state:W},A.set(R,z)}}}function oN(c,h){Jr.X(c,h);var g=ru;if(g&&c){var v=wo(g).hoistableScripts,A=au(c),R=v.get(A);R||(R=g.querySelector(Vl(A)),R||(c=d({src:c,async:!0},h),(h=Ui.get(A))&&Gm(c,h),R=g.createElement("script"),Rn(R),Mn(R,"link",c),g.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},v.set(A,R))}}function uN(c,h){Jr.M(c,h);var g=ru;if(g&&c){var v=wo(g).hoistableScripts,A=au(c),R=v.get(A);R||(R=g.querySelector(Vl(A)),R||(c=d({src:c,async:!0,type:"module"},h),(h=Ui.get(A))&&Gm(c,h),R=g.createElement("script"),Rn(R),Mn(R,"link",c),g.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},v.set(A,R))}}function qx(c,h,g,v){var A=(A=we.current)?of(A):null;if(!A)throw Error(i(446));switch(c){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(h=su(g.href),g=wo(A).hoistableStyles,v=g.get(h),v||(v={type:"style",instance:null,count:0,state:null},g.set(h,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){c=su(g.href);var R=wo(A).hoistableStyles,z=R.get(c);if(z||(A=A.ownerDocument||A,z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},R.set(c,z),(R=A.querySelector(ql(c)))&&!R._p&&(z.instance=R,z.state.loading=5),Ui.has(c)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Ui.set(c,g),R||lN(A,c,g,z.state))),h&&v===null)throw Error(i(528,""));return z}if(h&&v!==null)throw Error(i(529,""));return null;case"script":return h=g.async,g=g.src,typeof g=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=au(g),g=wo(A).hoistableScripts,v=g.get(h),v||(v={type:"script",instance:null,count:0,state:null},g.set(h,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,c))}}function su(c){return'href="'+Oi(c)+'"'}function ql(c){return'link[rel="stylesheet"]['+c+"]"}function Vx(c){return d({},c,{"data-precedence":c.precedence,precedence:null})}function lN(c,h,g,v){c.querySelector('link[rel="preload"][as="style"]['+h+"]")?v.loading=1:(h=c.createElement("link"),v.preload=h,h.addEventListener("load",function(){return v.loading|=1}),h.addEventListener("error",function(){return v.loading|=2}),Mn(h,"link",g),Rn(h),c.head.appendChild(h))}function au(c){return'[src="'+Oi(c)+'"]'}function Vl(c){return"script[async]"+c}function Gx(c,h,g){if(h.count++,h.instance===null)switch(h.type){case"style":var v=c.querySelector('style[data-href~="'+Oi(g.href)+'"]');if(v)return h.instance=v,Rn(v),v;var A=d({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return v=(c.ownerDocument||c).createElement("style"),Rn(v),Mn(v,"style",A),uf(v,g.precedence,c),h.instance=v;case"stylesheet":A=su(g.href);var R=c.querySelector(ql(A));if(R)return h.state.loading|=4,h.instance=R,Rn(R),R;v=Vx(g),(A=Ui.get(A))&&Vm(v,A),R=(c.ownerDocument||c).createElement("link"),Rn(R);var z=R;return z._p=new Promise(function(W,se){z.onload=W,z.onerror=se}),Mn(R,"link",v),h.state.loading|=4,uf(R,g.precedence,c),h.instance=R;case"script":return R=au(g.src),(A=c.querySelector(Vl(R)))?(h.instance=A,Rn(A),A):(v=g,(A=Ui.get(R))&&(v=d({},g),Gm(v,A)),c=c.ownerDocument||c,A=c.createElement("script"),Rn(A),Mn(A,"link",v),c.head.appendChild(A),h.instance=A);case"void":return null;default:throw Error(i(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(v=h.instance,h.state.loading|=4,uf(v,g.precedence,c));return h.instance}function uf(c,h,g){for(var v=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=v.length?v[v.length-1]:null,R=A,z=0;z<v.length;z++){var W=v[z];if(W.dataset.precedence===h)R=W;else if(R!==A)break}R?R.parentNode.insertBefore(c,R.nextSibling):(h=g.nodeType===9?g.head:g,h.insertBefore(c,h.firstChild))}function Vm(c,h){c.crossOrigin==null&&(c.crossOrigin=h.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=h.referrerPolicy),c.title==null&&(c.title=h.title)}function Gm(c,h){c.crossOrigin==null&&(c.crossOrigin=h.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=h.referrerPolicy),c.integrity==null&&(c.integrity=h.integrity)}var lf=null;function jx(c,h,g){if(lf===null){var v=new Map,A=lf=new Map;A.set(g,v)}else A=lf,v=A.get(g),v||(v=new Map,A.set(g,v));if(v.has(c))return v;for(v.set(c,null),g=g.getElementsByTagName(c),A=0;A<g.length;A++){var R=g[A];if(!(R[nl]||R[zn]||c==="link"&&R.getAttribute("rel")==="stylesheet")&&R.namespaceURI!=="http://www.w3.org/2000/svg"){var z=R.getAttribute(h)||"";z=c+z;var W=v.get(z);W?W.push(R):v.set(z,[R])}}return v}function Wx(c,h,g){c=c.ownerDocument||c,c.head.insertBefore(g,h==="title"?c.querySelector("head > title"):null)}function cN(c,h,g){if(g===1||h.itemProp!=null)return!1;switch(c){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return c=h.disabled,typeof h.precedence=="string"&&c==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function $x(c){return!(c.type==="stylesheet"&&(c.state.loading&3)===0)}var Gl=null;function dN(){}function fN(c,h,g){if(Gl===null)throw Error(i(475));var v=Gl;if(h.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var A=su(g.href),R=c.querySelector(ql(A));if(R){c=R._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(v.count++,v=cf.bind(v),c.then(v,v)),h.state.loading|=4,h.instance=R,Rn(R);return}R=c.ownerDocument||c,g=Vx(g),(A=Ui.get(A))&&Vm(g,A),R=R.createElement("link"),Rn(R);var z=R;z._p=new Promise(function(W,se){z.onload=W,z.onerror=se}),Mn(R,"link",g),h.instance=R}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(h,c),(c=h.state.preload)&&(h.state.loading&3)===0&&(v.count++,h=cf.bind(v),c.addEventListener("load",h),c.addEventListener("error",h))}}function hN(){if(Gl===null)throw Error(i(475));var c=Gl;return c.stylesheets&&c.count===0&&jm(c,c.stylesheets),0<c.count?function(h){var g=setTimeout(function(){if(c.stylesheets&&jm(c,c.stylesheets),c.unsuspend){var v=c.unsuspend;c.unsuspend=null,v()}},6e4);return c.unsuspend=h,function(){c.unsuspend=null,clearTimeout(g)}}:null}function cf(){if(this.count--,this.count===0){if(this.stylesheets)jm(this,this.stylesheets);else if(this.unsuspend){var c=this.unsuspend;this.unsuspend=null,c()}}}var df=null;function jm(c,h){c.stylesheets=null,c.unsuspend!==null&&(c.count++,df=new Map,h.forEach(pN,c),df=null,cf.call(c))}function pN(c,h){if(!(h.state.loading&4)){var g=df.get(c);if(g)var v=g.get(null);else{g=new Map,df.set(c,g);for(var A=c.querySelectorAll("link[data-precedence],style[data-precedence]"),R=0;R<A.length;R++){var z=A[R];(z.nodeName==="LINK"||z.getAttribute("media")!=="not all")&&(g.set(z.dataset.precedence,z),v=z)}v&&g.set(null,v)}A=h.instance,z=A.getAttribute("data-precedence"),R=g.get(z)||v,R===v&&g.set(null,A),g.set(z,A),this.count++,v=cf.bind(this),A.addEventListener("load",v),A.addEventListener("error",v),R?R.parentNode.insertBefore(A,R.nextSibling):(c=c.nodeType===9?c.head:c,c.insertBefore(A,c.firstChild)),h.state.loading|=4}}var jl={$$typeof:S,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function mN(c,h,g,v,A,R,z,W){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=To(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=To(0),this.hiddenUpdates=To(null),this.identifierPrefix=v,this.onUncaughtError=A,this.onCaughtError=R,this.onRecoverableError=z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function Yx(c,h,g,v,A,R,z,W,se,ve,Re,ke){return c=new mN(c,h,g,z,W,se,ve,ke),h=1,R===!0&&(h|=24),R=mi(3,null,null,h),c.current=R,R.stateNode=c,h=Cp(),h.refCount++,c.pooledCache=h,h.refCount++,R.memoizedState={element:v,isDehydrated:g,cache:h},Lp(R),c}function Kx(c){return c?(c=Bo,c):Bo}function Xx(c,h,g,v,A,R){A=Kx(A),v.context===null?v.context=A:v.pendingContext=A,v=Rs(h),v.payload={element:g},R=R===void 0?null:R,R!==null&&(v.callback=R),g=_s(c,v,h),g!==null&&(Ei(g,c,h),Tl(g,c,h))}function Qx(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var g=c.retryLane;c.retryLane=g!==0&&g<h?g:h}}function Wm(c,h){Qx(c,h),(c=c.alternate)&&Qx(c,h)}function Zx(c){if(c.tag===13){var h=Mo(c,67108864);h!==null&&Ei(h,c,67108864),Wm(c,67108864)}}var ff=!0;function gN(c,h,g,v){var A=j.T;j.T=null;var R=te.p;try{te.p=2,$m(c,h,g,v)}finally{te.p=R,j.T=A}}function yN(c,h,g,v){var A=j.T;j.T=null;var R=te.p;try{te.p=8,$m(c,h,g,v)}finally{te.p=R,j.T=A}}function $m(c,h,g,v){if(ff){var A=Ym(v);if(A===null)km(c,h,v,hf,g),eS(c,v);else if(bN(A,c,h,g,v))v.stopPropagation();else if(eS(c,v),h&4&&-1<vN.indexOf(c)){for(;A!==null;){var R=Ao(A);if(R!==null)switch(R.tag){case 3:if(R=R.stateNode,R.current.memoizedState.isDehydrated){var z=Ze(R.pendingLanes);if(z!==0){var W=R;for(W.pendingLanes|=2,W.entangledLanes|=2;z;){var se=1<<31-B(z);W.entanglements[1]|=se,z&=~se}mr(R),(Nt&6)===0&&(Kd=k()+500,Fl(0))}}break;case 13:W=Mo(R,2),W!==null&&Ei(W,R,2),Qd(),Wm(R,2)}if(R=Ym(v),R===null&&km(c,h,v,hf,g),R===A)break;A=R}A!==null&&v.stopPropagation()}else km(c,h,v,null,g)}}function Ym(c){return c=J0(c),Km(c)}var hf=null;function Km(c){if(hf=null,c=So(c),c!==null){var h=s(c);if(h===null)c=null;else{var g=h.tag;if(g===13){if(c=a(h),c!==null)return c;c=null}else if(g===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;c=null}else h!==c&&(c=null)}}return hf=c,null}function Jx(c){switch(c){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(X()){case ue:return 2;case Se:return 8;case Oe:case ze:return 32;case Ne:return 268435456;default:return 32}default:return 32}}var Xm=!1,zs=null,qs=null,Vs=null,Wl=new Map,$l=new Map,Gs=[],vN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eS(c,h){switch(c){case"focusin":case"focusout":zs=null;break;case"dragenter":case"dragleave":qs=null;break;case"mouseover":case"mouseout":Vs=null;break;case"pointerover":case"pointerout":Wl.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":$l.delete(h.pointerId)}}function Yl(c,h,g,v,A,R){return c===null||c.nativeEvent!==R?(c={blockedOn:h,domEventName:g,eventSystemFlags:v,nativeEvent:R,targetContainers:[A]},h!==null&&(h=Ao(h),h!==null&&Zx(h)),c):(c.eventSystemFlags|=v,h=c.targetContainers,A!==null&&h.indexOf(A)===-1&&h.push(A),c)}function bN(c,h,g,v,A){switch(h){case"focusin":return zs=Yl(zs,c,h,g,v,A),!0;case"dragenter":return qs=Yl(qs,c,h,g,v,A),!0;case"mouseover":return Vs=Yl(Vs,c,h,g,v,A),!0;case"pointerover":var R=A.pointerId;return Wl.set(R,Yl(Wl.get(R)||null,c,h,g,v,A)),!0;case"gotpointercapture":return R=A.pointerId,$l.set(R,Yl($l.get(R)||null,c,h,g,v,A)),!0}return!1}function tS(c){var h=So(c.target);if(h!==null){var g=s(h);if(g!==null){if(h=g.tag,h===13){if(h=a(g),h!==null){c.blockedOn=h,fP(c.priority,function(){if(g.tag===13){var v=bi();v=q0(v);var A=Mo(g,v);A!==null&&Ei(A,g,v),Wm(g,v)}});return}}else if(h===3&&g.stateNode.current.memoizedState.isDehydrated){c.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}c.blockedOn=null}function pf(c){if(c.blockedOn!==null)return!1;for(var h=c.targetContainers;0<h.length;){var g=Ym(c.nativeEvent);if(g===null){g=c.nativeEvent;var v=new g.constructor(g.type,g);Z0=v,g.target.dispatchEvent(v),Z0=null}else return h=Ao(g),h!==null&&Zx(h),c.blockedOn=g,!1;h.shift()}return!0}function nS(c,h,g){pf(c)&&g.delete(h)}function EN(){Xm=!1,zs!==null&&pf(zs)&&(zs=null),qs!==null&&pf(qs)&&(qs=null),Vs!==null&&pf(Vs)&&(Vs=null),Wl.forEach(nS),$l.forEach(nS)}function mf(c,h){c.blockedOn===h&&(c.blockedOn=null,Xm||(Xm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,EN)))}var gf=null;function iS(c){gf!==c&&(gf=c,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){gf===c&&(gf=null);for(var h=0;h<c.length;h+=3){var g=c[h],v=c[h+1],A=c[h+2];if(typeof v!="function"){if(Km(v||g)===null)continue;break}var R=Ao(g);R!==null&&(c.splice(h,3),h-=3,Kp(R,{pending:!0,data:A,method:g.method,action:v},v,A))}}))}function Kl(c){function h(se){return mf(se,c)}zs!==null&&mf(zs,c),qs!==null&&mf(qs,c),Vs!==null&&mf(Vs,c),Wl.forEach(h),$l.forEach(h);for(var g=0;g<Gs.length;g++){var v=Gs[g];v.blockedOn===c&&(v.blockedOn=null)}for(;0<Gs.length&&(g=Gs[0],g.blockedOn===null);)tS(g),g.blockedOn===null&&Gs.shift();if(g=(c.ownerDocument||c).$$reactFormReplay,g!=null)for(v=0;v<g.length;v+=3){var A=g[v],R=g[v+1],z=A[ei]||null;if(typeof R=="function")z||iS(g);else if(z){var W=null;if(R&&R.hasAttribute("formAction")){if(A=R,z=R[ei]||null)W=z.formAction;else if(Km(A)!==null)continue}else W=z.action;typeof W=="function"?g[v+1]=W:(g.splice(v,3),v-=3),iS(g)}}}function Qm(c){this._internalRoot=c}yf.prototype.render=Qm.prototype.render=function(c){var h=this._internalRoot;if(h===null)throw Error(i(409));var g=h.current,v=bi();Xx(g,v,c,h,null,null)},yf.prototype.unmount=Qm.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var h=c.containerInfo;Xx(c.current,2,null,c,null,null),Qd(),h[xo]=null}};function yf(c){this._internalRoot=c}yf.prototype.unstable_scheduleHydration=function(c){if(c){var h=EE();c={blockedOn:null,target:c,priority:h};for(var g=0;g<Gs.length&&h!==0&&h<Gs[g].priority;g++);Gs.splice(g,0,c),g===0&&tS(c)}};var rS=e.version;if(rS!=="19.1.1")throw Error(i(527,rS,"19.1.1"));te.findDOMNode=function(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(i(188)):(c=Object.keys(c).join(","),Error(i(268,c)));return c=l(h),c=c!==null?u(c):null,c=c===null?null:c.stateNode,c};var TN={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vf.isDisabled&&vf.supportsFiber)try{he=vf.inject(TN),Te=vf}catch{}}return Ql.createRoot=function(c,h){if(!r(c))throw Error(i(299));var g=!1,v="",A=E2,R=T2,z=x2,W=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(v=h.identifierPrefix),h.onUncaughtError!==void 0&&(A=h.onUncaughtError),h.onCaughtError!==void 0&&(R=h.onCaughtError),h.onRecoverableError!==void 0&&(z=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(W=h.unstable_transitionCallbacks)),h=Yx(c,1,!1,null,null,g,v,A,R,z,W,null),c[xo]=h.current,Pm(c),new Qm(h)},Ql.hydrateRoot=function(c,h,g){if(!r(c))throw Error(i(299));var v=!1,A="",R=E2,z=T2,W=x2,se=null,ve=null;return g!=null&&(g.unstable_strictMode===!0&&(v=!0),g.identifierPrefix!==void 0&&(A=g.identifierPrefix),g.onUncaughtError!==void 0&&(R=g.onUncaughtError),g.onCaughtError!==void 0&&(z=g.onCaughtError),g.onRecoverableError!==void 0&&(W=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(se=g.unstable_transitionCallbacks),g.formState!==void 0&&(ve=g.formState)),h=Yx(c,1,!0,h,g??null,v,A,R,z,W,se,ve),h.context=Kx(null),g=h.current,v=bi(),v=q0(v),A=Rs(v),A.callback=null,_s(g,A,v),g=v,h.current.lanes=g,xs(h,g),mr(h),c[xo]=h.current,Pm(c),new yf(h)},Ql.version="19.1.1",Ql}var pS;function ON(){if(pS)return eg.exports;pS=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),eg.exports=DN(),eg.exports}var PN=ON();const{slice:kN,forEach:NN}=[];function MN(t){return NN.call(kN.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}function BN(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(t))}const mS=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,FN=function(t,e){const i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},r=encodeURIComponent(e);let s=`${t}=${r}`;if(i.maxAge>0){const a=i.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");s+=`; Max-Age=${Math.floor(a)}`}if(i.domain){if(!mS.test(i.domain))throw new TypeError("option domain is invalid");s+=`; Domain=${i.domain}`}if(i.path){if(!mS.test(i.path))throw new TypeError("option path is invalid");s+=`; Path=${i.path}`}if(i.expires){if(typeof i.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+=`; Expires=${i.expires.toUTCString()}`}if(i.httpOnly&&(s+="; HttpOnly"),i.secure&&(s+="; Secure"),i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i.partitioned&&(s+="; Partitioned"),s},gS={create(t,e,n,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+n*60*1e3)),i&&(r.domain=i),document.cookie=FN(t,e,r)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let i=0;i<n.length;i++){let r=n[i];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return r.substring(e.length,r.length)}return null},remove(t,e){this.create(t,"",-1,e)}};var UN={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return gS.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:i,cookieDomain:r,cookieOptions:s}=e;n&&typeof document<"u"&&gS.create(n,t,i,r,s)}},HN={name:"querystring",lookup(t){var i;let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:r}=window.location;!window.location.search&&((i=window.location.hash)==null?void 0:i.indexOf("?"))>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));const a=r.substring(1).split("&");for(let o=0;o<a.length;o++){const l=a[o].indexOf("=");l>0&&a[o].substring(0,l)===e&&(n=a[o].substring(l+1))}}return n}},zN={name:"hash",lookup(t){var r;let{lookupHash:e,lookupFromHashIndex:n}=t,i;if(typeof window<"u"){const{hash:s}=window.location;if(s&&s.length>2){const a=s.substring(1);if(e){const o=a.split("&");for(let l=0;l<o.length;l++){const u=o[l].indexOf("=");u>0&&o[l].substring(0,u)===e&&(i=o[l].substring(u+1))}}if(i)return i;if(!i&&n>-1){const o=s.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?(r=o[typeof n=="number"?n:0])==null?void 0:r.replace("/",""):void 0}}}return i}};let ou=null;const yS=()=>{if(ou!==null)return ou;try{if(ou=typeof window<"u"&&window.localStorage!==null,!ou)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{ou=!1}return ou};var qN={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&yS())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&yS()&&window.localStorage.setItem(n,t)}};let uu=null;const vS=()=>{if(uu!==null)return uu;try{if(uu=typeof window<"u"&&window.sessionStorage!==null,!uu)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{uu=!1}return uu};var VN={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&vS())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&vS()&&window.sessionStorage.setItem(n,t)}},GN={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:i,language:r}=navigator;if(n)for(let s=0;s<n.length;s++)e.push(n[s]);i&&e.push(i),r&&e.push(r)}return e.length>0?e:void 0}},jN={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const i=e||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(n=i.getAttribute("lang")),n}},WN={name:"path",lookup(t){var r;let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?(r=n[typeof e=="number"?e:0])==null?void 0:r.replace("/",""):void 0}},$N={name:"subdomain",lookup(t){var r,s;let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,i=typeof window<"u"&&((s=(r=window.location)==null?void 0:r.hostname)==null?void 0:s.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(i)return i[n]}};let FR=!1;try{document.cookie,FR=!0}catch{}const UR=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];FR||UR.splice(1,1);const YN=()=>({order:UR,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class HR{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=MN(n,this.options||{},YN()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=r=>r.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(UN),this.addDetector(HN),this.addDetector(qN),this.addDetector(VN),this.addDetector(GN),this.addDetector(jN),this.addDetector(WN),this.addDetector($N),this.addDetector(zN)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return e.forEach(i=>{if(this.detectors[i]){let r=this.detectors[i].lookup(this.options);r&&typeof r=="string"&&(r=[r]),r&&(n=n.concat(r))}}),n=n.filter(i=>i!=null&&!BN(i)).map(i=>this.options.convertDetectedLanguage(i)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(i=>{this.detectors[i]&&this.detectors[i].cacheUserLanguage(e,this.options)}))}}HR.type="languageDetector";const ht=t=>typeof t=="string",Zl=()=>{let t,e;const n=new Promise((i,r)=>{t=i,e=r});return n.resolve=t,n.reject=e,n},bS=t=>t==null?"":""+t,KN=(t,e,n)=>{t.forEach(i=>{e[i]&&(n[i]=e[i])})},XN=/###/g,ES=t=>t&&t.indexOf("###")>-1?t.replace(XN,"."):t,TS=t=>!t||ht(t),pc=(t,e,n)=>{const i=ht(e)?e.split("."):e;let r=0;for(;r<i.length-1;){if(TS(t))return{};const s=ES(i[r]);!t[s]&&n&&(t[s]=new n),Object.prototype.hasOwnProperty.call(t,s)?t=t[s]:t={},++r}return TS(t)?{}:{obj:t,k:ES(i[r])}},xS=(t,e,n)=>{const{obj:i,k:r}=pc(t,e,Object);if(i!==void 0||e.length===1){i[r]=n;return}let s=e[e.length-1],a=e.slice(0,e.length-1),o=pc(t,a,Object);for(;o.obj===void 0&&a.length;)s=`${a[a.length-1]}.${s}`,a=a.slice(0,a.length-1),o=pc(t,a,Object),o&&o.obj&&typeof o.obj[`${o.k}.${s}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${s}`]=n},QN=(t,e,n,i)=>{const{obj:r,k:s}=pc(t,e,Object);r[s]=r[s]||[],r[s].push(n)},_h=(t,e)=>{const{obj:n,k:i}=pc(t,e);if(n)return n[i]},ZN=(t,e,n)=>{const i=_h(t,n);return i!==void 0?i:_h(e,n)},zR=(t,e,n)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in t?ht(t[i])||t[i]instanceof String||ht(e[i])||e[i]instanceof String?n&&(t[i]=e[i]):zR(t[i],e[i],n):t[i]=e[i]);return t},lu=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var JN={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const e5=t=>ht(t)?t.replace(/[&<>"'\/]/g,e=>JN[e]):t;class t5{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const n5=[" ",",","?","!",";"],i5=new t5(20),r5=(t,e,n)=>{e=e||"",n=n||"";const i=n5.filter(a=>e.indexOf(a)<0&&n.indexOf(a)<0);if(i.length===0)return!0;const r=i5.getRegExp(`(${i.map(a=>a==="?"?"\\?":a).join("|")})`);let s=!r.test(t);if(!s){const a=t.indexOf(n);a>0&&!r.test(t.substring(0,a))&&(s=!0)}return s},dy=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[e])return t[e];const i=e.split(n);let r=t;for(let s=0;s<i.length;){if(!r||typeof r!="object")return;let a,o="";for(let l=s;l<i.length;++l)if(l!==s&&(o+=n),o+=i[l],a=r[o],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&l<i.length-1)continue;s+=l-s+1;break}r=a}return r},Ih=t=>t&&t.replace("_","-"),s5={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};let a5=class fy{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=e||s5,this.options=n,this.debug=n.debug}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"log","",!0)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"warn","",!0)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"error","")}deprecate(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,i,r){return r&&!this.debug?null:(ht(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new fy(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new fy(this.logger,e)}};var Ar=new a5;let e0=class{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const r=this.observers[i].get(n)||0;this.observers[i].set(n,r+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(a=>{let[o,l]=a;for(let u=0;u<l;u++)o(...i)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(a=>{let[o,l]=a;for(let u=0;u<l;u++)o.apply(o,[e,...i])})}};class SS extends e0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,a=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;e.indexOf(".")>-1?o=e.split("."):(o=[e,n],i&&(Array.isArray(i)?o.push(...i):ht(i)&&s?o.push(...i.split(s)):o.push(i)));const l=_h(this.data,o);return!l&&!n&&!i&&e.indexOf(".")>-1&&(e=o[0],n=o[1],i=o.slice(2).join(".")),l||!a||!ht(i)?l:dy(this.data&&this.data[e]&&this.data[e][n],i,s)}addResource(e,n,i,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let o=[e,n];i&&(o=o.concat(a?i.split(a):i)),e.indexOf(".")>-1&&(o=e.split("."),r=n,n=o[1]),this.addNamespaces(n),xS(this.data,o,r),s.silent||this.emit("added",e,n,i,r)}addResources(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const s in i)(ht(i[s])||Array.isArray(i[s]))&&this.addResource(e,n,s,i[s],{silent:!0});r.silent||this.emit("added",e,n,i)}addResourceBundle(e,n,i,r,s){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},o=[e,n];e.indexOf(".")>-1&&(o=e.split("."),r=i,i=n,n=o[1]),this.addNamespaces(n);let l=_h(this.data,o)||{};a.skipCopy||(i=JSON.parse(JSON.stringify(i))),r?zR(l,i,s):l={...l,...i},xS(this.data,o,l),a.silent||this.emit("added",e,n,i)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,n)}:this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(r=>n[r]&&Object.keys(n[r]).length>0)}toJSON(){return this.data}}var qR={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,i,r){return t.forEach(s=>{this.processors[s]&&(e=this.processors[s].process(e,n,i,r))}),e}};const AS={};class Lh extends e0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),KN(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Ar.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const i=this.resolve(e,n);return i&&i.res!==void 0}extractFromKey(e,n){let i=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const r=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let s=n.ns||this.options.defaultNS||[];const a=i&&e.indexOf(i)>-1,o=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!r5(e,i,r);if(a&&!o){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:ht(s)?[s]:s};const u=e.split(i);(i!==r||i===r&&this.options.ns.indexOf(u[0])>-1)&&(s=u.shift()),e=u.join(r)}return{key:e,namespaces:ht(s)?[s]:s}}translate(e,n,i){if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const r=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:a,namespaces:o}=this.extractFromKey(e[e.length-1],n),l=o[o.length-1],u=n.lng||this.language,d=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(d){const w=n.nsSeparator||this.options.nsSeparator;return r?{res:`${l}${w}${a}`,usedKey:a,exactUsedKey:a,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:`${l}${w}${a}`}return r?{res:a,usedKey:a,exactUsedKey:a,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:a}const f=this.resolve(e,n);let p=f&&f.res;const m=f&&f.usedKey||a,y=f&&f.exactUsedKey||a,b=Object.prototype.toString.apply(p),E=["[object Number]","[object Function]","[object RegExp]"],T=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,x=!this.i18nFormat||this.i18nFormat.handleAsObject,S=!ht(p)&&typeof p!="boolean"&&typeof p!="number";if(x&&p&&S&&E.indexOf(b)<0&&!(ht(T)&&Array.isArray(p))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const w=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,p,{...n,ns:o}):`key '${a} (${this.language})' returned an object instead of string.`;return r?(f.res=w,f.usedParams=this.getUsedParamsDetails(n),f):w}if(s){const w=Array.isArray(p),C=w?[]:{},I=w?y:m;for(const L in p)if(Object.prototype.hasOwnProperty.call(p,L)){const N=`${I}${s}${L}`;C[L]=this.translate(N,{...n,joinArrays:!1,ns:o}),C[L]===N&&(C[L]=p[L])}p=C}}else if(x&&ht(T)&&Array.isArray(p))p=p.join(T),p&&(p=this.extendTranslation(p,e,n,i));else{let w=!1,C=!1;const I=n.count!==void 0&&!ht(n.count),L=Lh.hasDefaultValue(n),N=I?this.pluralResolver.getSuffix(u,n.count,n):"",G=n.ordinal&&I?this.pluralResolver.getSuffix(u,n.count,{ordinal:!1}):"",O=I&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),D=O&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${N}`]||n[`defaultValue${G}`]||n.defaultValue;!this.isValidLookup(p)&&L&&(w=!0,p=D),this.isValidLookup(p)||(C=!0,p=a);const $=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&C?void 0:p,J=L&&D!==p&&this.options.updateMissing;if(C||w||J){if(this.logger.log(J?"updateKey":"missingKey",u,l,a,J?D:p),s){const ne=this.resolve(a,{...n,keySeparator:!1});ne&&ne.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let K=[];const j=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&j&&j[0])for(let ne=0;ne<j.length;ne++)K.push(j[ne]);else this.options.saveMissingTo==="all"?K=this.languageUtils.toResolveHierarchy(n.lng||this.language):K.push(n.lng||this.language);const te=(ne,oe,P)=>{const ie=L&&P!==p?P:$;this.options.missingKeyHandler?this.options.missingKeyHandler(ne,l,oe,ie,J,n):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(ne,l,oe,ie,J,n),this.emit("missingKey",ne,l,oe,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&I?K.forEach(ne=>{const oe=this.pluralResolver.getSuffixes(ne,n);O&&n[`defaultValue${this.options.pluralSeparator}zero`]&&oe.indexOf(`${this.options.pluralSeparator}zero`)<0&&oe.push(`${this.options.pluralSeparator}zero`),oe.forEach(P=>{te([ne],a+P,n[`defaultValue${P}`]||D)})}):te(K,a,D))}p=this.extendTranslation(p,e,n,f,i),C&&p===a&&this.options.appendNamespaceToMissingKey&&(p=`${l}:${a}`),(C||w)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${a}`:a,w?p:void 0):p=this.options.parseMissingKeyHandler(p))}return r?(f.res=p,f.usedParams=this.getUsedParamsDetails(n),f):p}extendTranslation(e,n,i,r,s){var a=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const u=ht(e)&&(i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(u){const p=e.match(this.interpolator.nestingRegexp);d=p&&p.length}let f=i.replace&&!ht(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),e=this.interpolator.interpolate(e,f,i.lng||this.language||r.usedLng,i),u){const p=e.match(this.interpolator.nestingRegexp),m=p&&p.length;d<m&&(i.nest=!1)}!i.lng&&this.options.compatibilityAPI!=="v1"&&r&&r.res&&(i.lng=this.language||r.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var p=arguments.length,m=new Array(p),y=0;y<p;y++)m[y]=arguments[y];return s&&s[0]===m[0]&&!i.context?(a.logger.warn(`It seems you are nesting recursively key: ${m[0]} in key: ${n[0]}`),null):a.translate(...m,n)},i)),i.interpolation&&this.interpolator.reset()}const o=i.postProcess||this.options.postProcess,l=ht(o)?[o]:o;return e!=null&&l&&l.length&&i.applyPostProcessor!==!1&&(e=qR.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i,r,s,a,o;return ht(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(i))return;const u=this.extractFromKey(l,n),d=u.key;r=d;let f=u.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const p=n.count!==void 0&&!ht(n.count),m=p&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),y=n.context!==void 0&&(ht(n.context)||typeof n.context=="number")&&n.context!=="",b=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);f.forEach(E=>{this.isValidLookup(i)||(o=E,!AS[`${b[0]}-${E}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(o)&&(AS[`${b[0]}-${E}`]=!0,this.logger.warn(`key "${r}" for languages "${b.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),b.forEach(T=>{if(this.isValidLookup(i))return;a=T;const x=[d];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(x,d,T,E,n);else{let w;p&&(w=this.pluralResolver.getSuffix(T,n.count,n));const C=`${this.options.pluralSeparator}zero`,I=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(x.push(d+w),n.ordinal&&w.indexOf(I)===0&&x.push(d+w.replace(I,this.options.pluralSeparator)),m&&x.push(d+C)),y){const L=`${d}${this.options.contextSeparator}${n.context}`;x.push(L),p&&(x.push(L+w),n.ordinal&&w.indexOf(I)===0&&x.push(L+w.replace(I,this.options.pluralSeparator)),m&&x.push(L+C))}}let S;for(;S=x.pop();)this.isValidLookup(i)||(s=S,i=this.getResource(T,E,S,n))}))})}),{res:i,usedKey:r,exactUsedKey:s,usedLng:a,usedNS:o}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,n,i,r):this.resourceStore.getResource(e,n,i,r)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!ht(e.replace);let r=i?e.replace:e;if(i&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!i){r={...r};for(const s of n)delete r[s]}return r}static hasDefaultValue(e){const n="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&n===i.substring(0,n.length)&&e[i]!==void 0)return!0;return!1}}const rg=t=>t.charAt(0).toUpperCase()+t.slice(1);class wS{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ar.create("languageUtils")}getScriptPartFromCode(e){if(e=Ih(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=Ih(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(ht(e)&&e.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let r=Intl.getCanonicalLocales(e)[0];if(r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r)return r}catch{}const n=["hans","hant","latn","cyrl","cans","mong","arab"];let i=e.split("-");return this.options.lowerCaseLng?i=i.map(r=>r.toLowerCase()):i.length===2?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),n.indexOf(i[1].toLowerCase())>-1&&(i[1]=rg(i[1].toLowerCase()))):i.length===3&&(i[0]=i[0].toLowerCase(),i[1].length===2&&(i[1]=i[1].toUpperCase()),i[0]!=="sgn"&&i[2].length===2&&(i[2]=i[2].toUpperCase()),n.indexOf(i[1].toLowerCase())>-1&&(i[1]=rg(i[1].toLowerCase())),n.indexOf(i[2].toLowerCase())>-1&&(i[2]=rg(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(i=>{if(n)return;const r=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(r))&&(n=r)}),!n&&this.options.supportedLngs&&e.forEach(i=>{if(n)return;const r=this.getLanguagePartFromCode(i);if(this.isSupportedCode(r))return n=r;n=this.options.supportedLngs.find(s=>{if(s===r)return s;if(!(s.indexOf("-")<0&&r.indexOf("-")<0)&&(s.indexOf("-")>0&&r.indexOf("-")<0&&s.substring(0,s.indexOf("-"))===r||s.indexOf(r)===0&&r.length>1))return s})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),ht(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let i=e[n];return i||(i=e[this.getScriptPartFromCode(n)]),i||(i=e[this.formatLanguageCode(n)]),i||(i=e[this.getLanguagePartFromCode(n)]),i||(i=e.default),i||[]}toResolveHierarchy(e,n){const i=this.getFallbackCodes(n||this.options.fallbackLng||[],e),r=[],s=a=>{a&&(this.isSupportedCode(a)?r.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return ht(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):ht(e)&&s(this.formatLanguageCode(e)),i.forEach(a=>{r.indexOf(a)<0&&s(this.formatLanguageCode(a))}),r}}let o5=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],u5={1:t=>+(t>1),2:t=>+(t!=1),3:t=>0,4:t=>t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,5:t=>t==0?0:t==1?1:t==2?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5,6:t=>t==1?0:t>=2&&t<=4?1:2,7:t=>t==1?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,8:t=>t==1?0:t==2?1:t!=8&&t!=11?2:3,9:t=>+(t>=2),10:t=>t==1?0:t==2?1:t<7?2:t<11?3:4,11:t=>t==1||t==11?0:t==2||t==12?1:t>2&&t<20?2:3,12:t=>+(t%10!=1||t%100==11),13:t=>+(t!==0),14:t=>t==1?0:t==2?1:t==3?2:3,15:t=>t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2,16:t=>t%10==1&&t%100!=11?0:t!==0?1:2,17:t=>t==1||t%10==1&&t%100!=11?0:1,18:t=>t==0?0:t==1?1:2,19:t=>t==1?0:t==0||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3,20:t=>t==1?0:t==0||t%100>0&&t%100<20?1:2,21:t=>t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0,22:t=>t==1?0:t==2?1:(t<0||t>10)&&t%10==0?2:3};const l5=["v1","v2","v3"],c5=["v4"],CS={zero:0,one:1,two:2,few:3,many:4,other:5},d5=()=>{const t={};return o5.forEach(e=>{e.lngs.forEach(n=>{t[n]={numbers:e.nr,plurals:u5[e.fc]}})}),t};class f5{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=n,this.logger=Ar.create("pluralResolver"),(!this.options.compatibilityJSON||c5.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=d5(),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const i=Ih(e==="dev"?"en":e),r=n.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:i,type:r});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let a;try{a=new Intl.PluralRules(i,{type:r})}catch{if(!e.match(/-|_/))return;const l=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(l,n)}return this.pluralRulesCache[s]=a,a}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=this.getRule(e,n);return this.shouldUseIntlApi()?i&&i.resolvedOptions().pluralCategories.length>1:i&&i.numbers.length>1}getPluralFormsOfKey(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,i).map(r=>`${n}${r}`)}getSuffixes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=this.getRule(e,n);return i?this.shouldUseIntlApi()?i.resolvedOptions().pluralCategories.sort((r,s)=>CS[r]-CS[s]).map(r=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r}`):i.numbers.map(r=>this.getSuffix(e,r,n)):[]}getSuffix(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=this.getRule(e,i);return r?this.shouldUseIntlApi()?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r.select(n)}`:this.getSuffixRetroCompatible(r,n):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,n){const i=e.noAbs?e.plurals(n):e.plurals(Math.abs(n));let r=e.numbers[i];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(r===2?r="plural":r===1&&(r=""));const s=()=>this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString();return this.options.compatibilityJSON==="v1"?r===1?"":typeof r=="number"?`_plural_${r.toString()}`:s():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?s():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}shouldUseIntlApi(){return!l5.includes(this.options.compatibilityJSON)}}const RS=function(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=ZN(t,e,n);return!s&&r&&ht(n)&&(s=dy(t,n,i),s===void 0&&(s=dy(e,n,i))),s},sg=t=>t.replace(/\$/g,"$$$$");class h5{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ar.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(n=>n),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:i,useRawValueToEscape:r,prefix:s,prefixEscaped:a,suffix:o,suffixEscaped:l,formatSeparator:u,unescapeSuffix:d,unescapePrefix:f,nestingPrefix:p,nestingPrefixEscaped:m,nestingSuffix:y,nestingSuffixEscaped:b,nestingOptionsSeparator:E,maxReplaces:T,alwaysFormat:x}=e.interpolation;this.escape=n!==void 0?n:e5,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=s?lu(s):a||"{{",this.suffix=o?lu(o):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=d?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=p?lu(p):m||lu("$t("),this.nestingSuffix=y?lu(y):b||lu(")"),this.nestingOptionsSeparator=E||",",this.maxReplaces=T||1e3,this.alwaysFormat=x!==void 0?x:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,i)=>n&&n.source===i?(n.lastIndex=0,n):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,n,i,r){let s,a,o;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=m=>{if(m.indexOf(this.formatSeparator)<0){const T=RS(n,l,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(T,void 0,i,{...r,...n,interpolationkey:m}):T}const y=m.split(this.formatSeparator),b=y.shift().trim(),E=y.join(this.formatSeparator).trim();return this.format(RS(n,l,b,this.options.keySeparator,this.options.ignoreJSONStructure),E,i,{...r,...n,interpolationkey:b})};this.resetRegExp();const d=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,f=r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>sg(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?sg(this.escape(m)):sg(m)}].forEach(m=>{for(o=0;s=m.regex.exec(e);){const y=s[1].trim();if(a=u(y),a===void 0)if(typeof d=="function"){const E=d(e,s,r);a=ht(E)?E:""}else if(r&&Object.prototype.hasOwnProperty.call(r,y))a="";else if(f){a=s[0];continue}else this.logger.warn(`missed to pass in variable ${y} for interpolating ${e}`),a="";else!ht(a)&&!this.useRawValueToEscape&&(a=bS(a));const b=m.safeValue(a);if(e=e.replace(s[0],b),f?(m.regex.lastIndex+=a.length,m.regex.lastIndex-=s[0].length):m.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),e}nest(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r,s,a;const o=(l,u)=>{const d=this.nestingOptionsSeparator;if(l.indexOf(d)<0)return l;const f=l.split(new RegExp(`${d}[ ]*{`));let p=`{${f[1]}`;l=f[0],p=this.interpolate(p,a);const m=p.match(/'/g),y=p.match(/"/g);(m&&m.length%2===0&&!y||y.length%2!==0)&&(p=p.replace(/'/g,'"'));try{a=JSON.parse(p),u&&(a={...u,...a})}catch(b){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,b),`${l}${d}${p}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,l};for(;r=this.nestingRegexp.exec(e);){let l=[];a={...i},a=a.replace&&!ht(a.replace)?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;let u=!1;if(r[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(r[1])){const d=r[1].split(this.formatSeparator).map(f=>f.trim());r[1]=d.shift(),l=d,u=!0}if(s=n(o.call(this,r[1].trim(),a),a),s&&r[0]===e&&!ht(s))return s;ht(s)||(s=bS(s)),s||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),s=""),u&&(s=l.reduce((d,f)=>this.format(d,f,i.lng,{...i,interpolationkey:r[1].trim()}),s.trim())),e=e.replace(r[0],s),this.regexp.lastIndex=0}return e}}const p5=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const i=t.split("(");e=i[0].toLowerCase().trim();const r=i[1].substring(0,i[1].length-1);e==="currency"&&r.indexOf(":")<0?n.currency||(n.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?n.range||(n.range=r.trim()):r.split(";").forEach(a=>{if(a){const[o,...l]=a.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,""),d=o.trim();n[d]||(n[d]=u),u==="false"&&(n[d]=!1),u==="true"&&(n[d]=!0),isNaN(u)||(n[d]=parseInt(u,10))}})}return{formatName:e,formatOptions:n}},cu=t=>{const e={};return(n,i,r)=>{let s=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(s={...s,[r.interpolationkey]:void 0});const a=i+JSON.stringify(s);let o=e[a];return o||(o=t(Ih(i),r),e[a]=o),o(n)}};class m5{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ar.create("formatter"),this.options=e,this.formats={number:cu((n,i)=>{const r=new Intl.NumberFormat(n,{...i});return s=>r.format(s)}),currency:cu((n,i)=>{const r=new Intl.NumberFormat(n,{...i,style:"currency"});return s=>r.format(s)}),datetime:cu((n,i)=>{const r=new Intl.DateTimeFormat(n,{...i});return s=>r.format(s)}),relativetime:cu((n,i)=>{const r=new Intl.RelativeTimeFormat(n,{...i});return s=>r.format(s,i.range||"day")}),list:cu((n,i)=>{const r=new Intl.ListFormat(n,{...i});return s=>r.format(s)})},this.init(e)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=n.interpolation.formatSeparator||","}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=cu(n)}format(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=n.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(o=>o.indexOf(")")>-1)){const o=s.findIndex(l=>l.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,o)].join(this.formatSeparator)}return s.reduce((o,l)=>{const{formatName:u,formatOptions:d}=p5(l);if(this.formats[u]){let f=o;try{const p=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},m=p.locale||p.lng||r.locale||r.lng||i;f=this.formats[u](o,m,{...d,...r,...p})}catch(p){this.logger.warn(p)}return f}else this.logger.warn(`there was no format function for ${u}`);return o},e)}}const g5=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class y5 extends e0{constructor(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=n,this.services=i,this.languageUtils=i.languageUtils,this.options=r,this.logger=Ar.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(i,r.backend,r)}queueLoad(e,n,i,r){const s={},a={},o={},l={};return e.forEach(u=>{let d=!0;n.forEach(f=>{const p=`${u}|${f}`;!i.reload&&this.store.hasResourceBundle(u,f)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?a[p]===void 0&&(a[p]=!0):(this.state[p]=1,d=!1,a[p]===void 0&&(a[p]=!0),s[p]===void 0&&(s[p]=!0),l[f]===void 0&&(l[f]=!0)))}),d||(o[u]=!0)}),(Object.keys(s).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(s),pending:Object.keys(a),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(l)}}loaded(e,n,i){const r=e.split("|"),s=r[0],a=r[1];n&&this.emit("failedLoading",s,a,n),!n&&i&&this.store.addResourceBundle(s,a,i,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&i&&(this.state[e]=0);const o={};this.queue.forEach(l=>{QN(l.loaded,[s],a),g5(l,e),n&&l.errors.push(n),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{o[u]||(o[u]={});const d=l.loaded[u];d.length&&d.forEach(f=>{o[u][f]===void 0&&(o[u][f]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(l=>!l.done)}read(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:i,tried:r,wait:s,callback:a});return}this.readingCalls++;const o=(u,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(u&&d&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,i,r+1,s*2,a)},s);return}a(u,d)},l=this.backend[i].bind(this.backend);if(l.length===2){try{const u=l(e,n);u&&typeof u.then=="function"?u.then(d=>o(null,d)).catch(o):o(null,u)}catch(u){o(u)}return}return l(e,n,o)}prepareLoading(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();ht(e)&&(e=this.languageUtils.toResolveHierarchy(e)),ht(n)&&(n=[n]);const s=this.queueLoad(e,n,i,r);if(!s.toLoad.length)return s.pending.length||r(),null;s.toLoad.forEach(a=>{this.loadOne(a)})}load(e,n,i){this.prepareLoading(e,n,{},i)}reload(e,n,i){this.prepareLoading(e,n,{reload:!0},i)}loadOne(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=e.split("|"),r=i[0],s=i[1];this.read(r,s,"read",void 0,void 0,(a,o)=>{a&&this.logger.warn(`${n}loading namespace ${s} for language ${r} failed`,a),!a&&o&&this.logger.log(`${n}loaded namespace ${s} for language ${r}`,o),this.loaded(e,a,o)})}saveMissing(e,n,i,r,s){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${i}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if(this.backend&&this.backend.create){const l={...a,isUpdate:s},u=this.backend.create.bind(this.backend);if(u.length<6)try{let d;u.length===5?d=u(e,n,i,r,l):d=u(e,n,i,r),d&&typeof d.then=="function"?d.then(f=>o(null,f)).catch(o):o(null,d)}catch(d){o(d)}else u(e,n,i,r,o,l)}!e||!e[0]||this.store.addResource(e[0],n,i,r)}}}const _S=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),ht(t[1])&&(e.defaultValue=t[1]),ht(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(i=>{e[i]=n[i]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),IS=t=>(ht(t.ns)&&(t.ns=[t.ns]),ht(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),ht(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t),bf=()=>{},v5=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class Lc extends e0{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=IS(e),this.services={},this.logger=Ar,this.modules={external:[]},v5(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof n=="function"&&(i=n,n={}),!n.defaultNS&&n.defaultNS!==!1&&n.ns&&(ht(n.ns)?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const r=_S();this.options={...r,...this.options,...IS(n)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...r.interpolation,...this.options.interpolation}),n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);const s=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?Ar.init(s(this.modules.logger),this.options):Ar.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:typeof Intl<"u"&&(d=m5);const f=new wS(this.options);this.store=new SS(this.options.resources,this.options);const p=this.services;p.logger=Ar,p.resourceStore=this.store,p.languageUtils=f,p.pluralResolver=new f5(f,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),d&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(p.formatter=s(d),p.formatter.init(p,this.options),this.options.interpolation.format=p.formatter.format.bind(p.formatter)),p.interpolator=new h5(this.options),p.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},p.backendConnector=new y5(s(this.modules.backend),p.resourceStore,p,this.options),p.backendConnector.on("*",function(m){for(var y=arguments.length,b=new Array(y>1?y-1:0),E=1;E<y;E++)b[E-1]=arguments[E];e.emit(m,...b)}),this.modules.languageDetector&&(p.languageDetector=s(this.modules.languageDetector),p.languageDetector.init&&p.languageDetector.init(p,this.options.detection,this.options)),this.modules.i18nFormat&&(p.i18nFormat=s(this.modules.i18nFormat),p.i18nFormat.init&&p.i18nFormat.init(this)),this.translator=new Lh(this.services,this.options),this.translator.on("*",function(m){for(var y=arguments.length,b=new Array(y>1?y-1:0),E=1;E<y;E++)b[E-1]=arguments[E];e.emit(m,...b)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,i||(i=bf),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=function(){return e.store[d](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=function(){return e.store[d](...arguments),e}});const l=Zl(),u=()=>{const d=(f,p)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(p),i(f,p)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}loadResources(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bf;const r=ht(e)?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&r.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const s=[],a=o=>{if(!o||o==="cimode")return;this.services.languageUtils.toResolveHierarchy(o).forEach(u=>{u!=="cimode"&&s.indexOf(u)<0&&s.push(u)})};r?a(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>a(l)),this.options.preload&&this.options.preload.forEach(o=>a(o)),this.services.backendConnector.load(s,this.options.ns,o=>{!o&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(o)})}else i(null)}reloadResources(e,n,i){const r=Zl();return typeof e=="function"&&(i=e,e=void 0),typeof n=="function"&&(i=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),i||(i=bf),this.services.backendConnector.reload(e,n,s=>{r.resolve(),i(s)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&qR.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let n=0;n<this.languages.length;n++){const i=this.languages[n];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}}changeLanguage(e,n){var i=this;this.isLanguageChangingTo=e;const r=Zl();this.emit("languageChanging",e);const s=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},a=(l,u)=>{u?(s(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,r.resolve(function(){return i.t(...arguments)}),n&&n(l,function(){return i.t(...arguments)})},o=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const u=ht(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||s(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,d=>{a(d,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),r}getFixedT(e,n,i){var r=this;const s=function(a,o){let l;if(typeof o!="object"){for(var u=arguments.length,d=new Array(u>2?u-2:0),f=2;f<u;f++)d[f-2]=arguments[f];l=r.options.overloadTranslationOptionHandler([a,o].concat(d))}else l={...o};l.lng=l.lng||s.lng,l.lngs=l.lngs||s.lngs,l.ns=l.ns||s.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||i||s.keyPrefix);const p=r.options.keySeparator||".";let m;return l.keyPrefix&&Array.isArray(a)?m=a.map(y=>`${l.keyPrefix}${p}${y}`):m=l.keyPrefix?`${l.keyPrefix}${p}${a}`:a,r.t(m,l)};return ht(e)?s.lng=e:s.lngs=e,s.ns=n,s.keyPrefix=i,s}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=n.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const a=(o,l)=>{const u=this.services.backendConnector.state[`${o}|${l}`];return u===-1||u===0||u===2};if(n.precheck){const o=n.precheck(this,a);if(o!==void 0)return o}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(i,e)&&(!r||a(s,e)))}loadNamespaces(e,n){const i=Zl();return this.options.ns?(ht(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{i.resolve(),n&&n(r)}),i):(n&&n(),Promise.resolve())}loadLanguages(e,n){const i=Zl();ht(e)&&(e=[e]);const r=this.options.preload||[],s=e.filter(a=>r.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return s.length?(this.options.preload=r.concat(s),this.loadResources(a=>{i.resolve(),n&&n(a)}),i):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=this.services&&this.services.languageUtils||new wS(_S());return n.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new Lc(e,n)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bf;const i=e.forkResourceStore;i&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},s=new Lc(r);return(e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(o=>{s[o]=this[o]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},i&&(s.store=new SS(this.store.data,r),s.services.resourceStore=s.store),s.translator=new Lh(s.services,r),s.translator.on("*",function(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),d=1;d<l;d++)u[d-1]=arguments[d];s.emit(o,...u)}),s.init(r,n),s.translator.options=r,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Wn=Lc.createInstance();Wn.createInstance=Lc.createInstance;Wn.createInstance;Wn.dir;Wn.init;Wn.loadResources;Wn.reloadResources;Wn.use;Wn.changeLanguage;Wn.getFixedT;Wn.t;Wn.exists;Wn.setDefaultNamespace;Wn.hasLoadedNamespace;Wn.loadNamespaces;Wn.loadLanguages;const b5=(t,e,n,i)=>{var s,a,o,l;const r=[n,{code:e,...i||{}}];if((a=(s=t==null?void 0:t.services)==null?void 0:s.logger)!=null&&a.forward)return t.services.logger.forward(r,"warn","react-i18next::",!0);to(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),(l=(o=t==null?void 0:t.services)==null?void 0:o.logger)!=null&&l.warn?t.services.logger.warn(...r):console!=null&&console.warn&&console.warn(...r)},LS={},hy=(t,e,n,i)=>{to(n)&&LS[n]||(to(n)&&(LS[n]=new Date),b5(t,e,n,i))},VR=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},py=(t,e,n)=>{t.loadNamespaces(e,VR(t,n))},DS=(t,e,n,i)=>{if(to(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(e)>-1)return py(t,n,i);n.forEach(r=>{t.options.ns.indexOf(r)<0&&t.options.ns.push(r)}),t.loadLanguages(e,VR(t,i))},E5=(t,e,n={})=>!e.languages||!e.languages.length?(hy(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(i,r)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!r(i.isLanguageChangingTo,t))return!1}}),to=t=>typeof t=="string",T5=t=>typeof t=="object"&&t!==null,x5=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,S5={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},A5=t=>S5[t],w5=t=>t.replace(x5,A5);let my={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:w5};const C5=(t={})=>{my={...my,...t}},R5=()=>my;let GR;const _5=t=>{GR=t},I5=()=>GR,L5={type:"3rdParty",init(t){C5(t.options.react),_5(t)}},D5=H.createContext();class O5{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const P5=(t,e)=>{const n=H.useRef();return H.useEffect(()=>{n.current=t},[t,e]),n.current},jR=(t,e,n,i)=>t.getFixedT(e,n,i),k5=(t,e,n,i)=>H.useCallback(jR(t,e,n,i),[t,e,n,i]),ma=(t,e={})=>{var w,C,I,L;const{i18n:n}=e,{i18n:i,defaultNS:r}=H.useContext(D5)||{},s=n||i||I5();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new O5),!s){hy(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const N=(O,D)=>to(D)?D:T5(D)&&to(D.defaultValue)?D.defaultValue:Array.isArray(O)?O[O.length-1]:O,G=[N,{},!1];return G.t=N,G.i18n={},G.ready=!1,G}(w=s.options.react)!=null&&w.wait&&hy(s,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const a={...R5(),...s.options.react,...e},{useSuspense:o,keyPrefix:l}=a;let u=r||((C=s.options)==null?void 0:C.defaultNS);u=to(u)?[u]:u||["translation"],(L=(I=s.reportNamespaces).addUsedNamespaces)==null||L.call(I,u);const d=(s.isInitialized||s.initializedStoreOnce)&&u.every(N=>E5(N,s,a)),f=k5(s,e.lng||null,a.nsMode==="fallback"?u:u[0],l),p=()=>f,m=()=>jR(s,e.lng||null,a.nsMode==="fallback"?u:u[0],l),[y,b]=H.useState(p);let E=u.join();e.lng&&(E=`${e.lng}${E}`);const T=P5(E),x=H.useRef(!0);H.useEffect(()=>{const{bindI18n:N,bindI18nStore:G}=a;x.current=!0,!d&&!o&&(e.lng?DS(s,e.lng,u,()=>{x.current&&b(m)}):py(s,u,()=>{x.current&&b(m)})),d&&T&&T!==E&&x.current&&b(m);const O=()=>{x.current&&b(m)};return N&&(s==null||s.on(N,O)),G&&(s==null||s.store.on(G,O)),()=>{x.current=!1,s&&N&&(N==null||N.split(" ").forEach(D=>s.off(D,O))),G&&s&&G.split(" ").forEach(D=>s.store.off(D,O))}},[s,E]),H.useEffect(()=>{x.current&&d&&b(p)},[s,l,d]);const S=[y,s,d];if(S.t=y,S.i18n=s,S.ready=d,d||!d&&!o)return S;throw new Promise(N=>{e.lng?DS(s,e.lng,u,()=>N()):py(s,u,()=>N())})};var N5="http://library.stanford.edu/iiif/image-api/compliance.html#level0",M5="http://library.stanford.edu/iiif/image-api/compliance.html#level1",WR="http://library.stanford.edu/iiif/image-api/compliance.html#level2",B5="http://library.stanford.edu/iiif/image-api/conformance.html#level0",F5="http://library.stanford.edu/iiif/image-api/conformance.html#level1",$R="http://library.stanford.edu/iiif/image-api/conformance.html#level2",U5="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",H5="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",YR="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",z5="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",q5="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",KR="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",V5="http://iiif.io/api/image/1/level0.json",G5="http://iiif.io/api/image/1/profiles/level0.json",j5="http://iiif.io/api/image/1/level1.json",W5="http://iiif.io/api/image/1/profiles/level1.json",XR="http://iiif.io/api/image/1/level2.json",QR="http://iiif.io/api/image/1/profiles/level2.json",$5="http://iiif.io/api/image/2/level0.json",Y5="http://iiif.io/api/image/2/profiles/level0.json",K5="http://iiif.io/api/image/2/level1.json",X5="http://iiif.io/api/image/2/profiles/level1.json",ZR="http://iiif.io/api/image/2/level2.json",JR="http://iiif.io/api/image/2/profiles/level2.json",Q5="level0",Z5="level1",e_="level2",J5="http://iiif.io/api/image/2/level0",eM="http://iiif.io/api/image/2/level1",t_="http://iiif.io/api/image/2/level2",tM=[t_,WR,$R,YR,KR,XR,QR,ZR,JR,e_],nM=[J5,eM,t_,N5,M5,WR,B5,F5,$R,U5,H5,YR,z5,q5,KR,V5,G5,j5,W5,XR,QR,$5,Y5,K5,X5,ZR,JR,Q5,Z5,e_],iM=nM;function Or(t){for(let e in t)(typeof t[e]>"u"||t[e]===null)&&delete t[e];return t}function as(t){return Array.isArray(t)?t:t?[t]:[]}var rM=Object.defineProperty,sM=(t,e,n)=>e in t?rM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ta=(t,e,n)=>(sM(t,typeof e!="symbol"?e+"":e,n),n),OS=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function aM(t){if(typeof t>"u"||t===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(t))throw new Error("Array is not a valid entity");if(typeof t!="object")throw new Error(`${typeof t} is not a valid entity`);if(typeof t["@type"]=="string"){let e=OS.indexOf(t["@type"]);if(e!==-1)return OS[e]}if(t.profile)return"Service";if(t.format||t["@type"])return"ContentResource";throw new Error("Resource type is not known")}var oM=class n_{constructor(e,n={}){ta(this,"traversals"),ta(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...e},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...n}}static all(e){return new n_({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let n=[...(e.manifests||[]).map(s=>typeof s=="string"?{"@id":s,"@type":"sc:Manifest"}:s),...(e.collections||[]).map(s=>typeof s=="string"?{"@id":s,"@type":"sc:Collection"}:s),...e.members||[]],i=[],r=n.filter(s=>i.includes(s["@id"])?!1:(i.push(s["@id"]),!0));delete e.collections,delete e.manifests,e.members=r}return e.manifests&&(e.manifests=e.manifests.map(n=>this.traverseManifest(typeof n=="string"?{"@id":n,"@type":"sc:Manifest"}:n))),e.collections&&(e.collections=e.collections.map(n=>this.traverseCollection(typeof n=="string"?{"@id":n,"@type":"sc:Collection"}:n))),e.members&&(e.members=e.members.map(n=>typeof n=="string"?n:n["@type"]==="sc:Collection"?this.traverseCollection(n):n["@type"]==="sc:Manifest"?this.traverseManifest(n):this.traverseUnknown(n))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(n=>this.traverseSequence(n))),e.structures&&(e.structures=e.structures.map(n=>this.traverseRange(n))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(n=>this.traverseCanvas(n))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(n=>this.traverseAnnotation(n))),e.otherContent&&(e.otherContent=e.otherContent.map(n=>this.traverseAnnotationList(n))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let n=[...(e.ranges||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Range"}:i),...(e.canvases||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Canvas"}:i),...e.members||[]];delete e.ranges,delete e.canvases,e.members=n.length?n.map(i=>this.traverseUnknown(i)):void 0}return e}traverseAnnotationList(e){let n=typeof e=="string"?{"@id":e,"@type":"sc:AnnotationList"}:e;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(n)),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(n=>this.traverseAnnotation(n))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(Array.isArray(e.resource)?e.resource=e.resource.map(n=>this.traverseContentResource(n)):e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(n=>this.traverseAnnotationList(n))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(n=>this.traverseContentResource(n))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(aM(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"sc:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let n=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let s of i)typeof s=="string"?r.push(this.traverseContentResource({"@id":s,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(s));return!n&&!this.options.convertPropsToArray?r[0]:r}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let n=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let s of i)r.push(this.traverseService(s));return!n&&!this.options.convertPropsToArray?r[0]:r}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,n){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,n);return e.map(i=>this.traverseType(i,n))}traverseType(e,n){return n.reduce((i,r)=>{let s=r(i);return typeof s>"u"&&!this.options.allowUndefinedReturn?i:s},e)}},uM="http://library.stanford.edu/iiif/image-api/compliance.html#level1",lM="http://library.stanford.edu/iiif/image-api/compliance.html#level2",cM="http://library.stanford.edu/iiif/image-api/conformance.html#level1",dM="http://library.stanford.edu/iiif/image-api/conformance.html#level2",fM="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",hM="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",pM="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",mM="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",gM="http://iiif.io/api/image/1/level1.json",yM="http://iiif.io/api/image/1/profiles/level1.json",vM="http://iiif.io/api/image/1/level2.json",bM="http://iiif.io/api/image/1/profiles/level2.json",EM="http://iiif.io/api/image/2/level1.json",TM="http://iiif.io/api/image/2/profiles/level1.json",xM="http://iiif.io/api/image/2/level2.json",SM="http://iiif.io/api/image/2/profiles/level2.json",AM="level1",wM="level2",CM="http://iiif.io/api/image/2/level1",RM="http://iiif.io/api/image/2/level2",_M=[CM,RM,uM,lM,cM,dM,fM,hM,pM,mM,gM,yM,vM,bM,EM,TM,xM,SM,AM,wM],gy={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:""};function IM(t){if(typeof t=="string")return[t];if(!t)return[];let e=Array.isArray(t)?t:[t],n=[];for(let i of e){if(typeof i=="string"){n.push(i);continue}n.push({"@language":i["@language"]||i.language,"@value":i["@value"]||i.value})}return n}function Za(t,e="none"){if(!t)return{none:[""]};let n=IM(t),i={};for(let r of n){if(typeof r=="string"){i[e]=i[e]?i[e]:[],i[e].push(r||"");continue}if(!r["@language"]){i[e]=i[e]?i[e]:[],i[e].push(r["@value"]||"");continue}let s=r["@language"];i[s]=i[s]?i[s]:[],i[s].push(r["@value"]||"")}return Object.keys(i).length===0?{none:[""]}:i}function i_(t){if(Array.isArray(t))return i_(t.find(e=>typeof e=="string"));if(tM.indexOf(t)!==-1)return"level2";if(_M.indexOf(t)!==-1)return"level1";if(iM.indexOf(t)!==-1)return"level0";if(typeof t=="string")return t}function LM(t){let e=Array.isArray(t)?t:[t];for(let n of e)switch(n){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function DM(t){switch(t){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function PS(t){for(let e of["sc","oa","dcterms","dctypes","iiif"])if(t.startsWith(`${e}:`))return t.slice(e.length+1);return t}var OM=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function kv(t){let e=t["@id"]||t.id,n=t["@type"]||t.type,i=t.profile||void 0,r=t["@context"]||void 0;if(i){let s=DM(i);if(s)return s}if(r){let s=LM(r);if(s)return s}if(n){if(Array.isArray(n)){if(n.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(n.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";n=n[0]}for(let s of["sc","oa","dcterms","dctypes","iiif"])if(n.startsWith(`${s}:`)){n=n.slice(s.length+1);break}switch(n){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(n&&OM.indexOf(n)!==-1)return n;if(t.format){if(t.format.startsWith("image/"))return"Image";if(t.format.startsWith("text/")||t.format==="application/pdf")return"Text";if(t.format.startsWith("application/"))return"Dataset"}return e&&(e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".jpeg"))?"Image":n||"unknown"}var PM=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function kM(t){let e=t.match(PM);return e?e[0]:t}function NM(t,e="Rights/License",n="none"){let i=null,r=[],s=Array.isArray(t)?t:[t];for(let a of s){let o=a?kM(a):void 0;if(o&&(o.indexOf("creativecommons.org")!==-1||o.indexOf("rightsstatements.org")!==-1)){o.startsWith("https://")?i=`http://${o.slice(8)}`:i=o;continue}o&&r.push({label:{[n]:[e]},value:{[n]:[o]}})}return[i,r]}var MM=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function BM(t){if(t){let e=Array.isArray(t)?t:[t],n=[];for(let i of e)i==="http://iiif.io/api/presentation/2/context.json"&&n.push("http://iiif.io/api/presentation/3/context.json"),MM.indexOf(i)===-1&&n.push(i);if(e.length)return n.length===1?n[0]:n}}function FM(t){return t?t.map(e=>({label:Za(e.label),value:Za(e.value)})):[]}var kS=0;function r_(t,e){let n=encodeURI(t.id||t["@id"]||"").trim();return n&&e?`${n}/${e}`:n||(kS++,`http://example.org/${t["@type"]}${e?`/${e}`:""}/${kS}`)}function ms(t){let e=[...t.behavior||[]];t.viewingHint&&e.push(t.viewingHint);let n;return Array.isArray(t.motivation)?n=t.motivation.map(PS):t.motivation&&(n=PS(t.motivation)),{"@context":t["@context"]?BM(t["@context"]):void 0,id:(t["@id"]||r_(t)).trim(),type:kv(t),behavior:e.length?e:void 0,height:t.height?t.height:void 0,width:t.width?t.width:void 0,motivation:n,viewingDirection:t.viewingDirection,profile:t.profile,format:t.format?t.format:void 0,duration:void 0,timeMode:void 0}}function gs(t){let[e,n]=NM(t.license),i=[...t.metadata?FM(t.metadata):[],...n];return{rights:e,metadata:i.length?i:void 0,label:t.label?Za(t.label):void 0,requiredStatement:t.attribution?{label:Za(gy.attributionLabel),value:Za(t.attribution)}:void 0,navDate:t.navDate,summary:t.description?Za(t.description):void 0,thumbnail:UM(t.thumbnail)}}function UM(t){return t&&(Array.isArray(t)?t:[t]).map(e=>typeof e=="string"?{id:e,type:"Image"}:(e.type==="unknown"&&(e.type="Image"),e))}function HM(t){if(!t.within)return;let e=Array.isArray(t.within)?t.within:[t.within],n=[];for(let i of e)if(typeof i=="string"){if(i)switch(t["@type"]){case"sc:Manifest":n.push({id:i,type:"Collection"});break}}else i["@id"]&&n.push({id:i["@id"],type:kv(i)});return n.length?n:void 0}function ga(t){let e=t.related?Array.isArray(t.related)?t.related:[t.related]:[],n=t.contentLayer;return{provider:t.logo||e.length?[{id:gy.providerId,type:"Agent",homepage:e.length?[e[0]]:void 0,logo:t.logo?Array.isArray(t.logo)?t.logo:[t.logo]:void 0,label:Za(gy.providerName)}]:void 0,partOf:HM(t),rendering:t.rendering,seeAlso:t.seeAlso,start:t.startCanvas,service:t.service?as(t.service):void 0,supplementary:n?[n]:void 0}}function zM(t){return{chars:t.chars,format:t.format?t.format:void 0,language:t.language}}function ag(t,e){return t?typeof t=="string"?{id:t,type:e}:typeof(t==null?void 0:t["@id"])=="string"?{id:t["@id"],type:e}:typeof t.id=="string"?{id:t.id,type:e}:null:null}function qM(t){let e={};if(t.first){let n=ag(t.first,"Collection");n&&(e.first=n)}if((t.total||t.total===0)&&(e.total=t.total),t.prev){let n=ag(t.prev,"Collection");n&&(e.prev=n)}if(t.next){let n=ag(t.next,"Collection");n&&(e.next=n)}return e}function VM(t){let e=[];for(let n of t){let i={...n};i.items&&i.items.length===0&&delete i.items,e.push(i)}return e}function GM(t){return Or({...ms(t),...gs(t),...ga(t),...qM(t),items:VM(t.members)})}function jM(t){let e=[],n=[],i,r;for(let a of t.sequences||[])a.canvases.length&&e.push(...a.canvases),a.behavior&&n.push(...a.behavior),a.viewingDirection&&(r=a.viewingDirection),a.startCanvas&&(i=a.startCanvas);let s=ms(t);return n.length&&(s.behavior?s.behavior.push(...n):s.behavior=n),Or({...s,...gs(t),...ga(t),viewingDirection:r,start:i,items:e,structures:WM(t.structures)})}function WM(t){if(!t)return t;let e=new Map;for(let i of t)e.set(i.id,i);let n=[];for(let i of t)if(i.items){let r=i.items.map(s=>typeof s=="string"?(n.push(s),e.get(s)||s):s&&s.id?(n.push(s.id),e.get(s.id)||s):s);i.items=r}return t.filter(i=>n.indexOf(i.id)===-1)}function $M(t){return Or({...ms(t),...gs(t),...ga(t),annotations:t.otherContent&&t.otherContent.length?t.otherContent:void 0,items:t.images&&t.images.length?[{id:r_(t,"annotation-page"),type:"AnnotationPage",items:t.images}]:void 0})}function YM(t){return Or({...ms(t),...gs(t),...ga(t),items:t.resources&&t.resources.length?t.resources:void 0})}function KM(t){return!t.canvases||t.canvases.length===0?{canvases:[],behavior:[]}:{canvases:t.canvases,behavior:t.viewingHint?[t.viewingHint]:[],viewingDirection:t.viewingDirection,startCanvas:t.startCanvas}}function XM(t){function e(n){if(Array.isArray(n)){if(n.length>1)return{type:"List",items:n.map(e)};n=n[0]}if(typeof n=="string")return encodeURI(n).trim();if("@type"in n){let i;if(typeof n.full=="string")i=n.full;else if(n.full["@type"]==="dctypes:Image")i={id:n.full["@id"],type:"Image"};else if(n.full["@type"]==="sc:Canvas")i={id:n.full["@id"],type:"Canvas"};else throw new Error(`Unsupported source type on annotation: ${n.full["@type"]}`);return{type:"SpecificResource",source:i,selector:yy(n.selector)}}else return encodeURI(n["@id"]).trim()}return Or({...ms(t),...gs(t),...ga(t),target:e(t.on),body:Array.isArray(t.resource)?t.resource.map(NS):NS(t.resource)})}function NS(t){return t.type==="Choice"?t:s_(t)}function s_(t){let e=t;return Or({...ms(e),...gs(e),...ga(e),...zM(e)})}function QM(t){let e=[];return t.default&&t.default!=="rdf:nil"&&e.push(t.default),t.item&&t.item!=="rdf:nil"&&e.push(...t.item),Or({...ms(t),...gs(t),items:e})}function ZM(t){return Or({...ms(t),...gs(t),...ga(t),items:t.members})}function JM(t){let{"@id":e,"@type":n,"@context":i,profile:r,...s}=t,a={};return e&&(a["@id"]=e),a["@type"]=kv(t),a["@type"]==="unknown"&&(i&&i.length&&(a["@context"]=i),a["@type"]="Service"),r&&(a.profile=i_(r)),Or({...a,...s})}function e9(t){return Or({...ms(t),...gs(t),...ga(t)})}var t9=new oM({collection:[GM],manifest:[jM],canvas:[$M],annotationList:[YM],sequence:[KM],annotation:[XM],contentResource:[s_],choice:[QM],range:[ZM],service:[JM],layer:[e9]});function n9(t){return t&&t["@context"]&&(t["@context"]==="http://iiif.io/api/presentation/2/context.json"||t["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||t["@context"]==="http://www.shared-canvas.org/ns/context.json")||t["@context"]==="http://iiif.io/api/image/2/context.json"||t["@id"]&&t["@type"]==="sc:Collection"||t["@id"]&&t["@type"]==="sc:Manifest"?(t["@context"]||(t["@context"]="http://iiif.io/api/presentation/2/context.json"),t9.traverseUnknown(t)):t}function yy(t){if((Array.isArray(t["@type"])&&t["@type"].includes("oa:SvgSelector")||t["@type"]=="oa:SvgSelector")&&("chars"in t||"value"in t))return{type:"SvgSelector",value:"chars"in t?t.chars:t.value};if(t["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:t.value};if(t["@type"]==="oa:Choice")return[yy(t.default),...(Array.isArray(t.item)?t.item:[t.item]).map(yy)];if(t["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in t?t.region:void 0,rotation:"rotation"in t?t.rotation:void 0};throw new Error(`Unsupported selector type: ${t["@type"]}`)}function sa(t){return typeof t=="string"?!1:t&&!t.type&&"source"in t?(t.type="SpecificResource",!0):!!t&&t.type==="SpecificResource"}function Ef(...t){return e=>t.reduce((n,i)=>i(n),e)}var MS=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function i9(t,e){if(typeof t>"u"||t===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(t))throw new Error("Array is not a valid entity");if(typeof t!="object"){if(e)return e;throw new Error(`${typeof t} is not a valid entity`)}if(typeof t.type=="string"){let n=MS.indexOf(t.type);if(n!==-1)return MS[n]}if(t.profile)return"Service";throw new Error("Resource type is not known")}var r9=class a_{constructor(e,n={}){ta(this,"traversals"),ta(this,"options"),ta(this,"_traverseManifest",Ef(this.traverseManifestItems.bind(this),this.traverseNavPlace.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this),this.traverseManifestStructures.bind(this),this.traverseInlineAnnotationPages.bind(this))),ta(this,"_traverseCanvas",Ef(this.traverseCanvasItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this),this.traverseInlineAnnotationPages.bind(this))),ta(this,"_traverseAnnotationPage",Ef(this.traverseAnnotationPageItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this))),ta(this,"_traverseRange",Ef(this.traverseRangeRanges.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this))),this.traversals={collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[],specificResource:[],geoJson:[],...e},this.options={allowUndefinedReturn:!1,...n}}static all(e){return new a_({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],geoJson:[e],specificResource:[e],agent:[e]})}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=as(e.thumbnail).map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource))),e.provider&&(e.provider=e.provider.map(n=>this.traverseAgent(n,e))),e}traverseLinking(e){return e.seeAlso&&(e.seeAlso=as(e.seeAlso).map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource))),e.service&&(e.service=as(e.service).map(n=>this.traverseService(n))),e.services&&(e.services=as(e.services).map(n=>this.traverseService(n,e))),e.logo&&(e.logo=as(e.logo).map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource))),e.homepage&&(e.homepage=as(e.homepage).map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource))),e.partOf&&(e.partOf=e.partOf.map(n=>typeof n=="string"||!n.type?this.traverseType(n,{parent:e},this.traversals.contentResource):n.type==="Canvas"?this.traverseType(n,{parent:e},this.traversals.canvas):n.type==="AnnotationCollection"?this.traverseType(n,{parent:e},this.traversals.annotationCollection):n.type==="Collection"?this.traverseType(n,{parent:e},this.traversals.collection):this.traverseType(n,{parent:e},this.traversals.contentResource))),e.start&&(sa(e.start)?e.start=this.traverseSpecificResource(e.start,"Canvas",e):e.start=this.traverseType(e.start,{parent:e},this.traversals.canvas)),e.rendering&&(e.rendering=e.rendering.map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource))),e.supplementary&&(e.supplementary=e.supplementary.map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource))),e}traverseCollectionItems(e){return e.items&&e.items.map(n=>n.type==="Collection"?this.traverseCollection(n):this.traverseManifest(n)),e}traverseCollection(e,n){return this.traverseType(this.traverseDescriptive(this.traverseNavPlace(this.traverseInlineAnnotationPages(this.traverseLinking(this.traverseLinkedCanvases(this.traverseCollectionItems(e)))))),{parent:n},this.traversals.collection)}traverseGeoJson(e,n){return this.traverseType(e,{parent:n},this.traversals.geoJson)}traverseNavPlace(e){return e.navPlace&&(e.navPlace=this.traverseGeoJson(e.navPlace,e)),e}traverseManifestItems(e){return e.items&&(e.items=e.items.map(n=>this.traverseCanvas(n))),e}traverseManifestStructures(e){return e.structures&&(e.structures=e.structures.map(n=>this.traverseRange(n))),e}traverseManifest(e,n){return this.traverseType(this._traverseManifest(e),{parent:n},this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map(n=>this.traverseAnnotationPage(n,e)),e}traverseInlineAnnotationPages(e){return typeof e=="string"||!e||e.annotations&&(e.annotations=e.annotations.map(n=>this.traverseAnnotationPage(n,e))),e}traverseCanvas(e,n){return this.traverseType(this._traverseCanvas(e),{parent:n},this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&(e.items=e.items.map(n=>this.traverseAnnotation(n,e))),e}traverseAnnotationPage(e,n){return this.traverseType(this._traverseAnnotationPage(e),{parent:n},this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map(n=>this.traverseContentResource(n,e)):e.body&&(e.body=this.traverseContentResource(e.body,e)),e}traverseLinkedCanvases(e){return e.placeholderCanvas&&(e.placeholderCanvas=this.traverseCanvas(e.placeholderCanvas)),e.accompanyingCanvas&&(e.accompanyingCanvas=this.traverseCanvas(e.accompanyingCanvas)),e}traverseAnnotation(e,n){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(this.traverseDescriptive(e))),{parent:n},this.traversals.annotation)}traverseContentResourceLinking(e){return typeof e=="string"||!e||e&&e.service&&(e.service=as(e.service||[]).map(n=>this.traverseService(n,e))),e}traverseContentResource(e,n){return e.type==="Choice"&&(e.items=e.items.map(i=>this.traverseContentResource(i,e))),sa(e)?this.traverseSpecificResource(e,"ContentResource"):this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),{parent:n},this.traversals.contentResource)}traverseSpecificResource(e,n,i){let r=e.source;return typeof e.source=="string"&&(r={id:e.source,type:n||"unknown"}),this.traverseType({...e,source:n==="Canvas"||r.type==="Canvas"?this.traverseType(r,{parent:i},this.traversals.canvas):n==="ContentResource"?this.traverseContentResource(r,{parent:i}):this.traverseUnknown(r,{parent:i,typeHint:n})},{parent:i},this.traversals.specificResource)}traverseRangeRanges(e){return e.items&&(e.items=e.items.map(n=>typeof n=="string"?this.traverseCanvas({id:n,type:"Canvas"},e):sa(n)?this.traverseSpecificResource(n,"Canvas",e):n.type==="Manifest"?this.traverseManifest(n,e):this.traverseRange(n,e))),e}traverseRange(e,n){return this.traverseType(this._traverseRange(e),{parent:n},this.traversals.range)}traverseAgent(e,n){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),{parent:n},this.traversals.agent)}traverseType(e,n,i){return i.reduce((r,s)=>{let a=s(r,n);return typeof a>"u"&&!this.options.allowUndefinedReturn?r:a},e)}traverseService(e,n){let i=Object.assign({},e);return i&&i.service&&(i.service=as(i.service).map(r=>this.traverseService(r))),this.traverseType(i,{parent:n},this.traversals.service)}traverseUnknown(e,{parent:n,typeHint:i}={}){let r=i9(e,i);switch(r){case"Collection":return this.traverseCollection(e,n);case"Manifest":return this.traverseManifest(e,n);case"Canvas":return this.traverseCanvas(e,n);case"AnnotationPage":return this.traverseAnnotationPage(e,n);case"Annotation":return this.traverseAnnotation(e,n);case"ContentResource":return this.traverseContentResource(e,n);case"Range":return this.traverseRange(e,n);case"Service":return this.traverseService(e,n);case"Agent":return this.traverseAgent(e,n);default:throw new Error(`Unknown or unsupported resource type of ${r}`)}}};function o_(t,e){let n="unknown";if(!t)return;if(typeof t=="string")return{id:t,type:n};if(sa(t))return o_(t.source);let i=t.type||t["@type"],r=t.id||t["@id"];if(i&&i.indexOf(":")!==-1&&(i=i.split(":").pop()),r&&i)return{id:r,type:i}}var mc={},An="iiif-parser:hasPart",cs="iiif-parser:partOf",gc="iiif-parser:isExternal",sr="__$UNSET$__",u_="__$UNWRAP$__",nt=[];Object.freeze(nt);Object.freeze(mc);function s9(t){if(t===mc||Object.keys(t).length===0)return!0;for(let e in t)return!1;return!0}function Nv(t,e){if(e&&e["@explicit"]){let n={},i=Object.keys(e);for(let r of i)r===cs||r==="@explicit"||(s9(e[r])?n[r]=t[r]:n[r]=e[r]);return n}return t}function l_(t,e,n){let i=o_(e);if(!i)return[void 0,void 0];let r=t.requests[i.id],s=i.type||t.mapping[i.id];if(!s||r&&r.resourceUri&&(!t.entities[s]||!t.entities[s][r.resourceUri]))return[void 0,void 0];let a=t.entities[s][r?r.resourceUri:i.id];if(i.type&&!a)return l_(t,{id:i.id},n);if(a&&a[An]){let o=a[An].find(l=>n?l[cs]===n.id:l[cs]===a.id);return[Nv(a,o),a]}return[a,a]}var a9={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:nt,label:null,thumbnail:nt,summary:null,requiredStatement:null,metadata:nt,rights:null,provider:nt,items:nt,seeAlso:nt,homepage:nt,rendering:nt,service:nt},o9={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:nt,thumbnail:nt,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:nt,rights:null,navDate:null,provider:nt,items:nt,annotations:nt,seeAlso:nt,homepage:nt,partOf:nt,rendering:nt,service:nt,duration:0,height:0,width:0},u9={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:nt,thumbnail:nt,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:nt,rights:null,navDate:null,provider:nt,items:nt,annotations:nt,seeAlso:nt,homepage:nt,partOf:nt,rendering:nt,service:nt,services:nt},l9={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:nt,behavior:nt,homepage:nt,items:nt,label:null,metadata:nt,navDate:null,provider:nt,partOf:nt,accompanyingCanvas:null,placeholderCanvas:null,rendering:nt,requiredStatement:null,rights:null,seeAlso:nt,service:nt,services:nt,start:null,structures:nt,summary:null,thumbnail:nt,viewingDirection:"left-to-right"},c9={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:nt,thumbnail:nt,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:nt,rights:null,navDate:null,provider:nt,items:nt,annotations:nt,seeAlso:nt,homepage:nt,partOf:nt,rendering:nt,service:nt,start:null,supplementary:null,viewingDirection:"left-to-right"},d9={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:nt,seeAlso:nt,homepage:nt},f9={id:"https://iiif-parser/empty-service",type:"UnknownService"};function vy(t,e={}){if(Array.isArray(t))return vy(t[0]);if(typeof t=="string"){let[n,i]=t.split("#");return i?{type:"SpecificResource",source:{id:n,type:e.typeHint||"Unknown"},selector:{type:"FragmentSelector",value:i}}:{type:"SpecificResource",source:{id:n,type:e.typeMap&&e.typeMap[n]||e.typeHint||"Unknown"}}}if(t.type==="Choice"||t.type==="List"||t.type==="Composite"||t.type==="Independents")return vy(t.items[0]);if(!t.type&&"source"in t&&(t.type="SpecificResource"),t.type==="SpecificResource")return t.source.type==="Canvas"&&t.source.partOf&&typeof t.source.partOf=="string"&&(t.source.partOf=[{id:t.source.partOf,type:"Manifest"}]),t.selector?{type:"SpecificResource",source:t.source,selector:t.selector}:{type:"SpecificResource",source:t.source};if(t.id){t.type==="Canvas"&&t.partOf&&typeof t.partOf=="string"&&(t.partOf=[{id:t.partOf,type:"Manifest"}]);let[n,i]=t.id.split("#");return i?{type:"SpecificResource",source:{...t,id:n},selector:{type:"FragmentSelector",value:i}}:{type:"SpecificResource",source:{...t,id:n}}}return{type:"SpecificResource",source:t}}function h9(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function c_(t,e){if(typeof t=="string")return{id:t,type:e};if(!t.id)throw new Error(`Invalid resource does not have an ID (${JSON.stringify(t)}, ${e})`);return t}function p9(t,e){return(n,i)=>{let r=t[n]?t[n]:{};return(s,a)=>{let o=c_(s,i||n);return o&&o.id&&n?(r[o.id]=r[o.id]?Ey(r[o.id],o,{parent:a.parent,isTopLevel:e.id===o.id}):Ey({id:o.id,type:o.type},o,{parent:a.parent,isTopLevel:e.id===o.id}),{id:o.id,type:n==="ContentResource"?n:o.type}):o}}}function by(t,e,n){if(!e)return t;if(Array.isArray(t)){if(!Array.isArray(e))throw new Error("Cannot merge array with non-array");let i=[...t];for(let r of e)if(r["@id"]&&!r.id&&(r.id=r["@id"]),r["@type"]&&!r.type&&(r.type=r["@type"]),r!=null)if(Array.isArray(r))i.push(r);else if(typeof r=="object"&&r.id&&r.type){let s=i.findIndex(a=>a.id===r.id&&a.type===r.type);s>=0&&(i[s]=by(i[s],r))}else t.indexOf(r)===-1&&i.push(r);return i}else if(typeof t=="object"){if(Array.isArray(e)||typeof e!="object")throw new Error("Cannot merge object with non-object");let i={...t},r=[],s=[],a=Object.keys(t).filter(u=>u!==An&&u!=="id"&&u!=="type"),o={},l={};for(let[u,d]of Object.entries(e)){if(u===An||u==="id"||u==="type")continue;let f=i[u];f===d?s.push(u):f===nt||!f?(r.push(u),i[u]=d):(f&&d&&(o[u]=f,l[u]=d),i[u]=by(f,d),i[u]===o[u]&&(s.push(u),delete o[u]))}if(n&&(n.parent&&n.parent.id||n.isTopLevel)){let u=[],d={};if(n.parent?d[cs]=n.parent.id:n.isTopLevel&&(d[cs]=t.id),i[An]&&i[An].length){let f=!(i[An]||[]).find(m=>m["@explicit"]),p=r.length>0||s.length!==a.length;if(f&&p)for(let m of i[An]){let y={...m},b=Object.keys(o);if(y){y["@explicit"]=!0;for(let E of a)E!==An&&(y[E]=mc);for(let E of b)y[E]=o[E]}u.push(y)}else u.push(...i[An]);if(p){let m=Object.keys(l);d["@explicit"]=!0;for(let y of r)d[y]=mc;for(let y of s)d[y]=mc;for(let y of m)d[y]=l[y]}}d.id=i.id,d.type=i.type,u.push(d),i[An]=u}return i}else if(t)return t;return e}function Ey(t,e,n){if(typeof t=="string")return t;if(e.id!==t.id||e.type!==t.type){if(e.type==="ImageService3")return e;if(t.type==="ImageService3")return t;throw new Error(`Can only merge entities with identical identifiers and type! ${e.type}(${e.id}) => ${t.type}(${t.id})`)}return by({...t},e,n)}function m9(t){return(e,n)=>i=>{let{id:r,type:s}=c_(i,n||e);if(typeof r>"u")throw new Error("Found invalid entity without an ID.");return e==="ContentResource"||e==="Service"?t[r]=e:t[r]=s,i}}function g9(t){let e=Object.assign({},t);if(e["@id"]&&(e.id=e["@id"]),e["@type"]&&(e.type=e["@type"]),e.service){let n=[];e.service=Array.isArray(e.service)?e.service:[e.service];for(let i of e.service)n.push({id:i["@id"]||i.id,type:i["@type"]||i.type});e.service=n}return Object.assign({},f9,e)}function y9(t){return e=>{t.Service=t.Service?t.Service:{};let n=e.id||e["@id"],i=g9(e);return i&&i.id&&(t.Service[i.id]?t.Service[n]=Ey(t.Service[n],i):t.Service[n]=i),e}}function v9(t){let e=JSON.stringify(t),n=5381,i=e.length;for(;i;)n=n*33^e.charCodeAt(--i);let r=(n>>>0).toString(16);return r.length%2?"0"+r:r}function og(t){return e=>typeof e=="string"?{id:e,type:t}:e.id?e.type?e:{type:t,...e}:{id:`vault://${v9(e)}`,type:t,...e}}function du(t){return e=>({...t,...e})}function Jl(t){return Array.isArray(t)?t:[t]}function b9(t){return t.body&&(t.body=Jl(t.body)),t.seeAlso&&(t.seeAlso=Jl(t.seeAlso)),t.audience&&(t.audience=Jl(t.audience)),t.accessibility&&(t.accessibility=Jl(t.accessibility)),t.motivation&&(t.motivation=Jl(t.motivation)),t}function d_(t,{typeHint:e,partOfTypeHint:n}={}){if(typeof t=="string"&&(t={id:t,type:e||"unknown"}),sa(t))return typeof t.source=="string"&&(t.source={id:t.source,type:e||"unknown"}),t.source.type==="Canvas"&&t.source.partOf&&typeof t.source.partOf=="string"&&(t.source.partOf=[{id:t.source.partOf,type:n||"Manifest"}]),t;let i;if((t.id||"").indexOf("#")!==-1){let[r,s]=(t.id||"").split("#");t.id=r,s&&(i={type:"FragmentSelector",value:s})}return{type:"SpecificResource",source:t,selector:i}}function E9(t){let e=Object.assign({},t);return t&&t.items&&(e.items=t.items.map(n=>typeof n=="string"||n.type==="Canvas"?d_(n):n)),e}function T9(t){let e=Object.assign({},t);return e.start?(e.start=d_(e.start,{typeHint:"Canvas"}),e):t}function x9(t){let e=Object.assign({},t);return e.target?(e.target=vy(e.target,{typeHint:"Canvas"}),e):t}function S9(t){return t}function ug(t){return typeof t.items>"u"&&(t[gc]=!0),t}function A9(t){let e=n9(t),n=h9(),i={},r=p9(n,e),s=m9(i),a=new r9({collection:[ug,du(u9),s("Collection"),r("Collection")],manifest:[ug,du(l9),T9,s("Manifest"),r("Manifest")],canvas:[du(o9),s("Canvas"),r("Canvas")],annotationPage:[ug,og("AnnotationPage"),du(a9),s("AnnotationPage"),r("AnnotationPage")],annotation:[og("Annotation"),b9,x9,s("Annotation"),r("Annotation")],contentResource:[og("ContentResource"),s("ContentResource"),r("ContentResource")],range:[du(c9),E9,s("Range","Canvas"),r("Range","Canvas")],agent:[du(d9),s("Agent"),r("Agent")],specificResource:[S9],service:[y9(n)]}).traverseUnknown(e);return{entities:n,resource:a,mapping:i}}function w9(t){let e={};for(let[n,i]of t){if(n===u_&&i!==sr)return i;i!==sr&&typeof i<"u"&&i!==null&&(e[n]=i)}return e}function C9(t,e,n){if(!e.type||!e.id)throw new Error("Unknown entity");if(!n[e.type])throw new Error(`Serializer not found for ${e.type}`);function i(r,s,a=0){let o=n[r.type];if(!o)return sr;if(a>20)throw new Error("Circular reference: "+r.id+" "+r.type);let[l,u]=l_(t,r.type?r:r.id,s)||(r.id&&r.type?r:null);if(!l)return sr;let d=o(l,t,{parent:s,isTopLevel:e.id===r.id,fullResource:u}),f=d.next();for(;!f.done;){let p=f.value,m=sr;if(p)if(Array.isArray(p)){let y=[];for(let b of p)y.push(i(b,r,a+1));m=y}else m=i(p,r,a+1);f=d.next(m)}return f.value===sr?sr:w9(f.value)}return i(e)}function yc(t,{allowSourceString:e=!0,allowString:n=!1,allowedStringType:i}={}){let r=s=>{if(e&&s&&s.source&&typeof s.source!="string"){let a=Object.keys(s.source);if(s.source.id&&s.source.type&&a.length===2)return{...s,source:s.source.id}}return s};if(t){if(t.source&&t.source.partOf)return r(t);let s=Object.keys(t);if(s.length===2&&t.type&&t.source||s.length===3&&t.type&&t.source&&s.indexOf("selector")!==-1&&!t.selector)return n&&(!i||i===t.source.type)?t.source.id:t.source.type==="ContentResource"?{type:"SpecificResource",source:t.source.id}:t.source;if(t.selector&&!Array.isArray(t.selector)&&typeof t.selector!="string"&&t.selector.type==="FragmentSelector"){let a=`${t.source.id}#${t.selector.value}`;return n?a:{id:a,type:t.source.type}}}return r(t)}function Su(t){if(!t)return;let e=Object.keys(t);if(e.length!==0){if(e.length===1){let n=e[0];if(!n)return"";let i=(t[n]||[]).join("");return n==="@none"||n==="none"||n==="en"?i:{"@language":n,"@value":i}}return e.map(n=>({"@language":n,"@value":(t[n]||[]).join("")}))}}function f_(t){return Array.isArray(t)?t.map(e=>f_(e)):typeof t=="string"?t:t.type&&t.type==="Canvas"?t.id:t}function aa(t,e=!1){if(t)return t.length>1&&!e?t:t[0]||void 0}function R9(t){if(t){if(typeof t=="string")return{"@id":t};if("@id"in t){let e={...t};return delete e["@type"],e}return{"@context":"http://iiif.io/api/image/2/context.json","@id":t.id,profile:`http://iiif.io/api/image/2/profiles/${t.profile}.json`}}}function Fa(t,e){return[["@id",t.id],["@type",e],["format",t.format],["height",t.height],["width",t.width],["viewingDirection",t.viewingDirection!=="left-to-right"?t.viewingDirection:void 0],["license",t.license?t.license:void 0]]}function*Ua(t){let e=t.provider?yield t.provider[0]:void 0;return[["label",Su(t.label)],["metadata",t.metadata&&t.metadata.length?t.metadata.map(n=>({label:Su(n.label)||"",value:Su(n.value)||""})):void 0],["description",Su(t.summary)],["thumbnail",aa(yield t.thumbnail)],["navDate",t.navDate],["logo",e?aa(e.logo):void 0],["homepage",e?e.homepage:void 0],["attribution",t.requiredStatement?Su(t.requiredStatement.value):void 0]]}function*ec(t){let e=t.start&&t.start.type&&t.start.type==="SpecificResource"?yc(t.start):t.start;return[["seeAlso",aa(yield t.seeAlso)],["service",aa((t.service||[]).map(R9))],["rendering",aa(yield t.rendering)],["startCanvas",e?e.id:void 0]]}function _9(t){return t.type==="SpecificResource"}function I9(t){return t&&t.type==="FragmentSelector"}function L9(t){if(t&&_9(t)){let e=t.id,n=t.selector?Array.isArray(t.selector)?t.selector[0]:t.selector:void 0;return I9(n)&&(e+="#"+n.value),e}return t==null?void 0:t.id}var D9={Manifest:function*(t,e,{isTopLevel:n}){return[...n?[["@context","http://iiif.io/api/presentation/2/context.json"]]:[],...Fa(t,"sc:Manifest"),...yield*Ua(t),...yield*ec(t),["sequences",[{"@id":`${t.id}/sequence0`,"@type":"sc:Sequence",canvases:yield t.items}]],["structures",yield t.structures]]},Canvas:function*(t){let e=(yield t.items)[0];return[...Fa(t,"sc:Canvas"),...yield*Ua(t),...yield*ec(t),["images",e?[e.resources]:void 0],["annotations",t.annotations&&t.annotations.length?aa(yield t.annotations):void 0]]},AnnotationPage:function*(t){return[...Fa(t,"sc:AnnotationList"),...yield*Ua(t),["resources",t.items&&t.items.length?aa(yield t.items):void 0]]},Annotation:function*(t){return[["@id",t.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",f_(t.target)],["resource",aa(yield t.body,!0)]]},ContentResource:function*(t){switch(t.type){case"Image":return[...Fa(t,"dctypes:Image"),...yield*Ua(t),...yield*ec(t)];case"Text":case"Dataset":default:return[...Fa(t,void 0),...yield*Ua(t)]}},AnnotationCollection:function*(t){return[["@id",t.id],["@type","sc:Layer"],["label",Su(t.label)]]},Collection:function*(t){return[...Fa(t,"sc:Collection"),...yield*Ua(t),...yield*ec(t),["members",yield*t.items]]},Range:function*(t){let e=[],n=[];if(t.items)for(let i of t.items){let r=i.type==="SpecificResource"?i.source:i;if(r){let s=yield r;e.push({"@id":L9(i),"@type":r.type,label:s?s.label:void 0,within:t.id}),r.type==="Canvas"&&n.push(r.id)}}return[...Fa(t,"sc:Range"),...yield*Ua(t),...yield*ec(t),["canvases",n.length===e.length?n:void 0],["members",n.length!==e.length?e:void 0]]}};function Ha(t){var e;return[["id",(e=t.id)!=null&&e.startsWith("vault://")?void 0:t.id],["type",t.type],["format",t.format],["profile",t.profile],["height",t.height||void 0],["width",t.width||void 0],["duration",t.duration||void 0],["viewingDirection",t.viewingDirection!=="left-to-right"?t.viewingDirection:void 0],["behavior",t.behavior&&t.behavior.length?t.behavior:void 0],["timeMode",t.timeMode],["motivation",Array.isArray(t.motivation)?t.motivation[0]:t.motivation],[An,sr]]}function vn(t){if(t===sr||!t||t.length===0)return;let e=t.filter(n=>n!==sr);if(e.length!==0)return e}function h_(t){if(t&&t.type&&t.type==="ImageService2"){let{id:e,type:n,profile:i,...r}=t,s=typeof i=="string"?i:Array.isArray(i)?i.find(a=>typeof a=="string"):"";return{"@id":e,"@type":n,profile:s?s.startsWith("http")?s:`http://iiif.io/api/image/2/${s}.json`:"http://iiif.io/api/image/2/level0.json",...r}}return t}function BS(t){if(Array.isArray(t)||(t=t?[t]:[]),!(!t||t.length===0))return t.map(h_)}function*Ws(t){return[["label",t.label],["metadata",vn(t.metadata)],["summary",t.summary],["requiredStatement",t.requiredStatement],["rights",Array.isArray(t.rights)?t.rights[0]||void 0:t.rights||void 0],["navDate",t.navDate],["language",t.language],["thumbnail",vn(yield t.thumbnail)],["placeholderCanvas",yield t.placeholderCanvas],["accompanyingCanvas",yield t.accompanyingCanvas],["provider",vn(yield t.provider)]]}function*$s(t,e){let n=[];for(let i of t.partOf||[])i.type==="Manifest"&&e.type==="Manifest"||n.push(yield i);return[["seeAlso",vn(yield t.seeAlso)],["service",vn(BS(t.service))],["services",vn(BS(t.services))],["rendering",vn(yield t.rendering)],["supplementary",vn(yield t.supplementary)],["homepage",vn(yield t.homepage)],["logo",vn(yield t.logo)],["partOf",vn(n)],["start",t.start?yc(t.start):t.start]]}var O9={Manifest:function*(t,e,{isTopLevel:n}){if(!n)return[...Ha(t),...yield*Ws(t),["navPlace",t.navPlace]];let i="http://iiif.io/api/presentation/3/context.json";return(t.navPlace||FS(t))&&(i=["http://iiif.io/api/presentation/3/context.json","http://iiif.io/api/extension/navplace/context.json"]),[["@context",t["@context"]?t["@context"]:i],...Ha(t),...yield*Ws(t),...yield*$s(t),["items",yield t.items],["structures",vn(yield t.structures)],["annotations",vn(yield t.annotations)],["navPlace",t.navPlace]]},Canvas:function*(t,e,{parent:n}){return n&&n.type!=="Manifest"&&n.type!=="Canvas"?[["id",t.id]]:[...Ha(t),...yield*Ws(t),...yield*$s(t,n),["items",yield t.items],["annotations",vn(yield t.annotations)],["navPlace",t.navPlace]]},Agent:function*(t){return[["id",t.id],["type","Agent"],["label",t.label],...yield*$s(t)]},AnnotationPage:function*(t){var i;let e=Object.entries(t).map(([r,s])=>[r,Array.isArray(s)?vn(s):s]).filter(([r,s])=>r!=="items"&&r!=="id"&&r!==An&&r!==cs&&r!==gc),n=yield t.items;return[["id",(i=t.id)!=null&&i.startsWith("vault://")?void 0:t.id],...e,...yield*$s(t),["items",n.length||t[gc]===!1?n:sr]]},Service:function*(t){return[[u_,h_(t)]]},Annotation:function*(t){let e=Object.entries(t).map(([i,r])=>i==="motivation"?[i,Array.isArray(r)?r[0]:r]:i==="target"?[i,yc(r,{allowString:!0,allowSourceString:!0,allowedStringType:"Canvas"})]:[i,Array.isArray(r)?vn(r):r]).filter(([i])=>i!=="body"&&i!==An&&i!==gc),n;if(Array.isArray(t.body)){let i=[];for(let r of t.body)if(r&&sa(r)){let s={...r};r.source.type!=="Canvas"?s.source=yield r.source:s.source=r.source,i.push(yc(s,{allowSourceString:!0}))}else i.push(yield r);n=i}else t.body&&sa(t.body)?(n={...t.body},n.source=yield t.body.source):n=yield t.body;return[...e,...yield*Ws(t),...yield*$s(t),["body",n.length===1?n[0]:n]]},ContentResource:function*(t){return P9([...Ha(t),...yield*Ws(t),...yield*$s(t),["annotations",vn(yield t.annotations)],["items",vn(yield t.items)]],t)},AnnotationCollection:function*(t){return[["id",t.id],["type","AnnotationCollection"],["label",t.label]]},Collection:function*(t,e,{isTopLevel:n}){if(n){let i="http://iiif.io/api/presentation/3/context.json";return(t.navPlace||FS(t))&&(i=["http://iiif.io/api/extension/navplace/context.json","http://iiif.io/api/presentation/3/context.json"]),[["@context",i],...Ha(t),...yield*Ws(t),...yield*$s(t),["items",vn(yield t.items)],["navPlace",t.navPlace]]}return[...Ha(t),...yield*Ws(t),["navPlace",t.navPlace]]},Range:function*(t){let e=[];for(let n of t.items)n.type==="Range"?e.push(yield n):n&&n.type==="SpecificResource"?e.push(yc(n)):e.push(n);return[...Ha(t),...yield*Ws(t),...yield*$s(t),["items",e],["annotations",vn(yield t.annotations)],["navPlace",t.navPlace]]}};function P9(t,e){let n=Object.keys(e),i=t.map(([r])=>r);for(let r of n)r===An||r===gc||i.indexOf(r)===-1&&typeof e[r]<"u"&&t.push([r,e[r]]);return t}function FS(t){if(!t.items||!Array.isArray(t.items))return!1;for(let e of t.items)if(e.navPlace)return!0;return!1}let Tf;const k9=new Uint8Array(16);function N9(){if(!Tf&&(Tf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Tf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Tf(k9)}const Bn=[];for(let t=0;t<256;++t)Bn.push((t+256).toString(16).slice(1));function M9(t,e=0){return Bn[t[e+0]]+Bn[t[e+1]]+Bn[t[e+2]]+Bn[t[e+3]]+"-"+Bn[t[e+4]]+Bn[t[e+5]]+"-"+Bn[t[e+6]]+Bn[t[e+7]]+"-"+Bn[t[e+8]]+Bn[t[e+9]]+"-"+Bn[t[e+10]]+Bn[t[e+11]]+Bn[t[e+12]]+Bn[t[e+13]]+Bn[t[e+14]]+Bn[t[e+15]]}const B9=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),US={randomUUID:B9};function Dc(t,e,n){if(US.randomUUID&&!t)return US.randomUUID();t=t||{};const i=t.random||(t.rng||N9)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,M9(i)}var xf={},Mv={get(t){return t},setMetaValue([t,e,n],i){const r=Mv.getResourceMeta(t,e),s=r?r[n]:void 0,a=typeof i=="function"?i(s):i;xf[t]={...xf[t]||{},[e]:{...(xf[t]||{})[e]||{},[n]:a}}},getResourceMeta:(t,e)=>{const n=xf[t];if(n)return e?n[e]:n},async load(t){const e=typeof t=="string"?t:t.id;return fetch(e).then(n=>n.json())},requestStatus(t){}};function p_(t,e){var i;const n=[];for(const r of e.items)if(r.type==="SpecificResource"&&((i=r.source)==null?void 0:i.type)==="Canvas"&&(r.source.id.indexOf("#")!==-1?n.push({id:r.source.id.split("#")[0],type:"Canvas"}):n.push(r.source)),r.type==="Range"&&n.push(...p_(t,t.get(r))),r.type==="SpecificResource"){const s=typeof r.source=="string"?r.source:r.source.id;n.push({id:s,type:"Canvas"})}return n}function F9(t=Mv,e,n,i=!1){const r=e.behavior||[],s=n?t.get(n):null;if(!s)return[];const a=s.behavior||[],o=i?!1:r.includes("paged"),l=o?!1:r.includes("continuous"),u=o||l?!1:r.includes("individuals"),d=a.includes("facing-pages"),f=a.includes("non-paged");if(d||f||u||i)return[{id:s.id,type:"Canvas"}];const[p,m]=m_(t,e);if(l)return p;const y=p.findIndex(b=>b.id===n);if(y===-1)return[];for(const b of m)if(b.includes(y))return b.map(E=>p[E]);return[{id:s.id,type:"Canvas"}]}function m_(t=Mv,e,{disablePaging:n,skipNonPaged:i}={}){const r=e.behavior||[],s=r.includes("paged"),a=s?!1:r.includes("continuous"),o=s||a?!1:r.includes("individuals"),l=e.type==="Manifest"?e.items:p_(t,e);if(a)return[l,[l.map((y,b)=>b)]];if(o||!s||n)return[l,l.map((y,b)=>[b])];const u=[];let d=[];const f=()=>{d.length&&(u.push([...d]),d=[])};let p=0,m=!1;for(let y=0;y<l.length;y++){const E=t.get(l[y]).behavior||[];if(E.includes("non-paged")){y===p&&p++,i||(f(),u.push([y]),f());continue}if(y===p||E.includes("facing-pages")){d.length&&(m=!0),f(),u.push([y]),f();continue}if(d.push(y),m){f(),m=!1;continue}d.length>1&&f()}return d.length&&f(),[l,u]}function U9(t){const e=encodeURIComponent(t);return(typeof btoa>"u"?Buffer.from(e,"utf-8").toString("base64"):btoa(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function H9(t){const n=z9(t).replace(/-/g,"+").replace(/_/g,"/"),i=typeof atob>"u"?Buffer.from(n,"base64").toString("utf-8"):atob(n);return decodeURIComponent(i).trim()}function z9(t){const e=t.length%4;if(e===1)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");return t+(e?"====".slice(0,4-e):"")}function xt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function Pr(t,e=[]){let n=[];function i(s,a){const o=H.createContext(a),l=n.length;n=[...n,a];const u=f=>{var T;const{scope:p,children:m,...y}=f,b=((T=p==null?void 0:p[t])==null?void 0:T[l])||o,E=H.useMemo(()=>y,Object.values(y));return Ce.jsx(b.Provider,{value:E,children:m})};u.displayName=s+"Provider";function d(f,p){var b;const m=((b=p==null?void 0:p[t])==null?void 0:b[l])||o,y=H.useContext(m);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${s}\``)}return[u,d]}const r=()=>{const s=n.map(a=>H.createContext(a));return function(o){const l=(o==null?void 0:o[t])||s;return H.useMemo(()=>({[`__scope${t}`]:{...o,[t]:l}}),[o,l])}};return r.scopeName=t,[i,q9(r,...e)]}function q9(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const i=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const a=i.reduce((o,{useScope:l,scopeName:u})=>{const f=l(s)[`__scope${u}`];return{...o,...f}},{});return H.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}var Hn=globalThis!=null&&globalThis.document?H.useLayoutEffect:()=>{},V9=Pv[" useInsertionEffect ".trim().toString()]||Hn;function oa({prop:t,defaultProp:e,onChange:n=()=>{},caller:i}){const[r,s,a]=G9({defaultProp:e,onChange:n}),o=t!==void 0,l=o?t:r;{const d=H.useRef(t!==void 0);H.useEffect(()=>{const f=d.current;f!==o&&console.warn(`${i} is changing from ${f?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=o},[o,i])}const u=H.useCallback(d=>{var f;if(o){const p=j9(d)?d(t):d;p!==t&&((f=a.current)==null||f.call(a,p))}else s(d)},[o,t,s,a]);return[l,u]}function G9({defaultProp:t,onChange:e}){const[n,i]=H.useState(t),r=H.useRef(n),s=H.useRef(e);return V9(()=>{s.current=e},[e]),H.useEffect(()=>{var a;r.current!==n&&((a=s.current)==null||a.call(s,n),r.current=n)},[n,r]),[n,i,s]}function j9(t){return typeof t=="function"}function HS(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function g_(...t){return e=>{let n=!1;const i=t.map(r=>{const s=HS(r,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():HS(t[r],null)}}}}function Yt(...t){return H.useCallback(g_(...t),t)}var $c=BR();const W9=Wc($c);function Oc(t){const e=$9(t),n=H.forwardRef((i,r)=>{const{children:s,...a}=i,o=H.Children.toArray(s),l=o.find(K9);if(l){const u=l.props.children,d=o.map(f=>f===l?H.Children.count(u)>1?H.Children.only(null):H.isValidElement(u)?u.props.children:null:f);return Ce.jsx(e,{...a,ref:r,children:H.isValidElement(u)?H.cloneElement(u,void 0,d):null})}return Ce.jsx(e,{...a,ref:r,children:s})});return n.displayName=`${t}.Slot`,n}function $9(t){const e=H.forwardRef((n,i)=>{const{children:r,...s}=n;if(H.isValidElement(r)){const a=Q9(r),o=X9(s,r.props);return r.type!==H.Fragment&&(o.ref=i?g_(i,a):a),H.cloneElement(r,o)}return H.Children.count(r)>1?H.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Y9=Symbol("radix.slottable");function K9(t){return H.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Y9}function X9(t,e){const n={...e};for(const i in e){const r=t[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...o)=>{const l=s(...o);return r(...o),l}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...t,...n}}function Q9(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Z9=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ct=Z9.reduce((t,e)=>{const n=Oc(`Primitive.${e}`),i=H.forwardRef((r,s)=>{const{asChild:a,...o}=r,l=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Ce.jsx(l,{...o,ref:s})});return i.displayName=`Primitive.${e}`,{...t,[e]:i}},{});function J9(t,e){t&&$c.flushSync(()=>t.dispatchEvent(e))}function eB(t,e){return H.useReducer((n,i)=>e[n][i]??n,t)}var Yc=t=>{const{present:e,children:n}=t,i=tB(e),r=typeof n=="function"?n({present:i.isPresent}):H.Children.only(n),s=Yt(i.ref,nB(r));return typeof n=="function"||i.isPresent?H.cloneElement(r,{ref:s}):null};Yc.displayName="Presence";function tB(t){const[e,n]=H.useState(),i=H.useRef(null),r=H.useRef(t),s=H.useRef("none"),a=t?"mounted":"unmounted",[o,l]=eB(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return H.useEffect(()=>{const u=Sf(i.current);s.current=o==="mounted"?u:"none"},[o]),Hn(()=>{const u=i.current,d=r.current;if(d!==t){const p=s.current,m=Sf(u);t?l("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(d&&p!==m?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),Hn(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,f=m=>{const b=Sf(i.current).includes(CSS.escape(m.animationName));if(m.target===e&&b&&(l("ANIMATION_END"),!r.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},p=m=>{m.target===e&&(s.current=Sf(i.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:H.useCallback(u=>{i.current=u?getComputedStyle(u):null,n(u)},[])}}function Sf(t){return(t==null?void 0:t.animationName)||"none"}function nB(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var iB=Pv[" useId ".trim().toString()]||(()=>{}),rB=0;function po(t){const[e,n]=H.useState(iB());return Hn(()=>{n(i=>i??String(rB++))},[t]),t||(e?`radix-${e}`:"")}var t0="Collapsible",[sB]=Pr(t0),[aB,Bv]=sB(t0),y_=H.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:i,defaultOpen:r,disabled:s,onOpenChange:a,...o}=t,[l,u]=oa({prop:i,defaultProp:r??!1,onChange:a,caller:t0});return Ce.jsx(aB,{scope:n,disabled:s,contentId:po(),open:l,onOpenToggle:H.useCallback(()=>u(d=>!d),[u]),children:Ce.jsx(Ct.div,{"data-state":Uv(l),"data-disabled":s?"":void 0,...o,ref:e})})});y_.displayName=t0;var v_="CollapsibleTrigger",oB=H.forwardRef((t,e)=>{const{__scopeCollapsible:n,...i}=t,r=Bv(v_,n);return Ce.jsx(Ct.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":Uv(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...i,ref:e,onClick:xt(t.onClick,r.onOpenToggle)})});oB.displayName=v_;var Fv="CollapsibleContent",uB=H.forwardRef((t,e)=>{const{forceMount:n,...i}=t,r=Bv(Fv,t.__scopeCollapsible);return Ce.jsx(Yc,{present:n||r.open,children:({present:s})=>Ce.jsx(lB,{...i,ref:e,present:s})})});uB.displayName=Fv;var lB=H.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:i,children:r,...s}=t,a=Bv(Fv,n),[o,l]=H.useState(i),u=H.useRef(null),d=Yt(e,u),f=H.useRef(0),p=f.current,m=H.useRef(0),y=m.current,b=a.open||o,E=H.useRef(b),T=H.useRef(void 0);return H.useEffect(()=>{const x=requestAnimationFrame(()=>E.current=!1);return()=>cancelAnimationFrame(x)},[]),Hn(()=>{const x=u.current;if(x){T.current=T.current||{transitionDuration:x.style.transitionDuration,animationName:x.style.animationName},x.style.transitionDuration="0s",x.style.animationName="none";const S=x.getBoundingClientRect();f.current=S.height,m.current=S.width,E.current||(x.style.transitionDuration=T.current.transitionDuration,x.style.animationName=T.current.animationName),l(i)}},[a.open,i]),Ce.jsx(Ct.div,{"data-state":Uv(a.open),"data-disabled":a.disabled?"":void 0,id:a.contentId,hidden:!b,...s,ref:d,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...t.style},children:b&&r})});function Uv(t){return t?"open":"closed"}var cB=y_;const dB=H.createContext(null),lg={didCatch:!1,error:null};class Hv extends H.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=lg}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var n,i,r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];(n=(i=this.props).onReset)===null||n===void 0||n.call(i,{args:s,reason:"imperative-api"}),this.setState(lg)}}componentDidCatch(e,n){var i,r;(i=(r=this.props).onError)===null||i===void 0||i.call(r,e,n)}componentDidUpdate(e,n){const{didCatch:i}=this.state,{resetKeys:r}=this.props;if(i&&n.error!==null&&fB(e.resetKeys,r)){var s,a;(s=(a=this.props).onReset)===null||s===void 0||s.call(a,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(lg)}}render(){const{children:e,fallbackRender:n,FallbackComponent:i,fallback:r}=this.props,{didCatch:s,error:a}=this.state;let o=e;if(s){const l={error:a,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")o=n(l);else if(i)o=H.createElement(i,l);else if(r!==void 0)o=r;else throw a}return H.createElement(dB.Provider,{value:{didCatch:s,error:a,resetErrorBoundary:this.resetErrorBoundary}},o)}}function fB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==e.length||t.some((n,i)=>!Object.is(n,e[i]))}var qt="colors",Kn="sizes",Je="space",hB={gap:Je,gridGap:Je,columnGap:Je,gridColumnGap:Je,rowGap:Je,gridRowGap:Je,inset:Je,insetBlock:Je,insetBlockEnd:Je,insetBlockStart:Je,insetInline:Je,insetInlineEnd:Je,insetInlineStart:Je,margin:Je,marginTop:Je,marginRight:Je,marginBottom:Je,marginLeft:Je,marginBlock:Je,marginBlockEnd:Je,marginBlockStart:Je,marginInline:Je,marginInlineEnd:Je,marginInlineStart:Je,padding:Je,paddingTop:Je,paddingRight:Je,paddingBottom:Je,paddingLeft:Je,paddingBlock:Je,paddingBlockEnd:Je,paddingBlockStart:Je,paddingInline:Je,paddingInlineEnd:Je,paddingInlineStart:Je,top:Je,right:Je,bottom:Je,left:Je,scrollMargin:Je,scrollMarginTop:Je,scrollMarginRight:Je,scrollMarginBottom:Je,scrollMarginLeft:Je,scrollMarginX:Je,scrollMarginY:Je,scrollMarginBlock:Je,scrollMarginBlockEnd:Je,scrollMarginBlockStart:Je,scrollMarginInline:Je,scrollMarginInlineEnd:Je,scrollMarginInlineStart:Je,scrollPadding:Je,scrollPaddingTop:Je,scrollPaddingRight:Je,scrollPaddingBottom:Je,scrollPaddingLeft:Je,scrollPaddingX:Je,scrollPaddingY:Je,scrollPaddingBlock:Je,scrollPaddingBlockEnd:Je,scrollPaddingBlockStart:Je,scrollPaddingInline:Je,scrollPaddingInlineEnd:Je,scrollPaddingInlineStart:Je,fontSize:"fontSizes",background:qt,backgroundColor:qt,backgroundImage:qt,borderImage:qt,border:qt,borderBlock:qt,borderBlockEnd:qt,borderBlockStart:qt,borderBottom:qt,borderBottomColor:qt,borderColor:qt,borderInline:qt,borderInlineEnd:qt,borderInlineStart:qt,borderLeft:qt,borderLeftColor:qt,borderRight:qt,borderRightColor:qt,borderTop:qt,borderTopColor:qt,caretColor:qt,color:qt,columnRuleColor:qt,fill:qt,outline:qt,outlineColor:qt,stroke:qt,textDecorationColor:qt,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Kn,minBlockSize:Kn,maxBlockSize:Kn,inlineSize:Kn,minInlineSize:Kn,maxInlineSize:Kn,width:Kn,minWidth:Kn,maxWidth:Kn,height:Kn,minHeight:Kn,maxHeight:Kn,flexBasis:Kn,gridTemplateColumns:Kn,gridTemplateRows:Kn,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},pB=(t,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,Wu=()=>{const t=Object.create(null);return(e,n,...i)=>{const r=(s=>JSON.stringify(s,pB))(e);return r in t?t[r]:t[r]=n(e,...i)}},no=Symbol.for("sxs.internal"),zv=(t,e)=>Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)),zS=t=>{for(const e in t)return!0;return!1},{hasOwnProperty:mB}=Object.prototype,Ty=t=>t.includes("-")?t:t.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),gB=/\s+(?![^()]*\))/,fu=t=>e=>t(...typeof e=="string"?String(e).split(gB):[e]),qS={appearance:t=>({WebkitAppearance:t,appearance:t}),backfaceVisibility:t=>({WebkitBackfaceVisibility:t,backfaceVisibility:t}),backdropFilter:t=>({WebkitBackdropFilter:t,backdropFilter:t}),backgroundClip:t=>({WebkitBackgroundClip:t,backgroundClip:t}),boxDecorationBreak:t=>({WebkitBoxDecorationBreak:t,boxDecorationBreak:t}),clipPath:t=>({WebkitClipPath:t,clipPath:t}),content:t=>({content:t.includes('"')||t.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(t)?t:`"${t}"`}),hyphens:t=>({WebkitHyphens:t,hyphens:t}),maskImage:t=>({WebkitMaskImage:t,maskImage:t}),maskSize:t=>({WebkitMaskSize:t,maskSize:t}),tabSize:t=>({MozTabSize:t,tabSize:t}),textSizeAdjust:t=>({WebkitTextSizeAdjust:t,textSizeAdjust:t}),userSelect:t=>({WebkitUserSelect:t,userSelect:t}),marginBlock:fu(((t,e)=>({marginBlockStart:t,marginBlockEnd:e||t}))),marginInline:fu(((t,e)=>({marginInlineStart:t,marginInlineEnd:e||t}))),maxSize:fu(((t,e)=>({maxBlockSize:t,maxInlineSize:e||t}))),minSize:fu(((t,e)=>({minBlockSize:t,minInlineSize:e||t}))),paddingBlock:fu(((t,e)=>({paddingBlockStart:t,paddingBlockEnd:e||t}))),paddingInline:fu(((t,e)=>({paddingInlineStart:t,paddingInlineEnd:e||t})))},cg=/([\d.]+)([^]*)/,yB=(t,e)=>t.length?t.reduce(((n,i)=>(n.push(...e.map((r=>r.includes("&")?r.replace(/&/g,/[ +>|~]/.test(i)&&/&.*&/.test(r)?`:is(${i})`:i):i+" "+r))),n)),[]):e,vB=(t,e)=>t in bB&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,((n,i,r,s)=>i+(r==="stretch"?`-moz-available${s};${Ty(t)}:${i}-webkit-fill-available`:`-moz-fit-content${s};${Ty(t)}:${i}fit-content`)+s)):String(e),bB={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},ds=t=>t?t+"-":"",b_=(t,e,n)=>t.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,((i,r,s,a,o)=>a=="$"==!!s?i:(r||a=="--"?"calc(":"")+"var(--"+(a==="$"?ds(e)+(o.includes("$")?"":ds(n))+o.replace(/\$/g,"-"):o)+")"+(r||a=="--"?"*"+(r||"")+(s||"1")+")":""))),EB=/\s*,\s*(?![^()]*\))/,TB=Object.prototype.toString,Cu=(t,e,n,i,r)=>{let s,a,o;const l=(u,d,f)=>{let p,m;const y=b=>{for(p in b){const x=p.charCodeAt(0)===64,S=x&&Array.isArray(b[p])?b[p]:[b[p]];for(m of S){const w=/[A-Z]/.test(T=p)?T:T.replace(/-[^]/g,(I=>I[1].toUpperCase())),C=typeof m=="object"&&m&&m.toString===TB&&(!i.utils[w]||!d.length);if(w in i.utils&&!C){const I=i.utils[w];if(I!==a){a=I,y(I(m)),a=null;continue}}else if(w in qS){const I=qS[w];if(I!==o){o=I,y(I(m)),o=null;continue}}if(x&&(E=p.slice(1)in i.media?"@media "+i.media[p.slice(1)]:p,p=E.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,((I,L,N,G,O,D)=>{const V=cg.test(L),$=.0625*(V?-1:1),[J,K]=V?[G,L]:[L,G];return"("+(N[0]==="="?"":N[0]===">"===V?"max-":"min-")+J+":"+(N[0]!=="="&&N.length===1?K.replace(cg,((j,te,ne)=>Number(te)+$*(N===">"?1:-1)+ne)):K)+(O?") and ("+(O[0]===">"?"min-":"max-")+J+":"+(O.length===1?D.replace(cg,((j,te,ne)=>Number(te)+$*(O===">"?-1:1)+ne)):D):"")+")"}))),C){const I=x?f.concat(p):[...f],L=x?[...d]:yB(d,p.split(EB));s!==void 0&&r(VS(...s)),s=void 0,l(m,L,I)}else s===void 0&&(s=[[],d,f]),p=x||p.charCodeAt(0)!==36?p:`--${ds(i.prefix)}${p.slice(1).replace(/\$/g,"-")}`,m=C?m:typeof m=="number"?m&&w in xB?String(m)+"px":String(m):b_(vB(w,m??""),i.prefix,i.themeMap[w]),s[0].push(`${x?`${p} `:`${Ty(p)}:`}${m}`)}}var E,T};y(u),s!==void 0&&r(VS(...s)),s=void 0};l(t,e,n)},VS=(t,e,n)=>`${n.map((i=>`${i}{`)).join("")}${e.length?`${e.join(",")}{`:""}${t.join(";")}${e.length?"}":""}${Array(n.length?n.length+1:0).join("}")}`,xB={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},GS=t=>String.fromCharCode(t+(t>25?39:97)),io=t=>(e=>{let n,i="";for(n=Math.abs(e);n>52;n=n/52|0)i=GS(n%52)+i;return GS(n%52)+i})(((e,n)=>{let i=n.length;for(;i;)e=33*e^n.charCodeAt(--i);return e})(5381,JSON.stringify(t))>>>0),lc=["themed","global","styled","onevar","resonevar","allvar","inline"],SB=t=>{if(t.href&&!t.href.startsWith(location.origin))return!1;try{return!!t.cssRules}catch{return!1}},AB=t=>{let e;const n=()=>{const{cssRules:r}=e.sheet;return[].map.call(r,((s,a)=>{const{cssText:o}=s;let l="";if(o.startsWith("--sxs"))return"";if(r[a-1]&&(l=r[a-1].cssText).startsWith("--sxs")){if(!s.cssRules.length)return"";for(const u in e.rules)if(e.rules[u].group===s)return`--sxs{--sxs:${[...e.rules[u].cache].join(" ")}}${o}`;return s.cssRules.length?`${l}${o}`:""}return o})).join("")},i=()=>{if(e){const{rules:o,sheet:l}=e;if(!l.deleteRule){for(;Object(Object(l.cssRules)[0]).type===3;)l.cssRules.splice(0,1);l.cssRules=[]}for(const u in o)delete o[u]}const r=Object(t).styleSheets||[];for(const o of r)if(SB(o)){for(let l=0,u=o.cssRules;u[l];++l){const d=Object(u[l]);if(d.type!==1)continue;const f=Object(u[l+1]);if(f.type!==4)continue;++l;const{cssText:p}=d;if(!p.startsWith("--sxs"))continue;const m=p.slice(14,-3).trim().split(/\s+/),y=lc[m[0]];y&&(e||(e={sheet:o,reset:i,rules:{},toString:n}),e.rules[y]={group:f,index:l,cache:new Set(m)})}if(e)break}if(!e){const o=(l,u)=>({type:u,cssRules:[],insertRule(d,f){this.cssRules.splice(f,0,o(d,{import:3,undefined:1}[(d.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return l==="@media{}"?`@media{${[].map.call(this.cssRules,(d=>d.cssText)).join("")}}`:l}});e={sheet:t?(t.head||t).appendChild(document.createElement("style")).sheet:o("","text/css"),rules:{},reset:i,toString:n}}const{sheet:s,rules:a}=e;for(let o=lc.length-1;o>=0;--o){const l=lc[o];if(!a[l]){const u=lc[o+1],d=a[u]?a[u].index:s.cssRules.length;s.insertRule("@media{}",d),s.insertRule(`--sxs{--sxs:${o}}`,d),a[l]={group:s.cssRules[d+1],index:d,cache:new Set([o])}}wB(a[l])}};return i(),e},wB=t=>{const e=t.group;let n=e.cssRules.length;t.apply=i=>{try{e.insertRule(i,n),++n}catch{}}},tc=Symbol(),CB=Wu(),jS=(t,e)=>CB(t,(()=>(...n)=>{let i={type:null,composers:new Set};for(const r of n)if(r!=null)if(r[no]){i.type==null&&(i.type=r[no].type);for(const s of r[no].composers)i.composers.add(s)}else r.constructor!==Object||r.$$typeof?i.type==null&&(i.type=r):i.composers.add(RB(r,t));return i.type==null&&(i.type="span"),i.composers.size||i.composers.add(["PJLV",{},[],[],{},[]]),_B(t,i,e)})),RB=({variants:t,compoundVariants:e,defaultVariants:n,...i},r)=>{const s=`${ds(r.prefix)}c-${io(i)}`,a=[],o=[],l=Object.create(null),u=[];for(const p in n)l[p]=String(n[p]);if(typeof t=="object"&&t)for(const p in t){d=l,f=p,mB.call(d,f)||(l[p]="undefined");const m=t[p];for(const y in m){const b={[p]:String(y)};String(y)==="undefined"&&u.push(p);const E=m[y],T=[b,E,!zS(E)];a.push(T)}}var d,f;if(typeof e=="object"&&e)for(const p of e){let{css:m,...y}=p;m=typeof m=="object"&&m||{};for(const E in y)y[E]=String(y[E]);const b=[y,m,!zS(m)];o.push(b)}return[s,i,a,o,l,u]},_B=(t,e,n)=>{const[i,r,s,a]=IB(e.composers),o=typeof e.type=="function"||e.type.$$typeof?(f=>{function p(){for(let m=0;m<p[tc].length;m++){const[y,b]=p[tc][m];f.rules[y].apply(b)}return p[tc]=[],null}return p[tc]=[],p.rules={},lc.forEach((m=>p.rules[m]={apply:y=>p[tc].push([m,y])})),p})(n):null,l=(o||n).rules,u=`.${i}${r.length>1?`:where(.${r.slice(1).join(".")})`:""}`,d=f=>{f=typeof f=="object"&&f||LB;const{css:p,...m}=f,y={};for(const T in s)if(delete m[T],T in f){let x=f[T];typeof x=="object"&&x?y[T]={"@initial":s[T],...x}:(x=String(x),y[T]=x!=="undefined"||a.has(T)?x:s[T])}else y[T]=s[T];const b=new Set([...r]);for(const[T,x,S,w]of e.composers){n.rules.styled.cache.has(T)||(n.rules.styled.cache.add(T),Cu(x,[`.${T}`],[],t,(L=>{l.styled.apply(L)})));const C=WS(S,y,t.media),I=WS(w,y,t.media,!0);for(const L of C)if(L!==void 0)for(const[N,G,O]of L){const D=`${T}-${io(G)}-${N}`;b.add(D);const V=(O?n.rules.resonevar:n.rules.onevar).cache,$=O?l.resonevar:l.onevar;V.has(D)||(V.add(D),Cu(G,[`.${D}`],[],t,(J=>{$.apply(J)})))}for(const L of I)if(L!==void 0)for(const[N,G]of L){const O=`${T}-${io(G)}-${N}`;b.add(O),n.rules.allvar.cache.has(O)||(n.rules.allvar.cache.add(O),Cu(G,[`.${O}`],[],t,(D=>{l.allvar.apply(D)})))}}if(typeof p=="object"&&p){const T=`${i}-i${io(p)}-css`;b.add(T),n.rules.inline.cache.has(T)||(n.rules.inline.cache.add(T),Cu(p,[`.${T}`],[],t,(x=>{l.inline.apply(x)})))}for(const T of String(f.className||"").trim().split(/\s+/))T&&b.add(T);const E=m.className=[...b].join(" ");return{type:e.type,className:E,selector:u,props:m,toString:()=>E,deferredInjector:o}};return zv(d,{className:i,selector:u,[no]:e,toString:()=>(n.rules.styled.cache.has(i)||d(),i)})},IB=t=>{let e="";const n=[],i={},r=[];for(const[s,,,,a,o]of t){e===""&&(e=s),n.push(s),r.push(...o);for(const l in a){const u=a[l];(i[l]===void 0||u!=="undefined"||o.includes(u))&&(i[l]=u)}}return[e,n,i,new Set(r)]},WS=(t,e,n,i)=>{const r=[];e:for(let[s,a,o]of t){if(o)continue;let l,u=0,d=!1;for(l in s){const f=s[l];let p=e[l];if(p!==f){if(typeof p!="object"||!p)continue e;{let m,y,b=0;for(const E in p){if(f===String(p[E])){if(E!=="@initial"){const T=E.slice(1);(y=y||[]).push(T in n?n[T]:E.replace(/^@media ?/,"")),d=!0}u+=b,m=!0}++b}if(y&&y.length&&(a={["@media "+y.join(", ")]:a}),!m)continue e}}}(r[u]=r[u]||[]).push([i?"cv":`${l}-${s[l]}`,a,d])}return r},LB={},DB=Wu(),OB=(t,e)=>DB(t,(()=>(...n)=>{const i=()=>{for(let r of n){r=typeof r=="object"&&r||{};let s=io(r);if(!e.rules.global.cache.has(s)){if(e.rules.global.cache.add(s),"@import"in r){let a=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let o of[].concat(r["@import"]))o=o.includes('"')||o.includes("'")?o:`"${o}"`,e.sheet.insertRule(`@import ${o};`,a++);delete r["@import"]}Cu(r,[],[],t,(a=>{e.rules.global.apply(a)}))}}return""};return zv(i,{toString:i})})),PB=Wu(),kB=(t,e)=>PB(t,(()=>n=>{const i=`${ds(t.prefix)}k-${io(n)}`,r=()=>{if(!e.rules.global.cache.has(i)){e.rules.global.cache.add(i);const s=[];Cu(n,[],[],t,(o=>s.push(o)));const a=`@keyframes ${i}{${s.join("")}}`;e.rules.global.apply(a)}return i};return zv(r,{get name(){return r()},toString:r})})),NB=class{constructor(t,e,n,i){this.token=t==null?"":String(t),this.value=e==null?"":String(e),this.scale=n==null?"":String(n),this.prefix=i==null?"":String(i)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+ds(this.prefix)+ds(this.scale)+this.token}toString(){return this.computedValue}},MB=Wu(),BB=(t,e)=>MB(t,(()=>(n,i)=>{i=typeof n=="object"&&n||Object(i);const r=`.${n=(n=typeof n=="string"?n:"")||`${ds(t.prefix)}t-${io(i)}`}`,s={},a=[];for(const l in i){s[l]={};for(const u in i[l]){const d=`--${ds(t.prefix)}${l}-${u}`,f=b_(String(i[l][u]),t.prefix,l);s[l][u]=new NB(u,f,l,t.prefix),a.push(`${d}:${f}`)}}const o=()=>{if(a.length&&!e.rules.themed.cache.has(n)){e.rules.themed.cache.add(n);const l=`${i===t.theme?":root,":""}.${n}{${a.join(";")}}`;e.rules.themed.apply(l)}return n};return{...s,get className(){return o()},selector:r,toString:o}})),FB=Wu(),$S,UB=Wu(),E_=t=>{const e=(n=>{let i=!1;const r=FB(n,(s=>{i=!0;const a="prefix"in(s=typeof s=="object"&&s||{})?String(s.prefix):"",o=typeof s.media=="object"&&s.media||{},l=typeof s.root=="object"?s.root||null:globalThis.document||null,u=typeof s.theme=="object"&&s.theme||{},d={prefix:a,media:o,theme:u,themeMap:typeof s.themeMap=="object"&&s.themeMap||{...hB},utils:typeof s.utils=="object"&&s.utils||{}},f=AB(l),p={css:jS(d,f),globalCss:OB(d,f),keyframes:kB(d,f),createTheme:BB(d,f),reset(){f.reset(),p.theme.toString()},theme:{},sheet:f,config:d,prefix:a,getCssText:f.toString,toString:f.toString};return String(p.theme=p.createTheme(u)),p}));return i||r.reset(),r})(t);return e.styled=(({config:n,sheet:i})=>UB(n,(()=>{const r=jS(n,i);return(...s)=>{const a=r(...s),o=a[no].type,l=U.forwardRef(((u,d)=>{const f=u&&u.as||o,{props:p,deferredInjector:m}=a(u);return delete p.as,p.ref=d,m?U.createElement(U.Fragment,null,U.createElement(f,p),U.createElement(m,null)):U.createElement(f,p)}));return l.className=a.className,l.displayName=`Styled.${o.displayName||o.name||o}`,l.selector=a.selector,l.toString=()=>a.selector,l[no]=a[no],l}})))(e),e},HB=()=>$S||($S=E_()),zB=(...t)=>HB().createTheme(...t);function T_(t){const e=t+"CollectionProvider",[n,i]=Pr(e),[r,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:E,children:T}=b,x=U.useRef(null),S=U.useRef(new Map).current;return Ce.jsx(r,{scope:E,itemMap:S,collectionRef:x,children:T})};a.displayName=e;const o=t+"CollectionSlot",l=Oc(o),u=U.forwardRef((b,E)=>{const{scope:T,children:x}=b,S=s(o,T),w=Yt(E,S.collectionRef);return Ce.jsx(l,{ref:w,children:x})});u.displayName=o;const d=t+"CollectionItemSlot",f="data-radix-collection-item",p=Oc(d),m=U.forwardRef((b,E)=>{const{scope:T,children:x,...S}=b,w=U.useRef(null),C=Yt(E,w),I=s(d,T);return U.useEffect(()=>(I.itemMap.set(w,{ref:w,...S}),()=>void I.itemMap.delete(w))),Ce.jsx(p,{[f]:"",ref:C,children:x})});m.displayName=d;function y(b){const E=s(t+"CollectionConsumer",b);return U.useCallback(()=>{const x=E.collectionRef.current;if(!x)return[];const S=Array.from(x.querySelectorAll(`[${f}]`));return Array.from(E.itemMap.values()).sort((I,L)=>S.indexOf(I.ref.current)-S.indexOf(L.ref.current))},[E.collectionRef,E.itemMap])}return[{Provider:a,Slot:u,ItemSlot:m},y,i]}function ua(t){const e=H.useRef(t);return H.useEffect(()=>{e.current=t}),H.useMemo(()=>(...n)=>{var i;return(i=e.current)==null?void 0:i.call(e,...n)},[])}var qB=H.createContext(void 0);function n0(t){const e=H.useContext(qB);return t||e||"ltr"}var dg="rovingFocusGroup.onEntryFocus",VB={bubbles:!1,cancelable:!0},Kc="RovingFocusGroup",[xy,x_,GB]=T_(Kc),[jB,i0]=Pr(Kc,[GB]),[WB,$B]=jB(Kc),S_=H.forwardRef((t,e)=>Ce.jsx(xy.Provider,{scope:t.__scopeRovingFocusGroup,children:Ce.jsx(xy.Slot,{scope:t.__scopeRovingFocusGroup,children:Ce.jsx(YB,{...t,ref:e})})}));S_.displayName=Kc;var YB=H.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:r=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...f}=t,p=H.useRef(null),m=Yt(e,p),y=n0(s),[b,E]=oa({prop:a,defaultProp:o??null,onChange:l,caller:Kc}),[T,x]=H.useState(!1),S=ua(u),w=x_(n),C=H.useRef(!1),[I,L]=H.useState(0);return H.useEffect(()=>{const N=p.current;if(N)return N.addEventListener(dg,S),()=>N.removeEventListener(dg,S)},[S]),Ce.jsx(WB,{scope:n,orientation:i,dir:y,loop:r,currentTabStopId:b,onItemFocus:H.useCallback(N=>E(N),[E]),onItemShiftTab:H.useCallback(()=>x(!0),[]),onFocusableItemAdd:H.useCallback(()=>L(N=>N+1),[]),onFocusableItemRemove:H.useCallback(()=>L(N=>N-1),[]),children:Ce.jsx(Ct.div,{tabIndex:T||I===0?-1:0,"data-orientation":i,...f,ref:m,style:{outline:"none",...t.style},onMouseDown:xt(t.onMouseDown,()=>{C.current=!0}),onFocus:xt(t.onFocus,N=>{const G=!C.current;if(N.target===N.currentTarget&&G&&!T){const O=new CustomEvent(dg,VB);if(N.currentTarget.dispatchEvent(O),!O.defaultPrevented){const D=w().filter(j=>j.focusable),V=D.find(j=>j.active),$=D.find(j=>j.id===b),K=[V,$,...D].filter(Boolean).map(j=>j.ref.current);C_(K,d)}}C.current=!1}),onBlur:xt(t.onBlur,()=>x(!1))})})}),A_="RovingFocusGroupItem",w_=H.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:r=!1,tabStopId:s,children:a,...o}=t,l=po(),u=s||l,d=$B(A_,n),f=d.currentTabStopId===u,p=x_(n),{onFocusableItemAdd:m,onFocusableItemRemove:y,currentTabStopId:b}=d;return H.useEffect(()=>{if(i)return m(),()=>y()},[i,m,y]),Ce.jsx(xy.ItemSlot,{scope:n,id:u,focusable:i,active:r,children:Ce.jsx(Ct.span,{tabIndex:f?0:-1,"data-orientation":d.orientation,...o,ref:e,onMouseDown:xt(t.onMouseDown,E=>{i?d.onItemFocus(u):E.preventDefault()}),onFocus:xt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:xt(t.onKeyDown,E=>{if(E.key==="Tab"&&E.shiftKey){d.onItemShiftTab();return}if(E.target!==E.currentTarget)return;const T=QB(E,d.orientation,d.dir);if(T!==void 0){if(E.metaKey||E.ctrlKey||E.altKey||E.shiftKey)return;E.preventDefault();let S=p().filter(w=>w.focusable).map(w=>w.ref.current);if(T==="last")S.reverse();else if(T==="prev"||T==="next"){T==="prev"&&S.reverse();const w=S.indexOf(E.currentTarget);S=d.loop?ZB(S,w+1):S.slice(w+1)}setTimeout(()=>C_(S))}}),children:typeof a=="function"?a({isCurrentTabStop:f,hasTabStop:b!=null}):a})})});w_.displayName=A_;var KB={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function XB(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function QB(t,e,n){const i=XB(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return KB[i]}function C_(t,e=!1){const n=document.activeElement;for(const i of t)if(i===n||(i.focus({preventScroll:e}),document.activeElement!==n))return}function ZB(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var R_=S_,__=w_,r0="Tabs",[JB]=Pr(r0,[i0]),I_=i0(),[eF,qv]=JB(r0),L_=H.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,onValueChange:r,defaultValue:s,orientation:a="horizontal",dir:o,activationMode:l="automatic",...u}=t,d=n0(o),[f,p]=oa({prop:i,onChange:r,defaultProp:s??"",caller:r0});return Ce.jsx(eF,{scope:n,baseId:po(),value:f,onValueChange:p,orientation:a,dir:d,activationMode:l,children:Ce.jsx(Ct.div,{dir:d,"data-orientation":a,...u,ref:e})})});L_.displayName=r0;var D_="TabsList",O_=H.forwardRef((t,e)=>{const{__scopeTabs:n,loop:i=!0,...r}=t,s=qv(D_,n),a=I_(n);return Ce.jsx(R_,{asChild:!0,...a,orientation:s.orientation,dir:s.dir,loop:i,children:Ce.jsx(Ct.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});O_.displayName=D_;var P_="TabsTrigger",k_=H.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,disabled:r=!1,...s}=t,a=qv(P_,n),o=I_(n),l=B_(a.baseId,i),u=F_(a.baseId,i),d=i===a.value;return Ce.jsx(__,{asChild:!0,...o,focusable:!r,active:d,children:Ce.jsx(Ct.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...s,ref:e,onMouseDown:xt(t.onMouseDown,f=>{!r&&f.button===0&&f.ctrlKey===!1?a.onValueChange(i):f.preventDefault()}),onKeyDown:xt(t.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&a.onValueChange(i)}),onFocus:xt(t.onFocus,()=>{const f=a.activationMode!=="manual";!d&&!r&&f&&a.onValueChange(i)})})})});k_.displayName=P_;var N_="TabsContent",M_=H.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,forceMount:r,children:s,...a}=t,o=qv(N_,n),l=B_(o.baseId,i),u=F_(o.baseId,i),d=i===o.value,f=H.useRef(d);return H.useEffect(()=>{const p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),Ce.jsx(Yc,{present:r||d,children:({present:p})=>Ce.jsx(Ct.div,{"data-state":d?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!p,id:u,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:f.current?"0s":void 0},children:p&&s})})});M_.displayName=N_;function B_(t,e){return`${t}-trigger-${e}`}function F_(t,e){return`${t}-content-${e}`}var tF=L_,nF=O_,iF=k_,rF=M_;const U_=-1,s0=0,vc=1,Dh=2,Vv=3,Gv=4,jv=5,Wv=6,H_=7,z_=8,YS=typeof self=="object"?self:globalThis,sF=(t,e)=>{const n=(r,s)=>(t.set(s,r),r),i=r=>{if(t.has(r))return t.get(r);const[s,a]=e[r];switch(s){case s0:case U_:return n(a,r);case vc:{const o=n([],r);for(const l of a)o.push(i(l));return o}case Dh:{const o=n({},r);for(const[l,u]of a)o[i(l)]=i(u);return o}case Vv:return n(new Date(a),r);case Gv:{const{source:o,flags:l}=a;return n(new RegExp(o,l),r)}case jv:{const o=n(new Map,r);for(const[l,u]of a)o.set(i(l),i(u));return o}case Wv:{const o=n(new Set,r);for(const l of a)o.add(i(l));return o}case H_:{const{name:o,message:l}=a;return n(new YS[o](l),r)}case z_:return n(BigInt(a),r);case"BigInt":return n(Object(BigInt(a)),r);case"ArrayBuffer":return n(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:o}=new Uint8Array(a);return n(new DataView(o),a)}}return n(new YS[s](a),r)};return i},KS=t=>sF(new Map,t)(0),hu="",{toString:aF}={},{keys:oF}=Object,nc=t=>{const e=typeof t;if(e!=="object"||!t)return[s0,e];const n=aF.call(t).slice(8,-1);switch(n){case"Array":return[vc,hu];case"Object":return[Dh,hu];case"Date":return[Vv,hu];case"RegExp":return[Gv,hu];case"Map":return[jv,hu];case"Set":return[Wv,hu];case"DataView":return[vc,n]}return n.includes("Array")?[vc,n]:n.includes("Error")?[H_,n]:[Dh,n]},Af=([t,e])=>t===s0&&(e==="function"||e==="symbol"),uF=(t,e,n,i)=>{const r=(a,o)=>{const l=i.push(a)-1;return n.set(o,l),l},s=a=>{if(n.has(a))return n.get(a);let[o,l]=nc(a);switch(o){case s0:{let d=a;switch(l){case"bigint":o=z_,d=a.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+l);d=null;break;case"undefined":return r([U_],a)}return r([o,d],a)}case vc:{if(l){let p=a;return l==="DataView"?p=new Uint8Array(a.buffer):l==="ArrayBuffer"&&(p=new Uint8Array(a)),r([l,[...p]],a)}const d=[],f=r([o,d],a);for(const p of a)d.push(s(p));return f}case Dh:{if(l)switch(l){case"BigInt":return r([l,a.toString()],a);case"Boolean":case"Number":case"String":return r([l,a.valueOf()],a)}if(e&&"toJSON"in a)return s(a.toJSON());const d=[],f=r([o,d],a);for(const p of oF(a))(t||!Af(nc(a[p])))&&d.push([s(p),s(a[p])]);return f}case Vv:return r([o,a.toISOString()],a);case Gv:{const{source:d,flags:f}=a;return r([o,{source:d,flags:f}],a)}case jv:{const d=[],f=r([o,d],a);for(const[p,m]of a)(t||!(Af(nc(p))||Af(nc(m))))&&d.push([s(p),s(m)]);return f}case Wv:{const d=[],f=r([o,d],a);for(const p of a)(t||!Af(nc(p)))&&d.push(s(p));return f}}const{message:u}=a;return r([o,{name:l,message:u}],a)};return s},XS=(t,{json:e,lossy:n}={})=>{const i=[];return uF(!(e||n),!!e,new Map,i)(t),i},Uu=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?KS(XS(t,e)):structuredClone(t):(t,e)=>KS(XS(t,e));let Xc=class{constructor(e,n,i){this.normal=n,this.property=e,i&&(this.space=i)}};Xc.prototype.normal={};Xc.prototype.property={};Xc.prototype.space=void 0;function q_(t,e){const n={},i={};for(const r of t)Object.assign(n,r.property),Object.assign(i,r.normal);return new Xc(n,i,e)}function Pc(t){return t.toLowerCase()}let fi=class{constructor(e,n){this.attribute=n,this.property=e}};fi.prototype.attribute="";fi.prototype.booleanish=!1;fi.prototype.boolean=!1;fi.prototype.commaOrSpaceSeparated=!1;fi.prototype.commaSeparated=!1;fi.prototype.defined=!1;fi.prototype.mustUseProperty=!1;fi.prototype.number=!1;fi.prototype.overloadedBoolean=!1;fi.prototype.property="";fi.prototype.spaceSeparated=!1;fi.prototype.space=void 0;let lF=0;const bt=mo(),gn=mo(),Sy=mo(),qe=mo(),Xt=mo(),Iu=mo(),Ti=mo();function mo(){return 2**++lF}const Ay=Object.freeze(Object.defineProperty({__proto__:null,boolean:bt,booleanish:gn,commaOrSpaceSeparated:Ti,commaSeparated:Iu,number:qe,overloadedBoolean:Sy,spaceSeparated:Xt},Symbol.toStringTag,{value:"Module"})),fg=Object.keys(Ay);let $v=class extends fi{constructor(e,n,i,r){let s=-1;if(super(e,n),QS(this,"space",r),typeof i=="number")for(;++s<fg.length;){const a=fg[s];QS(this,fg[s],(i&Ay[a])===Ay[a])}}};$v.prototype.defined=!0;function QS(t,e,n){n&&(t[e]=n)}function $u(t){const e={},n={};for(const[i,r]of Object.entries(t.properties)){const s=new $v(i,t.transform(t.attributes||{},i),r,t.space);t.mustUseProperty&&t.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),e[i]=s,n[Pc(i)]=i,n[Pc(s.attribute)]=i}return new Xc(e,n,t.space)}const V_=$u({properties:{ariaActiveDescendant:null,ariaAtomic:gn,ariaAutoComplete:null,ariaBusy:gn,ariaChecked:gn,ariaColCount:qe,ariaColIndex:qe,ariaColSpan:qe,ariaControls:Xt,ariaCurrent:null,ariaDescribedBy:Xt,ariaDetails:null,ariaDisabled:gn,ariaDropEffect:Xt,ariaErrorMessage:null,ariaExpanded:gn,ariaFlowTo:Xt,ariaGrabbed:gn,ariaHasPopup:null,ariaHidden:gn,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Xt,ariaLevel:qe,ariaLive:null,ariaModal:gn,ariaMultiLine:gn,ariaMultiSelectable:gn,ariaOrientation:null,ariaOwns:Xt,ariaPlaceholder:null,ariaPosInSet:qe,ariaPressed:gn,ariaReadOnly:gn,ariaRelevant:null,ariaRequired:gn,ariaRoleDescription:Xt,ariaRowCount:qe,ariaRowIndex:qe,ariaRowSpan:qe,ariaSelected:gn,ariaSetSize:qe,ariaSort:null,ariaValueMax:qe,ariaValueMin:qe,ariaValueNow:qe,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function G_(t,e){return e in t?t[e]:e}function j_(t,e){return G_(t,e.toLowerCase())}const cF=$u({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Iu,acceptCharset:Xt,accessKey:Xt,action:null,allow:null,allowFullScreen:bt,allowPaymentRequest:bt,allowUserMedia:bt,alt:null,as:null,async:bt,autoCapitalize:null,autoComplete:Xt,autoFocus:bt,autoPlay:bt,blocking:Xt,capture:null,charSet:null,checked:bt,cite:null,className:Xt,cols:qe,colSpan:null,content:null,contentEditable:gn,controls:bt,controlsList:Xt,coords:qe|Iu,crossOrigin:null,data:null,dateTime:null,decoding:null,default:bt,defer:bt,dir:null,dirName:null,disabled:bt,download:Sy,draggable:gn,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:bt,formTarget:null,headers:Xt,height:qe,hidden:Sy,high:qe,href:null,hrefLang:null,htmlFor:Xt,httpEquiv:Xt,id:null,imageSizes:null,imageSrcSet:null,inert:bt,inputMode:null,integrity:null,is:null,isMap:bt,itemId:null,itemProp:Xt,itemRef:Xt,itemScope:bt,itemType:Xt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:bt,low:qe,manifest:null,max:null,maxLength:qe,media:null,method:null,min:null,minLength:qe,multiple:bt,muted:bt,name:null,nonce:null,noModule:bt,noValidate:bt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:bt,optimum:qe,pattern:null,ping:Xt,placeholder:null,playsInline:bt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:bt,referrerPolicy:null,rel:Xt,required:bt,reversed:bt,rows:qe,rowSpan:qe,sandbox:Xt,scope:null,scoped:bt,seamless:bt,selected:bt,shadowRootClonable:bt,shadowRootDelegatesFocus:bt,shadowRootMode:null,shape:null,size:qe,sizes:null,slot:null,span:qe,spellCheck:gn,src:null,srcDoc:null,srcLang:null,srcSet:null,start:qe,step:null,style:null,tabIndex:qe,target:null,title:null,translate:null,type:null,typeMustMatch:bt,useMap:null,value:gn,width:qe,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Xt,axis:null,background:null,bgColor:null,border:qe,borderColor:null,bottomMargin:qe,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:bt,declare:bt,event:null,face:null,frame:null,frameBorder:null,hSpace:qe,leftMargin:qe,link:null,longDesc:null,lowSrc:null,marginHeight:qe,marginWidth:qe,noResize:bt,noHref:bt,noShade:bt,noWrap:bt,object:null,profile:null,prompt:null,rev:null,rightMargin:qe,rules:null,scheme:null,scrolling:gn,standby:null,summary:null,text:null,topMargin:qe,valueType:null,version:null,vAlign:null,vLink:null,vSpace:qe,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:bt,disableRemotePlayback:bt,prefix:null,property:null,results:qe,security:null,unselectable:null},space:"html",transform:j_}),dF=$u({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ti,accentHeight:qe,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:qe,amplitude:qe,arabicForm:null,ascent:qe,attributeName:null,attributeType:null,azimuth:qe,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:qe,by:null,calcMode:null,capHeight:qe,className:Xt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:qe,diffuseConstant:qe,direction:null,display:null,dur:null,divisor:qe,dominantBaseline:null,download:bt,dx:null,dy:null,edgeMode:null,editable:null,elevation:qe,enableBackground:null,end:null,event:null,exponent:qe,externalResourcesRequired:null,fill:null,fillOpacity:qe,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Iu,g2:Iu,glyphName:Iu,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:qe,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:qe,horizOriginX:qe,horizOriginY:qe,id:null,ideographic:qe,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:qe,k:qe,k1:qe,k2:qe,k3:qe,k4:qe,kernelMatrix:Ti,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:qe,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:qe,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:qe,overlineThickness:qe,paintOrder:null,panose1:null,path:null,pathLength:qe,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Xt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:qe,pointsAtY:qe,pointsAtZ:qe,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ti,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ti,rev:Ti,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ti,requiredFeatures:Ti,requiredFonts:Ti,requiredFormats:Ti,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:qe,specularExponent:qe,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:qe,strikethroughThickness:qe,string:null,stroke:null,strokeDashArray:Ti,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:qe,strokeOpacity:qe,strokeWidth:null,style:null,surfaceScale:qe,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ti,tabIndex:qe,tableValues:null,target:null,targetX:qe,targetY:qe,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ti,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:qe,underlineThickness:qe,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:qe,values:null,vAlphabetic:qe,vMathematical:qe,vectorEffect:null,vHanging:qe,vIdeographic:qe,version:null,vertAdvY:qe,vertOriginX:qe,vertOriginY:qe,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:qe,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:G_}),W_=$u({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),$_=$u({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:j_}),Y_=$u({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),fF=/[A-Z]/g,ZS=/-[a-z]/g,hF=/^data[-\w.:]+$/i;function Yv(t,e){const n=Pc(e);let i=e,r=fi;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&hF.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(ZS,mF);i="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!ZS.test(s)){let a=s.replace(fF,pF);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}r=$v}return new r(i,e)}function pF(t){return"-"+t.toLowerCase()}function mF(t){return t.charAt(1).toUpperCase()}const a0=q_([V_,cF,W_,$_,Y_],"html"),Qc=q_([V_,dF,W_,$_,Y_],"svg");function JS(t){const e=[],n=String(t||"");let i=n.indexOf(","),r=0,s=!1;for(;!s;){i===-1&&(i=n.length,s=!0);const a=n.slice(r,i).trim();(a||!s)&&e.push(a),r=i+1,i=n.indexOf(",",r)}return e}function K_(t,e){const n=e||{};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const eA=/[#.]/g;function gF(t,e){const n=t||"",i={};let r=0,s,a;for(;r<n.length;){eA.lastIndex=r;const o=eA.exec(n),l=n.slice(r,o?o.index:n.length);l&&(s?s==="#"?i.id=l:Array.isArray(i.className)?i.className.push(l):i.className=[l]:a=l,r+=l.length),o&&(s=o[0],r++)}return{type:"element",tagName:a||e||"div",properties:i,children:[]}}function tA(t){const e=String(t||"").trim();return e?e.split(/[ \t\n\r\f]+/g):[]}function X_(t){return t.join(" ").trim()}function Q_(t,e,n){const i=n?EF(n):void 0;function r(s,a,...o){let l;if(s==null){l={type:"root",children:[]};const u=a;o.unshift(u)}else{l=gF(s,e);const u=l.tagName.toLowerCase(),d=i?i.get(u):void 0;if(l.tagName=d||u,yF(a))o.unshift(a);else for(const[f,p]of Object.entries(a))vF(t,l.properties,f,p)}for(const u of o)wy(l.children,u);return l.type==="element"&&l.tagName==="template"&&(l.content={type:"root",children:l.children},l.children=[]),l}return r}function yF(t){if(t===null||typeof t!="object"||Array.isArray(t))return!0;if(typeof t.type!="string")return!1;const e=t,n=Object.keys(t);for(const i of n){const r=e[i];if(r&&typeof r=="object"){if(!Array.isArray(r))return!0;const s=r;for(const a of s)if(typeof a!="number"&&typeof a!="string")return!0}}return!!("children"in t&&Array.isArray(t.children))}function vF(t,e,n,i){const r=Yv(t,n);let s;if(i!=null){if(typeof i=="number"){if(Number.isNaN(i))return;s=i}else typeof i=="boolean"?s=i:typeof i=="string"?r.spaceSeparated?s=tA(i):r.commaSeparated?s=JS(i):r.commaOrSpaceSeparated?s=tA(JS(i).join(" ")):s=nA(r,r.property,i):Array.isArray(i)?s=[...i]:s=r.property==="style"?bF(i):String(i);if(Array.isArray(s)){const a=[];for(const o of s)a.push(nA(r,r.property,o));s=a}r.property==="className"&&Array.isArray(e.className)&&(s=e.className.concat(s)),e[r.property]=s}}function wy(t,e){if(e!=null)if(typeof e=="number"||typeof e=="string")t.push({type:"text",value:String(e)});else if(Array.isArray(e))for(const n of e)wy(t,n);else if(typeof e=="object"&&"type"in e)e.type==="root"?wy(t,e.children):t.push(e);else throw new Error("Expected node, nodes, or string, got `"+e+"`")}function nA(t,e,n){if(typeof n=="string"){if(t.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((t.boolean||t.overloadedBoolean)&&(n===""||Pc(n)===Pc(e)))return!0}return n}function bF(t){const e=[];for(const[n,i]of Object.entries(t))e.push([n,i].join(": "));return e.join("; ")}function EF(t){const e=new Map;for(const n of t)e.set(n.toLowerCase(),n);return e}const TF=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],xF=Q_(a0,"div"),SF=Q_(Qc,"g",TF);function AF(t){const e=String(t),n=[];return{toOffset:r,toPoint:i};function i(s){if(typeof s=="number"&&s>-1&&s<=e.length){let a=0;for(;;){let o=n[a];if(o===void 0){const l=iA(e,n[a-1]);o=l===-1?e.length+1:l+1,n[a]=o}if(o>s)return{line:a+1,column:s-(a>0?n[a-1]:0)+1,offset:s};a++}}}function r(s){if(s&&typeof s.line=="number"&&typeof s.column=="number"&&!Number.isNaN(s.line)&&!Number.isNaN(s.column)){for(;n.length<s.line;){const o=n[n.length-1],l=iA(e,o),u=l===-1?e.length+1:l+1;if(o===u)break;n.push(u)}const a=(s.line>1?n[s.line-2]:0)+s.column-1;if(a<n[s.line-1])return a}}}function iA(t,e){const n=t.indexOf("\r",e),i=t.indexOf(`
`,e);return i===-1?n:n===-1||n+1===i?i:n<i?n:i}const Ja={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Z_={}.hasOwnProperty,wF=Object.prototype;function CF(t,e){const n=e||{};return Kv({file:n.file||void 0,location:!1,schema:n.space==="svg"?Qc:a0,verbose:n.verbose||!1},t)}function Kv(t,e){let n;switch(e.nodeName){case"#comment":{const i=e;return n={type:"comment",value:i.data},ch(t,i,n),n}case"#document":case"#document-fragment":{const i=e,r="mode"in i?i.mode==="quirks"||i.mode==="limited-quirks":!1;if(n={type:"root",children:J_(t,e.childNodes),data:{quirksMode:r}},t.file&&t.location){const s=String(t.file),a=AF(s),o=a.toPoint(0),l=a.toPoint(s.length);n.position={start:o,end:l}}return n}case"#documentType":{const i=e;return n={type:"doctype"},ch(t,i,n),n}case"#text":{const i=e;return n={type:"text",value:i.value},ch(t,i,n),n}default:return n=RF(t,e),n}}function J_(t,e){let n=-1;const i=[];for(;++n<e.length;){const r=Kv(t,e[n]);i.push(r)}return i}function RF(t,e){const n=t.schema;t.schema=e.namespaceURI===Ja.svg?Qc:a0;let i=-1;const r={};for(;++i<e.attrs.length;){const o=e.attrs[i],l=(o.prefix?o.prefix+":":"")+o.name;Z_.call(wF,l)||(r[l]=o.value)}const a=(t.schema.space==="svg"?SF:xF)(e.tagName,r,J_(t,e.childNodes));if(ch(t,e,a),a.tagName==="template"){const o=e,l=o.sourceCodeLocation,u=l&&l.startTag&&Ru(l.startTag),d=l&&l.endTag&&Ru(l.endTag),f=Kv(t,o.content);u&&d&&t.file&&(f.position={start:u.end,end:d.start}),a.content=f}return t.schema=n,a}function ch(t,e,n){if("sourceCodeLocation"in e&&e.sourceCodeLocation&&t.file){const i=_F(t,n,e.sourceCodeLocation);i&&(t.location=!0,n.position=i)}}function _F(t,e,n){const i=Ru(n);if(e.type==="element"){const r=e.children[e.children.length-1];if(i&&!n.endTag&&r&&r.position&&r.position.end&&(i.end=Object.assign({},r.position.end)),t.verbose){const s={};let a;if(n.attrs)for(a in n.attrs)Z_.call(n.attrs,a)&&(s[Yv(t.schema,a).property]=Ru(n.attrs[a]));n.startTag;const o=Ru(n.startTag),l=n.endTag?Ru(n.endTag):void 0,u={opening:o};l&&(u.closing=l),u.properties=s,e.data={position:u}}}return i}function Ru(t){const e=rA({line:t.startLine,column:t.startCol,offset:t.startOffset}),n=rA({line:t.endLine,column:t.endCol,offset:t.endOffset});return e||n?{start:e,end:n}:void 0}function rA(t){return t.line&&t.column?t:void 0}class Zc{constructor(e,n,i){this.property=e,this.normal=n,i&&(this.space=i)}}Zc.prototype.property={};Zc.prototype.normal={};Zc.prototype.space=null;function e6(t,e){const n={},i={};let r=-1;for(;++r<t.length;)Object.assign(n,t[r].property),Object.assign(i,t[r].normal);return new Zc(n,i,e)}function Cy(t){return t.toLowerCase()}class Wi{constructor(e,n){this.property=e,this.attribute=n}}Wi.prototype.space=null;Wi.prototype.boolean=!1;Wi.prototype.booleanish=!1;Wi.prototype.overloadedBoolean=!1;Wi.prototype.number=!1;Wi.prototype.commaSeparated=!1;Wi.prototype.spaceSeparated=!1;Wi.prototype.commaOrSpaceSeparated=!1;Wi.prototype.mustUseProperty=!1;Wi.prototype.defined=!1;let IF=0;const gt=go(),yn=go(),t6=go(),Ve=go(),Qt=go(),Lu=go(),xi=go();function go(){return 2**++IF}const Ry=Object.freeze(Object.defineProperty({__proto__:null,boolean:gt,booleanish:yn,commaOrSpaceSeparated:xi,commaSeparated:Lu,number:Ve,overloadedBoolean:t6,spaceSeparated:Qt},Symbol.toStringTag,{value:"Module"})),hg=Object.keys(Ry);class Xv extends Wi{constructor(e,n,i,r){let s=-1;if(super(e,n),sA(this,"space",r),typeof i=="number")for(;++s<hg.length;){const a=hg[s];sA(this,hg[s],(i&Ry[a])===Ry[a])}}}Xv.prototype.defined=!0;function sA(t,e,n){n&&(t[e]=n)}const LF={}.hasOwnProperty;function Yu(t){const e={},n={};let i;for(i in t.properties)if(LF.call(t.properties,i)){const r=t.properties[i],s=new Xv(i,t.transform(t.attributes||{},i),r,t.space);t.mustUseProperty&&t.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),e[i]=s,n[Cy(i)]=i,n[Cy(s.attribute)]=i}return new Zc(e,n,t.space)}const n6=Yu({space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),i6=Yu({space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function r6(t,e){return e in t?t[e]:e}function s6(t,e){return r6(t,e.toLowerCase())}const a6=Yu({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:s6,properties:{xmlns:null,xmlnsXLink:null}}),o6=Yu({transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:yn,ariaAutoComplete:null,ariaBusy:yn,ariaChecked:yn,ariaColCount:Ve,ariaColIndex:Ve,ariaColSpan:Ve,ariaControls:Qt,ariaCurrent:null,ariaDescribedBy:Qt,ariaDetails:null,ariaDisabled:yn,ariaDropEffect:Qt,ariaErrorMessage:null,ariaExpanded:yn,ariaFlowTo:Qt,ariaGrabbed:yn,ariaHasPopup:null,ariaHidden:yn,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Qt,ariaLevel:Ve,ariaLive:null,ariaModal:yn,ariaMultiLine:yn,ariaMultiSelectable:yn,ariaOrientation:null,ariaOwns:Qt,ariaPlaceholder:null,ariaPosInSet:Ve,ariaPressed:yn,ariaReadOnly:yn,ariaRelevant:null,ariaRequired:yn,ariaRoleDescription:Qt,ariaRowCount:Ve,ariaRowIndex:Ve,ariaRowSpan:Ve,ariaSelected:yn,ariaSetSize:Ve,ariaSort:null,ariaValueMax:Ve,ariaValueMin:Ve,ariaValueNow:Ve,ariaValueText:null,role:null}}),DF=Yu({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:s6,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Lu,acceptCharset:Qt,accessKey:Qt,action:null,allow:null,allowFullScreen:gt,allowPaymentRequest:gt,allowUserMedia:gt,alt:null,as:null,async:gt,autoCapitalize:null,autoComplete:Qt,autoFocus:gt,autoPlay:gt,blocking:Qt,capture:null,charSet:null,checked:gt,cite:null,className:Qt,cols:Ve,colSpan:null,content:null,contentEditable:yn,controls:gt,controlsList:Qt,coords:Ve|Lu,crossOrigin:null,data:null,dateTime:null,decoding:null,default:gt,defer:gt,dir:null,dirName:null,disabled:gt,download:t6,draggable:yn,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:gt,formTarget:null,headers:Qt,height:Ve,hidden:gt,high:Ve,href:null,hrefLang:null,htmlFor:Qt,httpEquiv:Qt,id:null,imageSizes:null,imageSrcSet:null,inert:gt,inputMode:null,integrity:null,is:null,isMap:gt,itemId:null,itemProp:Qt,itemRef:Qt,itemScope:gt,itemType:Qt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:gt,low:Ve,manifest:null,max:null,maxLength:Ve,media:null,method:null,min:null,minLength:Ve,multiple:gt,muted:gt,name:null,nonce:null,noModule:gt,noValidate:gt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:gt,optimum:Ve,pattern:null,ping:Qt,placeholder:null,playsInline:gt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:gt,referrerPolicy:null,rel:Qt,required:gt,reversed:gt,rows:Ve,rowSpan:Ve,sandbox:Qt,scope:null,scoped:gt,seamless:gt,selected:gt,shadowRootClonable:gt,shadowRootDelegatesFocus:gt,shadowRootMode:null,shape:null,size:Ve,sizes:null,slot:null,span:Ve,spellCheck:yn,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ve,step:null,style:null,tabIndex:Ve,target:null,title:null,translate:null,type:null,typeMustMatch:gt,useMap:null,value:yn,width:Ve,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Qt,axis:null,background:null,bgColor:null,border:Ve,borderColor:null,bottomMargin:Ve,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:gt,declare:gt,event:null,face:null,frame:null,frameBorder:null,hSpace:Ve,leftMargin:Ve,link:null,longDesc:null,lowSrc:null,marginHeight:Ve,marginWidth:Ve,noResize:gt,noHref:gt,noShade:gt,noWrap:gt,object:null,profile:null,prompt:null,rev:null,rightMargin:Ve,rules:null,scheme:null,scrolling:yn,standby:null,summary:null,text:null,topMargin:Ve,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ve,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:gt,disableRemotePlayback:gt,prefix:null,property:null,results:Ve,security:null,unselectable:null}}),OF=Yu({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:r6,properties:{about:xi,accentHeight:Ve,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ve,amplitude:Ve,arabicForm:null,ascent:Ve,attributeName:null,attributeType:null,azimuth:Ve,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ve,by:null,calcMode:null,capHeight:Ve,className:Qt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ve,diffuseConstant:Ve,direction:null,display:null,dur:null,divisor:Ve,dominantBaseline:null,download:gt,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ve,enableBackground:null,end:null,event:null,exponent:Ve,externalResourcesRequired:null,fill:null,fillOpacity:Ve,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Lu,g2:Lu,glyphName:Lu,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ve,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ve,horizOriginX:Ve,horizOriginY:Ve,id:null,ideographic:Ve,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ve,k:Ve,k1:Ve,k2:Ve,k3:Ve,k4:Ve,kernelMatrix:xi,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ve,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ve,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ve,overlineThickness:Ve,paintOrder:null,panose1:null,path:null,pathLength:Ve,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Qt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ve,pointsAtY:Ve,pointsAtZ:Ve,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:xi,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:xi,rev:xi,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:xi,requiredFeatures:xi,requiredFonts:xi,requiredFormats:xi,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ve,specularExponent:Ve,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ve,strikethroughThickness:Ve,string:null,stroke:null,strokeDashArray:xi,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ve,strokeOpacity:Ve,strokeWidth:null,style:null,surfaceScale:Ve,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:xi,tabIndex:Ve,tableValues:null,target:null,targetX:Ve,targetY:Ve,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:xi,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ve,underlineThickness:Ve,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ve,values:null,vAlphabetic:Ve,vMathematical:Ve,vectorEffect:null,vHanging:Ve,vIdeographic:Ve,version:null,vertAdvY:Ve,vertOriginX:Ve,vertOriginY:Ve,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ve,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),PF=/^data[-\w.:]+$/i,aA=/-[a-z]/g,kF=/[A-Z]/g;function NF(t,e){const n=Cy(e);let i=e,r=Wi;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&PF.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(aA,BF);i="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!aA.test(s)){let a=s.replace(kF,MF);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}r=Xv}return new r(i,e)}function MF(t){return"-"+t.toLowerCase()}function BF(t){return t.charAt(1).toUpperCase()}const FF=e6([i6,n6,a6,o6,DF],"html"),u6=e6([i6,n6,a6,o6,OF],"svg"),oA={}.hasOwnProperty;function Qv(t,e){const n=e||{};function i(r,...s){let a=i.invalid;const o=i.handlers;if(r&&oA.call(r,t)){const l=String(r[t]);a=oA.call(o,l)?o[l]:i.unknown}if(a)return a.call(this,r,...s)}return i.handlers=n.handlers||{},i.invalid=n.invalid,i.unknown=n.unknown,i}const UF={},HF={}.hasOwnProperty,l6=Qv("type",{handlers:{root:qF,element:$F,text:jF,comment:WF,doctype:GF}});function zF(t,e){const i=(e||UF).space;return l6(t,i==="svg"?u6:FF)}function qF(t,e){const n={nodeName:"#document",mode:(t.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return n.childNodes=Zv(t.children,n,e),Ku(t,n),n}function VF(t,e){const n={nodeName:"#document-fragment",childNodes:[]};return n.childNodes=Zv(t.children,n,e),Ku(t,n),n}function GF(t){const e={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return Ku(t,e),e}function jF(t){const e={nodeName:"#text",value:t.value,parentNode:null};return Ku(t,e),e}function WF(t){const e={nodeName:"#comment",data:t.value,parentNode:null};return Ku(t,e),e}function $F(t,e){const n=e;let i=n;t.type==="element"&&t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(i=u6);const r=[];let s;if(t.properties){for(s in t.properties)if(s!=="children"&&HF.call(t.properties,s)){const l=YF(i,s,t.properties[s]);l&&r.push(l)}}const a=i.space,o={nodeName:t.tagName,tagName:t.tagName,attrs:r,namespaceURI:Ja[a],childNodes:[],parentNode:null};return o.childNodes=Zv(t.children,o,i),Ku(t,o),t.tagName==="template"&&t.content&&(o.content=VF(t.content,i)),o}function YF(t,e,n){const i=NF(t,e);if(n===!1||n===null||n===void 0||typeof n=="number"&&Number.isNaN(n)||!n&&i.boolean)return;Array.isArray(n)&&(n=i.commaSeparated?K_(n):X_(n));const r={name:i.attribute,value:n===!0?"":String(n)};if(i.space&&i.space!=="html"&&i.space!=="svg"){const s=r.name.indexOf(":");s<0?r.prefix="":(r.name=r.name.slice(s+1),r.prefix=i.attribute.slice(0,s)),r.namespace=Ja[i.space]}return r}function Zv(t,e,n){let i=-1;const r=[];if(t)for(;++i<t.length;){const s=l6(t[i],n);s.parentNode=e,r.push(s)}return r}function Ku(t,e){const n=t.position;n&&n.start&&n.end&&(n.start.offset,n.end.offset,e.sourceCodeLocation={startLine:n.start.line,startCol:n.start.column,startOffset:n.start.offset,endLine:n.end.line,endCol:n.end.column,endOffset:n.end.offset})}const c6=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],KF=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),tn="";var Q;(function(t){t[t.EOF=-1]="EOF",t[t.NULL=0]="NULL",t[t.TABULATION=9]="TABULATION",t[t.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",t[t.LINE_FEED=10]="LINE_FEED",t[t.FORM_FEED=12]="FORM_FEED",t[t.SPACE=32]="SPACE",t[t.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",t[t.QUOTATION_MARK=34]="QUOTATION_MARK",t[t.AMPERSAND=38]="AMPERSAND",t[t.APOSTROPHE=39]="APOSTROPHE",t[t.HYPHEN_MINUS=45]="HYPHEN_MINUS",t[t.SOLIDUS=47]="SOLIDUS",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",t[t.EQUALS_SIGN=61]="EQUALS_SIGN",t[t.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",t[t.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",t[t.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",t[t.GRAVE_ACCENT=96]="GRAVE_ACCENT",t[t.LATIN_SMALL_A=97]="LATIN_SMALL_A",t[t.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(Q||(Q={}));const si={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function d6(t){return t>=55296&&t<=57343}function XF(t){return t>=56320&&t<=57343}function QF(t,e){return(t-55296)*1024+9216+e}function f6(t){return t!==32&&t!==10&&t!==13&&t!==9&&t!==12&&t>=1&&t<=31||t>=127&&t<=159}function h6(t){return t>=64976&&t<=65007||KF.has(t)}var Ae;(function(t){t.controlCharacterInInputStream="control-character-in-input-stream",t.noncharacterInInputStream="noncharacter-in-input-stream",t.surrogateInInputStream="surrogate-in-input-stream",t.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",t.endTagWithAttributes="end-tag-with-attributes",t.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",t.unexpectedSolidusInTag="unexpected-solidus-in-tag",t.unexpectedNullCharacter="unexpected-null-character",t.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",t.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",t.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",t.missingEndTagName="missing-end-tag-name",t.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",t.unknownNamedCharacterReference="unknown-named-character-reference",t.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",t.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",t.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",t.eofBeforeTagName="eof-before-tag-name",t.eofInTag="eof-in-tag",t.missingAttributeValue="missing-attribute-value",t.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",t.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",t.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",t.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",t.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",t.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",t.missingDoctypePublicIdentifier="missing-doctype-public-identifier",t.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",t.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",t.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",t.cdataInHtmlContent="cdata-in-html-content",t.incorrectlyOpenedComment="incorrectly-opened-comment",t.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",t.eofInDoctype="eof-in-doctype",t.nestedComment="nested-comment",t.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",t.eofInComment="eof-in-comment",t.incorrectlyClosedComment="incorrectly-closed-comment",t.eofInCdata="eof-in-cdata",t.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",t.nullCharacterReference="null-character-reference",t.surrogateCharacterReference="surrogate-character-reference",t.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",t.controlCharacterReference="control-character-reference",t.noncharacterCharacterReference="noncharacter-character-reference",t.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",t.missingDoctypeName="missing-doctype-name",t.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",t.duplicateAttribute="duplicate-attribute",t.nonConformingDoctype="non-conforming-doctype",t.missingDoctype="missing-doctype",t.misplacedDoctype="misplaced-doctype",t.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",t.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",t.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",t.openElementsLeftAfterEof="open-elements-left-after-eof",t.abandonedHeadElementChild="abandoned-head-element-child",t.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",t.nestedNoscriptInHead="nested-noscript-in-head",t.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(Ae||(Ae={}));const ZF=65536;class JF{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=ZF,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e,n){const{line:i,col:r,offset:s}=this,a=r+n,o=s+n;return{code:e,startLine:i,endLine:i,startCol:a,endCol:a,startOffset:o,endOffset:o}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const n=this.html.charCodeAt(this.pos+1);if(XF(n))return this.pos++,this._addGap(),QF(e,n)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,Q.EOF;return this._err(Ae.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,n){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=n}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,n){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(n)return this.html.startsWith(e,this.pos);for(let i=0;i<e.length;i++)if((this.html.charCodeAt(this.pos+i)|32)!==e.charCodeAt(i))return!1;return!0}peek(e){const n=this.pos+e;if(n>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,Q.EOF;const i=this.html.charCodeAt(n);return i===Q.CARRIAGE_RETURN?Q.LINE_FEED:i}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,Q.EOF;let e=this.html.charCodeAt(this.pos);return e===Q.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,Q.LINE_FEED):e===Q.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,d6(e)&&(e=this._processSurrogate(e)),this.handler.onParseError===null||e>31&&e<127||e===Q.LINE_FEED||e===Q.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){f6(e)?this._err(Ae.controlCharacterInInputStream):h6(e)&&this._err(Ae.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var wt;(function(t){t[t.CHARACTER=0]="CHARACTER",t[t.NULL_CHARACTER=1]="NULL_CHARACTER",t[t.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",t[t.START_TAG=3]="START_TAG",t[t.END_TAG=4]="END_TAG",t[t.COMMENT=5]="COMMENT",t[t.DOCTYPE=6]="DOCTYPE",t[t.EOF=7]="EOF",t[t.HIBERNATION=8]="HIBERNATION"})(wt||(wt={}));function p6(t,e){for(let n=t.attrs.length-1;n>=0;n--)if(t.attrs[n].name===e)return t.attrs[n].value;return null}const e7=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),t7=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function n7(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=t7.get(t))!==null&&e!==void 0?e:t}var Pn;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(Pn||(Pn={}));const i7=32;var ra;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(ra||(ra={}));function _y(t){return t>=Pn.ZERO&&t<=Pn.NINE}function r7(t){return t>=Pn.UPPER_A&&t<=Pn.UPPER_F||t>=Pn.LOWER_A&&t<=Pn.LOWER_F}function s7(t){return t>=Pn.UPPER_A&&t<=Pn.UPPER_Z||t>=Pn.LOWER_A&&t<=Pn.LOWER_Z||_y(t)}function a7(t){return t===Pn.EQUALS||s7(t)}var On;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(On||(On={}));var ls;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(ls||(ls={}));class o7{constructor(e,n,i){this.decodeTree=e,this.emitCodePoint=n,this.errors=i,this.state=On.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ls.Strict}startEntity(e){this.decodeMode=e,this.state=On.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case On.EntityStart:return e.charCodeAt(n)===Pn.NUM?(this.state=On.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=On.NamedEntity,this.stateNamedEntity(e,n));case On.NumericStart:return this.stateNumericStart(e,n);case On.NumericDecimal:return this.stateNumericDecimal(e,n);case On.NumericHex:return this.stateNumericHex(e,n);case On.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|i7)===Pn.LOWER_X?(this.state=On.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=On.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,i,r){if(n!==i){const s=i-n;this.result=this.result*Math.pow(r,s)+Number.parseInt(e.substr(n,s),r),this.consumed+=s}}stateNumericHex(e,n){const i=n;for(;n<e.length;){const r=e.charCodeAt(n);if(_y(r)||r7(r))n+=1;else return this.addToNumericResult(e,i,n,16),this.emitNumericEntity(r,3)}return this.addToNumericResult(e,i,n,16),-1}stateNumericDecimal(e,n){const i=n;for(;n<e.length;){const r=e.charCodeAt(n);if(_y(r))n+=1;else return this.addToNumericResult(e,i,n,10),this.emitNumericEntity(r,2)}return this.addToNumericResult(e,i,n,10),-1}emitNumericEntity(e,n){var i;if(this.consumed<=n)return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Pn.SEMI)this.consumed+=1;else if(this.decodeMode===ls.Strict)return 0;return this.emitCodePoint(n7(this.result),this.consumed),this.errors&&(e!==Pn.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:i}=this;let r=i[this.treeIndex],s=(r&ra.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const a=e.charCodeAt(n);if(this.treeIndex=u7(i,r,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return this.result===0||this.decodeMode===ls.Attribute&&(s===0||a7(a))?0:this.emitNotTerminatedNamedEntity();if(r=i[this.treeIndex],s=(r&ra.VALUE_LENGTH)>>14,s!==0){if(a===Pn.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==ls.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:i}=this,r=(i[n]&ra.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,r,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,i){const{decodeTree:r}=this;return this.emitCodePoint(n===1?r[e]&~ra.VALUE_LENGTH:r[e+1],i),n===3&&this.emitCodePoint(r[e+2],i),i}end(){var e;switch(this.state){case On.NamedEntity:return this.result!==0&&(this.decodeMode!==ls.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case On.NumericDecimal:return this.emitNumericEntity(0,2);case On.NumericHex:return this.emitNumericEntity(0,3);case On.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case On.EntityStart:return 0}}}function u7(t,e,n,i){const r=(e&ra.BRANCH_LENGTH)>>7,s=e&ra.JUMP_TABLE;if(r===0)return s!==0&&i===s?n:-1;if(s){const l=i-s;return l<0||l>=r?-1:t[n+l]-1}let a=n,o=a+r-1;for(;a<=o;){const l=a+o>>>1,u=t[l];if(u<i)a=l+1;else if(u>i)o=l-1;else return t[l+r]}return-1}var Ue;(function(t){t.HTML="http://www.w3.org/1999/xhtml",t.MATHML="http://www.w3.org/1998/Math/MathML",t.SVG="http://www.w3.org/2000/svg",t.XLINK="http://www.w3.org/1999/xlink",t.XML="http://www.w3.org/XML/1998/namespace",t.XMLNS="http://www.w3.org/2000/xmlns/"})(Ue||(Ue={}));var ro;(function(t){t.TYPE="type",t.ACTION="action",t.ENCODING="encoding",t.PROMPT="prompt",t.NAME="name",t.COLOR="color",t.FACE="face",t.SIZE="size"})(ro||(ro={}));var Vi;(function(t){t.NO_QUIRKS="no-quirks",t.QUIRKS="quirks",t.LIMITED_QUIRKS="limited-quirks"})(Vi||(Vi={}));var ge;(function(t){t.A="a",t.ADDRESS="address",t.ANNOTATION_XML="annotation-xml",t.APPLET="applet",t.AREA="area",t.ARTICLE="article",t.ASIDE="aside",t.B="b",t.BASE="base",t.BASEFONT="basefont",t.BGSOUND="bgsound",t.BIG="big",t.BLOCKQUOTE="blockquote",t.BODY="body",t.BR="br",t.BUTTON="button",t.CAPTION="caption",t.CENTER="center",t.CODE="code",t.COL="col",t.COLGROUP="colgroup",t.DD="dd",t.DESC="desc",t.DETAILS="details",t.DIALOG="dialog",t.DIR="dir",t.DIV="div",t.DL="dl",t.DT="dt",t.EM="em",t.EMBED="embed",t.FIELDSET="fieldset",t.FIGCAPTION="figcaption",t.FIGURE="figure",t.FONT="font",t.FOOTER="footer",t.FOREIGN_OBJECT="foreignObject",t.FORM="form",t.FRAME="frame",t.FRAMESET="frameset",t.H1="h1",t.H2="h2",t.H3="h3",t.H4="h4",t.H5="h5",t.H6="h6",t.HEAD="head",t.HEADER="header",t.HGROUP="hgroup",t.HR="hr",t.HTML="html",t.I="i",t.IMG="img",t.IMAGE="image",t.INPUT="input",t.IFRAME="iframe",t.KEYGEN="keygen",t.LABEL="label",t.LI="li",t.LINK="link",t.LISTING="listing",t.MAIN="main",t.MALIGNMARK="malignmark",t.MARQUEE="marquee",t.MATH="math",t.MENU="menu",t.META="meta",t.MGLYPH="mglyph",t.MI="mi",t.MO="mo",t.MN="mn",t.MS="ms",t.MTEXT="mtext",t.NAV="nav",t.NOBR="nobr",t.NOFRAMES="noframes",t.NOEMBED="noembed",t.NOSCRIPT="noscript",t.OBJECT="object",t.OL="ol",t.OPTGROUP="optgroup",t.OPTION="option",t.P="p",t.PARAM="param",t.PLAINTEXT="plaintext",t.PRE="pre",t.RB="rb",t.RP="rp",t.RT="rt",t.RTC="rtc",t.RUBY="ruby",t.S="s",t.SCRIPT="script",t.SEARCH="search",t.SECTION="section",t.SELECT="select",t.SOURCE="source",t.SMALL="small",t.SPAN="span",t.STRIKE="strike",t.STRONG="strong",t.STYLE="style",t.SUB="sub",t.SUMMARY="summary",t.SUP="sup",t.TABLE="table",t.TBODY="tbody",t.TEMPLATE="template",t.TEXTAREA="textarea",t.TFOOT="tfoot",t.TD="td",t.TH="th",t.THEAD="thead",t.TITLE="title",t.TR="tr",t.TRACK="track",t.TT="tt",t.U="u",t.UL="ul",t.SVG="svg",t.VAR="var",t.WBR="wbr",t.XMP="xmp"})(ge||(ge={}));var _;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.A=1]="A",t[t.ADDRESS=2]="ADDRESS",t[t.ANNOTATION_XML=3]="ANNOTATION_XML",t[t.APPLET=4]="APPLET",t[t.AREA=5]="AREA",t[t.ARTICLE=6]="ARTICLE",t[t.ASIDE=7]="ASIDE",t[t.B=8]="B",t[t.BASE=9]="BASE",t[t.BASEFONT=10]="BASEFONT",t[t.BGSOUND=11]="BGSOUND",t[t.BIG=12]="BIG",t[t.BLOCKQUOTE=13]="BLOCKQUOTE",t[t.BODY=14]="BODY",t[t.BR=15]="BR",t[t.BUTTON=16]="BUTTON",t[t.CAPTION=17]="CAPTION",t[t.CENTER=18]="CENTER",t[t.CODE=19]="CODE",t[t.COL=20]="COL",t[t.COLGROUP=21]="COLGROUP",t[t.DD=22]="DD",t[t.DESC=23]="DESC",t[t.DETAILS=24]="DETAILS",t[t.DIALOG=25]="DIALOG",t[t.DIR=26]="DIR",t[t.DIV=27]="DIV",t[t.DL=28]="DL",t[t.DT=29]="DT",t[t.EM=30]="EM",t[t.EMBED=31]="EMBED",t[t.FIELDSET=32]="FIELDSET",t[t.FIGCAPTION=33]="FIGCAPTION",t[t.FIGURE=34]="FIGURE",t[t.FONT=35]="FONT",t[t.FOOTER=36]="FOOTER",t[t.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",t[t.FORM=38]="FORM",t[t.FRAME=39]="FRAME",t[t.FRAMESET=40]="FRAMESET",t[t.H1=41]="H1",t[t.H2=42]="H2",t[t.H3=43]="H3",t[t.H4=44]="H4",t[t.H5=45]="H5",t[t.H6=46]="H6",t[t.HEAD=47]="HEAD",t[t.HEADER=48]="HEADER",t[t.HGROUP=49]="HGROUP",t[t.HR=50]="HR",t[t.HTML=51]="HTML",t[t.I=52]="I",t[t.IMG=53]="IMG",t[t.IMAGE=54]="IMAGE",t[t.INPUT=55]="INPUT",t[t.IFRAME=56]="IFRAME",t[t.KEYGEN=57]="KEYGEN",t[t.LABEL=58]="LABEL",t[t.LI=59]="LI",t[t.LINK=60]="LINK",t[t.LISTING=61]="LISTING",t[t.MAIN=62]="MAIN",t[t.MALIGNMARK=63]="MALIGNMARK",t[t.MARQUEE=64]="MARQUEE",t[t.MATH=65]="MATH",t[t.MENU=66]="MENU",t[t.META=67]="META",t[t.MGLYPH=68]="MGLYPH",t[t.MI=69]="MI",t[t.MO=70]="MO",t[t.MN=71]="MN",t[t.MS=72]="MS",t[t.MTEXT=73]="MTEXT",t[t.NAV=74]="NAV",t[t.NOBR=75]="NOBR",t[t.NOFRAMES=76]="NOFRAMES",t[t.NOEMBED=77]="NOEMBED",t[t.NOSCRIPT=78]="NOSCRIPT",t[t.OBJECT=79]="OBJECT",t[t.OL=80]="OL",t[t.OPTGROUP=81]="OPTGROUP",t[t.OPTION=82]="OPTION",t[t.P=83]="P",t[t.PARAM=84]="PARAM",t[t.PLAINTEXT=85]="PLAINTEXT",t[t.PRE=86]="PRE",t[t.RB=87]="RB",t[t.RP=88]="RP",t[t.RT=89]="RT",t[t.RTC=90]="RTC",t[t.RUBY=91]="RUBY",t[t.S=92]="S",t[t.SCRIPT=93]="SCRIPT",t[t.SEARCH=94]="SEARCH",t[t.SECTION=95]="SECTION",t[t.SELECT=96]="SELECT",t[t.SOURCE=97]="SOURCE",t[t.SMALL=98]="SMALL",t[t.SPAN=99]="SPAN",t[t.STRIKE=100]="STRIKE",t[t.STRONG=101]="STRONG",t[t.STYLE=102]="STYLE",t[t.SUB=103]="SUB",t[t.SUMMARY=104]="SUMMARY",t[t.SUP=105]="SUP",t[t.TABLE=106]="TABLE",t[t.TBODY=107]="TBODY",t[t.TEMPLATE=108]="TEMPLATE",t[t.TEXTAREA=109]="TEXTAREA",t[t.TFOOT=110]="TFOOT",t[t.TD=111]="TD",t[t.TH=112]="TH",t[t.THEAD=113]="THEAD",t[t.TITLE=114]="TITLE",t[t.TR=115]="TR",t[t.TRACK=116]="TRACK",t[t.TT=117]="TT",t[t.U=118]="U",t[t.UL=119]="UL",t[t.SVG=120]="SVG",t[t.VAR=121]="VAR",t[t.WBR=122]="WBR",t[t.XMP=123]="XMP"})(_||(_={}));const l7=new Map([[ge.A,_.A],[ge.ADDRESS,_.ADDRESS],[ge.ANNOTATION_XML,_.ANNOTATION_XML],[ge.APPLET,_.APPLET],[ge.AREA,_.AREA],[ge.ARTICLE,_.ARTICLE],[ge.ASIDE,_.ASIDE],[ge.B,_.B],[ge.BASE,_.BASE],[ge.BASEFONT,_.BASEFONT],[ge.BGSOUND,_.BGSOUND],[ge.BIG,_.BIG],[ge.BLOCKQUOTE,_.BLOCKQUOTE],[ge.BODY,_.BODY],[ge.BR,_.BR],[ge.BUTTON,_.BUTTON],[ge.CAPTION,_.CAPTION],[ge.CENTER,_.CENTER],[ge.CODE,_.CODE],[ge.COL,_.COL],[ge.COLGROUP,_.COLGROUP],[ge.DD,_.DD],[ge.DESC,_.DESC],[ge.DETAILS,_.DETAILS],[ge.DIALOG,_.DIALOG],[ge.DIR,_.DIR],[ge.DIV,_.DIV],[ge.DL,_.DL],[ge.DT,_.DT],[ge.EM,_.EM],[ge.EMBED,_.EMBED],[ge.FIELDSET,_.FIELDSET],[ge.FIGCAPTION,_.FIGCAPTION],[ge.FIGURE,_.FIGURE],[ge.FONT,_.FONT],[ge.FOOTER,_.FOOTER],[ge.FOREIGN_OBJECT,_.FOREIGN_OBJECT],[ge.FORM,_.FORM],[ge.FRAME,_.FRAME],[ge.FRAMESET,_.FRAMESET],[ge.H1,_.H1],[ge.H2,_.H2],[ge.H3,_.H3],[ge.H4,_.H4],[ge.H5,_.H5],[ge.H6,_.H6],[ge.HEAD,_.HEAD],[ge.HEADER,_.HEADER],[ge.HGROUP,_.HGROUP],[ge.HR,_.HR],[ge.HTML,_.HTML],[ge.I,_.I],[ge.IMG,_.IMG],[ge.IMAGE,_.IMAGE],[ge.INPUT,_.INPUT],[ge.IFRAME,_.IFRAME],[ge.KEYGEN,_.KEYGEN],[ge.LABEL,_.LABEL],[ge.LI,_.LI],[ge.LINK,_.LINK],[ge.LISTING,_.LISTING],[ge.MAIN,_.MAIN],[ge.MALIGNMARK,_.MALIGNMARK],[ge.MARQUEE,_.MARQUEE],[ge.MATH,_.MATH],[ge.MENU,_.MENU],[ge.META,_.META],[ge.MGLYPH,_.MGLYPH],[ge.MI,_.MI],[ge.MO,_.MO],[ge.MN,_.MN],[ge.MS,_.MS],[ge.MTEXT,_.MTEXT],[ge.NAV,_.NAV],[ge.NOBR,_.NOBR],[ge.NOFRAMES,_.NOFRAMES],[ge.NOEMBED,_.NOEMBED],[ge.NOSCRIPT,_.NOSCRIPT],[ge.OBJECT,_.OBJECT],[ge.OL,_.OL],[ge.OPTGROUP,_.OPTGROUP],[ge.OPTION,_.OPTION],[ge.P,_.P],[ge.PARAM,_.PARAM],[ge.PLAINTEXT,_.PLAINTEXT],[ge.PRE,_.PRE],[ge.RB,_.RB],[ge.RP,_.RP],[ge.RT,_.RT],[ge.RTC,_.RTC],[ge.RUBY,_.RUBY],[ge.S,_.S],[ge.SCRIPT,_.SCRIPT],[ge.SEARCH,_.SEARCH],[ge.SECTION,_.SECTION],[ge.SELECT,_.SELECT],[ge.SOURCE,_.SOURCE],[ge.SMALL,_.SMALL],[ge.SPAN,_.SPAN],[ge.STRIKE,_.STRIKE],[ge.STRONG,_.STRONG],[ge.STYLE,_.STYLE],[ge.SUB,_.SUB],[ge.SUMMARY,_.SUMMARY],[ge.SUP,_.SUP],[ge.TABLE,_.TABLE],[ge.TBODY,_.TBODY],[ge.TEMPLATE,_.TEMPLATE],[ge.TEXTAREA,_.TEXTAREA],[ge.TFOOT,_.TFOOT],[ge.TD,_.TD],[ge.TH,_.TH],[ge.THEAD,_.THEAD],[ge.TITLE,_.TITLE],[ge.TR,_.TR],[ge.TRACK,_.TRACK],[ge.TT,_.TT],[ge.U,_.U],[ge.UL,_.UL],[ge.SVG,_.SVG],[ge.VAR,_.VAR],[ge.WBR,_.WBR],[ge.XMP,_.XMP]]);function Xu(t){var e;return(e=l7.get(t))!==null&&e!==void 0?e:_.UNKNOWN}const He=_,c7={[Ue.HTML]:new Set([He.ADDRESS,He.APPLET,He.AREA,He.ARTICLE,He.ASIDE,He.BASE,He.BASEFONT,He.BGSOUND,He.BLOCKQUOTE,He.BODY,He.BR,He.BUTTON,He.CAPTION,He.CENTER,He.COL,He.COLGROUP,He.DD,He.DETAILS,He.DIR,He.DIV,He.DL,He.DT,He.EMBED,He.FIELDSET,He.FIGCAPTION,He.FIGURE,He.FOOTER,He.FORM,He.FRAME,He.FRAMESET,He.H1,He.H2,He.H3,He.H4,He.H5,He.H6,He.HEAD,He.HEADER,He.HGROUP,He.HR,He.HTML,He.IFRAME,He.IMG,He.INPUT,He.LI,He.LINK,He.LISTING,He.MAIN,He.MARQUEE,He.MENU,He.META,He.NAV,He.NOEMBED,He.NOFRAMES,He.NOSCRIPT,He.OBJECT,He.OL,He.P,He.PARAM,He.PLAINTEXT,He.PRE,He.SCRIPT,He.SECTION,He.SELECT,He.SOURCE,He.STYLE,He.SUMMARY,He.TABLE,He.TBODY,He.TD,He.TEMPLATE,He.TEXTAREA,He.TFOOT,He.TH,He.THEAD,He.TITLE,He.TR,He.TRACK,He.UL,He.WBR,He.XMP]),[Ue.MATHML]:new Set([He.MI,He.MO,He.MN,He.MS,He.MTEXT,He.ANNOTATION_XML]),[Ue.SVG]:new Set([He.TITLE,He.FOREIGN_OBJECT,He.DESC]),[Ue.XLINK]:new Set,[Ue.XML]:new Set,[Ue.XMLNS]:new Set},Iy=new Set([He.H1,He.H2,He.H3,He.H4,He.H5,He.H6]);ge.STYLE,ge.SCRIPT,ge.XMP,ge.IFRAME,ge.NOEMBED,ge.NOFRAMES,ge.PLAINTEXT;var ee;(function(t){t[t.DATA=0]="DATA",t[t.RCDATA=1]="RCDATA",t[t.RAWTEXT=2]="RAWTEXT",t[t.SCRIPT_DATA=3]="SCRIPT_DATA",t[t.PLAINTEXT=4]="PLAINTEXT",t[t.TAG_OPEN=5]="TAG_OPEN",t[t.END_TAG_OPEN=6]="END_TAG_OPEN",t[t.TAG_NAME=7]="TAG_NAME",t[t.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",t[t.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",t[t.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",t[t.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",t[t.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",t[t.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",t[t.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",t[t.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",t[t.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",t[t.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",t[t.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",t[t.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",t[t.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",t[t.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",t[t.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",t[t.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",t[t.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",t[t.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",t[t.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",t[t.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",t[t.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",t[t.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",t[t.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",t[t.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",t[t.BOGUS_COMMENT=40]="BOGUS_COMMENT",t[t.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",t[t.COMMENT_START=42]="COMMENT_START",t[t.COMMENT_START_DASH=43]="COMMENT_START_DASH",t[t.COMMENT=44]="COMMENT",t[t.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",t[t.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",t[t.COMMENT_END_DASH=49]="COMMENT_END_DASH",t[t.COMMENT_END=50]="COMMENT_END",t[t.COMMENT_END_BANG=51]="COMMENT_END_BANG",t[t.DOCTYPE=52]="DOCTYPE",t[t.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",t[t.DOCTYPE_NAME=54]="DOCTYPE_NAME",t[t.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",t[t.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",t[t.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",t[t.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",t[t.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",t[t.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",t[t.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",t[t.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",t[t.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",t[t.CDATA_SECTION=68]="CDATA_SECTION",t[t.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",t[t.CDATA_SECTION_END=70]="CDATA_SECTION_END",t[t.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",t[t.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(ee||(ee={}));const hn={DATA:ee.DATA,RCDATA:ee.RCDATA,RAWTEXT:ee.RAWTEXT,SCRIPT_DATA:ee.SCRIPT_DATA,PLAINTEXT:ee.PLAINTEXT,CDATA_SECTION:ee.CDATA_SECTION};function d7(t){return t>=Q.DIGIT_0&&t<=Q.DIGIT_9}function cc(t){return t>=Q.LATIN_CAPITAL_A&&t<=Q.LATIN_CAPITAL_Z}function f7(t){return t>=Q.LATIN_SMALL_A&&t<=Q.LATIN_SMALL_Z}function Zs(t){return f7(t)||cc(t)}function uA(t){return Zs(t)||d7(t)}function wf(t){return t+32}function m6(t){return t===Q.SPACE||t===Q.LINE_FEED||t===Q.TABULATION||t===Q.FORM_FEED}function lA(t){return m6(t)||t===Q.SOLIDUS||t===Q.GREATER_THAN_SIGN}function h7(t){return t===Q.NULL?Ae.nullCharacterReference:t>1114111?Ae.characterReferenceOutsideUnicodeRange:d6(t)?Ae.surrogateCharacterReference:h6(t)?Ae.noncharacterCharacterReference:f6(t)||t===Q.CARRIAGE_RETURN?Ae.controlCharacterReference:null}let p7=class{constructor(e,n){this.options=e,this.handler=n,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=ee.DATA,this.returnState=ee.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new JF(n),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new o7(e7,(i,r)=>{this.preprocessor.pos=this.entityStartPos+r-1,this._flushCodePointConsumedAsCharacterReference(i)},n.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(Ae.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:i=>{this._err(Ae.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+i)},validateNumericCharacterReference:i=>{const r=h7(i);r&&this._err(r,1)}}:void 0)}_err(e,n=0){var i,r;(r=(i=this.handler).onParseError)===null||r===void 0||r.call(i,this.preprocessor.getError(e,n))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||e==null||e())}write(e,n,i){this.active=!0,this.preprocessor.write(e,n),this._runParsingLoop(),this.paused||i==null||i()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let n=0;n<e;n++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,n){return this.preprocessor.startsWith(e,n)?(this._advanceBy(e.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:wt.START_TAG,tagName:"",tagID:_.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:wt.END_TAG,tagName:"",tagID:_.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:wt.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:wt.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,n){this.currentCharacterToken={type:e,chars:n,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,n;const i=this.currentToken;if(p6(i,this.currentAttr.name)===null){if(i.attrs.push(this.currentAttr),i.location&&this.currentLocation){const r=(e=(n=i.location).attrs)!==null&&e!==void 0?e:n.attrs=Object.create(null);r[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(Ae.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e),e.tagID=Xu(e.tagName),e.type===wt.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(Ae.endTagWithAttributes),e.selfClosing&&this._err(Ae.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case wt.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case wt.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case wt.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:wt.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,n){if(this.currentCharacterToken)if(this.currentCharacterToken.type===e){this.currentCharacterToken.chars+=n;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(e,n)}_emitCodePoint(e){const n=m6(e)?wt.WHITESPACE_CHARACTER:e===Q.NULL?wt.NULL_CHARACTER:wt.CHARACTER;this._appendCharToCurrentCharacterToken(n,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(wt.CHARACTER,e)}_startCharacterReference(){this.returnState=this.state,this.state=ee.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?ls.Attribute:ls.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===ee.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===ee.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===ee.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case ee.DATA:{this._stateData(e);break}case ee.RCDATA:{this._stateRcdata(e);break}case ee.RAWTEXT:{this._stateRawtext(e);break}case ee.SCRIPT_DATA:{this._stateScriptData(e);break}case ee.PLAINTEXT:{this._statePlaintext(e);break}case ee.TAG_OPEN:{this._stateTagOpen(e);break}case ee.END_TAG_OPEN:{this._stateEndTagOpen(e);break}case ee.TAG_NAME:{this._stateTagName(e);break}case ee.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(e);break}case ee.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(e);break}case ee.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(e);break}case ee.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(e);break}case ee.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(e);break}case ee.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(e);break}case ee.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(e);break}case ee.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(e);break}case ee.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(e);break}case ee.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(e);break}case ee.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(e);break}case ee.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(e);break}case ee.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(e);break}case ee.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(e);break}case ee.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(e);break}case ee.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(e);break}case ee.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(e);break}case ee.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(e);break}case ee.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(e);break}case ee.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(e);break}case ee.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(e);break}case ee.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(e);break}case ee.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(e);break}case ee.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(e);break}case ee.ATTRIBUTE_NAME:{this._stateAttributeName(e);break}case ee.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(e);break}case ee.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(e);break}case ee.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(e);break}case ee.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(e);break}case ee.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(e);break}case ee.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(e);break}case ee.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(e);break}case ee.BOGUS_COMMENT:{this._stateBogusComment(e);break}case ee.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(e);break}case ee.COMMENT_START:{this._stateCommentStart(e);break}case ee.COMMENT_START_DASH:{this._stateCommentStartDash(e);break}case ee.COMMENT:{this._stateComment(e);break}case ee.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(e);break}case ee.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(e);break}case ee.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(e);break}case ee.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(e);break}case ee.COMMENT_END_DASH:{this._stateCommentEndDash(e);break}case ee.COMMENT_END:{this._stateCommentEnd(e);break}case ee.COMMENT_END_BANG:{this._stateCommentEndBang(e);break}case ee.DOCTYPE:{this._stateDoctype(e);break}case ee.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(e);break}case ee.DOCTYPE_NAME:{this._stateDoctypeName(e);break}case ee.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(e);break}case ee.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(e);break}case ee.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(e);break}case ee.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(e);break}case ee.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(e);break}case ee.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(e);break}case ee.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break}case ee.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(e);break}case ee.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(e);break}case ee.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(e);break}case ee.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(e);break}case ee.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(e);break}case ee.BOGUS_DOCTYPE:{this._stateBogusDoctype(e);break}case ee.CDATA_SECTION:{this._stateCdataSection(e);break}case ee.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(e);break}case ee.CDATA_SECTION_END:{this._stateCdataSectionEnd(e);break}case ee.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case ee.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(e);break}default:throw new Error("Unknown state")}}_stateData(e){switch(e){case Q.LESS_THAN_SIGN:{this.state=ee.TAG_OPEN;break}case Q.AMPERSAND:{this._startCharacterReference();break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this._emitCodePoint(e);break}case Q.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case Q.AMPERSAND:{this._startCharacterReference();break}case Q.LESS_THAN_SIGN:{this.state=ee.RCDATA_LESS_THAN_SIGN;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this._emitChars(tn);break}case Q.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case Q.LESS_THAN_SIGN:{this.state=ee.RAWTEXT_LESS_THAN_SIGN;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this._emitChars(tn);break}case Q.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case Q.LESS_THAN_SIGN:{this.state=ee.SCRIPT_DATA_LESS_THAN_SIGN;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this._emitChars(tn);break}case Q.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this._emitChars(tn);break}case Q.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateTagOpen(e){if(Zs(e))this._createStartTagToken(),this.state=ee.TAG_NAME,this._stateTagName(e);else switch(e){case Q.EXCLAMATION_MARK:{this.state=ee.MARKUP_DECLARATION_OPEN;break}case Q.SOLIDUS:{this.state=ee.END_TAG_OPEN;break}case Q.QUESTION_MARK:{this._err(Ae.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=ee.BOGUS_COMMENT,this._stateBogusComment(e);break}case Q.EOF:{this._err(Ae.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(Ae.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=ee.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(Zs(e))this._createEndTagToken(),this.state=ee.TAG_NAME,this._stateTagName(e);else switch(e){case Q.GREATER_THAN_SIGN:{this._err(Ae.missingEndTagName),this.state=ee.DATA;break}case Q.EOF:{this._err(Ae.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(Ae.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=ee.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:{this.state=ee.BEFORE_ATTRIBUTE_NAME;break}case Q.SOLIDUS:{this.state=ee.SELF_CLOSING_START_TAG;break}case Q.GREATER_THAN_SIGN:{this.state=ee.DATA,this.emitCurrentTagToken();break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),n.tagName+=tn;break}case Q.EOF:{this._err(Ae.eofInTag),this._emitEOFToken();break}default:n.tagName+=String.fromCodePoint(cc(e)?wf(e):e)}}_stateRcdataLessThanSign(e){e===Q.SOLIDUS?this.state=ee.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=ee.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){Zs(e)?(this.state=ee.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=ee.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const n=this.currentToken;switch(n.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=ee.BEFORE_ATTRIBUTE_NAME,!1;case Q.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=ee.SELF_CLOSING_START_TAG,!1;case Q.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=ee.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=ee.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===Q.SOLIDUS?this.state=ee.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=ee.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){Zs(e)?(this.state=ee.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=ee.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=ee.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case Q.SOLIDUS:{this.state=ee.SCRIPT_DATA_END_TAG_OPEN;break}case Q.EXCLAMATION_MARK:{this.state=ee.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=ee.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){Zs(e)?(this.state=ee.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=ee.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=ee.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===Q.HYPHEN_MINUS?(this.state=ee.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=ee.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===Q.HYPHEN_MINUS?(this.state=ee.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=ee.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case Q.HYPHEN_MINUS:{this.state=ee.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case Q.LESS_THAN_SIGN:{this.state=ee.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this._emitChars(tn);break}case Q.EOF:{this._err(Ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case Q.HYPHEN_MINUS:{this.state=ee.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case Q.LESS_THAN_SIGN:{this.state=ee.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this.state=ee.SCRIPT_DATA_ESCAPED,this._emitChars(tn);break}case Q.EOF:{this._err(Ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=ee.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case Q.HYPHEN_MINUS:{this._emitChars("-");break}case Q.LESS_THAN_SIGN:{this.state=ee.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case Q.GREATER_THAN_SIGN:{this.state=ee.SCRIPT_DATA,this._emitChars(">");break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this.state=ee.SCRIPT_DATA_ESCAPED,this._emitChars(tn);break}case Q.EOF:{this._err(Ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=ee.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===Q.SOLIDUS?this.state=ee.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:Zs(e)?(this._emitChars("<"),this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=ee.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){Zs(e)?(this.state=ee.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=ee.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=ee.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(si.SCRIPT,!1)&&lA(this.preprocessor.peek(si.SCRIPT.length))){this._emitCodePoint(e);for(let n=0;n<si.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=ee.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case Q.HYPHEN_MINUS:{this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case Q.LESS_THAN_SIGN:{this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this._emitChars(tn);break}case Q.EOF:{this._err(Ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case Q.HYPHEN_MINUS:{this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case Q.LESS_THAN_SIGN:{this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(tn);break}case Q.EOF:{this._err(Ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case Q.HYPHEN_MINUS:{this._emitChars("-");break}case Q.LESS_THAN_SIGN:{this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case Q.GREATER_THAN_SIGN:{this.state=ee.SCRIPT_DATA,this._emitChars(">");break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(tn);break}case Q.EOF:{this._err(Ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===Q.SOLIDUS?(this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(si.SCRIPT,!1)&&lA(this.preprocessor.peek(si.SCRIPT.length))){this._emitCodePoint(e);for(let n=0;n<si.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=ee.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=ee.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.SOLIDUS:case Q.GREATER_THAN_SIGN:case Q.EOF:{this.state=ee.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case Q.EQUALS_SIGN:{this._err(Ae.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=ee.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=ee.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:case Q.SOLIDUS:case Q.GREATER_THAN_SIGN:case Q.EOF:{this._leaveAttrName(),this.state=ee.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case Q.EQUALS_SIGN:{this._leaveAttrName(),this.state=ee.BEFORE_ATTRIBUTE_VALUE;break}case Q.QUOTATION_MARK:case Q.APOSTROPHE:case Q.LESS_THAN_SIGN:{this._err(Ae.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this.currentAttr.name+=tn;break}default:this.currentAttr.name+=String.fromCodePoint(cc(e)?wf(e):e)}}_stateAfterAttributeName(e){switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.SOLIDUS:{this.state=ee.SELF_CLOSING_START_TAG;break}case Q.EQUALS_SIGN:{this.state=ee.BEFORE_ATTRIBUTE_VALUE;break}case Q.GREATER_THAN_SIGN:{this.state=ee.DATA,this.emitCurrentTagToken();break}case Q.EOF:{this._err(Ae.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=ee.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.QUOTATION_MARK:{this.state=ee.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case Q.APOSTROPHE:{this.state=ee.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.missingAttributeValue),this.state=ee.DATA,this.emitCurrentTagToken();break}default:this.state=ee.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case Q.QUOTATION_MARK:{this.state=ee.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case Q.AMPERSAND:{this._startCharacterReference();break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this.currentAttr.value+=tn;break}case Q.EOF:{this._err(Ae.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case Q.APOSTROPHE:{this.state=ee.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case Q.AMPERSAND:{this._startCharacterReference();break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this.currentAttr.value+=tn;break}case Q.EOF:{this._err(Ae.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:{this._leaveAttrValue(),this.state=ee.BEFORE_ATTRIBUTE_NAME;break}case Q.AMPERSAND:{this._startCharacterReference();break}case Q.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=ee.DATA,this.emitCurrentTagToken();break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this.currentAttr.value+=tn;break}case Q.QUOTATION_MARK:case Q.APOSTROPHE:case Q.LESS_THAN_SIGN:case Q.EQUALS_SIGN:case Q.GRAVE_ACCENT:{this._err(Ae.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break}case Q.EOF:{this._err(Ae.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:{this._leaveAttrValue(),this.state=ee.BEFORE_ATTRIBUTE_NAME;break}case Q.SOLIDUS:{this._leaveAttrValue(),this.state=ee.SELF_CLOSING_START_TAG;break}case Q.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=ee.DATA,this.emitCurrentTagToken();break}case Q.EOF:{this._err(Ae.eofInTag),this._emitEOFToken();break}default:this._err(Ae.missingWhitespaceBetweenAttributes),this.state=ee.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case Q.GREATER_THAN_SIGN:{const n=this.currentToken;n.selfClosing=!0,this.state=ee.DATA,this.emitCurrentTagToken();break}case Q.EOF:{this._err(Ae.eofInTag),this._emitEOFToken();break}default:this._err(Ae.unexpectedSolidusInTag),this.state=ee.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const n=this.currentToken;switch(e){case Q.GREATER_THAN_SIGN:{this.state=ee.DATA,this.emitCurrentComment(n);break}case Q.EOF:{this.emitCurrentComment(n),this._emitEOFToken();break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),n.data+=tn;break}default:n.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(si.DASH_DASH,!0)?(this._createCommentToken(si.DASH_DASH.length+1),this.state=ee.COMMENT_START):this._consumeSequenceIfMatch(si.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(si.DOCTYPE.length+1),this.state=ee.DOCTYPE):this._consumeSequenceIfMatch(si.CDATA_START,!0)?this.inForeignNode?this.state=ee.CDATA_SECTION:(this._err(Ae.cdataInHtmlContent),this._createCommentToken(si.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=ee.BOGUS_COMMENT):this._ensureHibernation()||(this._err(Ae.incorrectlyOpenedComment),this._createCommentToken(2),this.state=ee.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case Q.HYPHEN_MINUS:{this.state=ee.COMMENT_START_DASH;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.abruptClosingOfEmptyComment),this.state=ee.DATA;const n=this.currentToken;this.emitCurrentComment(n);break}default:this.state=ee.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){const n=this.currentToken;switch(e){case Q.HYPHEN_MINUS:{this.state=ee.COMMENT_END;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.abruptClosingOfEmptyComment),this.state=ee.DATA,this.emitCurrentComment(n);break}case Q.EOF:{this._err(Ae.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=ee.COMMENT,this._stateComment(e)}}_stateComment(e){const n=this.currentToken;switch(e){case Q.HYPHEN_MINUS:{this.state=ee.COMMENT_END_DASH;break}case Q.LESS_THAN_SIGN:{n.data+="<",this.state=ee.COMMENT_LESS_THAN_SIGN;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),n.data+=tn;break}case Q.EOF:{this._err(Ae.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const n=this.currentToken;switch(e){case Q.EXCLAMATION_MARK:{n.data+="!",this.state=ee.COMMENT_LESS_THAN_SIGN_BANG;break}case Q.LESS_THAN_SIGN:{n.data+="<";break}default:this.state=ee.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===Q.HYPHEN_MINUS?this.state=ee.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=ee.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===Q.HYPHEN_MINUS?this.state=ee.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=ee.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==Q.GREATER_THAN_SIGN&&e!==Q.EOF&&this._err(Ae.nestedComment),this.state=ee.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){const n=this.currentToken;switch(e){case Q.HYPHEN_MINUS:{this.state=ee.COMMENT_END;break}case Q.EOF:{this._err(Ae.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=ee.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){const n=this.currentToken;switch(e){case Q.GREATER_THAN_SIGN:{this.state=ee.DATA,this.emitCurrentComment(n);break}case Q.EXCLAMATION_MARK:{this.state=ee.COMMENT_END_BANG;break}case Q.HYPHEN_MINUS:{n.data+="-";break}case Q.EOF:{this._err(Ae.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--",this.state=ee.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){const n=this.currentToken;switch(e){case Q.HYPHEN_MINUS:{n.data+="--!",this.state=ee.COMMENT_END_DASH;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.incorrectlyClosedComment),this.state=ee.DATA,this.emitCurrentComment(n);break}case Q.EOF:{this._err(Ae.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--!",this.state=ee.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:{this.state=ee.BEFORE_DOCTYPE_NAME;break}case Q.GREATER_THAN_SIGN:{this.state=ee.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break}case Q.EOF:{this._err(Ae.eofInDoctype),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(Ae.missingWhitespaceBeforeDoctypeName),this.state=ee.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(cc(e))this._createDoctypeToken(String.fromCharCode(wf(e))),this.state=ee.DOCTYPE_NAME;else switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.NULL:{this._err(Ae.unexpectedNullCharacter),this._createDoctypeToken(tn),this.state=ee.DOCTYPE_NAME;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.missingDoctypeName),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=ee.DATA;break}case Q.EOF:{this._err(Ae.eofInDoctype),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=ee.DOCTYPE_NAME}}_stateDoctypeName(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:{this.state=ee.AFTER_DOCTYPE_NAME;break}case Q.GREATER_THAN_SIGN:{this.state=ee.DATA,this.emitCurrentDoctype(n);break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),n.name+=tn;break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.name+=String.fromCodePoint(cc(e)?wf(e):e)}}_stateAfterDoctypeName(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.GREATER_THAN_SIGN:{this.state=ee.DATA,this.emitCurrentDoctype(n);break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(si.PUBLIC,!1)?this.state=ee.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(si.SYSTEM,!1)?this.state=ee.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(Ae.invalidCharacterSequenceAfterDoctypeName),n.forceQuirks=!0,this.state=ee.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:{this.state=ee.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case Q.QUOTATION_MARK:{this._err(Ae.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=ee.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case Q.APOSTROPHE:{this._err(Ae.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=ee.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=ee.DATA,this.emitCurrentDoctype(n);break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(Ae.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=ee.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.QUOTATION_MARK:{n.publicId="",this.state=ee.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case Q.APOSTROPHE:{n.publicId="",this.state=ee.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=ee.DATA,this.emitCurrentDoctype(n);break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(Ae.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=ee.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const n=this.currentToken;switch(e){case Q.QUOTATION_MARK:{this.state=ee.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),n.publicId+=tn;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=ee.DATA;break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const n=this.currentToken;switch(e){case Q.APOSTROPHE:{this.state=ee.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),n.publicId+=tn;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=ee.DATA;break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:{this.state=ee.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case Q.GREATER_THAN_SIGN:{this.state=ee.DATA,this.emitCurrentDoctype(n);break}case Q.QUOTATION_MARK:{this._err(Ae.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=ee.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case Q.APOSTROPHE:{this._err(Ae.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=ee.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(Ae.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=ee.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=ee.DATA;break}case Q.QUOTATION_MARK:{n.systemId="",this.state=ee.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case Q.APOSTROPHE:{n.systemId="",this.state=ee.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(Ae.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=ee.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:{this.state=ee.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case Q.QUOTATION_MARK:{this._err(Ae.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=ee.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case Q.APOSTROPHE:{this._err(Ae.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=ee.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=ee.DATA,this.emitCurrentDoctype(n);break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(Ae.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=ee.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.QUOTATION_MARK:{n.systemId="",this.state=ee.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case Q.APOSTROPHE:{n.systemId="",this.state=ee.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=ee.DATA,this.emitCurrentDoctype(n);break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(Ae.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=ee.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const n=this.currentToken;switch(e){case Q.QUOTATION_MARK:{this.state=ee.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),n.systemId+=tn;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=ee.DATA;break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const n=this.currentToken;switch(e){case Q.APOSTROPHE:{this.state=ee.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter),n.systemId+=tn;break}case Q.GREATER_THAN_SIGN:{this._err(Ae.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=ee.DATA;break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const n=this.currentToken;switch(e){case Q.SPACE:case Q.LINE_FEED:case Q.TABULATION:case Q.FORM_FEED:break;case Q.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=ee.DATA;break}case Q.EOF:{this._err(Ae.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(Ae.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=ee.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const n=this.currentToken;switch(e){case Q.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=ee.DATA;break}case Q.NULL:{this._err(Ae.unexpectedNullCharacter);break}case Q.EOF:{this.emitCurrentDoctype(n),this._emitEOFToken();break}}}_stateCdataSection(e){switch(e){case Q.RIGHT_SQUARE_BRACKET:{this.state=ee.CDATA_SECTION_BRACKET;break}case Q.EOF:{this._err(Ae.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===Q.RIGHT_SQUARE_BRACKET?this.state=ee.CDATA_SECTION_END:(this._emitChars("]"),this.state=ee.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case Q.GREATER_THAN_SIGN:{this.state=ee.DATA;break}case Q.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=ee.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(){let e=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(e<0)if(this.preprocessor.lastChunkWritten)e=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}e===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(Q.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&uA(this.preprocessor.peek(1))?ee.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(e){uA(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===Q.SEMICOLON&&this._err(Ae.unknownNamedCharacterReference),this.state=this.returnState,this._callState(e))}};const g6=new Set([_.DD,_.DT,_.LI,_.OPTGROUP,_.OPTION,_.P,_.RB,_.RP,_.RT,_.RTC]),cA=new Set([...g6,_.CAPTION,_.COLGROUP,_.TBODY,_.TD,_.TFOOT,_.TH,_.THEAD,_.TR]),Oh=new Set([_.APPLET,_.CAPTION,_.HTML,_.MARQUEE,_.OBJECT,_.TABLE,_.TD,_.TEMPLATE,_.TH]),m7=new Set([...Oh,_.OL,_.UL]),g7=new Set([...Oh,_.BUTTON]),dA=new Set([_.ANNOTATION_XML,_.MI,_.MN,_.MO,_.MS,_.MTEXT]),fA=new Set([_.DESC,_.FOREIGN_OBJECT,_.TITLE]),y7=new Set([_.TR,_.TEMPLATE,_.HTML]),v7=new Set([_.TBODY,_.TFOOT,_.THEAD,_.TEMPLATE,_.HTML]),b7=new Set([_.TABLE,_.TEMPLATE,_.HTML]),E7=new Set([_.TD,_.TH]);class T7{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,n,i){this.treeAdapter=n,this.handler=i,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=_.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===_.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===Ue.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,n){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=n,this.currentTagId=n,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,n,!0)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,n){const i=this._indexOf(e);this.items[i]=n,i===this.stackTop&&(this.current=n)}insertAfter(e,n,i){const r=this._indexOf(e)+1;this.items.splice(r,0,n),this.tagIDs.splice(r,0,i),this.stackTop++,r===this.stackTop&&this._updateCurrentElement(),this.current&&this.currentTagId!==void 0&&this.handler.onItemPush(this.current,this.currentTagId,r===this.stackTop)}popUntilTagNamePopped(e){let n=this.stackTop+1;do n=this.tagIDs.lastIndexOf(e,n-1);while(n>0&&this.treeAdapter.getNamespaceURI(this.items[n])!==Ue.HTML);this.shortenToLength(Math.max(n,0))}shortenToLength(e){for(;this.stackTop>=e;){const n=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(n,this.stackTop<e)}}popUntilElementPopped(e){const n=this._indexOf(e);this.shortenToLength(Math.max(n,0))}popUntilPopped(e,n){const i=this._indexOfTagNames(e,n);this.shortenToLength(Math.max(i,0))}popUntilNumberedHeaderPopped(){this.popUntilPopped(Iy,Ue.HTML)}popUntilTableCellPopped(){this.popUntilPopped(E7,Ue.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,n){for(let i=this.stackTop;i>=0;i--)if(e.has(this.tagIDs[i])&&this.treeAdapter.getNamespaceURI(this.items[i])===n)return i;return-1}clearBackTo(e,n){const i=this._indexOfTagNames(e,n);this.shortenToLength(i+1)}clearBackToTableContext(){this.clearBackTo(b7,Ue.HTML)}clearBackToTableBodyContext(){this.clearBackTo(v7,Ue.HTML)}clearBackToTableRowContext(){this.clearBackTo(y7,Ue.HTML)}remove(e){const n=this._indexOf(e);n>=0&&(n===this.stackTop?this.pop():(this.items.splice(n,1),this.tagIDs.splice(n,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===_.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const n=this._indexOf(e)-1;return n>=0?this.items[n]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===_.HTML}hasInDynamicScope(e,n){for(let i=this.stackTop;i>=0;i--){const r=this.tagIDs[i];switch(this.treeAdapter.getNamespaceURI(this.items[i])){case Ue.HTML:{if(r===e)return!0;if(n.has(r))return!1;break}case Ue.SVG:{if(fA.has(r))return!1;break}case Ue.MATHML:{if(dA.has(r))return!1;break}}}return!0}hasInScope(e){return this.hasInDynamicScope(e,Oh)}hasInListItemScope(e){return this.hasInDynamicScope(e,m7)}hasInButtonScope(e){return this.hasInDynamicScope(e,g7)}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const n=this.tagIDs[e];switch(this.treeAdapter.getNamespaceURI(this.items[e])){case Ue.HTML:{if(Iy.has(n))return!0;if(Oh.has(n))return!1;break}case Ue.SVG:{if(fA.has(n))return!1;break}case Ue.MATHML:{if(dA.has(n))return!1;break}}}return!0}hasInTableScope(e){for(let n=this.stackTop;n>=0;n--)if(this.treeAdapter.getNamespaceURI(this.items[n])===Ue.HTML)switch(this.tagIDs[n]){case e:return!0;case _.TABLE:case _.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--)if(this.treeAdapter.getNamespaceURI(this.items[e])===Ue.HTML)switch(this.tagIDs[e]){case _.TBODY:case _.THEAD:case _.TFOOT:return!0;case _.TABLE:case _.HTML:return!1}return!0}hasInSelectScope(e){for(let n=this.stackTop;n>=0;n--)if(this.treeAdapter.getNamespaceURI(this.items[n])===Ue.HTML)switch(this.tagIDs[n]){case e:return!0;case _.OPTION:case _.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;this.currentTagId!==void 0&&g6.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;this.currentTagId!==void 0&&cA.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==void 0&&this.currentTagId!==e&&cA.has(this.currentTagId);)this.pop()}}const pg=3;var Tr;(function(t){t[t.Marker=0]="Marker",t[t.Element=1]="Element"})(Tr||(Tr={}));const hA={type:Tr.Marker};class x7{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,n){const i=[],r=n.length,s=this.treeAdapter.getTagName(e),a=this.treeAdapter.getNamespaceURI(e);for(let o=0;o<this.entries.length;o++){const l=this.entries[o];if(l.type===Tr.Marker)break;const{element:u}=l;if(this.treeAdapter.getTagName(u)===s&&this.treeAdapter.getNamespaceURI(u)===a){const d=this.treeAdapter.getAttrList(u);d.length===r&&i.push({idx:o,attrs:d})}}return i}_ensureNoahArkCondition(e){if(this.entries.length<pg)return;const n=this.treeAdapter.getAttrList(e),i=this._getNoahArkConditionCandidates(e,n);if(i.length<pg)return;const r=new Map(n.map(a=>[a.name,a.value]));let s=0;for(let a=0;a<i.length;a++){const o=i[a];o.attrs.every(l=>r.get(l.name)===l.value)&&(s+=1,s>=pg&&this.entries.splice(o.idx,1))}}insertMarker(){this.entries.unshift(hA)}pushElement(e,n){this._ensureNoahArkCondition(e),this.entries.unshift({type:Tr.Element,element:e,token:n})}insertElementAfterBookmark(e,n){const i=this.entries.indexOf(this.bookmark);this.entries.splice(i,0,{type:Tr.Element,element:e,token:n})}removeEntry(e){const n=this.entries.indexOf(e);n!==-1&&this.entries.splice(n,1)}clearToLastMarker(){const e=this.entries.indexOf(hA);e===-1?this.entries.length=0:this.entries.splice(0,e+1)}getElementEntryInScopeWithTagName(e){const n=this.entries.find(i=>i.type===Tr.Marker||this.treeAdapter.getTagName(i.element)===e);return n&&n.type===Tr.Element?n:null}getElementEntry(e){return this.entries.find(n=>n.type===Tr.Element&&n.element===e)}}const Js={createDocument(){return{nodeName:"#document",mode:Vi.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(t,e,n){return{nodeName:t,tagName:t,attrs:n,namespaceURI:e,childNodes:[],parentNode:null}},createCommentNode(t){return{nodeName:"#comment",data:t,parentNode:null}},createTextNode(t){return{nodeName:"#text",value:t,parentNode:null}},appendChild(t,e){t.childNodes.push(e),e.parentNode=t},insertBefore(t,e,n){const i=t.childNodes.indexOf(n);t.childNodes.splice(i,0,e),e.parentNode=t},setTemplateContent(t,e){t.content=e},getTemplateContent(t){return t.content},setDocumentType(t,e,n,i){const r=t.childNodes.find(s=>s.nodeName==="#documentType");if(r)r.name=e,r.publicId=n,r.systemId=i;else{const s={nodeName:"#documentType",name:e,publicId:n,systemId:i,parentNode:null};Js.appendChild(t,s)}},setDocumentMode(t,e){t.mode=e},getDocumentMode(t){return t.mode},detachNode(t){if(t.parentNode){const e=t.parentNode.childNodes.indexOf(t);t.parentNode.childNodes.splice(e,1),t.parentNode=null}},insertText(t,e){if(t.childNodes.length>0){const n=t.childNodes[t.childNodes.length-1];if(Js.isTextNode(n)){n.value+=e;return}}Js.appendChild(t,Js.createTextNode(e))},insertTextBefore(t,e,n){const i=t.childNodes[t.childNodes.indexOf(n)-1];i&&Js.isTextNode(i)?i.value+=e:Js.insertBefore(t,Js.createTextNode(e),n)},adoptAttributes(t,e){const n=new Set(t.attrs.map(i=>i.name));for(let i=0;i<e.length;i++)n.has(e[i].name)||t.attrs.push(e[i])},getFirstChild(t){return t.childNodes[0]},getChildNodes(t){return t.childNodes},getParentNode(t){return t.parentNode},getAttrList(t){return t.attrs},getTagName(t){return t.tagName},getNamespaceURI(t){return t.namespaceURI},getTextNodeContent(t){return t.value},getCommentNodeContent(t){return t.data},getDocumentTypeNodeName(t){return t.name},getDocumentTypeNodePublicId(t){return t.publicId},getDocumentTypeNodeSystemId(t){return t.systemId},isTextNode(t){return t.nodeName==="#text"},isCommentNode(t){return t.nodeName==="#comment"},isDocumentTypeNode(t){return t.nodeName==="#documentType"},isElementNode(t){return Object.prototype.hasOwnProperty.call(t,"tagName")},setNodeSourceCodeLocation(t,e){t.sourceCodeLocation=e},getNodeSourceCodeLocation(t){return t.sourceCodeLocation},updateNodeSourceCodeLocation(t,e){t.sourceCodeLocation={...t.sourceCodeLocation,...e}}},y6="html",S7="about:legacy-compat",A7="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",v6=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],w7=[...v6,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],C7=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),b6=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],R7=[...b6,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function pA(t,e){return e.some(n=>t.startsWith(n))}function _7(t){return t.name===y6&&t.publicId===null&&(t.systemId===null||t.systemId===S7)}function I7(t){if(t.name!==y6)return Vi.QUIRKS;const{systemId:e}=t;if(e&&e.toLowerCase()===A7)return Vi.QUIRKS;let{publicId:n}=t;if(n!==null){if(n=n.toLowerCase(),C7.has(n))return Vi.QUIRKS;let i=e===null?w7:v6;if(pA(n,i))return Vi.QUIRKS;if(i=e===null?b6:R7,pA(n,i))return Vi.LIMITED_QUIRKS}return Vi.NO_QUIRKS}const mA={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},L7="definitionurl",D7="definitionURL",O7=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(t=>[t.toLowerCase(),t])),P7=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:Ue.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:Ue.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:Ue.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:Ue.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:Ue.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:Ue.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:Ue.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:Ue.XML}],["xml:space",{prefix:"xml",name:"space",namespace:Ue.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:Ue.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:Ue.XMLNS}]]),k7=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(t=>[t.toLowerCase(),t])),N7=new Set([_.B,_.BIG,_.BLOCKQUOTE,_.BODY,_.BR,_.CENTER,_.CODE,_.DD,_.DIV,_.DL,_.DT,_.EM,_.EMBED,_.H1,_.H2,_.H3,_.H4,_.H5,_.H6,_.HEAD,_.HR,_.I,_.IMG,_.LI,_.LISTING,_.MENU,_.META,_.NOBR,_.OL,_.P,_.PRE,_.RUBY,_.S,_.SMALL,_.SPAN,_.STRONG,_.STRIKE,_.SUB,_.SUP,_.TABLE,_.TT,_.U,_.UL,_.VAR]);function M7(t){const e=t.tagID;return e===_.FONT&&t.attrs.some(({name:i})=>i===ro.COLOR||i===ro.SIZE||i===ro.FACE)||N7.has(e)}function E6(t){for(let e=0;e<t.attrs.length;e++)if(t.attrs[e].name===L7){t.attrs[e].name=D7;break}}function T6(t){for(let e=0;e<t.attrs.length;e++){const n=O7.get(t.attrs[e].name);n!=null&&(t.attrs[e].name=n)}}function Jv(t){for(let e=0;e<t.attrs.length;e++){const n=P7.get(t.attrs[e].name);n&&(t.attrs[e].prefix=n.prefix,t.attrs[e].name=n.name,t.attrs[e].namespace=n.namespace)}}function B7(t){const e=k7.get(t.tagName);e!=null&&(t.tagName=e,t.tagID=Xu(t.tagName))}function F7(t,e){return e===Ue.MATHML&&(t===_.MI||t===_.MO||t===_.MN||t===_.MS||t===_.MTEXT)}function U7(t,e,n){if(e===Ue.MATHML&&t===_.ANNOTATION_XML){for(let i=0;i<n.length;i++)if(n[i].name===ro.ENCODING){const r=n[i].value.toLowerCase();return r===mA.TEXT_HTML||r===mA.APPLICATION_XML}}return e===Ue.SVG&&(t===_.FOREIGN_OBJECT||t===_.DESC||t===_.TITLE)}function H7(t,e,n,i){return(!i||i===Ue.HTML)&&U7(t,e,n)||(!i||i===Ue.MATHML)&&F7(t,e)}const z7="hidden",q7=8,V7=3;var re;(function(t){t[t.INITIAL=0]="INITIAL",t[t.BEFORE_HTML=1]="BEFORE_HTML",t[t.BEFORE_HEAD=2]="BEFORE_HEAD",t[t.IN_HEAD=3]="IN_HEAD",t[t.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",t[t.AFTER_HEAD=5]="AFTER_HEAD",t[t.IN_BODY=6]="IN_BODY",t[t.TEXT=7]="TEXT",t[t.IN_TABLE=8]="IN_TABLE",t[t.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",t[t.IN_CAPTION=10]="IN_CAPTION",t[t.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",t[t.IN_TABLE_BODY=12]="IN_TABLE_BODY",t[t.IN_ROW=13]="IN_ROW",t[t.IN_CELL=14]="IN_CELL",t[t.IN_SELECT=15]="IN_SELECT",t[t.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",t[t.IN_TEMPLATE=17]="IN_TEMPLATE",t[t.AFTER_BODY=18]="AFTER_BODY",t[t.IN_FRAMESET=19]="IN_FRAMESET",t[t.AFTER_FRAMESET=20]="AFTER_FRAMESET",t[t.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",t[t.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(re||(re={}));const G7={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},x6=new Set([_.TABLE,_.TBODY,_.TFOOT,_.THEAD,_.TR]),gA={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Js,onParseError:null};let yA=class{constructor(e,n,i=null,r=null){this.fragmentContext=i,this.scriptHandler=r,this.currentToken=null,this.stopped=!1,this.insertionMode=re.INITIAL,this.originalInsertionMode=re.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...gA,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=n??this.treeAdapter.createDocument(),this.tokenizer=new p7(this.options,this),this.activeFormattingElements=new x7(this.treeAdapter),this.fragmentContextID=i?Xu(this.treeAdapter.getTagName(i)):_.UNKNOWN,this._setContextModes(i??this.document,this.fragmentContextID),this.openElements=new T7(this.document,this.treeAdapter,this)}static parse(e,n){const i=new this(n);return i.tokenizer.write(e,!0),i.document}static getFragmentParser(e,n){const i={...gA,...n};e??(e=i.treeAdapter.createElement(ge.TEMPLATE,Ue.HTML,[]));const r=i.treeAdapter.createElement("documentmock",Ue.HTML,[]),s=new this(i,r,e);return s.fragmentContextID===_.TEMPLATE&&s.tmplInsertionModeStack.unshift(re.IN_TEMPLATE),s._initTokenizerForFragmentParsing(),s._insertFakeRootElement(),s._resetInsertionMode(),s._findFormInFragmentContext(),s}getFragment(){const e=this.treeAdapter.getFirstChild(this.document),n=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,n),n}_err(e,n,i){var r;if(!this.onParseError)return;const s=(r=e.location)!==null&&r!==void 0?r:G7,a={code:n,startLine:s.startLine,startCol:s.startCol,startOffset:s.startOffset,endLine:i?s.startLine:s.endLine,endCol:i?s.startCol:s.endCol,endOffset:i?s.startOffset:s.endOffset};this.onParseError(a)}onItemPush(e,n,i){var r,s;(s=(r=this.treeAdapter).onItemPush)===null||s===void 0||s.call(r,e),i&&this.openElements.stackTop>0&&this._setContextModes(e,n)}onItemPop(e,n){var i,r;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),(r=(i=this.treeAdapter).onItemPop)===null||r===void 0||r.call(i,e,this.openElements.current),n){let s,a;this.openElements.stackTop===0&&this.fragmentContext?(s=this.fragmentContext,a=this.fragmentContextID):{current:s,currentTagId:a}=this.openElements,this._setContextModes(s,a)}}_setContextModes(e,n){const i=e===this.document||e&&this.treeAdapter.getNamespaceURI(e)===Ue.HTML;this.currentNotInHTML=!i,this.tokenizer.inForeignNode=!i&&e!==void 0&&n!==void 0&&!this._isIntegrationPoint(n,e)}_switchToTextParsing(e,n){this._insertElement(e,Ue.HTML),this.tokenizer.state=n,this.originalInsertionMode=this.insertionMode,this.insertionMode=re.TEXT}switchToPlaintextParsing(){this.insertionMode=re.TEXT,this.originalInsertionMode=re.IN_BODY,this.tokenizer.state=hn.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===ge.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==Ue.HTML))switch(this.fragmentContextID){case _.TITLE:case _.TEXTAREA:{this.tokenizer.state=hn.RCDATA;break}case _.STYLE:case _.XMP:case _.IFRAME:case _.NOEMBED:case _.NOFRAMES:case _.NOSCRIPT:{this.tokenizer.state=hn.RAWTEXT;break}case _.SCRIPT:{this.tokenizer.state=hn.SCRIPT_DATA;break}case _.PLAINTEXT:{this.tokenizer.state=hn.PLAINTEXT;break}}}_setDocumentType(e){const n=e.name||"",i=e.publicId||"",r=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,n,i,r),e.location){const a=this.treeAdapter.getChildNodes(this.document).find(o=>this.treeAdapter.isDocumentTypeNode(o));a&&this.treeAdapter.setNodeSourceCodeLocation(a,e.location)}}_attachElementToTree(e,n){if(this.options.sourceCodeLocationInfo){const i=n&&{...n,startTag:n};this.treeAdapter.setNodeSourceCodeLocation(e,i)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const i=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(i??this.document,e)}}_appendElement(e,n){const i=this.treeAdapter.createElement(e.tagName,n,e.attrs);this._attachElementToTree(i,e.location)}_insertElement(e,n){const i=this.treeAdapter.createElement(e.tagName,n,e.attrs);this._attachElementToTree(i,e.location),this.openElements.push(i,e.tagID)}_insertFakeElement(e,n){const i=this.treeAdapter.createElement(e,Ue.HTML,[]);this._attachElementToTree(i,null),this.openElements.push(i,n)}_insertTemplate(e){const n=this.treeAdapter.createElement(e.tagName,Ue.HTML,e.attrs),i=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(n,i),this._attachElementToTree(n,e.location),this.openElements.push(n,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(ge.HTML,Ue.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,_.HTML)}_appendCommentNode(e,n){const i=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(n,i),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,e.location)}_insertCharacters(e){let n,i;if(this._shouldFosterParentOnInsertion()?({parent:n,beforeElement:i}=this._findFosterParentingLocation(),i?this.treeAdapter.insertTextBefore(n,e.chars,i):this.treeAdapter.insertText(n,e.chars)):(n=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(n,e.chars)),!e.location)return;const r=this.treeAdapter.getChildNodes(n),s=i?r.lastIndexOf(i):r.length,a=r[s-1];if(this.treeAdapter.getNodeSourceCodeLocation(a)){const{endLine:l,endCol:u,endOffset:d}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(a,{endLine:l,endCol:u,endOffset:d})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(a,e.location)}_adoptNodes(e,n){for(let i=this.treeAdapter.getFirstChild(e);i;i=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(i),this.treeAdapter.appendChild(n,i)}_setEndLocation(e,n){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&n.location){const i=n.location,r=this.treeAdapter.getTagName(e),s=n.type===wt.END_TAG&&r===n.tagName?{endTag:{...i},endLine:i.endLine,endCol:i.endCol,endOffset:i.endOffset}:{endLine:i.startLine,endCol:i.startCol,endOffset:i.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,s)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let n,i;return this.openElements.stackTop===0&&this.fragmentContext?(n=this.fragmentContext,i=this.fragmentContextID):{current:n,currentTagId:i}=this.openElements,e.tagID===_.SVG&&this.treeAdapter.getTagName(n)===ge.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(n)===Ue.MATHML?!1:this.tokenizer.inForeignNode||(e.tagID===_.MGLYPH||e.tagID===_.MALIGNMARK)&&i!==void 0&&!this._isIntegrationPoint(i,n,Ue.HTML)}_processToken(e){switch(e.type){case wt.CHARACTER:{this.onCharacter(e);break}case wt.NULL_CHARACTER:{this.onNullCharacter(e);break}case wt.COMMENT:{this.onComment(e);break}case wt.DOCTYPE:{this.onDoctype(e);break}case wt.START_TAG:{this._processStartTag(e);break}case wt.END_TAG:{this.onEndTag(e);break}case wt.EOF:{this.onEof(e);break}case wt.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(e);break}}}_isIntegrationPoint(e,n,i){const r=this.treeAdapter.getNamespaceURI(n),s=this.treeAdapter.getAttrList(n);return H7(e,r,s,i)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const n=this.activeFormattingElements.entries.findIndex(r=>r.type===Tr.Marker||this.openElements.contains(r.element)),i=n===-1?e-1:n-1;for(let r=i;r>=0;r--){const s=this.activeFormattingElements.entries[r];this._insertElement(s.token,this.treeAdapter.getNamespaceURI(s.element)),s.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=re.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(_.P),this.openElements.popUntilTagNamePopped(_.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case _.TR:{this.insertionMode=re.IN_ROW;return}case _.TBODY:case _.THEAD:case _.TFOOT:{this.insertionMode=re.IN_TABLE_BODY;return}case _.CAPTION:{this.insertionMode=re.IN_CAPTION;return}case _.COLGROUP:{this.insertionMode=re.IN_COLUMN_GROUP;return}case _.TABLE:{this.insertionMode=re.IN_TABLE;return}case _.BODY:{this.insertionMode=re.IN_BODY;return}case _.FRAMESET:{this.insertionMode=re.IN_FRAMESET;return}case _.SELECT:{this._resetInsertionModeForSelect(e);return}case _.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case _.HTML:{this.insertionMode=this.headElement?re.AFTER_HEAD:re.BEFORE_HEAD;return}case _.TD:case _.TH:{if(e>0){this.insertionMode=re.IN_CELL;return}break}case _.HEAD:{if(e>0){this.insertionMode=re.IN_HEAD;return}break}}this.insertionMode=re.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let n=e-1;n>0;n--){const i=this.openElements.tagIDs[n];if(i===_.TEMPLATE)break;if(i===_.TABLE){this.insertionMode=re.IN_SELECT_IN_TABLE;return}}this.insertionMode=re.IN_SELECT}_isElementCausesFosterParenting(e){return x6.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this.openElements.currentTagId!==void 0&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const n=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case _.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(n)===Ue.HTML)return{parent:this.treeAdapter.getTemplateContent(n),beforeElement:null};break}case _.TABLE:{const i=this.treeAdapter.getParentNode(n);return i?{parent:i,beforeElement:n}:{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const n=this._findFosterParentingLocation();n.beforeElement?this.treeAdapter.insertBefore(n.parent,e,n.beforeElement):this.treeAdapter.appendChild(n.parent,e)}_isSpecialElement(e,n){const i=this.treeAdapter.getNamespaceURI(e);return c7[i].has(n)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){EH(this,e);return}switch(this.insertionMode){case re.INITIAL:{ic(this,e);break}case re.BEFORE_HTML:{bc(this,e);break}case re.BEFORE_HEAD:{Ec(this,e);break}case re.IN_HEAD:{Tc(this,e);break}case re.IN_HEAD_NO_SCRIPT:{xc(this,e);break}case re.AFTER_HEAD:{Sc(this,e);break}case re.IN_BODY:case re.IN_CAPTION:case re.IN_CELL:case re.IN_TEMPLATE:{A6(this,e);break}case re.TEXT:case re.IN_SELECT:case re.IN_SELECT_IN_TABLE:{this._insertCharacters(e);break}case re.IN_TABLE:case re.IN_TABLE_BODY:case re.IN_ROW:{mg(this,e);break}case re.IN_TABLE_TEXT:{L6(this,e);break}case re.IN_COLUMN_GROUP:{Ph(this,e);break}case re.AFTER_BODY:{kh(this,e);break}case re.AFTER_AFTER_BODY:{dh(this,e);break}}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){bH(this,e);return}switch(this.insertionMode){case re.INITIAL:{ic(this,e);break}case re.BEFORE_HTML:{bc(this,e);break}case re.BEFORE_HEAD:{Ec(this,e);break}case re.IN_HEAD:{Tc(this,e);break}case re.IN_HEAD_NO_SCRIPT:{xc(this,e);break}case re.AFTER_HEAD:{Sc(this,e);break}case re.TEXT:{this._insertCharacters(e);break}case re.IN_TABLE:case re.IN_TABLE_BODY:case re.IN_ROW:{mg(this,e);break}case re.IN_COLUMN_GROUP:{Ph(this,e);break}case re.AFTER_BODY:{kh(this,e);break}case re.AFTER_AFTER_BODY:{dh(this,e);break}}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML){Ly(this,e);return}switch(this.insertionMode){case re.INITIAL:case re.BEFORE_HTML:case re.BEFORE_HEAD:case re.IN_HEAD:case re.IN_HEAD_NO_SCRIPT:case re.AFTER_HEAD:case re.IN_BODY:case re.IN_TABLE:case re.IN_CAPTION:case re.IN_COLUMN_GROUP:case re.IN_TABLE_BODY:case re.IN_ROW:case re.IN_CELL:case re.IN_SELECT:case re.IN_SELECT_IN_TABLE:case re.IN_TEMPLATE:case re.IN_FRAMESET:case re.AFTER_FRAMESET:{Ly(this,e);break}case re.IN_TABLE_TEXT:{rc(this,e);break}case re.AFTER_BODY:{Q7(this,e);break}case re.AFTER_AFTER_BODY:case re.AFTER_AFTER_FRAMESET:{Z7(this,e);break}}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case re.INITIAL:{J7(this,e);break}case re.BEFORE_HEAD:case re.IN_HEAD:case re.IN_HEAD_NO_SCRIPT:case re.AFTER_HEAD:{this._err(e,Ae.misplacedDoctype);break}case re.IN_TABLE_TEXT:{rc(this,e);break}}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,Ae.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?TH(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case re.INITIAL:{ic(this,e);break}case re.BEFORE_HTML:{eU(this,e);break}case re.BEFORE_HEAD:{nU(this,e);break}case re.IN_HEAD:{cr(this,e);break}case re.IN_HEAD_NO_SCRIPT:{sU(this,e);break}case re.AFTER_HEAD:{oU(this,e);break}case re.IN_BODY:{$n(this,e);break}case re.IN_TABLE:{Hu(this,e);break}case re.IN_TABLE_TEXT:{rc(this,e);break}case re.IN_CAPTION:{iH(this,e);break}case re.IN_COLUMN_GROUP:{nb(this,e);break}case re.IN_TABLE_BODY:{l0(this,e);break}case re.IN_ROW:{c0(this,e);break}case re.IN_CELL:{aH(this,e);break}case re.IN_SELECT:{P6(this,e);break}case re.IN_SELECT_IN_TABLE:{uH(this,e);break}case re.IN_TEMPLATE:{cH(this,e);break}case re.AFTER_BODY:{fH(this,e);break}case re.IN_FRAMESET:{hH(this,e);break}case re.AFTER_FRAMESET:{mH(this,e);break}case re.AFTER_AFTER_BODY:{yH(this,e);break}case re.AFTER_AFTER_FRAMESET:{vH(this,e);break}}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?xH(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case re.INITIAL:{ic(this,e);break}case re.BEFORE_HTML:{tU(this,e);break}case re.BEFORE_HEAD:{iU(this,e);break}case re.IN_HEAD:{rU(this,e);break}case re.IN_HEAD_NO_SCRIPT:{aU(this,e);break}case re.AFTER_HEAD:{uU(this,e);break}case re.IN_BODY:{u0(this,e);break}case re.TEXT:{$U(this,e);break}case re.IN_TABLE:{kc(this,e);break}case re.IN_TABLE_TEXT:{rc(this,e);break}case re.IN_CAPTION:{rH(this,e);break}case re.IN_COLUMN_GROUP:{sH(this,e);break}case re.IN_TABLE_BODY:{Dy(this,e);break}case re.IN_ROW:{O6(this,e);break}case re.IN_CELL:{oH(this,e);break}case re.IN_SELECT:{k6(this,e);break}case re.IN_SELECT_IN_TABLE:{lH(this,e);break}case re.IN_TEMPLATE:{dH(this,e);break}case re.AFTER_BODY:{M6(this,e);break}case re.IN_FRAMESET:{pH(this,e);break}case re.AFTER_FRAMESET:{gH(this,e);break}case re.AFTER_AFTER_BODY:{dh(this,e);break}}}onEof(e){switch(this.insertionMode){case re.INITIAL:{ic(this,e);break}case re.BEFORE_HTML:{bc(this,e);break}case re.BEFORE_HEAD:{Ec(this,e);break}case re.IN_HEAD:{Tc(this,e);break}case re.IN_HEAD_NO_SCRIPT:{xc(this,e);break}case re.AFTER_HEAD:{Sc(this,e);break}case re.IN_BODY:case re.IN_TABLE:case re.IN_CAPTION:case re.IN_COLUMN_GROUP:case re.IN_TABLE_BODY:case re.IN_ROW:case re.IN_CELL:case re.IN_SELECT:case re.IN_SELECT_IN_TABLE:{_6(this,e);break}case re.TEXT:{YU(this,e);break}case re.IN_TABLE_TEXT:{rc(this,e);break}case re.IN_TEMPLATE:{N6(this,e);break}case re.AFTER_BODY:case re.IN_FRAMESET:case re.AFTER_FRAMESET:case re.AFTER_AFTER_BODY:case re.AFTER_AFTER_FRAMESET:{tb(this,e);break}}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===Q.LINE_FEED)){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(e);return}switch(this.insertionMode){case re.IN_HEAD:case re.IN_HEAD_NO_SCRIPT:case re.AFTER_HEAD:case re.TEXT:case re.IN_COLUMN_GROUP:case re.IN_SELECT:case re.IN_SELECT_IN_TABLE:case re.IN_FRAMESET:case re.AFTER_FRAMESET:{this._insertCharacters(e);break}case re.IN_BODY:case re.IN_CAPTION:case re.IN_CELL:case re.IN_TEMPLATE:case re.AFTER_BODY:case re.AFTER_AFTER_BODY:case re.AFTER_AFTER_FRAMESET:{S6(this,e);break}case re.IN_TABLE:case re.IN_TABLE_BODY:case re.IN_ROW:{mg(this,e);break}case re.IN_TABLE_TEXT:{I6(this,e);break}}}};function j7(t,e){let n=t.activeFormattingElements.getElementEntryInScopeWithTagName(e.tagName);return n?t.openElements.contains(n.element)?t.openElements.hasInScope(e.tagID)||(n=null):(t.activeFormattingElements.removeEntry(n),n=null):R6(t,e),n}function W7(t,e){let n=null,i=t.openElements.stackTop;for(;i>=0;i--){const r=t.openElements.items[i];if(r===e.element)break;t._isSpecialElement(r,t.openElements.tagIDs[i])&&(n=r)}return n||(t.openElements.shortenToLength(Math.max(i,0)),t.activeFormattingElements.removeEntry(e)),n}function $7(t,e,n){let i=e,r=t.openElements.getCommonAncestor(e);for(let s=0,a=r;a!==n;s++,a=r){r=t.openElements.getCommonAncestor(a);const o=t.activeFormattingElements.getElementEntry(a),l=o&&s>=V7;!o||l?(l&&t.activeFormattingElements.removeEntry(o),t.openElements.remove(a)):(a=Y7(t,o),i===e&&(t.activeFormattingElements.bookmark=o),t.treeAdapter.detachNode(i),t.treeAdapter.appendChild(a,i),i=a)}return i}function Y7(t,e){const n=t.treeAdapter.getNamespaceURI(e.element),i=t.treeAdapter.createElement(e.token.tagName,n,e.token.attrs);return t.openElements.replace(e.element,i),e.element=i,i}function K7(t,e,n){const i=t.treeAdapter.getTagName(e),r=Xu(i);if(t._isElementCausesFosterParenting(r))t._fosterParentElement(n);else{const s=t.treeAdapter.getNamespaceURI(e);r===_.TEMPLATE&&s===Ue.HTML&&(e=t.treeAdapter.getTemplateContent(e)),t.treeAdapter.appendChild(e,n)}}function X7(t,e,n){const i=t.treeAdapter.getNamespaceURI(n.element),{token:r}=n,s=t.treeAdapter.createElement(r.tagName,i,r.attrs);t._adoptNodes(e,s),t.treeAdapter.appendChild(e,s),t.activeFormattingElements.insertElementAfterBookmark(s,r),t.activeFormattingElements.removeEntry(n),t.openElements.remove(n.element),t.openElements.insertAfter(e,s,r.tagID)}function eb(t,e){for(let n=0;n<q7;n++){const i=j7(t,e);if(!i)break;const r=W7(t,i);if(!r)break;t.activeFormattingElements.bookmark=i;const s=$7(t,r,i.element),a=t.openElements.getCommonAncestor(i.element);t.treeAdapter.detachNode(s),a&&K7(t,a,s),X7(t,r,i)}}function Ly(t,e){t._appendCommentNode(e,t.openElements.currentTmplContentOrNode)}function Q7(t,e){t._appendCommentNode(e,t.openElements.items[0])}function Z7(t,e){t._appendCommentNode(e,t.document)}function tb(t,e){if(t.stopped=!0,e.location){const n=t.fragmentContext?0:2;for(let i=t.openElements.stackTop;i>=n;i--)t._setEndLocation(t.openElements.items[i],e);if(!t.fragmentContext&&t.openElements.stackTop>=0){const i=t.openElements.items[0],r=t.treeAdapter.getNodeSourceCodeLocation(i);if(r&&!r.endTag&&(t._setEndLocation(i,e),t.openElements.stackTop>=1)){const s=t.openElements.items[1],a=t.treeAdapter.getNodeSourceCodeLocation(s);a&&!a.endTag&&t._setEndLocation(s,e)}}}}function J7(t,e){t._setDocumentType(e);const n=e.forceQuirks?Vi.QUIRKS:I7(e);_7(e)||t._err(e,Ae.nonConformingDoctype),t.treeAdapter.setDocumentMode(t.document,n),t.insertionMode=re.BEFORE_HTML}function ic(t,e){t._err(e,Ae.missingDoctype,!0),t.treeAdapter.setDocumentMode(t.document,Vi.QUIRKS),t.insertionMode=re.BEFORE_HTML,t._processToken(e)}function eU(t,e){e.tagID===_.HTML?(t._insertElement(e,Ue.HTML),t.insertionMode=re.BEFORE_HEAD):bc(t,e)}function tU(t,e){const n=e.tagID;(n===_.HTML||n===_.HEAD||n===_.BODY||n===_.BR)&&bc(t,e)}function bc(t,e){t._insertFakeRootElement(),t.insertionMode=re.BEFORE_HEAD,t._processToken(e)}function nU(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.HEAD:{t._insertElement(e,Ue.HTML),t.headElement=t.openElements.current,t.insertionMode=re.IN_HEAD;break}default:Ec(t,e)}}function iU(t,e){const n=e.tagID;n===_.HEAD||n===_.BODY||n===_.HTML||n===_.BR?Ec(t,e):t._err(e,Ae.endTagWithoutMatchingOpenElement)}function Ec(t,e){t._insertFakeElement(ge.HEAD,_.HEAD),t.headElement=t.openElements.current,t.insertionMode=re.IN_HEAD,t._processToken(e)}function cr(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.BASE:case _.BASEFONT:case _.BGSOUND:case _.LINK:case _.META:{t._appendElement(e,Ue.HTML),e.ackSelfClosing=!0;break}case _.TITLE:{t._switchToTextParsing(e,hn.RCDATA);break}case _.NOSCRIPT:{t.options.scriptingEnabled?t._switchToTextParsing(e,hn.RAWTEXT):(t._insertElement(e,Ue.HTML),t.insertionMode=re.IN_HEAD_NO_SCRIPT);break}case _.NOFRAMES:case _.STYLE:{t._switchToTextParsing(e,hn.RAWTEXT);break}case _.SCRIPT:{t._switchToTextParsing(e,hn.SCRIPT_DATA);break}case _.TEMPLATE:{t._insertTemplate(e),t.activeFormattingElements.insertMarker(),t.framesetOk=!1,t.insertionMode=re.IN_TEMPLATE,t.tmplInsertionModeStack.unshift(re.IN_TEMPLATE);break}case _.HEAD:{t._err(e,Ae.misplacedStartTagForHeadElement);break}default:Tc(t,e)}}function rU(t,e){switch(e.tagID){case _.HEAD:{t.openElements.pop(),t.insertionMode=re.AFTER_HEAD;break}case _.BODY:case _.BR:case _.HTML:{Tc(t,e);break}case _.TEMPLATE:{yo(t,e);break}default:t._err(e,Ae.endTagWithoutMatchingOpenElement)}}function yo(t,e){t.openElements.tmplCount>0?(t.openElements.generateImpliedEndTagsThoroughly(),t.openElements.currentTagId!==_.TEMPLATE&&t._err(e,Ae.closingOfElementWithOpenChildElements),t.openElements.popUntilTagNamePopped(_.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode()):t._err(e,Ae.endTagWithoutMatchingOpenElement)}function Tc(t,e){t.openElements.pop(),t.insertionMode=re.AFTER_HEAD,t._processToken(e)}function sU(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.BASEFONT:case _.BGSOUND:case _.HEAD:case _.LINK:case _.META:case _.NOFRAMES:case _.STYLE:{cr(t,e);break}case _.NOSCRIPT:{t._err(e,Ae.nestedNoscriptInHead);break}default:xc(t,e)}}function aU(t,e){switch(e.tagID){case _.NOSCRIPT:{t.openElements.pop(),t.insertionMode=re.IN_HEAD;break}case _.BR:{xc(t,e);break}default:t._err(e,Ae.endTagWithoutMatchingOpenElement)}}function xc(t,e){const n=e.type===wt.EOF?Ae.openElementsLeftAfterEof:Ae.disallowedContentInNoscriptInHead;t._err(e,n),t.openElements.pop(),t.insertionMode=re.IN_HEAD,t._processToken(e)}function oU(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.BODY:{t._insertElement(e,Ue.HTML),t.framesetOk=!1,t.insertionMode=re.IN_BODY;break}case _.FRAMESET:{t._insertElement(e,Ue.HTML),t.insertionMode=re.IN_FRAMESET;break}case _.BASE:case _.BASEFONT:case _.BGSOUND:case _.LINK:case _.META:case _.NOFRAMES:case _.SCRIPT:case _.STYLE:case _.TEMPLATE:case _.TITLE:{t._err(e,Ae.abandonedHeadElementChild),t.openElements.push(t.headElement,_.HEAD),cr(t,e),t.openElements.remove(t.headElement);break}case _.HEAD:{t._err(e,Ae.misplacedStartTagForHeadElement);break}default:Sc(t,e)}}function uU(t,e){switch(e.tagID){case _.BODY:case _.HTML:case _.BR:{Sc(t,e);break}case _.TEMPLATE:{yo(t,e);break}default:t._err(e,Ae.endTagWithoutMatchingOpenElement)}}function Sc(t,e){t._insertFakeElement(ge.BODY,_.BODY),t.insertionMode=re.IN_BODY,o0(t,e)}function o0(t,e){switch(e.type){case wt.CHARACTER:{A6(t,e);break}case wt.WHITESPACE_CHARACTER:{S6(t,e);break}case wt.COMMENT:{Ly(t,e);break}case wt.START_TAG:{$n(t,e);break}case wt.END_TAG:{u0(t,e);break}case wt.EOF:{_6(t,e);break}}}function S6(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e)}function A6(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e),t.framesetOk=!1}function lU(t,e){t.openElements.tmplCount===0&&t.treeAdapter.adoptAttributes(t.openElements.items[0],e.attrs)}function cU(t,e){const n=t.openElements.tryPeekProperlyNestedBodyElement();n&&t.openElements.tmplCount===0&&(t.framesetOk=!1,t.treeAdapter.adoptAttributes(n,e.attrs))}function dU(t,e){const n=t.openElements.tryPeekProperlyNestedBodyElement();t.framesetOk&&n&&(t.treeAdapter.detachNode(n),t.openElements.popAllUpToHtmlElement(),t._insertElement(e,Ue.HTML),t.insertionMode=re.IN_FRAMESET)}function fU(t,e){t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t._insertElement(e,Ue.HTML)}function hU(t,e){t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t.openElements.currentTagId!==void 0&&Iy.has(t.openElements.currentTagId)&&t.openElements.pop(),t._insertElement(e,Ue.HTML)}function pU(t,e){t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t._insertElement(e,Ue.HTML),t.skipNextNewLine=!0,t.framesetOk=!1}function mU(t,e){const n=t.openElements.tmplCount>0;(!t.formElement||n)&&(t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t._insertElement(e,Ue.HTML),n||(t.formElement=t.openElements.current))}function gU(t,e){t.framesetOk=!1;const n=e.tagID;for(let i=t.openElements.stackTop;i>=0;i--){const r=t.openElements.tagIDs[i];if(n===_.LI&&r===_.LI||(n===_.DD||n===_.DT)&&(r===_.DD||r===_.DT)){t.openElements.generateImpliedEndTagsWithExclusion(r),t.openElements.popUntilTagNamePopped(r);break}if(r!==_.ADDRESS&&r!==_.DIV&&r!==_.P&&t._isSpecialElement(t.openElements.items[i],r))break}t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t._insertElement(e,Ue.HTML)}function yU(t,e){t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t._insertElement(e,Ue.HTML),t.tokenizer.state=hn.PLAINTEXT}function vU(t,e){t.openElements.hasInScope(_.BUTTON)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(_.BUTTON)),t._reconstructActiveFormattingElements(),t._insertElement(e,Ue.HTML),t.framesetOk=!1}function bU(t,e){const n=t.activeFormattingElements.getElementEntryInScopeWithTagName(ge.A);n&&(eb(t,e),t.openElements.remove(n.element),t.activeFormattingElements.removeEntry(n)),t._reconstructActiveFormattingElements(),t._insertElement(e,Ue.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function EU(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Ue.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function TU(t,e){t._reconstructActiveFormattingElements(),t.openElements.hasInScope(_.NOBR)&&(eb(t,e),t._reconstructActiveFormattingElements()),t._insertElement(e,Ue.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function xU(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Ue.HTML),t.activeFormattingElements.insertMarker(),t.framesetOk=!1}function SU(t,e){t.treeAdapter.getDocumentMode(t.document)!==Vi.QUIRKS&&t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t._insertElement(e,Ue.HTML),t.framesetOk=!1,t.insertionMode=re.IN_TABLE}function w6(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,Ue.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function C6(t){const e=p6(t,ro.TYPE);return e!=null&&e.toLowerCase()===z7}function AU(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,Ue.HTML),C6(e)||(t.framesetOk=!1),e.ackSelfClosing=!0}function wU(t,e){t._appendElement(e,Ue.HTML),e.ackSelfClosing=!0}function CU(t,e){t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t._appendElement(e,Ue.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function RU(t,e){e.tagName=ge.IMG,e.tagID=_.IMG,w6(t,e)}function _U(t,e){t._insertElement(e,Ue.HTML),t.skipNextNewLine=!0,t.tokenizer.state=hn.RCDATA,t.originalInsertionMode=t.insertionMode,t.framesetOk=!1,t.insertionMode=re.TEXT}function IU(t,e){t.openElements.hasInButtonScope(_.P)&&t._closePElement(),t._reconstructActiveFormattingElements(),t.framesetOk=!1,t._switchToTextParsing(e,hn.RAWTEXT)}function LU(t,e){t.framesetOk=!1,t._switchToTextParsing(e,hn.RAWTEXT)}function vA(t,e){t._switchToTextParsing(e,hn.RAWTEXT)}function DU(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Ue.HTML),t.framesetOk=!1,t.insertionMode=t.insertionMode===re.IN_TABLE||t.insertionMode===re.IN_CAPTION||t.insertionMode===re.IN_TABLE_BODY||t.insertionMode===re.IN_ROW||t.insertionMode===re.IN_CELL?re.IN_SELECT_IN_TABLE:re.IN_SELECT}function OU(t,e){t.openElements.currentTagId===_.OPTION&&t.openElements.pop(),t._reconstructActiveFormattingElements(),t._insertElement(e,Ue.HTML)}function PU(t,e){t.openElements.hasInScope(_.RUBY)&&t.openElements.generateImpliedEndTags(),t._insertElement(e,Ue.HTML)}function kU(t,e){t.openElements.hasInScope(_.RUBY)&&t.openElements.generateImpliedEndTagsWithExclusion(_.RTC),t._insertElement(e,Ue.HTML)}function NU(t,e){t._reconstructActiveFormattingElements(),E6(e),Jv(e),e.selfClosing?t._appendElement(e,Ue.MATHML):t._insertElement(e,Ue.MATHML),e.ackSelfClosing=!0}function MU(t,e){t._reconstructActiveFormattingElements(),T6(e),Jv(e),e.selfClosing?t._appendElement(e,Ue.SVG):t._insertElement(e,Ue.SVG),e.ackSelfClosing=!0}function bA(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Ue.HTML)}function $n(t,e){switch(e.tagID){case _.I:case _.S:case _.B:case _.U:case _.EM:case _.TT:case _.BIG:case _.CODE:case _.FONT:case _.SMALL:case _.STRIKE:case _.STRONG:{EU(t,e);break}case _.A:{bU(t,e);break}case _.H1:case _.H2:case _.H3:case _.H4:case _.H5:case _.H6:{hU(t,e);break}case _.P:case _.DL:case _.OL:case _.UL:case _.DIV:case _.DIR:case _.NAV:case _.MAIN:case _.MENU:case _.ASIDE:case _.CENTER:case _.FIGURE:case _.FOOTER:case _.HEADER:case _.HGROUP:case _.DIALOG:case _.DETAILS:case _.ADDRESS:case _.ARTICLE:case _.SEARCH:case _.SECTION:case _.SUMMARY:case _.FIELDSET:case _.BLOCKQUOTE:case _.FIGCAPTION:{fU(t,e);break}case _.LI:case _.DD:case _.DT:{gU(t,e);break}case _.BR:case _.IMG:case _.WBR:case _.AREA:case _.EMBED:case _.KEYGEN:{w6(t,e);break}case _.HR:{CU(t,e);break}case _.RB:case _.RTC:{PU(t,e);break}case _.RT:case _.RP:{kU(t,e);break}case _.PRE:case _.LISTING:{pU(t,e);break}case _.XMP:{IU(t,e);break}case _.SVG:{MU(t,e);break}case _.HTML:{lU(t,e);break}case _.BASE:case _.LINK:case _.META:case _.STYLE:case _.TITLE:case _.SCRIPT:case _.BGSOUND:case _.BASEFONT:case _.TEMPLATE:{cr(t,e);break}case _.BODY:{cU(t,e);break}case _.FORM:{mU(t,e);break}case _.NOBR:{TU(t,e);break}case _.MATH:{NU(t,e);break}case _.TABLE:{SU(t,e);break}case _.INPUT:{AU(t,e);break}case _.PARAM:case _.TRACK:case _.SOURCE:{wU(t,e);break}case _.IMAGE:{RU(t,e);break}case _.BUTTON:{vU(t,e);break}case _.APPLET:case _.OBJECT:case _.MARQUEE:{xU(t,e);break}case _.IFRAME:{LU(t,e);break}case _.SELECT:{DU(t,e);break}case _.OPTION:case _.OPTGROUP:{OU(t,e);break}case _.NOEMBED:case _.NOFRAMES:{vA(t,e);break}case _.FRAMESET:{dU(t,e);break}case _.TEXTAREA:{_U(t,e);break}case _.NOSCRIPT:{t.options.scriptingEnabled?vA(t,e):bA(t,e);break}case _.PLAINTEXT:{yU(t,e);break}case _.COL:case _.TH:case _.TD:case _.TR:case _.HEAD:case _.FRAME:case _.TBODY:case _.TFOOT:case _.THEAD:case _.CAPTION:case _.COLGROUP:break;default:bA(t,e)}}function BU(t,e){if(t.openElements.hasInScope(_.BODY)&&(t.insertionMode=re.AFTER_BODY,t.options.sourceCodeLocationInfo)){const n=t.openElements.tryPeekProperlyNestedBodyElement();n&&t._setEndLocation(n,e)}}function FU(t,e){t.openElements.hasInScope(_.BODY)&&(t.insertionMode=re.AFTER_BODY,M6(t,e))}function UU(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n))}function HU(t){const e=t.openElements.tmplCount>0,{formElement:n}=t;e||(t.formElement=null),(n||e)&&t.openElements.hasInScope(_.FORM)&&(t.openElements.generateImpliedEndTags(),e?t.openElements.popUntilTagNamePopped(_.FORM):n&&t.openElements.remove(n))}function zU(t){t.openElements.hasInButtonScope(_.P)||t._insertFakeElement(ge.P,_.P),t._closePElement()}function qU(t){t.openElements.hasInListItemScope(_.LI)&&(t.openElements.generateImpliedEndTagsWithExclusion(_.LI),t.openElements.popUntilTagNamePopped(_.LI))}function VU(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTagsWithExclusion(n),t.openElements.popUntilTagNamePopped(n))}function GU(t){t.openElements.hasNumberedHeaderInScope()&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilNumberedHeaderPopped())}function jU(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n),t.activeFormattingElements.clearToLastMarker())}function WU(t){t._reconstructActiveFormattingElements(),t._insertFakeElement(ge.BR,_.BR),t.openElements.pop(),t.framesetOk=!1}function R6(t,e){const n=e.tagName,i=e.tagID;for(let r=t.openElements.stackTop;r>0;r--){const s=t.openElements.items[r],a=t.openElements.tagIDs[r];if(i===a&&(i!==_.UNKNOWN||t.treeAdapter.getTagName(s)===n)){t.openElements.generateImpliedEndTagsWithExclusion(i),t.openElements.stackTop>=r&&t.openElements.shortenToLength(r);break}if(t._isSpecialElement(s,a))break}}function u0(t,e){switch(e.tagID){case _.A:case _.B:case _.I:case _.S:case _.U:case _.EM:case _.TT:case _.BIG:case _.CODE:case _.FONT:case _.NOBR:case _.SMALL:case _.STRIKE:case _.STRONG:{eb(t,e);break}case _.P:{zU(t);break}case _.DL:case _.UL:case _.OL:case _.DIR:case _.DIV:case _.NAV:case _.PRE:case _.MAIN:case _.MENU:case _.ASIDE:case _.BUTTON:case _.CENTER:case _.FIGURE:case _.FOOTER:case _.HEADER:case _.HGROUP:case _.DIALOG:case _.ADDRESS:case _.ARTICLE:case _.DETAILS:case _.SEARCH:case _.SECTION:case _.SUMMARY:case _.LISTING:case _.FIELDSET:case _.BLOCKQUOTE:case _.FIGCAPTION:{UU(t,e);break}case _.LI:{qU(t);break}case _.DD:case _.DT:{VU(t,e);break}case _.H1:case _.H2:case _.H3:case _.H4:case _.H5:case _.H6:{GU(t);break}case _.BR:{WU(t);break}case _.BODY:{BU(t,e);break}case _.HTML:{FU(t,e);break}case _.FORM:{HU(t);break}case _.APPLET:case _.OBJECT:case _.MARQUEE:{jU(t,e);break}case _.TEMPLATE:{yo(t,e);break}default:R6(t,e)}}function _6(t,e){t.tmplInsertionModeStack.length>0?N6(t,e):tb(t,e)}function $U(t,e){var n;e.tagID===_.SCRIPT&&((n=t.scriptHandler)===null||n===void 0||n.call(t,t.openElements.current)),t.openElements.pop(),t.insertionMode=t.originalInsertionMode}function YU(t,e){t._err(e,Ae.eofInElementThatCanContainOnlyText),t.openElements.pop(),t.insertionMode=t.originalInsertionMode,t.onEof(e)}function mg(t,e){if(t.openElements.currentTagId!==void 0&&x6.has(t.openElements.currentTagId))switch(t.pendingCharacterTokens.length=0,t.hasNonWhitespacePendingCharacterToken=!1,t.originalInsertionMode=t.insertionMode,t.insertionMode=re.IN_TABLE_TEXT,e.type){case wt.CHARACTER:{L6(t,e);break}case wt.WHITESPACE_CHARACTER:{I6(t,e);break}}else Jc(t,e)}function KU(t,e){t.openElements.clearBackToTableContext(),t.activeFormattingElements.insertMarker(),t._insertElement(e,Ue.HTML),t.insertionMode=re.IN_CAPTION}function XU(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,Ue.HTML),t.insertionMode=re.IN_COLUMN_GROUP}function QU(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(ge.COLGROUP,_.COLGROUP),t.insertionMode=re.IN_COLUMN_GROUP,nb(t,e)}function ZU(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,Ue.HTML),t.insertionMode=re.IN_TABLE_BODY}function JU(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(ge.TBODY,_.TBODY),t.insertionMode=re.IN_TABLE_BODY,l0(t,e)}function eH(t,e){t.openElements.hasInTableScope(_.TABLE)&&(t.openElements.popUntilTagNamePopped(_.TABLE),t._resetInsertionMode(),t._processStartTag(e))}function tH(t,e){C6(e)?t._appendElement(e,Ue.HTML):Jc(t,e),e.ackSelfClosing=!0}function nH(t,e){!t.formElement&&t.openElements.tmplCount===0&&(t._insertElement(e,Ue.HTML),t.formElement=t.openElements.current,t.openElements.pop())}function Hu(t,e){switch(e.tagID){case _.TD:case _.TH:case _.TR:{JU(t,e);break}case _.STYLE:case _.SCRIPT:case _.TEMPLATE:{cr(t,e);break}case _.COL:{QU(t,e);break}case _.FORM:{nH(t,e);break}case _.TABLE:{eH(t,e);break}case _.TBODY:case _.TFOOT:case _.THEAD:{ZU(t,e);break}case _.INPUT:{tH(t,e);break}case _.CAPTION:{KU(t,e);break}case _.COLGROUP:{XU(t,e);break}default:Jc(t,e)}}function kc(t,e){switch(e.tagID){case _.TABLE:{t.openElements.hasInTableScope(_.TABLE)&&(t.openElements.popUntilTagNamePopped(_.TABLE),t._resetInsertionMode());break}case _.TEMPLATE:{yo(t,e);break}case _.BODY:case _.CAPTION:case _.COL:case _.COLGROUP:case _.HTML:case _.TBODY:case _.TD:case _.TFOOT:case _.TH:case _.THEAD:case _.TR:break;default:Jc(t,e)}}function Jc(t,e){const n=t.fosterParentingEnabled;t.fosterParentingEnabled=!0,o0(t,e),t.fosterParentingEnabled=n}function I6(t,e){t.pendingCharacterTokens.push(e)}function L6(t,e){t.pendingCharacterTokens.push(e),t.hasNonWhitespacePendingCharacterToken=!0}function rc(t,e){let n=0;if(t.hasNonWhitespacePendingCharacterToken)for(;n<t.pendingCharacterTokens.length;n++)Jc(t,t.pendingCharacterTokens[n]);else for(;n<t.pendingCharacterTokens.length;n++)t._insertCharacters(t.pendingCharacterTokens[n]);t.insertionMode=t.originalInsertionMode,t._processToken(e)}const D6=new Set([_.CAPTION,_.COL,_.COLGROUP,_.TBODY,_.TD,_.TFOOT,_.TH,_.THEAD,_.TR]);function iH(t,e){const n=e.tagID;D6.has(n)?t.openElements.hasInTableScope(_.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(_.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=re.IN_TABLE,Hu(t,e)):$n(t,e)}function rH(t,e){const n=e.tagID;switch(n){case _.CAPTION:case _.TABLE:{t.openElements.hasInTableScope(_.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(_.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=re.IN_TABLE,n===_.TABLE&&kc(t,e));break}case _.BODY:case _.COL:case _.COLGROUP:case _.HTML:case _.TBODY:case _.TD:case _.TFOOT:case _.TH:case _.THEAD:case _.TR:break;default:u0(t,e)}}function nb(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.COL:{t._appendElement(e,Ue.HTML),e.ackSelfClosing=!0;break}case _.TEMPLATE:{cr(t,e);break}default:Ph(t,e)}}function sH(t,e){switch(e.tagID){case _.COLGROUP:{t.openElements.currentTagId===_.COLGROUP&&(t.openElements.pop(),t.insertionMode=re.IN_TABLE);break}case _.TEMPLATE:{yo(t,e);break}case _.COL:break;default:Ph(t,e)}}function Ph(t,e){t.openElements.currentTagId===_.COLGROUP&&(t.openElements.pop(),t.insertionMode=re.IN_TABLE,t._processToken(e))}function l0(t,e){switch(e.tagID){case _.TR:{t.openElements.clearBackToTableBodyContext(),t._insertElement(e,Ue.HTML),t.insertionMode=re.IN_ROW;break}case _.TH:case _.TD:{t.openElements.clearBackToTableBodyContext(),t._insertFakeElement(ge.TR,_.TR),t.insertionMode=re.IN_ROW,c0(t,e);break}case _.CAPTION:case _.COL:case _.COLGROUP:case _.TBODY:case _.TFOOT:case _.THEAD:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=re.IN_TABLE,Hu(t,e));break}default:Hu(t,e)}}function Dy(t,e){const n=e.tagID;switch(e.tagID){case _.TBODY:case _.TFOOT:case _.THEAD:{t.openElements.hasInTableScope(n)&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=re.IN_TABLE);break}case _.TABLE:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=re.IN_TABLE,kc(t,e));break}case _.BODY:case _.CAPTION:case _.COL:case _.COLGROUP:case _.HTML:case _.TD:case _.TH:case _.TR:break;default:kc(t,e)}}function c0(t,e){switch(e.tagID){case _.TH:case _.TD:{t.openElements.clearBackToTableRowContext(),t._insertElement(e,Ue.HTML),t.insertionMode=re.IN_CELL,t.activeFormattingElements.insertMarker();break}case _.CAPTION:case _.COL:case _.COLGROUP:case _.TBODY:case _.TFOOT:case _.THEAD:case _.TR:{t.openElements.hasInTableScope(_.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=re.IN_TABLE_BODY,l0(t,e));break}default:Hu(t,e)}}function O6(t,e){switch(e.tagID){case _.TR:{t.openElements.hasInTableScope(_.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=re.IN_TABLE_BODY);break}case _.TABLE:{t.openElements.hasInTableScope(_.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=re.IN_TABLE_BODY,Dy(t,e));break}case _.TBODY:case _.TFOOT:case _.THEAD:{(t.openElements.hasInTableScope(e.tagID)||t.openElements.hasInTableScope(_.TR))&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=re.IN_TABLE_BODY,Dy(t,e));break}case _.BODY:case _.CAPTION:case _.COL:case _.COLGROUP:case _.HTML:case _.TD:case _.TH:break;default:kc(t,e)}}function aH(t,e){const n=e.tagID;D6.has(n)?(t.openElements.hasInTableScope(_.TD)||t.openElements.hasInTableScope(_.TH))&&(t._closeTableCell(),c0(t,e)):$n(t,e)}function oH(t,e){const n=e.tagID;switch(n){case _.TD:case _.TH:{t.openElements.hasInTableScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=re.IN_ROW);break}case _.TABLE:case _.TBODY:case _.TFOOT:case _.THEAD:case _.TR:{t.openElements.hasInTableScope(n)&&(t._closeTableCell(),O6(t,e));break}case _.BODY:case _.CAPTION:case _.COL:case _.COLGROUP:case _.HTML:break;default:u0(t,e)}}function P6(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.OPTION:{t.openElements.currentTagId===_.OPTION&&t.openElements.pop(),t._insertElement(e,Ue.HTML);break}case _.OPTGROUP:{t.openElements.currentTagId===_.OPTION&&t.openElements.pop(),t.openElements.currentTagId===_.OPTGROUP&&t.openElements.pop(),t._insertElement(e,Ue.HTML);break}case _.HR:{t.openElements.currentTagId===_.OPTION&&t.openElements.pop(),t.openElements.currentTagId===_.OPTGROUP&&t.openElements.pop(),t._appendElement(e,Ue.HTML),e.ackSelfClosing=!0;break}case _.INPUT:case _.KEYGEN:case _.TEXTAREA:case _.SELECT:{t.openElements.hasInSelectScope(_.SELECT)&&(t.openElements.popUntilTagNamePopped(_.SELECT),t._resetInsertionMode(),e.tagID!==_.SELECT&&t._processStartTag(e));break}case _.SCRIPT:case _.TEMPLATE:{cr(t,e);break}}}function k6(t,e){switch(e.tagID){case _.OPTGROUP:{t.openElements.stackTop>0&&t.openElements.currentTagId===_.OPTION&&t.openElements.tagIDs[t.openElements.stackTop-1]===_.OPTGROUP&&t.openElements.pop(),t.openElements.currentTagId===_.OPTGROUP&&t.openElements.pop();break}case _.OPTION:{t.openElements.currentTagId===_.OPTION&&t.openElements.pop();break}case _.SELECT:{t.openElements.hasInSelectScope(_.SELECT)&&(t.openElements.popUntilTagNamePopped(_.SELECT),t._resetInsertionMode());break}case _.TEMPLATE:{yo(t,e);break}}}function uH(t,e){const n=e.tagID;n===_.CAPTION||n===_.TABLE||n===_.TBODY||n===_.TFOOT||n===_.THEAD||n===_.TR||n===_.TD||n===_.TH?(t.openElements.popUntilTagNamePopped(_.SELECT),t._resetInsertionMode(),t._processStartTag(e)):P6(t,e)}function lH(t,e){const n=e.tagID;n===_.CAPTION||n===_.TABLE||n===_.TBODY||n===_.TFOOT||n===_.THEAD||n===_.TR||n===_.TD||n===_.TH?t.openElements.hasInTableScope(n)&&(t.openElements.popUntilTagNamePopped(_.SELECT),t._resetInsertionMode(),t.onEndTag(e)):k6(t,e)}function cH(t,e){switch(e.tagID){case _.BASE:case _.BASEFONT:case _.BGSOUND:case _.LINK:case _.META:case _.NOFRAMES:case _.SCRIPT:case _.STYLE:case _.TEMPLATE:case _.TITLE:{cr(t,e);break}case _.CAPTION:case _.COLGROUP:case _.TBODY:case _.TFOOT:case _.THEAD:{t.tmplInsertionModeStack[0]=re.IN_TABLE,t.insertionMode=re.IN_TABLE,Hu(t,e);break}case _.COL:{t.tmplInsertionModeStack[0]=re.IN_COLUMN_GROUP,t.insertionMode=re.IN_COLUMN_GROUP,nb(t,e);break}case _.TR:{t.tmplInsertionModeStack[0]=re.IN_TABLE_BODY,t.insertionMode=re.IN_TABLE_BODY,l0(t,e);break}case _.TD:case _.TH:{t.tmplInsertionModeStack[0]=re.IN_ROW,t.insertionMode=re.IN_ROW,c0(t,e);break}default:t.tmplInsertionModeStack[0]=re.IN_BODY,t.insertionMode=re.IN_BODY,$n(t,e)}}function dH(t,e){e.tagID===_.TEMPLATE&&yo(t,e)}function N6(t,e){t.openElements.tmplCount>0?(t.openElements.popUntilTagNamePopped(_.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode(),t.onEof(e)):tb(t,e)}function fH(t,e){e.tagID===_.HTML?$n(t,e):kh(t,e)}function M6(t,e){var n;if(e.tagID===_.HTML){if(t.fragmentContext||(t.insertionMode=re.AFTER_AFTER_BODY),t.options.sourceCodeLocationInfo&&t.openElements.tagIDs[0]===_.HTML){t._setEndLocation(t.openElements.items[0],e);const i=t.openElements.items[1];i&&!(!((n=t.treeAdapter.getNodeSourceCodeLocation(i))===null||n===void 0)&&n.endTag)&&t._setEndLocation(i,e)}}else kh(t,e)}function kh(t,e){t.insertionMode=re.IN_BODY,o0(t,e)}function hH(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.FRAMESET:{t._insertElement(e,Ue.HTML);break}case _.FRAME:{t._appendElement(e,Ue.HTML),e.ackSelfClosing=!0;break}case _.NOFRAMES:{cr(t,e);break}}}function pH(t,e){e.tagID===_.FRAMESET&&!t.openElements.isRootHtmlElementCurrent()&&(t.openElements.pop(),!t.fragmentContext&&t.openElements.currentTagId!==_.FRAMESET&&(t.insertionMode=re.AFTER_FRAMESET))}function mH(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.NOFRAMES:{cr(t,e);break}}}function gH(t,e){e.tagID===_.HTML&&(t.insertionMode=re.AFTER_AFTER_FRAMESET)}function yH(t,e){e.tagID===_.HTML?$n(t,e):dh(t,e)}function dh(t,e){t.insertionMode=re.IN_BODY,o0(t,e)}function vH(t,e){switch(e.tagID){case _.HTML:{$n(t,e);break}case _.NOFRAMES:{cr(t,e);break}}}function bH(t,e){e.chars=tn,t._insertCharacters(e)}function EH(t,e){t._insertCharacters(e),t.framesetOk=!1}function B6(t){for(;t.treeAdapter.getNamespaceURI(t.openElements.current)!==Ue.HTML&&t.openElements.currentTagId!==void 0&&!t._isIntegrationPoint(t.openElements.currentTagId,t.openElements.current);)t.openElements.pop()}function TH(t,e){if(M7(e))B6(t),t._startTagOutsideForeignContent(e);else{const n=t._getAdjustedCurrentElement(),i=t.treeAdapter.getNamespaceURI(n);i===Ue.MATHML?E6(e):i===Ue.SVG&&(B7(e),T6(e)),Jv(e),e.selfClosing?t._appendElement(e,i):t._insertElement(e,i),e.ackSelfClosing=!0}}function xH(t,e){if(e.tagID===_.P||e.tagID===_.BR){B6(t),t._endTagOutsideForeignContent(e);return}for(let n=t.openElements.stackTop;n>0;n--){const i=t.openElements.items[n];if(t.treeAdapter.getNamespaceURI(i)===Ue.HTML){t._endTagOutsideForeignContent(e);break}const r=t.treeAdapter.getTagName(i);if(r.toLowerCase()===e.tagName){e.tagName=r,t.openElements.shortenToLength(n);break}}}ge.AREA,ge.BASE,ge.BASEFONT,ge.BGSOUND,ge.BR,ge.COL,ge.EMBED,ge.FRAME,ge.HR,ge.IMG,ge.INPUT,ge.KEYGEN,ge.LINK,ge.META,ge.PARAM,ge.SOURCE,ge.TRACK,ge.WBR;const d0=F6("end"),ys=F6("start");function F6(t){return e;function e(n){const i=n&&n.position&&n.position[t]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function SH(t){const e=ys(t),n=d0(t);if(e&&n)return{start:e,end:n}}const f0=(function(t){if(t==null)return RH;if(typeof t=="function")return h0(t);if(typeof t=="object")return Array.isArray(t)?AH(t):wH(t);if(typeof t=="string")return CH(t);throw new Error("Expected function, string, or object as test")});function AH(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=f0(t[n]);return h0(i);function i(...r){let s=-1;for(;++s<e.length;)if(e[s].apply(this,r))return!0;return!1}}function wH(t){const e=t;return h0(n);function n(i){const r=i;let s;for(s in t)if(r[s]!==e[s])return!1;return!0}}function CH(t){return h0(e);function e(n){return n&&n.type===t}}function h0(t){return e;function e(n,i,r){return!!(_H(n)&&t.call(this,n,typeof i=="number"?i:void 0,r||void 0))}}function RH(){return!0}function _H(t){return t!==null&&typeof t=="object"&&"type"in t}const U6=[],IH=!0,Oy=!1,LH="skip";function H6(t,e,n,i){let r;typeof e=="function"&&typeof n!="function"?(i=n,n=e):r=e;const s=f0(r),a=i?-1:1;o(t,void 0,[])();function o(l,u,d){const f=l&&typeof l=="object"?l:{};if(typeof f.type=="string"){const m=typeof f.tagName=="string"?f.tagName:typeof f.name=="string"?f.name:void 0;Object.defineProperty(p,"name",{value:"node ("+(l.type+(m?"<"+m+">":""))+")"})}return p;function p(){let m=U6,y,b,E;if((!e||s(l,u,d[d.length-1]||void 0))&&(m=DH(n(l,d)),m[0]===Oy))return m;if("children"in l&&l.children){const T=l;if(T.children&&m[0]!==LH)for(b=(i?T.children.length:-1)+a,E=d.concat(T);b>-1&&b<T.children.length;){const x=T.children[b];if(y=o(x,b,E)(),y[0]===Oy)return y;b=typeof y[1]=="number"?y[1]:b+a}}return m}}}function DH(t){return Array.isArray(t)?t:typeof t=="number"?[IH,t]:t==null?U6:[t]}function ib(t,e,n,i){let r,s,a;typeof e=="function"&&typeof n!="function"?(s=void 0,a=e,r=n):(s=e,a=n,r=i),H6(t,s,o,r);function o(l,u){const d=u[u.length-1],f=d?d.children.indexOf(l):void 0;return a(l,f,d)}}const OH=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,PH=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),EA={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function z6(t,e){const n=VH(t),i=Qv("type",{handlers:{root:kH,element:NH,text:MH,comment:V6,doctype:BH,raw:UH},unknown:HH}),r={parser:n?new yA(EA):yA.getFragmentParser(void 0,EA),handle(o){i(o,r)},stitches:!1,options:e||{}};i(t,r),Qu(r,ys());const s=n?r.parser.document:r.parser.getFragment(),a=CF(s,{file:r.options.file});return r.stitches&&ib(a,"comment",function(o,l,u){const d=o;if(d.value.stitch&&u&&l!==void 0){const f=u.children;return f[l]=d.value.stitch,l}}),a.type==="root"&&a.children.length===1&&a.children[0].type===t.type?a.children[0]:a}function q6(t,e){let n=-1;if(t)for(;++n<t.length;)e.handle(t[n])}function kH(t,e){q6(t.children,e)}function NH(t,e){zH(t,e),q6(t.children,e),qH(t,e)}function MH(t,e){e.parser.tokenizer.state>4&&(e.parser.tokenizer.state=0);const n={type:wt.CHARACTER,chars:t.value,location:ed(t)};Qu(e,ys(t)),e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken)}function BH(t,e){const n={type:wt.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:ed(t)};Qu(e,ys(t)),e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken)}function FH(t,e){e.stitches=!0;const n=GH(t);if("children"in t&&"children"in n){const i=z6({type:"root",children:t.children},e.options);n.children=i.children}V6({type:"comment",value:{stitch:n}},e)}function V6(t,e){const n=t.value,i={type:wt.COMMENT,data:n,location:ed(t)};Qu(e,ys(t)),e.parser.currentToken=i,e.parser._processToken(e.parser.currentToken)}function UH(t,e){if(e.parser.tokenizer.preprocessor.html="",e.parser.tokenizer.preprocessor.pos=-1,e.parser.tokenizer.preprocessor.lastGapPos=-2,e.parser.tokenizer.preprocessor.gapStack=[],e.parser.tokenizer.preprocessor.skipNextNewLine=!1,e.parser.tokenizer.preprocessor.lastChunkWritten=!1,e.parser.tokenizer.preprocessor.endOfChunkHit=!1,e.parser.tokenizer.preprocessor.isEol=!1,G6(e,ys(t)),e.parser.tokenizer.write(e.options.tagfilter?t.value.replace(OH,"&lt;$1$2"):t.value,!1),e.parser.tokenizer._runParsingLoop(),e.parser.tokenizer.state===72||e.parser.tokenizer.state===78){e.parser.tokenizer.preprocessor.lastChunkWritten=!0;const n=e.parser.tokenizer._consume();e.parser.tokenizer._callState(n)}}function HH(t,e){const n=t;if(e.options.passThrough&&e.options.passThrough.includes(n.type))FH(n,e);else{let i="";throw PH.has(n.type)&&(i=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+n.type+"` node"+i)}}function Qu(t,e){G6(t,e);const n=t.parser.tokenizer.currentCharacterToken;n&&n.location&&(n.location.endLine=t.parser.tokenizer.preprocessor.line,n.location.endCol=t.parser.tokenizer.preprocessor.col+1,n.location.endOffset=t.parser.tokenizer.preprocessor.offset+1,t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)),t.parser.tokenizer.paused=!1,t.parser.tokenizer.inLoop=!1,t.parser.tokenizer.active=!1,t.parser.tokenizer.returnState=hn.DATA,t.parser.tokenizer.charRefCode=-1,t.parser.tokenizer.consumedAfterSnapshot=-1,t.parser.tokenizer.currentLocation=null,t.parser.tokenizer.currentCharacterToken=null,t.parser.tokenizer.currentToken=null,t.parser.tokenizer.currentAttr={name:"",value:""}}function G6(t,e){if(e&&e.offset!==void 0){const n={startLine:e.line,startCol:e.column,startOffset:e.offset,endLine:-1,endCol:-1,endOffset:-1};t.parser.tokenizer.preprocessor.lineStartPos=-e.column+1,t.parser.tokenizer.preprocessor.droppedBufferSize=e.offset,t.parser.tokenizer.preprocessor.line=e.line,t.parser.tokenizer.currentLocation=n}}function zH(t,e){const n=t.tagName.toLowerCase();if(e.parser.tokenizer.state===hn.PLAINTEXT)return;Qu(e,ys(t));const i=e.parser.openElements.current;let r="namespaceURI"in i?i.namespaceURI:Ja.html;r===Ja.html&&n==="svg"&&(r=Ja.svg);const s=zF({...t,children:[]},{space:r===Ja.svg?"svg":"html"}),a={type:wt.START_TAG,tagName:n,tagID:Xu(n),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in s?s.attrs:[],location:ed(t)};e.parser.currentToken=a,e.parser._processToken(e.parser.currentToken),e.parser.tokenizer.lastStartTagName=n}function qH(t,e){const n=t.tagName.toLowerCase();if(!e.parser.tokenizer.inForeignNode&&c6.includes(n)||e.parser.tokenizer.state===hn.PLAINTEXT)return;Qu(e,d0(t));const i={type:wt.END_TAG,tagName:n,tagID:Xu(n),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:ed(t)};e.parser.currentToken=i,e.parser._processToken(e.parser.currentToken),n===e.parser.tokenizer.lastStartTagName&&(e.parser.tokenizer.state===hn.RCDATA||e.parser.tokenizer.state===hn.RAWTEXT||e.parser.tokenizer.state===hn.SCRIPT_DATA)&&(e.parser.tokenizer.state=hn.DATA)}function VH(t){const e=t.type==="root"?t.children[0]:t;return!!(e&&(e.type==="doctype"||e.type==="element"&&e.tagName.toLowerCase()==="html"))}function ed(t){const e=ys(t)||{line:void 0,column:void 0,offset:void 0},n=d0(t)||{line:void 0,column:void 0,offset:void 0};return{startLine:e.line,startCol:e.column,startOffset:e.offset,endLine:n.line,endCol:n.column,endOffset:n.offset}}function GH(t){return"children"in t?Uu({...t,children:[]}):Uu(t)}function jH(t){return function(e,n){return z6(e,{...t,file:n})}}const WH=/["&'<>`]/g,$H=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,YH=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,KH=/[|\\{}()[\]^$+*?.]/g,TA=new WeakMap;function XH(t,e){if(t=t.replace(e.subset?QH(e.subset):WH,i),e.subset||e.escapeOnly)return t;return t.replace($H,n).replace(YH,i);function n(r,s,a){return e.format((r.charCodeAt(0)-55296)*1024+r.charCodeAt(1)-56320+65536,a.charCodeAt(s+2),e)}function i(r,s,a){return e.format(r.charCodeAt(0),a.charCodeAt(s+1),e)}}function QH(t){let e=TA.get(t);return e||(e=ZH(t),TA.set(t,e)),e}function ZH(t){const e=[];let n=-1;for(;++n<t.length;)e.push(t[n].replace(KH,"\\$&"));return new RegExp("(?:"+e.join("|")+")","g")}const JH=/[\dA-Fa-f]/;function ez(t,e,n){const i="&#x"+t.toString(16).toUpperCase();return n&&e&&!JH.test(String.fromCharCode(e))?i:i+";"}const tz=/\d/;function nz(t,e,n){const i="&#"+String(t);return n&&e&&!tz.test(String.fromCharCode(e))?i:i+";"}const iz=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],gg={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},rz=["cent","copy","divide","gt","lt","not","para","times"],j6={}.hasOwnProperty,Py={};let Cf;for(Cf in gg)j6.call(gg,Cf)&&(Py[gg[Cf]]=Cf);const sz=/[^\dA-Za-z]/;function az(t,e,n,i){const r=String.fromCharCode(t);if(j6.call(Py,r)){const s=Py[r],a="&"+s;return n&&iz.includes(s)&&!rz.includes(s)&&(!i||e&&e!==61&&sz.test(String.fromCharCode(e)))?a:a+";"}return""}function oz(t,e,n){let i=ez(t,e,n.omitOptionalSemicolons),r;if((n.useNamedReferences||n.useShortestReferences)&&(r=az(t,e,n.omitOptionalSemicolons,n.attribute)),(n.useShortestReferences||!r)&&n.useShortestReferences){const s=nz(t,e,n.omitOptionalSemicolons);s.length<i.length&&(i=s)}return r&&(!n.useShortestReferences||r.length<i.length)?r:i}function Du(t,e){return XH(t,Object.assign({format:oz},e))}const uz=/^>|^->|<!--|-->|--!>|<!-$/g,lz=[">"],cz=["<",">"];function dz(t,e,n,i){return i.settings.bogusComments?"<?"+Du(t.value,Object.assign({},i.settings.characterReferences,{subset:lz}))+">":"<!--"+t.value.replace(uz,r)+"-->";function r(s){return Du(s,Object.assign({},i.settings.characterReferences,{subset:cz}))}}function fz(t,e,n,i){return"<!"+(i.settings.upperDoctype?"DOCTYPE":"doctype")+(i.settings.tightDoctype?"":" ")+"html>"}function Nh(t,e){const n=String(t);if(typeof e!="string")throw new TypeError("Expected character");let i=0,r=n.indexOf(e);for(;r!==-1;)i++,r=n.indexOf(e,r+e.length);return i}const hz=/[ \t\n\f\r]/g;function rb(t){return typeof t=="object"?t.type==="text"?xA(t.value):!1:xA(t)}function xA(t){return t.replace(hz,"")===""}const Cn=$6(1),W6=$6(-1),pz=[];function $6(t){return e;function e(n,i,r){const s=n?n.children:pz;let a=(i||0)+t,o=s[a];if(!r)for(;o&&rb(o);)a+=t,o=s[a];return o}}const mz={}.hasOwnProperty;function Y6(t){return e;function e(n,i,r){return mz.call(t,n.tagName)&&t[n.tagName](n,i,r)}}const sb=Y6({body:yz,caption:yg,colgroup:yg,dd:Tz,dt:Ez,head:yg,html:gz,li:bz,optgroup:xz,option:Sz,p:vz,rp:SA,rt:SA,tbody:wz,td:AA,tfoot:Cz,th:AA,thead:Az,tr:Rz});function yg(t,e,n){const i=Cn(n,e,!0);return!i||i.type!=="comment"&&!(i.type==="text"&&rb(i.value.charAt(0)))}function gz(t,e,n){const i=Cn(n,e);return!i||i.type!=="comment"}function yz(t,e,n){const i=Cn(n,e);return!i||i.type!=="comment"}function vz(t,e,n){const i=Cn(n,e);return i?i.type==="element"&&(i.tagName==="address"||i.tagName==="article"||i.tagName==="aside"||i.tagName==="blockquote"||i.tagName==="details"||i.tagName==="div"||i.tagName==="dl"||i.tagName==="fieldset"||i.tagName==="figcaption"||i.tagName==="figure"||i.tagName==="footer"||i.tagName==="form"||i.tagName==="h1"||i.tagName==="h2"||i.tagName==="h3"||i.tagName==="h4"||i.tagName==="h5"||i.tagName==="h6"||i.tagName==="header"||i.tagName==="hgroup"||i.tagName==="hr"||i.tagName==="main"||i.tagName==="menu"||i.tagName==="nav"||i.tagName==="ol"||i.tagName==="p"||i.tagName==="pre"||i.tagName==="section"||i.tagName==="table"||i.tagName==="ul"):!n||!(n.type==="element"&&(n.tagName==="a"||n.tagName==="audio"||n.tagName==="del"||n.tagName==="ins"||n.tagName==="map"||n.tagName==="noscript"||n.tagName==="video"))}function bz(t,e,n){const i=Cn(n,e);return!i||i.type==="element"&&i.tagName==="li"}function Ez(t,e,n){const i=Cn(n,e);return!!(i&&i.type==="element"&&(i.tagName==="dt"||i.tagName==="dd"))}function Tz(t,e,n){const i=Cn(n,e);return!i||i.type==="element"&&(i.tagName==="dt"||i.tagName==="dd")}function SA(t,e,n){const i=Cn(n,e);return!i||i.type==="element"&&(i.tagName==="rp"||i.tagName==="rt")}function xz(t,e,n){const i=Cn(n,e);return!i||i.type==="element"&&i.tagName==="optgroup"}function Sz(t,e,n){const i=Cn(n,e);return!i||i.type==="element"&&(i.tagName==="option"||i.tagName==="optgroup")}function Az(t,e,n){const i=Cn(n,e);return!!(i&&i.type==="element"&&(i.tagName==="tbody"||i.tagName==="tfoot"))}function wz(t,e,n){const i=Cn(n,e);return!i||i.type==="element"&&(i.tagName==="tbody"||i.tagName==="tfoot")}function Cz(t,e,n){return!Cn(n,e)}function Rz(t,e,n){const i=Cn(n,e);return!i||i.type==="element"&&i.tagName==="tr"}function AA(t,e,n){const i=Cn(n,e);return!i||i.type==="element"&&(i.tagName==="td"||i.tagName==="th")}const _z=Y6({body:Dz,colgroup:Oz,head:Lz,html:Iz,tbody:Pz});function Iz(t){const e=Cn(t,-1);return!e||e.type!=="comment"}function Lz(t){const e=new Set;for(const i of t.children)if(i.type==="element"&&(i.tagName==="base"||i.tagName==="title")){if(e.has(i.tagName))return!1;e.add(i.tagName)}const n=t.children[0];return!n||n.type==="element"}function Dz(t){const e=Cn(t,-1,!0);return!e||e.type!=="comment"&&!(e.type==="text"&&rb(e.value.charAt(0)))&&!(e.type==="element"&&(e.tagName==="meta"||e.tagName==="link"||e.tagName==="script"||e.tagName==="style"||e.tagName==="template"))}function Oz(t,e,n){const i=W6(n,e),r=Cn(t,-1,!0);return n&&i&&i.type==="element"&&i.tagName==="colgroup"&&sb(i,n.children.indexOf(i),n)?!1:!!(r&&r.type==="element"&&r.tagName==="col")}function Pz(t,e,n){const i=W6(n,e),r=Cn(t,-1);return n&&i&&i.type==="element"&&(i.tagName==="thead"||i.tagName==="tbody")&&sb(i,n.children.indexOf(i),n)?!1:!!(r&&r.type==="element"&&r.tagName==="tr")}const Rf={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function kz(t,e,n,i){const r=i.schema,s=r.space==="svg"?!1:i.settings.omitOptionalTags;let a=r.space==="svg"?i.settings.closeEmptyElements:i.settings.voids.includes(t.tagName.toLowerCase());const o=[];let l;r.space==="html"&&t.tagName==="svg"&&(i.schema=Qc);const u=Nz(i,t.properties),d=i.all(r.space==="html"&&t.tagName==="template"?t.content:t);return i.schema=r,d&&(a=!1),(u||!s||!_z(t,e,n))&&(o.push("<",t.tagName,u?" "+u:""),a&&(r.space==="svg"||i.settings.closeSelfClosing)&&(l=u.charAt(u.length-1),(!i.settings.tightSelfClosing||l==="/"||l&&l!=='"'&&l!=="'")&&o.push(" "),o.push("/")),o.push(">")),o.push(d),!a&&(!s||!sb(t,e,n))&&o.push("</"+t.tagName+">"),o.join("")}function Nz(t,e){const n=[];let i=-1,r;if(e){for(r in e)if(e[r]!==null&&e[r]!==void 0){const s=Mz(t,r,e[r]);s&&n.push(s)}}for(;++i<n.length;){const s=t.settings.tightAttributes?n[i].charAt(n[i].length-1):void 0;i!==n.length-1&&s!=='"'&&s!=="'"&&(n[i]+=" ")}return n.join("")}function Mz(t,e,n){const i=Yv(t.schema,e),r=t.settings.allowParseErrors&&t.schema.space==="html"?0:1,s=t.settings.allowDangerousCharacters?0:1;let a=t.quote,o;if(i.overloadedBoolean&&(n===i.attribute||n==="")?n=!0:(i.boolean||i.overloadedBoolean)&&(typeof n!="string"||n===i.attribute||n==="")&&(n=!!n),n==null||n===!1||typeof n=="number"&&Number.isNaN(n))return"";const l=Du(i.attribute,Object.assign({},t.settings.characterReferences,{subset:Rf.name[r][s]}));return n===!0||(n=Array.isArray(n)?(i.commaSeparated?K_:X_)(n,{padLeft:!t.settings.tightCommaSeparatedLists}):String(n),t.settings.collapseEmptyAttributes&&!n)?l:(t.settings.preferUnquoted&&(o=Du(n,Object.assign({},t.settings.characterReferences,{attribute:!0,subset:Rf.unquoted[r][s]}))),o!==n&&(t.settings.quoteSmart&&Nh(n,a)>Nh(n,t.alternative)&&(a=t.alternative),o=a+Du(n,Object.assign({},t.settings.characterReferences,{subset:(a==="'"?Rf.single:Rf.double)[r][s],attribute:!0}))+a),l+(o&&"="+o))}const Bz=["<","&"];function K6(t,e,n,i){return n&&n.type==="element"&&(n.tagName==="script"||n.tagName==="style")?t.value:Du(t.value,Object.assign({},i.settings.characterReferences,{subset:Bz}))}function Fz(t,e,n,i){return i.settings.allowDangerousHtml?t.value:K6(t,e,n,i)}function Uz(t,e,n,i){return i.all(t)}const Hz=Qv("type",{invalid:zz,unknown:qz,handlers:{comment:dz,doctype:fz,element:kz,raw:Fz,root:Uz,text:K6}});function zz(t){throw new Error("Expected node, not `"+t+"`")}function qz(t){const e=t;throw new Error("Cannot compile unknown node `"+e.type+"`")}const Vz={},Gz={},jz=[];function Wz(t,e){const n=e||Vz,i=n.quote||'"',r=i==='"'?"'":'"';if(i!=='"'&&i!=="'")throw new Error("Invalid quote `"+i+"`, expected `'` or `\"`");return{one:$z,all:Yz,settings:{omitOptionalTags:n.omitOptionalTags||!1,allowParseErrors:n.allowParseErrors||!1,allowDangerousCharacters:n.allowDangerousCharacters||!1,quoteSmart:n.quoteSmart||!1,preferUnquoted:n.preferUnquoted||!1,tightAttributes:n.tightAttributes||!1,upperDoctype:n.upperDoctype||!1,tightDoctype:n.tightDoctype||!1,bogusComments:n.bogusComments||!1,tightCommaSeparatedLists:n.tightCommaSeparatedLists||!1,tightSelfClosing:n.tightSelfClosing||!1,collapseEmptyAttributes:n.collapseEmptyAttributes||!1,allowDangerousHtml:n.allowDangerousHtml||!1,voids:n.voids||c6,characterReferences:n.characterReferences||Gz,closeSelfClosing:n.closeSelfClosing||!1,closeEmptyElements:n.closeEmptyElements||!1},schema:n.space==="svg"?Qc:a0,quote:i,alternative:r}.one(Array.isArray(t)?{type:"root",children:t}:t,void 0,void 0)}function $z(t,e,n){return Hz(t,e,n,this)}function Yz(t){const e=[],n=t&&t.children||jz;let i=-1;for(;++i<n.length;)e[i]=this.one(n[i],i,t);return e.join("")}function Kz(t){const e=this,n={...e.data("settings"),...t};e.compiler=i;function i(r){return Wz(r,n)}}const Zn=ya(/[A-Za-z]/),Gn=ya(/[\dA-Za-z]/),Xz=ya(/[#-'*+\--9=?A-Z^-~]/);function Mh(t){return t!==null&&(t<32||t===127)}const ky=ya(/\d/),Qz=ya(/[\dA-Fa-f]/),Zz=ya(/[!-/:-@[-`{-~]/);function at(t){return t!==null&&t<-2}function $t(t){return t!==null&&(t<0||t===32)}function It(t){return t===-2||t===-1||t===32}const p0=ya(new RegExp("\\p{P}|\\p{S}","u")),uo=ya(/\s/);function ya(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function Jz(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function eq(t,e,n){const r=f0((n||{}).ignore||[]),s=tq(e);let a=-1;for(;++a<s.length;)H6(t,"text",o);function o(u,d){let f=-1,p;for(;++f<d.length;){const m=d[f],y=p?p.children:void 0;if(r(m,y?y.indexOf(m):void 0,p))return;p=m}if(p)return l(u,d)}function l(u,d){const f=d[d.length-1],p=s[a][0],m=s[a][1];let y=0;const E=f.children.indexOf(u);let T=!1,x=[];p.lastIndex=0;let S=p.exec(u.value);for(;S;){const w=S.index,C={index:S.index,input:S.input,stack:[...d,u]};let I=m(...S,C);if(typeof I=="string"&&(I=I.length>0?{type:"text",value:I}:void 0),I===!1?p.lastIndex=w+1:(y!==w&&x.push({type:"text",value:u.value.slice(y,w)}),Array.isArray(I)?x.push(...I):I&&x.push(I),y=w+S[0].length,T=!0),!p.global)break;S=p.exec(u.value)}return T?(y<u.value.length&&x.push({type:"text",value:u.value.slice(y)}),f.children.splice(E,1,...x)):x=[u],E+x.length}}function tq(t){const e=[];if(!Array.isArray(t))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!t[0]||Array.isArray(t[0])?t:[t];let i=-1;for(;++i<n.length;){const r=n[i];e.push([nq(r[0]),iq(r[1])])}return e}function nq(t){return typeof t=="string"?new RegExp(Jz(t),"g"):t}function iq(t){return typeof t=="function"?t:function(){return t}}const vg="phrasing",bg=["autolink","link","image","label"];function rq(){return{transforms:[dq],enter:{literalAutolink:aq,literalAutolinkEmail:Eg,literalAutolinkHttp:Eg,literalAutolinkWww:Eg},exit:{literalAutolink:cq,literalAutolinkEmail:lq,literalAutolinkHttp:oq,literalAutolinkWww:uq}}}function sq(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:vg,notInConstruct:bg},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:vg,notInConstruct:bg},{character:":",before:"[ps]",after:"\\/",inConstruct:vg,notInConstruct:bg}]}}function aq(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function Eg(t){this.config.enter.autolinkProtocol.call(this,t)}function oq(t){this.config.exit.autolinkProtocol.call(this,t)}function uq(t){this.config.exit.data.call(this,t);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(t)}function lq(t){this.config.exit.autolinkEmail.call(this,t)}function cq(t){this.exit(t)}function dq(t){eq(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,fq],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),hq]],{ignore:["link","linkReference"]})}function fq(t,e,n,i,r){let s="";if(!X6(r)||(/^w/i.test(e)&&(n=e+n,e="",s="http://"),!pq(n)))return!1;const a=mq(n+i);if(!a[0])return!1;const o={type:"link",title:null,url:s+e+a[0],children:[{type:"text",value:e+a[0]}]};return a[1]?[o,{type:"text",value:a[1]}]:o}function hq(t,e,n,i){return!X6(i,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+n,children:[{type:"text",value:e+"@"+n}]}}function pq(t){const e=t.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function mq(t){const e=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!e)return[t,void 0];t=t.slice(0,e.index);let n=e[0],i=n.indexOf(")");const r=Nh(t,"(");let s=Nh(t,")");for(;i!==-1&&r>s;)t+=n.slice(0,i+1),n=n.slice(i+1),i=n.indexOf(")"),s++;return[t,n]}function X6(t,e){const n=t.input.charCodeAt(t.index-1);return(t.index===0||uo(n)||p0(n))&&(!e||n!==47)}function or(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}Q6.peek=Aq;function gq(){this.buffer()}function yq(t){this.enter({type:"footnoteReference",identifier:"",label:""},t)}function vq(){this.buffer()}function bq(t){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},t)}function Eq(t){const e=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=or(this.sliceSerialize(t)).toLowerCase(),n.label=e}function Tq(t){this.exit(t)}function xq(t){const e=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=or(this.sliceSerialize(t)).toLowerCase(),n.label=e}function Sq(t){this.exit(t)}function Aq(){return"["}function Q6(t,e,n,i){const r=n.createTracker(i);let s=r.move("[^");const a=n.enter("footnoteReference"),o=n.enter("reference");return s+=r.move(n.safe(n.associationId(t),{after:"]",before:s})),o(),a(),s+=r.move("]"),s}function wq(){return{enter:{gfmFootnoteCallString:gq,gfmFootnoteCall:yq,gfmFootnoteDefinitionLabelString:vq,gfmFootnoteDefinition:bq},exit:{gfmFootnoteCallString:Eq,gfmFootnoteCall:Tq,gfmFootnoteDefinitionLabelString:xq,gfmFootnoteDefinition:Sq}}}function Cq(t){let e=!1;return t&&t.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:n,footnoteReference:Q6},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(i,r,s,a){const o=s.createTracker(a);let l=o.move("[^");const u=s.enter("footnoteDefinition"),d=s.enter("label");return l+=o.move(s.safe(s.associationId(i),{before:l,after:"]"})),d(),l+=o.move("]:"),i.children&&i.children.length>0&&(o.shift(4),l+=o.move((e?`
`:" ")+s.indentLines(s.containerFlow(i,o.current()),e?Z6:Rq))),u(),l}}function Rq(t,e,n){return e===0?t:Z6(t,e,n)}function Z6(t,e,n){return(n?"":"    ")+t}const _q=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];J6.peek=Pq;function Iq(){return{canContainEols:["delete"],enter:{strikethrough:Dq},exit:{strikethrough:Oq}}}function Lq(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:_q}],handlers:{delete:J6}}}function Dq(t){this.enter({type:"delete",children:[]},t)}function Oq(t){this.exit(t)}function J6(t,e,n,i){const r=n.createTracker(i),s=n.enter("strikethrough");let a=r.move("~~");return a+=n.containerPhrasing(t,{...r.current(),before:a,after:"~"}),a+=r.move("~~"),s(),a}function Pq(){return"~"}function kq(t){return t.length}function Nq(t,e){const n=e||{},i=(n.align||[]).concat(),r=n.stringLength||kq,s=[],a=[],o=[],l=[];let u=0,d=-1;for(;++d<t.length;){const b=[],E=[];let T=-1;for(t[d].length>u&&(u=t[d].length);++T<t[d].length;){const x=Mq(t[d][T]);if(n.alignDelimiters!==!1){const S=r(x);E[T]=S,(l[T]===void 0||S>l[T])&&(l[T]=S)}b.push(x)}a[d]=b,o[d]=E}let f=-1;if(typeof i=="object"&&"length"in i)for(;++f<u;)s[f]=wA(i[f]);else{const b=wA(i);for(;++f<u;)s[f]=b}f=-1;const p=[],m=[];for(;++f<u;){const b=s[f];let E="",T="";b===99?(E=":",T=":"):b===108?E=":":b===114&&(T=":");let x=n.alignDelimiters===!1?1:Math.max(1,l[f]-E.length-T.length);const S=E+"-".repeat(x)+T;n.alignDelimiters!==!1&&(x=E.length+x+T.length,x>l[f]&&(l[f]=x),m[f]=x),p[f]=S}a.splice(1,0,p),o.splice(1,0,m),d=-1;const y=[];for(;++d<a.length;){const b=a[d],E=o[d];f=-1;const T=[];for(;++f<u;){const x=b[f]||"";let S="",w="";if(n.alignDelimiters!==!1){const C=l[f]-(E[f]||0),I=s[f];I===114?S=" ".repeat(C):I===99?C%2?(S=" ".repeat(C/2+.5),w=" ".repeat(C/2-.5)):(S=" ".repeat(C/2),w=S):w=" ".repeat(C)}n.delimiterStart!==!1&&!f&&T.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&x==="")&&(n.delimiterStart!==!1||f)&&T.push(" "),n.alignDelimiters!==!1&&T.push(S),T.push(x),n.alignDelimiters!==!1&&T.push(w),n.padding!==!1&&T.push(" "),(n.delimiterEnd!==!1||f!==u-1)&&T.push("|")}y.push(n.delimiterEnd===!1?T.join("").replace(/ +$/,""):T.join(""))}return y.join(`
`)}function Mq(t){return t==null?"":String(t)}function wA(t){const e=typeof t=="string"?t.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function Bq(t,e,n,i){const r=n.enter("blockquote"),s=n.createTracker(i);s.move("> "),s.shift(2);const a=n.indentLines(n.containerFlow(t,s.current()),Fq);return r(),a}function Fq(t,e,n){return">"+(n?"":" ")+t}function Uq(t,e){return CA(t,e.inConstruct,!0)&&!CA(t,e.notInConstruct,!1)}function CA(t,e,n){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return n;let i=-1;for(;++i<e.length;)if(t.includes(e[i]))return!0;return!1}function RA(t,e,n,i){let r=-1;for(;++r<n.unsafe.length;)if(n.unsafe[r].character===`
`&&Uq(n.stack,n.unsafe[r]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function Hq(t,e){const n=String(t);let i=n.indexOf(e),r=i,s=0,a=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===r?++s>a&&(a=s):s=1,r=i+e.length,i=n.indexOf(e,r);return a}function zq(t,e){return!!(e.options.fences===!1&&t.value&&!t.lang&&/[^ \r\n]/.test(t.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value))}function qq(t){const e=t.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function Vq(t,e,n,i){const r=qq(n),s=t.value||"",a=r==="`"?"GraveAccent":"Tilde";if(zq(t,n)){const f=n.enter("codeIndented"),p=n.indentLines(s,Gq);return f(),p}const o=n.createTracker(i),l=r.repeat(Math.max(Hq(s,r)+1,3)),u=n.enter("codeFenced");let d=o.move(l);if(t.lang){const f=n.enter(`codeFencedLang${a}`);d+=o.move(n.safe(t.lang,{before:d,after:" ",encode:["`"],...o.current()})),f()}if(t.lang&&t.meta){const f=n.enter(`codeFencedMeta${a}`);d+=o.move(" "),d+=o.move(n.safe(t.meta,{before:d,after:`
`,encode:["`"],...o.current()})),f()}return d+=o.move(`
`),s&&(d+=o.move(s+`
`)),d+=o.move(l),u(),d}function Gq(t,e,n){return(n?"":"    ")+t}function ab(t){const e=t.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function jq(t,e,n,i){const r=ab(n),s=r==='"'?"Quote":"Apostrophe",a=n.enter("definition");let o=n.enter("label");const l=n.createTracker(i);let u=l.move("[");return u+=l.move(n.safe(n.associationId(t),{before:u,after:"]",...l.current()})),u+=l.move("]: "),o(),!t.url||/[\0- \u007F]/.test(t.url)?(o=n.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(n.safe(t.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(o=n.enter("destinationRaw"),u+=l.move(n.safe(t.url,{before:u,after:t.title?" ":`
`,...l.current()}))),o(),t.title&&(o=n.enter(`title${s}`),u+=l.move(" "+r),u+=l.move(n.safe(t.title,{before:u,after:r,...l.current()})),u+=l.move(r),o()),a(),u}function Wq(t){const e=t.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function Nc(t){return"&#x"+t.toString(16).toUpperCase()+";"}function zu(t){if(t===null||$t(t)||uo(t))return 1;if(p0(t))return 2}function Bh(t,e,n){const i=zu(t),r=zu(e);return i===void 0?r===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}eI.peek=$q;function eI(t,e,n,i){const r=Wq(n),s=n.enter("emphasis"),a=n.createTracker(i),o=a.move(r);let l=a.move(n.containerPhrasing(t,{after:r,before:o,...a.current()}));const u=l.charCodeAt(0),d=Bh(i.before.charCodeAt(i.before.length-1),u,r);d.inside&&(l=Nc(u)+l.slice(1));const f=l.charCodeAt(l.length-1),p=Bh(i.after.charCodeAt(0),f,r);p.inside&&(l=l.slice(0,-1)+Nc(f));const m=a.move(r);return s(),n.attentionEncodeSurroundingInfo={after:p.outside,before:d.outside},o+l+m}function $q(t,e,n){return n.options.emphasis||"*"}const Yq={};function ob(t,e){const n=Yq,i=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,r=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return tI(t,i,r)}function tI(t,e,n){if(Kq(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return _A(t.children,e,n)}return Array.isArray(t)?_A(t,e,n):""}function _A(t,e,n){const i=[];let r=-1;for(;++r<t.length;)i[r]=tI(t[r],e,n);return i.join("")}function Kq(t){return!!(t&&typeof t=="object")}function Xq(t,e){let n=!1;return ib(t,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return n=!0,Oy}),!!((!t.depth||t.depth<3)&&ob(t)&&(e.options.setext||n))}function Qq(t,e,n,i){const r=Math.max(Math.min(6,t.depth||1),1),s=n.createTracker(i);if(Xq(t,n)){const d=n.enter("headingSetext"),f=n.enter("phrasing"),p=n.containerPhrasing(t,{...s.current(),before:`
`,after:`
`});return f(),d(),p+`
`+(r===1?"=":"-").repeat(p.length-(Math.max(p.lastIndexOf("\r"),p.lastIndexOf(`
`))+1))}const a="#".repeat(r),o=n.enter("headingAtx"),l=n.enter("phrasing");s.move(a+" ");let u=n.containerPhrasing(t,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(u)&&(u=Nc(u.charCodeAt(0))+u.slice(1)),u=u?a+" "+u:a,n.options.closeAtx&&(u+=" "+a),l(),o(),u}nI.peek=Zq;function nI(t){return t.value||""}function Zq(){return"<"}iI.peek=Jq;function iI(t,e,n,i){const r=ab(n),s=r==='"'?"Quote":"Apostrophe",a=n.enter("image");let o=n.enter("label");const l=n.createTracker(i);let u=l.move("![");return u+=l.move(n.safe(t.alt,{before:u,after:"]",...l.current()})),u+=l.move("]("),o(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(o=n.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(n.safe(t.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(o=n.enter("destinationRaw"),u+=l.move(n.safe(t.url,{before:u,after:t.title?" ":")",...l.current()}))),o(),t.title&&(o=n.enter(`title${s}`),u+=l.move(" "+r),u+=l.move(n.safe(t.title,{before:u,after:r,...l.current()})),u+=l.move(r),o()),u+=l.move(")"),a(),u}function Jq(){return"!"}rI.peek=eV;function rI(t,e,n,i){const r=t.referenceType,s=n.enter("imageReference");let a=n.enter("label");const o=n.createTracker(i);let l=o.move("![");const u=n.safe(t.alt,{before:l,after:"]",...o.current()});l+=o.move(u+"]["),a();const d=n.stack;n.stack=[],a=n.enter("reference");const f=n.safe(n.associationId(t),{before:l,after:"]",...o.current()});return a(),n.stack=d,s(),r==="full"||!u||u!==f?l+=o.move(f+"]"):r==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function eV(){return"!"}sI.peek=tV;function sI(t,e,n){let i=t.value||"",r="`",s=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++s<n.unsafe.length;){const a=n.unsafe[s],o=n.compilePattern(a);let l;if(a.atBreak)for(;l=o.exec(i);){let u=l.index;i.charCodeAt(u)===10&&i.charCodeAt(u-1)===13&&u--,i=i.slice(0,u)+" "+i.slice(l.index+1)}}return r+i+r}function tV(){return"`"}function aI(t,e){const n=ob(t);return!!(!e.options.resourceLink&&t.url&&!t.title&&t.children&&t.children.length===1&&t.children[0].type==="text"&&(n===t.url||"mailto:"+n===t.url)&&/^[a-z][a-z+.-]+:/i.test(t.url)&&!/[\0- <>\u007F]/.test(t.url))}oI.peek=nV;function oI(t,e,n,i){const r=ab(n),s=r==='"'?"Quote":"Apostrophe",a=n.createTracker(i);let o,l;if(aI(t,n)){const d=n.stack;n.stack=[],o=n.enter("autolink");let f=a.move("<");return f+=a.move(n.containerPhrasing(t,{before:f,after:">",...a.current()})),f+=a.move(">"),o(),n.stack=d,f}o=n.enter("link"),l=n.enter("label");let u=a.move("[");return u+=a.move(n.containerPhrasing(t,{before:u,after:"](",...a.current()})),u+=a.move("]("),l(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(l=n.enter("destinationLiteral"),u+=a.move("<"),u+=a.move(n.safe(t.url,{before:u,after:">",...a.current()})),u+=a.move(">")):(l=n.enter("destinationRaw"),u+=a.move(n.safe(t.url,{before:u,after:t.title?" ":")",...a.current()}))),l(),t.title&&(l=n.enter(`title${s}`),u+=a.move(" "+r),u+=a.move(n.safe(t.title,{before:u,after:r,...a.current()})),u+=a.move(r),l()),u+=a.move(")"),o(),u}function nV(t,e,n){return aI(t,n)?"<":"["}uI.peek=iV;function uI(t,e,n,i){const r=t.referenceType,s=n.enter("linkReference");let a=n.enter("label");const o=n.createTracker(i);let l=o.move("[");const u=n.containerPhrasing(t,{before:l,after:"]",...o.current()});l+=o.move(u+"]["),a();const d=n.stack;n.stack=[],a=n.enter("reference");const f=n.safe(n.associationId(t),{before:l,after:"]",...o.current()});return a(),n.stack=d,s(),r==="full"||!u||u!==f?l+=o.move(f+"]"):r==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function iV(){return"["}function ub(t){const e=t.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function rV(t){const e=ub(t),n=t.options.bulletOther;if(!n)return e==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+n+"`) to be different");return n}function sV(t){const e=t.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function lI(t){const e=t.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function aV(t,e,n,i){const r=n.enter("list"),s=n.bulletCurrent;let a=t.ordered?sV(n):ub(n);const o=t.ordered?a==="."?")":".":rV(n);let l=e&&n.bulletLastUsed?a===n.bulletLastUsed:!1;if(!t.ordered){const d=t.children?t.children[0]:void 0;if((a==="*"||a==="-")&&d&&(!d.children||!d.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(l=!0),lI(n)===a&&d){let f=-1;for(;++f<t.children.length;){const p=t.children[f];if(p&&p.type==="listItem"&&p.children&&p.children[0]&&p.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=o),n.bulletCurrent=a;const u=n.containerFlow(t,i);return n.bulletLastUsed=a,n.bulletCurrent=s,r(),u}function oV(t){const e=t.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function uV(t,e,n,i){const r=oV(n);let s=n.bulletCurrent||ub(n);e&&e.type==="list"&&e.ordered&&(s=(typeof e.start=="number"&&e.start>-1?e.start:1)+(n.options.incrementListMarker===!1?0:e.children.indexOf(t))+s);let a=s.length+1;(r==="tab"||r==="mixed"&&(e&&e.type==="list"&&e.spread||t.spread))&&(a=Math.ceil(a/4)*4);const o=n.createTracker(i);o.move(s+" ".repeat(a-s.length)),o.shift(a);const l=n.enter("listItem"),u=n.indentLines(n.containerFlow(t,o.current()),d);return l(),u;function d(f,p,m){return p?(m?"":" ".repeat(a))+f:(m?s:s+" ".repeat(a-s.length))+f}}function lV(t,e,n,i){const r=n.enter("paragraph"),s=n.enter("phrasing"),a=n.containerPhrasing(t,i);return s(),r(),a}const cV=f0(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function dV(t,e,n,i){return(t.children.some(function(a){return cV(a)})?n.containerPhrasing:n.containerFlow).call(n,t,i)}function fV(t){const e=t.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}cI.peek=hV;function cI(t,e,n,i){const r=fV(n),s=n.enter("strong"),a=n.createTracker(i),o=a.move(r+r);let l=a.move(n.containerPhrasing(t,{after:r,before:o,...a.current()}));const u=l.charCodeAt(0),d=Bh(i.before.charCodeAt(i.before.length-1),u,r);d.inside&&(l=Nc(u)+l.slice(1));const f=l.charCodeAt(l.length-1),p=Bh(i.after.charCodeAt(0),f,r);p.inside&&(l=l.slice(0,-1)+Nc(f));const m=a.move(r+r);return s(),n.attentionEncodeSurroundingInfo={after:p.outside,before:d.outside},o+l+m}function hV(t,e,n){return n.options.strong||"*"}function pV(t,e,n,i){return n.safe(t.value,i)}function mV(t){const e=t.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function gV(t,e,n){const i=(lI(n)+(n.options.ruleSpaces?" ":"")).repeat(mV(n));return n.options.ruleSpaces?i.slice(0,-1):i}const dI={blockquote:Bq,break:RA,code:Vq,definition:jq,emphasis:eI,hardBreak:RA,heading:Qq,html:nI,image:iI,imageReference:rI,inlineCode:sI,link:oI,linkReference:uI,list:aV,listItem:uV,paragraph:lV,root:dV,strong:cI,text:pV,thematicBreak:gV},IA=document.createElement("i");function lb(t){const e="&"+t+";";IA.innerHTML=e;const n=IA.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function fI(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}const yV=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function vV(t){return t.replace(yV,bV)}function bV(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const r=n.charCodeAt(1),s=r===120||r===88;return fI(n.slice(s?2:1),s?16:10)}return lb(n)||t}function EV(){return{enter:{table:TV,tableData:LA,tableHeader:LA,tableRow:SV},exit:{codeText:AV,table:xV,tableData:Tg,tableHeader:Tg,tableRow:Tg}}}function TV(t){const e=t._align;this.enter({type:"table",align:e.map(function(n){return n==="none"?null:n}),children:[]},t),this.data.inTable=!0}function xV(t){this.exit(t),this.data.inTable=void 0}function SV(t){this.enter({type:"tableRow",children:[]},t)}function Tg(t){this.exit(t)}function LA(t){this.enter({type:"tableCell",children:[]},t)}function AV(t){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,wV));const n=this.stack[this.stack.length-1];n.type,n.value=e,this.exit(t)}function wV(t,e){return e==="|"?e:t}function CV(t){const e=t||{},n=e.tableCellPadding,i=e.tablePipeAlign,r=e.stringLength,s=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:p,table:a,tableCell:l,tableRow:o}};function a(m,y,b,E){return u(d(m,b,E),m.align)}function o(m,y,b,E){const T=f(m,b,E),x=u([T]);return x.slice(0,x.indexOf(`
`))}function l(m,y,b,E){const T=b.enter("tableCell"),x=b.enter("phrasing"),S=b.containerPhrasing(m,{...E,before:s,after:s});return x(),T(),S}function u(m,y){return Nq(m,{align:y,alignDelimiters:i,padding:n,stringLength:r})}function d(m,y,b){const E=m.children;let T=-1;const x=[],S=y.enter("table");for(;++T<E.length;)x[T]=f(E[T],y,b);return S(),x}function f(m,y,b){const E=m.children;let T=-1;const x=[],S=y.enter("tableRow");for(;++T<E.length;)x[T]=l(E[T],m,y,b);return S(),x}function p(m,y,b){let E=dI.inlineCode(m,y,b);return b.stack.includes("tableCell")&&(E=E.replace(/\|/g,"\\$&")),E}}function RV(){return{exit:{taskListCheckValueChecked:DA,taskListCheckValueUnchecked:DA,paragraph:IV}}}function _V(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:LV}}}function DA(t){const e=this.stack[this.stack.length-2];e.type,e.checked=t.type==="taskListCheckValueChecked"}function IV(t){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const i=n.children[0];if(i&&i.type==="text"){const r=e.children;let s=-1,a;for(;++s<r.length;){const o=r[s];if(o.type==="paragraph"){a=o;break}}a===n&&(i.value=i.value.slice(1),i.value.length===0?n.children.shift():n.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,n.position.start=Object.assign({},i.position.start)))}}this.exit(t)}function LV(t,e,n,i){const r=t.children[0],s=typeof t.checked=="boolean"&&r&&r.type==="paragraph",a="["+(t.checked?"x":" ")+"] ",o=n.createTracker(i);s&&o.move(a);let l=dI.listItem(t,e,n,{...i,...o.current()});return s&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),l;function u(d){return d+a}}function DV(){return[rq(),wq(),Iq(),EV(),RV()]}function OV(t){return{extensions:[sq(),Cq(t),Lq(),CV(t),_V()]}}function Ri(t,e,n,i){const r=t.length;let s=0,a;if(e<0?e=-e>r?0:r+e:e=e>r?r:e,n=n>0?n:0,i.length<1e4)a=Array.from(i),a.unshift(e,n),t.splice(...a);else for(n&&t.splice(e,n);s<i.length;)a=i.slice(s,s+1e4),a.unshift(e,0),t.splice(...a),s+=1e4,e+=1e4}function Gi(t,e){return t.length>0?(Ri(t,t.length,0,e),t):e}const OA={}.hasOwnProperty;function hI(t){const e={};let n=-1;for(;++n<t.length;)PV(e,t[n]);return e}function PV(t,e){let n;for(n in e){const r=(OA.call(t,n)?t[n]:void 0)||(t[n]={}),s=e[n];let a;if(s)for(a in s){OA.call(r,a)||(r[a]=[]);const o=s[a];kV(r[a],Array.isArray(o)?o:o?[o]:[])}}}function kV(t,e){let n=-1;const i=[];for(;++n<e.length;)(e[n].add==="after"?t:i).push(e[n]);Ri(t,0,0,i)}const NV={tokenize:zV,partial:!0},pI={tokenize:qV,partial:!0},mI={tokenize:VV,partial:!0},gI={tokenize:GV,partial:!0},MV={tokenize:jV,partial:!0},yI={name:"wwwAutolink",tokenize:UV,previous:bI},vI={name:"protocolAutolink",tokenize:HV,previous:EI},vs={name:"emailAutolink",tokenize:FV,previous:TI},kr={};function BV(){return{text:kr}}let za=48;for(;za<123;)kr[za]=vs,za++,za===58?za=65:za===91&&(za=97);kr[43]=vs;kr[45]=vs;kr[46]=vs;kr[95]=vs;kr[72]=[vs,vI];kr[104]=[vs,vI];kr[87]=[vs,yI];kr[119]=[vs,yI];function FV(t,e,n){const i=this;let r,s;return a;function a(f){return!Ny(f)||!TI.call(i,i.previous)||cb(i.events)?n(f):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),o(f))}function o(f){return Ny(f)?(t.consume(f),o):f===64?(t.consume(f),l):n(f)}function l(f){return f===46?t.check(MV,d,u)(f):f===45||f===95||Gn(f)?(s=!0,t.consume(f),l):d(f)}function u(f){return t.consume(f),r=!0,l}function d(f){return s&&r&&Zn(i.previous)?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),e(f)):n(f)}}function UV(t,e,n){const i=this;return r;function r(a){return a!==87&&a!==119||!bI.call(i,i.previous)||cb(i.events)?n(a):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(NV,t.attempt(pI,t.attempt(mI,s),n),n)(a))}function s(a){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),e(a)}}function HV(t,e,n){const i=this;let r="",s=!1;return a;function a(f){return(f===72||f===104)&&EI.call(i,i.previous)&&!cb(i.events)?(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),r+=String.fromCodePoint(f),t.consume(f),o):n(f)}function o(f){if(Zn(f)&&r.length<5)return r+=String.fromCodePoint(f),t.consume(f),o;if(f===58){const p=r.toLowerCase();if(p==="http"||p==="https")return t.consume(f),l}return n(f)}function l(f){return f===47?(t.consume(f),s?u:(s=!0,l)):n(f)}function u(f){return f===null||Mh(f)||$t(f)||uo(f)||p0(f)?n(f):t.attempt(pI,t.attempt(mI,d),n)(f)}function d(f){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),e(f)}}function zV(t,e,n){let i=0;return r;function r(a){return(a===87||a===119)&&i<3?(i++,t.consume(a),r):a===46&&i===3?(t.consume(a),s):n(a)}function s(a){return a===null?n(a):e(a)}}function qV(t,e,n){let i,r,s;return a;function a(u){return u===46||u===95?t.check(gI,l,o)(u):u===null||$t(u)||uo(u)||u!==45&&p0(u)?l(u):(s=!0,t.consume(u),a)}function o(u){return u===95?i=!0:(r=i,i=void 0),t.consume(u),a}function l(u){return r||i||!s?n(u):e(u)}}function VV(t,e){let n=0,i=0;return r;function r(a){return a===40?(n++,t.consume(a),r):a===41&&i<n?s(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?t.check(gI,e,s)(a):a===null||$t(a)||uo(a)?e(a):(t.consume(a),r)}function s(a){return a===41&&i++,t.consume(a),r}}function GV(t,e,n){return i;function i(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(t.consume(o),i):o===38?(t.consume(o),s):o===93?(t.consume(o),r):o===60||o===null||$t(o)||uo(o)?e(o):n(o)}function r(o){return o===null||o===40||o===91||$t(o)||uo(o)?e(o):i(o)}function s(o){return Zn(o)?a(o):n(o)}function a(o){return o===59?(t.consume(o),i):Zn(o)?(t.consume(o),a):n(o)}}function jV(t,e,n){return i;function i(s){return t.consume(s),r}function r(s){return Gn(s)?n(s):e(s)}}function bI(t){return t===null||t===40||t===42||t===95||t===91||t===93||t===126||$t(t)}function EI(t){return!Zn(t)}function TI(t){return!(t===47||Ny(t))}function Ny(t){return t===43||t===45||t===46||t===95||Gn(t)}function cb(t){let e=t.length,n=!1;for(;e--;){const i=t[e][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return t.length>0&&!n&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}function Zu(t){const e=[];let n=-1,i=0,r=0;for(;++n<t.length;){const s=t.charCodeAt(n);let a="";if(s===37&&Gn(t.charCodeAt(n+1))&&Gn(t.charCodeAt(n+2)))r=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(a=String.fromCharCode(s));else if(s>55295&&s<57344){const o=t.charCodeAt(n+1);s<56320&&o>56319&&o<57344?(a=String.fromCharCode(s,o),r=1):a=""}else a=String.fromCharCode(s);a&&(e.push(t.slice(i,n),encodeURIComponent(a)),i=n+r+1,a=""),r&&(n+=r,r=0)}return e.join("")+t.slice(i)}function m0(t,e,n){const i=[];let r=-1;for(;++r<t.length;){const s=t[r].resolveAll;s&&!i.includes(s)&&(e=s(e,n),i.push(s))}return e}const My={name:"attention",resolveAll:WV,tokenize:$V};function WV(t,e){let n=-1,i,r,s,a,o,l,u,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(i=n;i--;)if(t[i][0]==="exit"&&t[i][1].type==="attentionSequence"&&t[i][1]._open&&e.sliceSerialize(t[i][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[i][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[i][1].end.offset-t[i][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;l=t[i][1].end.offset-t[i][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const f={...t[i][1].end},p={...t[n][1].start};PA(f,-l),PA(p,l),a={type:l>1?"strongSequence":"emphasisSequence",start:f,end:{...t[i][1].end}},o={type:l>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:p},s={type:l>1?"strongText":"emphasisText",start:{...t[i][1].end},end:{...t[n][1].start}},r={type:l>1?"strong":"emphasis",start:{...a.start},end:{...o.end}},t[i][1].end={...a.start},t[n][1].start={...o.end},u=[],t[i][1].end.offset-t[i][1].start.offset&&(u=Gi(u,[["enter",t[i][1],e],["exit",t[i][1],e]])),u=Gi(u,[["enter",r,e],["enter",a,e],["exit",a,e],["enter",s,e]]),u=Gi(u,m0(e.parser.constructs.insideSpan.null,t.slice(i+1,n),e)),u=Gi(u,[["exit",s,e],["enter",o,e],["exit",o,e],["exit",r,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,u=Gi(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,Ri(t,i-1,n-i+3,u),n=i+u.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function $V(t,e){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,r=zu(i);let s;return a;function a(l){return s=l,t.enter("attentionSequence"),o(l)}function o(l){if(l===s)return t.consume(l),o;const u=t.exit("attentionSequence"),d=zu(l),f=!d||d===2&&r||n.includes(l),p=!r||r===2&&d||n.includes(i);return u._open=!!(s===42?f:f&&(r||!p)),u._close=!!(s===42?p:p&&(d||!f)),e(l)}}function PA(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const YV={name:"autolink",tokenize:KV};function KV(t,e,n){let i=0;return r;function r(m){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),s}function s(m){return Zn(m)?(t.consume(m),a):m===64?n(m):u(m)}function a(m){return m===43||m===45||m===46||Gn(m)?(i=1,o(m)):u(m)}function o(m){return m===58?(t.consume(m),i=0,l):(m===43||m===45||m===46||Gn(m))&&i++<32?(t.consume(m),o):(i=0,u(m))}function l(m){return m===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):m===null||m===32||m===60||Mh(m)?n(m):(t.consume(m),l)}function u(m){return m===64?(t.consume(m),d):Xz(m)?(t.consume(m),u):n(m)}function d(m){return Gn(m)?f(m):n(m)}function f(m){return m===46?(t.consume(m),i=0,d):m===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):p(m)}function p(m){if((m===45||Gn(m))&&i++<63){const y=m===45?p:f;return t.consume(m),y}return n(m)}}function Ot(t,e,n,i){const r=i?i-1:Number.POSITIVE_INFINITY;let s=0;return a;function a(l){return It(l)?(t.enter(n),o(l)):e(l)}function o(l){return It(l)&&s++<r?(t.consume(l),o):(t.exit(n),e(l))}}const td={partial:!0,tokenize:XV};function XV(t,e,n){return i;function i(s){return It(s)?Ot(t,r,"linePrefix")(s):r(s)}function r(s){return s===null||at(s)?e(s):n(s)}}const xI={continuation:{tokenize:ZV},exit:JV,name:"blockQuote",tokenize:QV};function QV(t,e,n){const i=this;return r;function r(a){if(a===62){const o=i.containerState;return o.open||(t.enter("blockQuote",{_container:!0}),o.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(a),t.exit("blockQuoteMarker"),s}return n(a)}function s(a){return It(a)?(t.enter("blockQuotePrefixWhitespace"),t.consume(a),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(a))}}function ZV(t,e,n){const i=this;return r;function r(a){return It(a)?Ot(t,s,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):s(a)}function s(a){return t.attempt(xI,e,n)(a)}}function JV(t){t.exit("blockQuote")}const SI={name:"characterEscape",tokenize:eG};function eG(t,e,n){return i;function i(s){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(s),t.exit("escapeMarker"),r}function r(s){return Zz(s)?(t.enter("characterEscapeValue"),t.consume(s),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(s)}}const AI={name:"characterReference",tokenize:tG};function tG(t,e,n){const i=this;let r=0,s,a;return o;function o(f){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(f),t.exit("characterReferenceMarker"),l}function l(f){return f===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(f),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),s=31,a=Gn,d(f))}function u(f){return f===88||f===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(f),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),s=6,a=Qz,d):(t.enter("characterReferenceValue"),s=7,a=ky,d(f))}function d(f){if(f===59&&r){const p=t.exit("characterReferenceValue");return a===Gn&&!lb(i.sliceSerialize(p))?n(f):(t.enter("characterReferenceMarker"),t.consume(f),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return a(f)&&r++<s?(t.consume(f),d):n(f)}}const kA={partial:!0,tokenize:iG},NA={concrete:!0,name:"codeFenced",tokenize:nG};function nG(t,e,n){const i=this,r={partial:!0,tokenize:C};let s=0,a=0,o;return l;function l(I){return u(I)}function u(I){const L=i.events[i.events.length-1];return s=L&&L[1].type==="linePrefix"?L[2].sliceSerialize(L[1],!0).length:0,o=I,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(I)}function d(I){return I===o?(a++,t.consume(I),d):a<3?n(I):(t.exit("codeFencedFenceSequence"),It(I)?Ot(t,f,"whitespace")(I):f(I))}function f(I){return I===null||at(I)?(t.exit("codeFencedFence"),i.interrupt?e(I):t.check(kA,b,w)(I)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),p(I))}function p(I){return I===null||at(I)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),f(I)):It(I)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Ot(t,m,"whitespace")(I)):I===96&&I===o?n(I):(t.consume(I),p)}function m(I){return I===null||at(I)?f(I):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),y(I))}function y(I){return I===null||at(I)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),f(I)):I===96&&I===o?n(I):(t.consume(I),y)}function b(I){return t.attempt(r,w,E)(I)}function E(I){return t.enter("lineEnding"),t.consume(I),t.exit("lineEnding"),T}function T(I){return s>0&&It(I)?Ot(t,x,"linePrefix",s+1)(I):x(I)}function x(I){return I===null||at(I)?t.check(kA,b,w)(I):(t.enter("codeFlowValue"),S(I))}function S(I){return I===null||at(I)?(t.exit("codeFlowValue"),x(I)):(t.consume(I),S)}function w(I){return t.exit("codeFenced"),e(I)}function C(I,L,N){let G=0;return O;function O(K){return I.enter("lineEnding"),I.consume(K),I.exit("lineEnding"),D}function D(K){return I.enter("codeFencedFence"),It(K)?Ot(I,V,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(K):V(K)}function V(K){return K===o?(I.enter("codeFencedFenceSequence"),$(K)):N(K)}function $(K){return K===o?(G++,I.consume(K),$):G>=a?(I.exit("codeFencedFenceSequence"),It(K)?Ot(I,J,"whitespace")(K):J(K)):N(K)}function J(K){return K===null||at(K)?(I.exit("codeFencedFence"),L(K)):N(K)}}}function iG(t,e,n){const i=this;return r;function r(a){return a===null?n(a):(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),s)}function s(a){return i.parser.lazy[i.now().line]?n(a):e(a)}}const xg={name:"codeIndented",tokenize:sG},rG={partial:!0,tokenize:aG};function sG(t,e,n){const i=this;return r;function r(u){return t.enter("codeIndented"),Ot(t,s,"linePrefix",5)(u)}function s(u){const d=i.events[i.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?a(u):n(u)}function a(u){return u===null?l(u):at(u)?t.attempt(rG,a,l)(u):(t.enter("codeFlowValue"),o(u))}function o(u){return u===null||at(u)?(t.exit("codeFlowValue"),a(u)):(t.consume(u),o)}function l(u){return t.exit("codeIndented"),e(u)}}function aG(t,e,n){const i=this;return r;function r(a){return i.parser.lazy[i.now().line]?n(a):at(a)?(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),r):Ot(t,s,"linePrefix",5)(a)}function s(a){const o=i.events[i.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?e(a):at(a)?r(a):n(a)}}const oG={name:"codeText",previous:lG,resolve:uG,tokenize:cG};function uG(t){let e=t.length-4,n=3,i,r;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(i=n;++i<e;)if(t[i][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(i=n-1,e++;++i<=e;)r===void 0?i!==e&&t[i][1].type!=="lineEnding"&&(r=i):(i===e||t[i][1].type==="lineEnding")&&(t[r][1].type="codeTextData",i!==r+2&&(t[r][1].end=t[i-1][1].end,t.splice(r+2,i-r-2),e-=i-r-2,i=r+2),r=void 0);return t}function lG(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function cG(t,e,n){let i=0,r,s;return a;function a(f){return t.enter("codeText"),t.enter("codeTextSequence"),o(f)}function o(f){return f===96?(t.consume(f),i++,o):(t.exit("codeTextSequence"),l(f))}function l(f){return f===null?n(f):f===32?(t.enter("space"),t.consume(f),t.exit("space"),l):f===96?(s=t.enter("codeTextSequence"),r=0,d(f)):at(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),l):(t.enter("codeTextData"),u(f))}function u(f){return f===null||f===32||f===96||at(f)?(t.exit("codeTextData"),l(f)):(t.consume(f),u)}function d(f){return f===96?(t.consume(f),r++,d):r===i?(t.exit("codeTextSequence"),t.exit("codeText"),e(f)):(s.type="codeTextData",u(f))}}class dG{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const i=n??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(e,i):e>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(e,n,i){const r=n||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return i&&sc(this.left,i),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),sc(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),sc(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);sc(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);sc(this.left,n.reverse())}}}function sc(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function wI(t){const e={};let n=-1,i,r,s,a,o,l,u;const d=new dG(t);for(;++n<d.length;){for(;n in e;)n=e[n];if(i=d.get(n),n&&i[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(l=i[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(i[0]==="enter")i[1].contentType&&(Object.assign(e,fG(d,n)),n=e[n],u=!0);else if(i[1]._container){for(s=n,r=void 0;s--;)if(a=d.get(s),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(r&&(d.get(r)[1].type="lineEndingBlank"),a[1].type="lineEnding",r=s);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;r&&(i[1].end={...d.get(r)[1].start},o=d.slice(r,n),o.unshift(i),d.splice(r,n-r+1,o))}}return Ri(t,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function fG(t,e){const n=t.get(e)[1],i=t.get(e)[2];let r=e-1;const s=[];let a=n._tokenizer;a||(a=i.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const o=a.events,l=[],u={};let d,f,p=-1,m=n,y=0,b=0;const E=[b];for(;m;){for(;t.get(++r)[1]!==m;);s.push(r),m._tokenizer||(d=i.sliceStream(m),m.next||d.push(null),f&&a.defineSkip(m.start),m._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(d),m._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),f=m,m=m.next}for(m=n;++p<o.length;)o[p][0]==="exit"&&o[p-1][0]==="enter"&&o[p][1].type===o[p-1][1].type&&o[p][1].start.line!==o[p][1].end.line&&(b=p+1,E.push(b),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(a.events=[],m?(m._tokenizer=void 0,m.previous=void 0):E.pop(),p=E.length;p--;){const T=o.slice(E[p],E[p+1]),x=s.pop();l.push([x,x+T.length-1]),t.splice(x,2,T)}for(l.reverse(),p=-1;++p<l.length;)u[y+l[p][0]]=y+l[p][1],y+=l[p][1]-l[p][0]-1;return u}const hG={resolve:mG,tokenize:gG},pG={partial:!0,tokenize:yG};function mG(t){return wI(t),t}function gG(t,e){let n;return i;function i(o){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),r(o)}function r(o){return o===null?s(o):at(o)?t.check(pG,a,s)(o):(t.consume(o),r)}function s(o){return t.exit("chunkContent"),t.exit("content"),e(o)}function a(o){return t.consume(o),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,r}}function yG(t,e,n){const i=this;return r;function r(a){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),Ot(t,s,"linePrefix")}function s(a){if(a===null||at(a))return n(a);const o=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?e(a):t.interrupt(i.parser.constructs.flow,n,e)(a)}}function CI(t,e,n,i,r,s,a,o,l){const u=l||Number.POSITIVE_INFINITY;let d=0;return f;function f(T){return T===60?(t.enter(i),t.enter(r),t.enter(s),t.consume(T),t.exit(s),p):T===null||T===32||T===41||Mh(T)?n(T):(t.enter(i),t.enter(a),t.enter(o),t.enter("chunkString",{contentType:"string"}),b(T))}function p(T){return T===62?(t.enter(s),t.consume(T),t.exit(s),t.exit(r),t.exit(i),e):(t.enter(o),t.enter("chunkString",{contentType:"string"}),m(T))}function m(T){return T===62?(t.exit("chunkString"),t.exit(o),p(T)):T===null||T===60||at(T)?n(T):(t.consume(T),T===92?y:m)}function y(T){return T===60||T===62||T===92?(t.consume(T),m):m(T)}function b(T){return!d&&(T===null||T===41||$t(T))?(t.exit("chunkString"),t.exit(o),t.exit(a),t.exit(i),e(T)):d<u&&T===40?(t.consume(T),d++,b):T===41?(t.consume(T),d--,b):T===null||T===32||T===40||Mh(T)?n(T):(t.consume(T),T===92?E:b)}function E(T){return T===40||T===41||T===92?(t.consume(T),b):b(T)}}function RI(t,e,n,i,r,s){const a=this;let o=0,l;return u;function u(m){return t.enter(i),t.enter(r),t.consume(m),t.exit(r),t.enter(s),d}function d(m){return o>999||m===null||m===91||m===93&&!l||m===94&&!o&&"_hiddenFootnoteSupport"in a.parser.constructs?n(m):m===93?(t.exit(s),t.enter(r),t.consume(m),t.exit(r),t.exit(i),e):at(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),f(m))}function f(m){return m===null||m===91||m===93||at(m)||o++>999?(t.exit("chunkString"),d(m)):(t.consume(m),l||(l=!It(m)),m===92?p:f)}function p(m){return m===91||m===92||m===93?(t.consume(m),o++,f):f(m)}}function _I(t,e,n,i,r,s){let a;return o;function o(p){return p===34||p===39||p===40?(t.enter(i),t.enter(r),t.consume(p),t.exit(r),a=p===40?41:p,l):n(p)}function l(p){return p===a?(t.enter(r),t.consume(p),t.exit(r),t.exit(i),e):(t.enter(s),u(p))}function u(p){return p===a?(t.exit(s),l(a)):p===null?n(p):at(p)?(t.enter("lineEnding"),t.consume(p),t.exit("lineEnding"),Ot(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(p))}function d(p){return p===a||p===null||at(p)?(t.exit("chunkString"),u(p)):(t.consume(p),p===92?f:d)}function f(p){return p===a||p===92?(t.consume(p),d):d(p)}}function Ac(t,e){let n;return i;function i(r){return at(r)?(t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),n=!0,i):It(r)?Ot(t,i,n?"linePrefix":"lineSuffix")(r):e(r)}}const vG={name:"definition",tokenize:EG},bG={partial:!0,tokenize:TG};function EG(t,e,n){const i=this;let r;return s;function s(m){return t.enter("definition"),a(m)}function a(m){return RI.call(i,t,o,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function o(m){return r=or(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),m===58?(t.enter("definitionMarker"),t.consume(m),t.exit("definitionMarker"),l):n(m)}function l(m){return $t(m)?Ac(t,u)(m):u(m)}function u(m){return CI(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return t.attempt(bG,f,f)(m)}function f(m){return It(m)?Ot(t,p,"whitespace")(m):p(m)}function p(m){return m===null||at(m)?(t.exit("definition"),i.parser.defined.push(r),e(m)):n(m)}}function TG(t,e,n){return i;function i(o){return $t(o)?Ac(t,r)(o):n(o)}function r(o){return _I(t,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function s(o){return It(o)?Ot(t,a,"whitespace")(o):a(o)}function a(o){return o===null||at(o)?e(o):n(o)}}const xG={name:"hardBreakEscape",tokenize:SG};function SG(t,e,n){return i;function i(s){return t.enter("hardBreakEscape"),t.consume(s),r}function r(s){return at(s)?(t.exit("hardBreakEscape"),e(s)):n(s)}}const AG={name:"headingAtx",resolve:wG,tokenize:CG};function wG(t,e){let n=t.length-2,i=3,r,s;return t[i][1].type==="whitespace"&&(i+=2),n-2>i&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(i===n-1||n-4>i&&t[n-2][1].type==="whitespace")&&(n-=i+1===n?2:4),n>i&&(r={type:"atxHeadingText",start:t[i][1].start,end:t[n][1].end},s={type:"chunkText",start:t[i][1].start,end:t[n][1].end,contentType:"text"},Ri(t,i,n-i+1,[["enter",r,e],["enter",s,e],["exit",s,e],["exit",r,e]])),t}function CG(t,e,n){let i=0;return r;function r(d){return t.enter("atxHeading"),s(d)}function s(d){return t.enter("atxHeadingSequence"),a(d)}function a(d){return d===35&&i++<6?(t.consume(d),a):d===null||$t(d)?(t.exit("atxHeadingSequence"),o(d)):n(d)}function o(d){return d===35?(t.enter("atxHeadingSequence"),l(d)):d===null||at(d)?(t.exit("atxHeading"),e(d)):It(d)?Ot(t,o,"whitespace")(d):(t.enter("atxHeadingText"),u(d))}function l(d){return d===35?(t.consume(d),l):(t.exit("atxHeadingSequence"),o(d))}function u(d){return d===null||d===35||$t(d)?(t.exit("atxHeadingText"),o(d)):(t.consume(d),u)}}const RG=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],MA=["pre","script","style","textarea"],_G={concrete:!0,name:"htmlFlow",resolveTo:DG,tokenize:OG},IG={partial:!0,tokenize:kG},LG={partial:!0,tokenize:PG};function DG(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function OG(t,e,n){const i=this;let r,s,a,o,l;return u;function u(q){return d(q)}function d(q){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(q),f}function f(q){return q===33?(t.consume(q),p):q===47?(t.consume(q),s=!0,b):q===63?(t.consume(q),r=3,i.interrupt?e:P):Zn(q)?(t.consume(q),a=String.fromCharCode(q),E):n(q)}function p(q){return q===45?(t.consume(q),r=2,m):q===91?(t.consume(q),r=5,o=0,y):Zn(q)?(t.consume(q),r=4,i.interrupt?e:P):n(q)}function m(q){return q===45?(t.consume(q),i.interrupt?e:P):n(q)}function y(q){const ye="CDATA[";return q===ye.charCodeAt(o++)?(t.consume(q),o===ye.length?i.interrupt?e:V:y):n(q)}function b(q){return Zn(q)?(t.consume(q),a=String.fromCharCode(q),E):n(q)}function E(q){if(q===null||q===47||q===62||$t(q)){const ye=q===47,Pe=a.toLowerCase();return!ye&&!s&&MA.includes(Pe)?(r=1,i.interrupt?e(q):V(q)):RG.includes(a.toLowerCase())?(r=6,ye?(t.consume(q),T):i.interrupt?e(q):V(q)):(r=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(q):s?x(q):S(q))}return q===45||Gn(q)?(t.consume(q),a+=String.fromCharCode(q),E):n(q)}function T(q){return q===62?(t.consume(q),i.interrupt?e:V):n(q)}function x(q){return It(q)?(t.consume(q),x):O(q)}function S(q){return q===47?(t.consume(q),O):q===58||q===95||Zn(q)?(t.consume(q),w):It(q)?(t.consume(q),S):O(q)}function w(q){return q===45||q===46||q===58||q===95||Gn(q)?(t.consume(q),w):C(q)}function C(q){return q===61?(t.consume(q),I):It(q)?(t.consume(q),C):S(q)}function I(q){return q===null||q===60||q===61||q===62||q===96?n(q):q===34||q===39?(t.consume(q),l=q,L):It(q)?(t.consume(q),I):N(q)}function L(q){return q===l?(t.consume(q),l=null,G):q===null||at(q)?n(q):(t.consume(q),L)}function N(q){return q===null||q===34||q===39||q===47||q===60||q===61||q===62||q===96||$t(q)?C(q):(t.consume(q),N)}function G(q){return q===47||q===62||It(q)?S(q):n(q)}function O(q){return q===62?(t.consume(q),D):n(q)}function D(q){return q===null||at(q)?V(q):It(q)?(t.consume(q),D):n(q)}function V(q){return q===45&&r===2?(t.consume(q),j):q===60&&r===1?(t.consume(q),te):q===62&&r===4?(t.consume(q),ie):q===63&&r===3?(t.consume(q),P):q===93&&r===5?(t.consume(q),oe):at(q)&&(r===6||r===7)?(t.exit("htmlFlowData"),t.check(IG,le,$)(q)):q===null||at(q)?(t.exit("htmlFlowData"),$(q)):(t.consume(q),V)}function $(q){return t.check(LG,J,le)(q)}function J(q){return t.enter("lineEnding"),t.consume(q),t.exit("lineEnding"),K}function K(q){return q===null||at(q)?$(q):(t.enter("htmlFlowData"),V(q))}function j(q){return q===45?(t.consume(q),P):V(q)}function te(q){return q===47?(t.consume(q),a="",ne):V(q)}function ne(q){if(q===62){const ye=a.toLowerCase();return MA.includes(ye)?(t.consume(q),ie):V(q)}return Zn(q)&&a.length<8?(t.consume(q),a+=String.fromCharCode(q),ne):V(q)}function oe(q){return q===93?(t.consume(q),P):V(q)}function P(q){return q===62?(t.consume(q),ie):q===45&&r===2?(t.consume(q),P):V(q)}function ie(q){return q===null||at(q)?(t.exit("htmlFlowData"),le(q)):(t.consume(q),ie)}function le(q){return t.exit("htmlFlow"),e(q)}}function PG(t,e,n){const i=this;return r;function r(a){return at(a)?(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),s):n(a)}function s(a){return i.parser.lazy[i.now().line]?n(a):e(a)}}function kG(t,e,n){return i;function i(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),t.attempt(td,e,n)}}const NG={name:"htmlText",tokenize:MG};function MG(t,e,n){const i=this;let r,s,a;return o;function o(P){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(P),l}function l(P){return P===33?(t.consume(P),u):P===47?(t.consume(P),C):P===63?(t.consume(P),S):Zn(P)?(t.consume(P),N):n(P)}function u(P){return P===45?(t.consume(P),d):P===91?(t.consume(P),s=0,y):Zn(P)?(t.consume(P),x):n(P)}function d(P){return P===45?(t.consume(P),m):n(P)}function f(P){return P===null?n(P):P===45?(t.consume(P),p):at(P)?(a=f,te(P)):(t.consume(P),f)}function p(P){return P===45?(t.consume(P),m):f(P)}function m(P){return P===62?j(P):P===45?p(P):f(P)}function y(P){const ie="CDATA[";return P===ie.charCodeAt(s++)?(t.consume(P),s===ie.length?b:y):n(P)}function b(P){return P===null?n(P):P===93?(t.consume(P),E):at(P)?(a=b,te(P)):(t.consume(P),b)}function E(P){return P===93?(t.consume(P),T):b(P)}function T(P){return P===62?j(P):P===93?(t.consume(P),T):b(P)}function x(P){return P===null||P===62?j(P):at(P)?(a=x,te(P)):(t.consume(P),x)}function S(P){return P===null?n(P):P===63?(t.consume(P),w):at(P)?(a=S,te(P)):(t.consume(P),S)}function w(P){return P===62?j(P):S(P)}function C(P){return Zn(P)?(t.consume(P),I):n(P)}function I(P){return P===45||Gn(P)?(t.consume(P),I):L(P)}function L(P){return at(P)?(a=L,te(P)):It(P)?(t.consume(P),L):j(P)}function N(P){return P===45||Gn(P)?(t.consume(P),N):P===47||P===62||$t(P)?G(P):n(P)}function G(P){return P===47?(t.consume(P),j):P===58||P===95||Zn(P)?(t.consume(P),O):at(P)?(a=G,te(P)):It(P)?(t.consume(P),G):j(P)}function O(P){return P===45||P===46||P===58||P===95||Gn(P)?(t.consume(P),O):D(P)}function D(P){return P===61?(t.consume(P),V):at(P)?(a=D,te(P)):It(P)?(t.consume(P),D):G(P)}function V(P){return P===null||P===60||P===61||P===62||P===96?n(P):P===34||P===39?(t.consume(P),r=P,$):at(P)?(a=V,te(P)):It(P)?(t.consume(P),V):(t.consume(P),J)}function $(P){return P===r?(t.consume(P),r=void 0,K):P===null?n(P):at(P)?(a=$,te(P)):(t.consume(P),$)}function J(P){return P===null||P===34||P===39||P===60||P===61||P===96?n(P):P===47||P===62||$t(P)?G(P):(t.consume(P),J)}function K(P){return P===47||P===62||$t(P)?G(P):n(P)}function j(P){return P===62?(t.consume(P),t.exit("htmlTextData"),t.exit("htmlText"),e):n(P)}function te(P){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(P),t.exit("lineEnding"),ne}function ne(P){return It(P)?Ot(t,oe,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(P):oe(P)}function oe(P){return t.enter("htmlTextData"),a(P)}}const db={name:"labelEnd",resolveAll:HG,resolveTo:zG,tokenize:qG},BG={tokenize:VG},FG={tokenize:GG},UG={tokenize:jG};function HG(t){let e=-1;const n=[];for(;++e<t.length;){const i=t[e][1];if(n.push(t[e]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const r=i.type==="labelImage"?4:2;i.type="data",e+=r}}return t.length!==n.length&&Ri(t,0,t.length,n),t}function zG(t,e){let n=t.length,i=0,r,s,a,o;for(;n--;)if(r=t[n][1],s){if(r.type==="link"||r.type==="labelLink"&&r._inactive)break;t[n][0]==="enter"&&r.type==="labelLink"&&(r._inactive=!0)}else if(a){if(t[n][0]==="enter"&&(r.type==="labelImage"||r.type==="labelLink")&&!r._balanced&&(s=n,r.type!=="labelLink")){i=2;break}}else r.type==="labelEnd"&&(a=n);const l={type:t[s][1].type==="labelLink"?"link":"image",start:{...t[s][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[s][1].start},end:{...t[a][1].end}},d={type:"labelText",start:{...t[s+i+2][1].end},end:{...t[a-2][1].start}};return o=[["enter",l,e],["enter",u,e]],o=Gi(o,t.slice(s+1,s+i+3)),o=Gi(o,[["enter",d,e]]),o=Gi(o,m0(e.parser.constructs.insideSpan.null,t.slice(s+i+4,a-3),e)),o=Gi(o,[["exit",d,e],t[a-2],t[a-1],["exit",u,e]]),o=Gi(o,t.slice(a+1)),o=Gi(o,[["exit",l,e]]),Ri(t,s,t.length,o),t}function qG(t,e,n){const i=this;let r=i.events.length,s,a;for(;r--;)if((i.events[r][1].type==="labelImage"||i.events[r][1].type==="labelLink")&&!i.events[r][1]._balanced){s=i.events[r][1];break}return o;function o(p){return s?s._inactive?f(p):(a=i.parser.defined.includes(or(i.sliceSerialize({start:s.end,end:i.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(p),t.exit("labelMarker"),t.exit("labelEnd"),l):n(p)}function l(p){return p===40?t.attempt(BG,d,a?d:f)(p):p===91?t.attempt(FG,d,a?u:f)(p):a?d(p):f(p)}function u(p){return t.attempt(UG,d,f)(p)}function d(p){return e(p)}function f(p){return s._balanced=!0,n(p)}}function VG(t,e,n){return i;function i(f){return t.enter("resource"),t.enter("resourceMarker"),t.consume(f),t.exit("resourceMarker"),r}function r(f){return $t(f)?Ac(t,s)(f):s(f)}function s(f){return f===41?d(f):CI(t,a,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(f)}function a(f){return $t(f)?Ac(t,l)(f):d(f)}function o(f){return n(f)}function l(f){return f===34||f===39||f===40?_I(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(f):d(f)}function u(f){return $t(f)?Ac(t,d)(f):d(f)}function d(f){return f===41?(t.enter("resourceMarker"),t.consume(f),t.exit("resourceMarker"),t.exit("resource"),e):n(f)}}function GG(t,e,n){const i=this;return r;function r(o){return RI.call(i,t,s,a,"reference","referenceMarker","referenceString")(o)}function s(o){return i.parser.defined.includes(or(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?e(o):n(o)}function a(o){return n(o)}}function jG(t,e,n){return i;function i(s){return t.enter("reference"),t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),r}function r(s){return s===93?(t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),t.exit("reference"),e):n(s)}}const WG={name:"labelStartImage",resolveAll:db.resolveAll,tokenize:$G};function $G(t,e,n){const i=this;return r;function r(o){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(o),t.exit("labelImageMarker"),s}function s(o){return o===91?(t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelImage"),a):n(o)}function a(o){return o===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(o):e(o)}}const YG={name:"labelStartLink",resolveAll:db.resolveAll,tokenize:KG};function KG(t,e,n){const i=this;return r;function r(a){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(a),t.exit("labelMarker"),t.exit("labelLink"),s}function s(a){return a===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(a):e(a)}}const Sg={name:"lineEnding",tokenize:XG};function XG(t,e){return n;function n(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),Ot(t,e,"linePrefix")}}const fh={name:"thematicBreak",tokenize:QG};function QG(t,e,n){let i=0,r;return s;function s(u){return t.enter("thematicBreak"),a(u)}function a(u){return r=u,o(u)}function o(u){return u===r?(t.enter("thematicBreakSequence"),l(u)):i>=3&&(u===null||at(u))?(t.exit("thematicBreak"),e(u)):n(u)}function l(u){return u===r?(t.consume(u),i++,l):(t.exit("thematicBreakSequence"),It(u)?Ot(t,o,"whitespace")(u):o(u))}}const ui={continuation:{tokenize:tj},exit:ij,name:"list",tokenize:ej},ZG={partial:!0,tokenize:rj},JG={partial:!0,tokenize:nj};function ej(t,e,n){const i=this,r=i.events[i.events.length-1];let s=r&&r[1].type==="linePrefix"?r[2].sliceSerialize(r[1],!0).length:0,a=0;return o;function o(m){const y=i.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(y==="listUnordered"?!i.containerState.marker||m===i.containerState.marker:ky(m)){if(i.containerState.type||(i.containerState.type=y,t.enter(y,{_container:!0})),y==="listUnordered")return t.enter("listItemPrefix"),m===42||m===45?t.check(fh,n,u)(m):u(m);if(!i.interrupt||m===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),l(m)}return n(m)}function l(m){return ky(m)&&++a<10?(t.consume(m),l):(!i.interrupt||a<2)&&(i.containerState.marker?m===i.containerState.marker:m===41||m===46)?(t.exit("listItemValue"),u(m)):n(m)}function u(m){return t.enter("listItemMarker"),t.consume(m),t.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||m,t.check(td,i.interrupt?n:d,t.attempt(ZG,p,f))}function d(m){return i.containerState.initialBlankLine=!0,s++,p(m)}function f(m){return It(m)?(t.enter("listItemPrefixWhitespace"),t.consume(m),t.exit("listItemPrefixWhitespace"),p):n(m)}function p(m){return i.containerState.size=s+i.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(m)}}function tj(t,e,n){const i=this;return i.containerState._closeFlow=void 0,t.check(td,r,s);function r(o){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,Ot(t,e,"listItemIndent",i.containerState.size+1)(o)}function s(o){return i.containerState.furtherBlankLines||!It(o)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,a(o)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,t.attempt(JG,e,a)(o))}function a(o){return i.containerState._closeFlow=!0,i.interrupt=void 0,Ot(t,t.attempt(ui,e,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function nj(t,e,n){const i=this;return Ot(t,r,"listItemIndent",i.containerState.size+1);function r(s){const a=i.events[i.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===i.containerState.size?e(s):n(s)}}function ij(t){t.exit(this.containerState.type)}function rj(t,e,n){const i=this;return Ot(t,r,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function r(s){const a=i.events[i.events.length-1];return!It(s)&&a&&a[1].type==="listItemPrefixWhitespace"?e(s):n(s)}}const BA={name:"setextUnderline",resolveTo:sj,tokenize:aj};function sj(t,e){let n=t.length,i,r,s;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){i=n;break}t[n][1].type==="paragraph"&&(r=n)}else t[n][1].type==="content"&&t.splice(n,1),!s&&t[n][1].type==="definition"&&(s=n);const a={type:"setextHeading",start:{...t[i][1].start},end:{...t[t.length-1][1].end}};return t[r][1].type="setextHeadingText",s?(t.splice(r,0,["enter",a,e]),t.splice(s+1,0,["exit",t[i][1],e]),t[i][1].end={...t[s][1].end}):t[i][1]=a,t.push(["exit",a,e]),t}function aj(t,e,n){const i=this;let r;return s;function s(u){let d=i.events.length,f;for(;d--;)if(i.events[d][1].type!=="lineEnding"&&i.events[d][1].type!=="linePrefix"&&i.events[d][1].type!=="content"){f=i.events[d][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||f)?(t.enter("setextHeadingLine"),r=u,a(u)):n(u)}function a(u){return t.enter("setextHeadingLineSequence"),o(u)}function o(u){return u===r?(t.consume(u),o):(t.exit("setextHeadingLineSequence"),It(u)?Ot(t,l,"lineSuffix")(u):l(u))}function l(u){return u===null||at(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const oj={tokenize:mj,partial:!0};function uj(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:fj,continuation:{tokenize:hj},exit:pj}},text:{91:{name:"gfmFootnoteCall",tokenize:dj},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:lj,resolveTo:cj}}}}function lj(t,e,n){const i=this;let r=i.events.length;const s=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a;for(;r--;){const l=i.events[r][1];if(l.type==="labelImage"){a=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return o;function o(l){if(!a||!a._balanced)return n(l);const u=or(i.sliceSerialize({start:a.end,end:i.now()}));return u.codePointAt(0)!==94||!s.includes(u.slice(1))?n(l):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(l),t.exit("gfmFootnoteCallLabelMarker"),e(l))}}function cj(t,e){let n=t.length;for(;n--;)if(t[n][1].type==="labelImage"&&t[n][0]==="enter"){t[n][1];break}t[n+1][1].type="data",t[n+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},t[n+3][1].start),end:Object.assign({},t[t.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},t[n+3][1].end),end:Object.assign({},t[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},t[t.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},o=[t[n+1],t[n+2],["enter",i,e],t[n+3],t[n+4],["enter",r,e],["exit",r,e],["enter",s,e],["enter",a,e],["exit",a,e],["exit",s,e],t[t.length-2],t[t.length-1],["exit",i,e]];return t.splice(n,t.length-n+1,...o),t}function dj(t,e,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s=0,a;return o;function o(f){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(f),t.exit("gfmFootnoteCallLabelMarker"),l}function l(f){return f!==94?n(f):(t.enter("gfmFootnoteCallMarker"),t.consume(f),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",u)}function u(f){if(s>999||f===93&&!a||f===null||f===91||$t(f))return n(f);if(f===93){t.exit("chunkString");const p=t.exit("gfmFootnoteCallString");return r.includes(or(i.sliceSerialize(p)))?(t.enter("gfmFootnoteCallLabelMarker"),t.consume(f),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),e):n(f)}return $t(f)||(a=!0),s++,t.consume(f),f===92?d:u}function d(f){return f===91||f===92||f===93?(t.consume(f),s++,u):u(f)}}function fj(t,e,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s,a=0,o;return l;function l(y){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(y),t.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(y){return y===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(y),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),t.enter("chunkString").contentType="string",d):n(y)}function d(y){if(a>999||y===93&&!o||y===null||y===91||$t(y))return n(y);if(y===93){t.exit("chunkString");const b=t.exit("gfmFootnoteDefinitionLabelString");return s=or(i.sliceSerialize(b)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(y),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),p}return $t(y)||(o=!0),a++,t.consume(y),y===92?f:d}function f(y){return y===91||y===92||y===93?(t.consume(y),a++,d):d(y)}function p(y){return y===58?(t.enter("definitionMarker"),t.consume(y),t.exit("definitionMarker"),r.includes(s)||r.push(s),Ot(t,m,"gfmFootnoteDefinitionWhitespace")):n(y)}function m(y){return e(y)}}function hj(t,e,n){return t.check(td,e,t.attempt(oj,e,n))}function pj(t){t.exit("gfmFootnoteDefinition")}function mj(t,e,n){const i=this;return Ot(t,r,"gfmFootnoteDefinitionIndent",5);function r(s){const a=i.events[i.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?e(s):n(s)}}function gj(t){let n=(t||{}).singleTilde;const i={name:"strikethrough",tokenize:s,resolveAll:r};return n==null&&(n=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function r(a,o){let l=-1;for(;++l<a.length;)if(a[l][0]==="enter"&&a[l][1].type==="strikethroughSequenceTemporary"&&a[l][1]._close){let u=l;for(;u--;)if(a[u][0]==="exit"&&a[u][1].type==="strikethroughSequenceTemporary"&&a[u][1]._open&&a[l][1].end.offset-a[l][1].start.offset===a[u][1].end.offset-a[u][1].start.offset){a[l][1].type="strikethroughSequence",a[u][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},a[u][1].start),end:Object.assign({},a[l][1].end)},f={type:"strikethroughText",start:Object.assign({},a[u][1].end),end:Object.assign({},a[l][1].start)},p=[["enter",d,o],["enter",a[u][1],o],["exit",a[u][1],o],["enter",f,o]],m=o.parser.constructs.insideSpan.null;m&&Ri(p,p.length,0,m0(m,a.slice(u+1,l),o)),Ri(p,p.length,0,[["exit",f,o],["enter",a[l][1],o],["exit",a[l][1],o],["exit",d,o]]),Ri(a,u-1,l-u+3,p),l=u+p.length-2;break}}for(l=-1;++l<a.length;)a[l][1].type==="strikethroughSequenceTemporary"&&(a[l][1].type="data");return a}function s(a,o,l){const u=this.previous,d=this.events;let f=0;return p;function p(y){return u===126&&d[d.length-1][1].type!=="characterEscape"?l(y):(a.enter("strikethroughSequenceTemporary"),m(y))}function m(y){const b=zu(u);if(y===126)return f>1?l(y):(a.consume(y),f++,m);if(f<2&&!n)return l(y);const E=a.exit("strikethroughSequenceTemporary"),T=zu(y);return E._open=!T||T===2&&!!b,E._close=!b||b===2&&!!T,o(y)}}}class yj{constructor(){this.map=[]}add(e,n,i){vj(this,e,n,i)}consume(e){if(this.map.sort(function(s,a){return s[0]-a[0]}),this.map.length===0)return;let n=this.map.length;const i=[];for(;n>0;)n-=1,i.push(e.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),e.length=this.map[n][0];i.push(e.slice()),e.length=0;let r=i.pop();for(;r;){for(const s of r)e.push(s);r=i.pop()}this.map.length=0}}function vj(t,e,n,i){let r=0;if(!(n===0&&i.length===0)){for(;r<t.map.length;){if(t.map[r][0]===e){t.map[r][1]+=n,t.map[r][2].push(...i);return}r+=1}t.map.push([e,n,i])}}function bj(t,e){let n=!1;const i=[];for(;e<t.length;){const r=t[e];if(n){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(t[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(t[e-1][1].type==="tableDelimiterMarker"){const s=i.length-1;i[s]=i[s]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(n=!0);e+=1}return i}function Ej(){return{flow:{null:{name:"table",tokenize:Tj,resolveAll:xj}}}}function Tj(t,e,n){const i=this;let r=0,s=0,a;return o;function o(O){let D=i.events.length-1;for(;D>-1;){const J=i.events[D][1].type;if(J==="lineEnding"||J==="linePrefix")D--;else break}const V=D>-1?i.events[D][1].type:null,$=V==="tableHead"||V==="tableRow"?I:l;return $===I&&i.parser.lazy[i.now().line]?n(O):$(O)}function l(O){return t.enter("tableHead"),t.enter("tableRow"),u(O)}function u(O){return O===124||(a=!0,s+=1),d(O)}function d(O){return O===null?n(O):at(O)?s>1?(s=0,i.interrupt=!0,t.exit("tableRow"),t.enter("lineEnding"),t.consume(O),t.exit("lineEnding"),m):n(O):It(O)?Ot(t,d,"whitespace")(O):(s+=1,a&&(a=!1,r+=1),O===124?(t.enter("tableCellDivider"),t.consume(O),t.exit("tableCellDivider"),a=!0,d):(t.enter("data"),f(O)))}function f(O){return O===null||O===124||$t(O)?(t.exit("data"),d(O)):(t.consume(O),O===92?p:f)}function p(O){return O===92||O===124?(t.consume(O),f):f(O)}function m(O){return i.interrupt=!1,i.parser.lazy[i.now().line]?n(O):(t.enter("tableDelimiterRow"),a=!1,It(O)?Ot(t,y,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):y(O))}function y(O){return O===45||O===58?E(O):O===124?(a=!0,t.enter("tableCellDivider"),t.consume(O),t.exit("tableCellDivider"),b):C(O)}function b(O){return It(O)?Ot(t,E,"whitespace")(O):E(O)}function E(O){return O===58?(s+=1,a=!0,t.enter("tableDelimiterMarker"),t.consume(O),t.exit("tableDelimiterMarker"),T):O===45?(s+=1,T(O)):O===null||at(O)?w(O):C(O)}function T(O){return O===45?(t.enter("tableDelimiterFiller"),x(O)):C(O)}function x(O){return O===45?(t.consume(O),x):O===58?(a=!0,t.exit("tableDelimiterFiller"),t.enter("tableDelimiterMarker"),t.consume(O),t.exit("tableDelimiterMarker"),S):(t.exit("tableDelimiterFiller"),S(O))}function S(O){return It(O)?Ot(t,w,"whitespace")(O):w(O)}function w(O){return O===124?y(O):O===null||at(O)?!a||r!==s?C(O):(t.exit("tableDelimiterRow"),t.exit("tableHead"),e(O)):C(O)}function C(O){return n(O)}function I(O){return t.enter("tableRow"),L(O)}function L(O){return O===124?(t.enter("tableCellDivider"),t.consume(O),t.exit("tableCellDivider"),L):O===null||at(O)?(t.exit("tableRow"),e(O)):It(O)?Ot(t,L,"whitespace")(O):(t.enter("data"),N(O))}function N(O){return O===null||O===124||$t(O)?(t.exit("data"),L(O)):(t.consume(O),O===92?G:N)}function G(O){return O===92||O===124?(t.consume(O),N):N(O)}}function xj(t,e){let n=-1,i=!0,r=0,s=[0,0,0,0],a=[0,0,0,0],o=!1,l=0,u,d,f;const p=new yj;for(;++n<t.length;){const m=t[n],y=m[1];m[0]==="enter"?y.type==="tableHead"?(o=!1,l!==0&&(FA(p,e,l,u,d),d=void 0,l=0),u={type:"table",start:Object.assign({},y.start),end:Object.assign({},y.end)},p.add(n,0,[["enter",u,e]])):y.type==="tableRow"||y.type==="tableDelimiterRow"?(i=!0,f=void 0,s=[0,0,0,0],a=[0,n+1,0,0],o&&(o=!1,d={type:"tableBody",start:Object.assign({},y.start),end:Object.assign({},y.end)},p.add(n,0,[["enter",d,e]])),r=y.type==="tableDelimiterRow"?2:d?3:1):r&&(y.type==="data"||y.type==="tableDelimiterMarker"||y.type==="tableDelimiterFiller")?(i=!1,a[2]===0&&(s[1]!==0&&(a[0]=a[1],f=_f(p,e,s,r,void 0,f),s=[0,0,0,0]),a[2]=n)):y.type==="tableCellDivider"&&(i?i=!1:(s[1]!==0&&(a[0]=a[1],f=_f(p,e,s,r,void 0,f)),s=a,a=[s[1],n,0,0])):y.type==="tableHead"?(o=!0,l=n):y.type==="tableRow"||y.type==="tableDelimiterRow"?(l=n,s[1]!==0?(a[0]=a[1],f=_f(p,e,s,r,n,f)):a[1]!==0&&(f=_f(p,e,a,r,n,f)),r=0):r&&(y.type==="data"||y.type==="tableDelimiterMarker"||y.type==="tableDelimiterFiller")&&(a[3]=n)}for(l!==0&&FA(p,e,l,u,d),p.consume(e.events),n=-1;++n<e.events.length;){const m=e.events[n];m[0]==="enter"&&m[1].type==="table"&&(m[1]._align=bj(e.events,n))}return t}function _f(t,e,n,i,r,s){const a=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",o="tableContent";n[0]!==0&&(s.end=Object.assign({},Au(e.events,n[0])),t.add(n[0],0,[["exit",s,e]]));const l=Au(e.events,n[1]);if(s={type:a,start:Object.assign({},l),end:Object.assign({},l)},t.add(n[1],0,[["enter",s,e]]),n[2]!==0){const u=Au(e.events,n[2]),d=Au(e.events,n[3]),f={type:o,start:Object.assign({},u),end:Object.assign({},d)};if(t.add(n[2],0,[["enter",f,e]]),i!==2){const p=e.events[n[2]],m=e.events[n[3]];if(p[1].end=Object.assign({},m[1].end),p[1].type="chunkText",p[1].contentType="text",n[3]>n[2]+1){const y=n[2]+1,b=n[3]-n[2]-1;t.add(y,b,[])}}t.add(n[3]+1,0,[["exit",f,e]])}return r!==void 0&&(s.end=Object.assign({},Au(e.events,r)),t.add(r,0,[["exit",s,e]]),s=void 0),s}function FA(t,e,n,i,r){const s=[],a=Au(e.events,n);r&&(r.end=Object.assign({},a),s.push(["exit",r,e])),i.end=Object.assign({},a),s.push(["exit",i,e]),t.add(n+1,0,s)}function Au(t,e){const n=t[e],i=n[0]==="enter"?"start":"end";return n[1][i]}const Sj={name:"tasklistCheck",tokenize:wj};function Aj(){return{text:{91:Sj}}}function wj(t,e,n){const i=this;return r;function r(l){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?n(l):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),s)}function s(l){return $t(l)?(t.enter("taskListCheckValueUnchecked"),t.consume(l),t.exit("taskListCheckValueUnchecked"),a):l===88||l===120?(t.enter("taskListCheckValueChecked"),t.consume(l),t.exit("taskListCheckValueChecked"),a):n(l)}function a(l){return l===93?(t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),o):n(l)}function o(l){return at(l)?e(l):It(l)?t.check({tokenize:Cj},e,n)(l):n(l)}}function Cj(t,e,n){return Ot(t,i,"whitespace");function i(r){return r===null?n(r):e(r)}}function Rj(t){return hI([BV(),uj(),gj(t),Ej(),Aj()])}const _j={};function Ij(t){const e=this,n=t||_j,i=e.data(),r=i.micromarkExtensions||(i.micromarkExtensions=[]),s=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),a=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);r.push(Rj(n)),s.push(DV()),a.push(OV(n))}const Lj={tokenize:Dj};function Dj(t){const e=t.attempt(this.parser.constructs.contentInitial,i,r);let n;return e;function i(o){if(o===null){t.consume(o);return}return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Ot(t,e,"linePrefix")}function r(o){return t.enter("paragraph"),s(o)}function s(o){const l=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,a(o)}function a(o){if(o===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(o);return}return at(o)?(t.consume(o),t.exit("chunkText"),s):(t.consume(o),a)}}const Oj={tokenize:Pj},UA={tokenize:kj};function Pj(t){const e=this,n=[];let i=0,r,s,a;return o;function o(S){if(i<n.length){const w=n[i];return e.containerState=w[1],t.attempt(w[0].continuation,l,u)(S)}return u(S)}function l(S){if(i++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,r&&x();const w=e.events.length;let C=w,I;for(;C--;)if(e.events[C][0]==="exit"&&e.events[C][1].type==="chunkFlow"){I=e.events[C][1].end;break}T(i);let L=w;for(;L<e.events.length;)e.events[L][1].end={...I},L++;return Ri(e.events,C+1,0,e.events.slice(w)),e.events.length=L,u(S)}return o(S)}function u(S){if(i===n.length){if(!r)return p(S);if(r.currentConstruct&&r.currentConstruct.concrete)return y(S);e.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(UA,d,f)(S)}function d(S){return r&&x(),T(i),p(S)}function f(S){return e.parser.lazy[e.now().line]=i!==n.length,a=e.now().offset,y(S)}function p(S){return e.containerState={},t.attempt(UA,m,y)(S)}function m(S){return i++,n.push([e.currentConstruct,e.containerState]),p(S)}function y(S){if(S===null){r&&x(),T(0),t.consume(S);return}return r=r||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:r,contentType:"flow",previous:s}),b(S)}function b(S){if(S===null){E(t.exit("chunkFlow"),!0),T(0),t.consume(S);return}return at(S)?(t.consume(S),E(t.exit("chunkFlow")),i=0,e.interrupt=void 0,o):(t.consume(S),b)}function E(S,w){const C=e.sliceStream(S);if(w&&C.push(null),S.previous=s,s&&(s.next=S),s=S,r.defineSkip(S.start),r.write(C),e.parser.lazy[S.start.line]){let I=r.events.length;for(;I--;)if(r.events[I][1].start.offset<a&&(!r.events[I][1].end||r.events[I][1].end.offset>a))return;const L=e.events.length;let N=L,G,O;for(;N--;)if(e.events[N][0]==="exit"&&e.events[N][1].type==="chunkFlow"){if(G){O=e.events[N][1].end;break}G=!0}for(T(i),I=L;I<e.events.length;)e.events[I][1].end={...O},I++;Ri(e.events,N+1,0,e.events.slice(L)),e.events.length=I}}function T(S){let w=n.length;for(;w-- >S;){const C=n[w];e.containerState=C[1],C[0].exit.call(e,t)}n.length=S}function x(){r.write([null]),s=void 0,r=void 0,e.containerState._closeFlow=void 0}}function kj(t,e,n){return Ot(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}const Nj={tokenize:Mj};function Mj(t){const e=this,n=t.attempt(td,i,t.attempt(this.parser.constructs.flowInitial,r,Ot(t,t.attempt(this.parser.constructs.flow,r,t.attempt(hG,r)),"linePrefix")));return n;function i(s){if(s===null){t.consume(s);return}return t.enter("lineEndingBlank"),t.consume(s),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function r(s){if(s===null){t.consume(s);return}return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const Bj={resolveAll:LI()},Fj=II("string"),Uj=II("text");function II(t){return{resolveAll:LI(t==="text"?Hj:void 0),tokenize:e};function e(n){const i=this,r=this.parser.constructs[t],s=n.attempt(r,a,o);return a;function a(d){return u(d)?s(d):o(d)}function o(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),l}function l(d){return u(d)?(n.exit("data"),s(d)):(n.consume(d),l)}function u(d){if(d===null)return!0;const f=r[d];let p=-1;if(f)for(;++p<f.length;){const m=f[p];if(!m.previous||m.previous.call(i,i.previous))return!0}return!1}}}function LI(t){return e;function e(n,i){let r=-1,s;for(;++r<=n.length;)s===void 0?n[r]&&n[r][1].type==="data"&&(s=r,r++):(!n[r]||n[r][1].type!=="data")&&(r!==s+2&&(n[s][1].end=n[r-1][1].end,n.splice(s+2,r-s-2),r=s+2),s=void 0);return t?t(n,i):n}}function Hj(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const i=t[n-1][1],r=e.sliceStream(i);let s=r.length,a=-1,o=0,l;for(;s--;){const u=r[s];if(typeof u=="string"){for(a=u.length;u.charCodeAt(a-1)===32;)o++,a--;if(a)break;a=-1}else if(u===-2)l=!0,o++;else if(u!==-1){s++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(o=0),o){const u={type:n===t.length||l||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?a:i.start._bufferIndex+a,_index:i.start._index+s,line:i.end.line,column:i.end.column-o,offset:i.end.offset-o},end:{...i.end}};i.end={...u.start},i.start.offset===i.end.offset?Object.assign(i,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const zj={42:ui,43:ui,45:ui,48:ui,49:ui,50:ui,51:ui,52:ui,53:ui,54:ui,55:ui,56:ui,57:ui,62:xI},qj={91:vG},Vj={[-2]:xg,[-1]:xg,32:xg},Gj={35:AG,42:fh,45:[BA,fh],60:_G,61:BA,95:fh,96:NA,126:NA},jj={38:AI,92:SI},Wj={[-5]:Sg,[-4]:Sg,[-3]:Sg,33:WG,38:AI,42:My,60:[YV,NG],91:YG,92:[xG,SI],93:db,95:My,96:oG},$j={null:[My,Bj]},Yj={null:[42,95]},Kj={null:[]},Xj=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Yj,contentInitial:qj,disable:Kj,document:zj,flow:Gj,flowInitial:Vj,insideSpan:$j,string:jj,text:Wj},Symbol.toStringTag,{value:"Module"}));function Qj(t,e,n){let i={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const r={},s=[];let a=[],o=[];const l={attempt:L(C),check:L(I),consume:x,enter:S,exit:w,interrupt:L(I,{interrupt:!0})},u={code:null,containerState:{},defineSkip:b,events:[],now:y,parser:t,previous:null,sliceSerialize:p,sliceStream:m,write:f};let d=e.tokenize.call(u,l);return e.resolveAll&&s.push(e),u;function f(D){return a=Gi(a,D),E(),a[a.length-1]!==null?[]:(N(e,0),u.events=m0(s,u.events,u),u.events)}function p(D,V){return Jj(m(D),V)}function m(D){return Zj(a,D)}function y(){const{_bufferIndex:D,_index:V,line:$,column:J,offset:K}=i;return{_bufferIndex:D,_index:V,line:$,column:J,offset:K}}function b(D){r[D.line]=D.column,O()}function E(){let D;for(;i._index<a.length;){const V=a[i._index];if(typeof V=="string")for(D=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===D&&i._bufferIndex<V.length;)T(V.charCodeAt(i._bufferIndex));else T(V)}}function T(D){d=d(D)}function x(D){at(D)?(i.line++,i.column=1,i.offset+=D===-3?2:1,O()):D!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===a[i._index].length&&(i._bufferIndex=-1,i._index++)),u.previous=D}function S(D,V){const $=V||{};return $.type=D,$.start=y(),u.events.push(["enter",$,u]),o.push($),$}function w(D){const V=o.pop();return V.end=y(),u.events.push(["exit",V,u]),V}function C(D,V){N(D,V.from)}function I(D,V){V.restore()}function L(D,V){return $;function $(J,K,j){let te,ne,oe,P;return Array.isArray(J)?le(J):"tokenize"in J?le([J]):ie(J);function ie(we){return Me;function Me(Fe){const $e=Fe!==null&&we[Fe],Ye=Fe!==null&&we.null,fe=[...Array.isArray($e)?$e:$e?[$e]:[],...Array.isArray(Ye)?Ye:Ye?[Ye]:[]];return le(fe)(Fe)}}function le(we){return te=we,ne=0,we.length===0?j:q(we[ne])}function q(we){return Me;function Me(Fe){return P=G(),oe=we,we.partial||(u.currentConstruct=we),we.name&&u.parser.constructs.disable.null.includes(we.name)?Pe():we.tokenize.call(V?Object.assign(Object.create(u),V):u,l,ye,Pe)(Fe)}}function ye(we){return D(oe,P),K}function Pe(we){return P.restore(),++ne<te.length?q(te[ne]):j}}}function N(D,V){D.resolveAll&&!s.includes(D)&&s.push(D),D.resolve&&Ri(u.events,V,u.events.length-V,D.resolve(u.events.slice(V),u)),D.resolveTo&&(u.events=D.resolveTo(u.events,u))}function G(){const D=y(),V=u.previous,$=u.currentConstruct,J=u.events.length,K=Array.from(o);return{from:J,restore:j};function j(){i=D,u.previous=V,u.currentConstruct=$,u.events.length=J,o=K,O()}}function O(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}function Zj(t,e){const n=e.start._index,i=e.start._bufferIndex,r=e.end._index,s=e.end._bufferIndex;let a;if(n===r)a=[t[n].slice(i,s)];else{if(a=t.slice(n,r),i>-1){const o=a[0];typeof o=="string"?a[0]=o.slice(i):a.shift()}s>0&&a.push(t[r].slice(0,s))}return a}function Jj(t,e){let n=-1;const i=[];let r;for(;++n<t.length;){const s=t[n];let a;if(typeof s=="string")a=s;else switch(s){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=e?" ":"	";break}case-1:{if(!e&&r)continue;a=" ";break}default:a=String.fromCharCode(s)}r=s===-2,i.push(a)}return i.join("")}function eW(t){const i={constructs:hI([Xj,...(t||{}).extensions||[]]),content:r(Lj),defined:[],document:r(Oj),flow:r(Nj),lazy:{},string:r(Fj),text:r(Uj)};return i;function r(s){return a;function a(o){return Qj(i,s,o)}}}function tW(t){for(;!wI(t););return t}const HA=/[\0\t\n\r]/g;function nW(){let t=1,e="",n=!0,i;return r;function r(s,a,o){const l=[];let u,d,f,p,m;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(a||void 0).decode(s)),f=0,e="",n&&(s.charCodeAt(0)===65279&&f++,n=void 0);f<s.length;){if(HA.lastIndex=f,u=HA.exec(s),p=u&&u.index!==void 0?u.index:s.length,m=s.charCodeAt(p),!u){e=s.slice(f);break}if(m===10&&f===p&&i)l.push(-3),i=void 0;else switch(i&&(l.push(-5),i=void 0),f<p&&(l.push(s.slice(f,p)),t+=p-f),m){case 0:{l.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,l.push(-2);t++<d;)l.push(-1);break}case 10:{l.push(-4),t=1;break}default:i=!0,t=1}f=p+1}return o&&(i&&l.push(-5),e&&l.push(e),l.push(null)),l}}function wc(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?zA(t.position):"start"in t||"end"in t?zA(t):"line"in t||"column"in t?By(t):""}function By(t){return qA(t&&t.line)+":"+qA(t&&t.column)}function zA(t){return By(t&&t.start)+"-"+By(t&&t.end)}function qA(t){return t&&typeof t=="number"?t:1}const DI={}.hasOwnProperty;function iW(t,e,n){return typeof e!="string"&&(n=e,e=void 0),rW(n)(tW(eW(n).document().write(nW()(t,e,!0))))}function rW(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(ue),autolinkProtocol:G,autolinkEmail:G,atxHeading:s(Lt),blockQuote:s(Ye),characterEscape:G,characterReference:G,codeFenced:s(fe),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(fe,a),codeText:s(Ie,a),codeTextData:G,data:G,codeFlowValue:G,definition:s(Le),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(Ke),hardBreakEscape:s(Qe),hardBreakTrailing:s(Qe),htmlFlow:s(k,a),htmlFlowData:G,htmlText:s(k,a),htmlTextData:G,image:s(X),label:a,link:s(ue),listItem:s(Oe),listItemValue:p,listOrdered:s(Se,f),listUnordered:s(Se),paragraph:s(ze),reference:q,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s(Lt),strong:s(Ne),thematicBreak:s(mt)},exit:{atxHeading:l(),atxHeadingSequence:C,autolink:l(),autolinkEmail:$e,autolinkProtocol:Fe,blockQuote:l(),characterEscapeValue:O,characterReferenceMarkerHexadecimal:Pe,characterReferenceMarkerNumeric:Pe,characterReferenceValue:we,characterReference:Me,codeFenced:l(E),codeFencedFence:b,codeFencedFenceInfo:m,codeFencedFenceMeta:y,codeFlowValue:O,codeIndented:l(T),codeText:l(K),codeTextData:O,data:O,definition:l(),definitionDestinationString:w,definitionLabelString:x,definitionTitleString:S,emphasis:l(),hardBreakEscape:l(V),hardBreakTrailing:l(V),htmlFlow:l($),htmlFlowData:O,htmlText:l(J),htmlTextData:O,image:l(te),label:oe,labelText:ne,lineEnding:D,link:l(j),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:ye,resourceDestinationString:P,resourceTitleString:ie,resource:le,setextHeading:l(N),setextHeadingLineSequence:L,setextHeadingText:I,strong:l(),thematicBreak:l()}};OI(e,(t||{}).mdastExtensions||[]);const n={};return i;function i(he){let Te={type:"root",children:[]};const je={stack:[Te],tokenStack:[],config:e,enter:o,exit:u,buffer:a,resume:d,data:n},B=[];let F=-1;for(;++F<he.length;)if(he[F][1].type==="listOrdered"||he[F][1].type==="listUnordered")if(he[F][0]==="enter")B.push(F);else{const Y=B.pop();F=r(he,Y,F)}for(F=-1;++F<he.length;){const Y=e[he[F][0]];DI.call(Y,he[F][1].type)&&Y[he[F][1].type].call(Object.assign({sliceSerialize:he[F][2].sliceSerialize},je),he[F][1])}if(je.tokenStack.length>0){const Y=je.tokenStack[je.tokenStack.length-1];(Y[1]||VA).call(je,void 0,Y[0])}for(Te.position={start:Ys(he.length>0?he[0][1].start:{line:1,column:1,offset:0}),end:Ys(he.length>0?he[he.length-2][1].end:{line:1,column:1,offset:0})},F=-1;++F<e.transforms.length;)Te=e.transforms[F](Te)||Te;return Te}function r(he,Te,je){let B=Te-1,F=-1,Y=!1,Z,xe,Be,Ze;for(;++B<=je;){const lt=he[B];switch(lt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{lt[0]==="enter"?F++:F--,Ze=void 0;break}case"lineEndingBlank":{lt[0]==="enter"&&(Z&&!Ze&&!F&&!Be&&(Be=B),Ze=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ze=void 0}if(!F&&lt[0]==="enter"&&lt[1].type==="listItemPrefix"||F===-1&&lt[0]==="exit"&&(lt[1].type==="listUnordered"||lt[1].type==="listOrdered")){if(Z){let tt=B;for(xe=void 0;tt--;){const Zt=he[tt];if(Zt[1].type==="lineEnding"||Zt[1].type==="lineEndingBlank"){if(Zt[0]==="exit")continue;xe&&(he[xe][1].type="lineEndingBlank",Y=!0),Zt[1].type="lineEnding",xe=tt}else if(!(Zt[1].type==="linePrefix"||Zt[1].type==="blockQuotePrefix"||Zt[1].type==="blockQuotePrefixWhitespace"||Zt[1].type==="blockQuoteMarker"||Zt[1].type==="listItemIndent"))break}Be&&(!xe||Be<xe)&&(Z._spread=!0),Z.end=Object.assign({},xe?he[xe][1].start:lt[1].end),he.splice(xe||B,0,["exit",Z,lt[2]]),B++,je++}if(lt[1].type==="listItemPrefix"){const tt={type:"listItem",_spread:!1,start:Object.assign({},lt[1].start),end:void 0};Z=tt,he.splice(B,0,["enter",tt,lt[2]]),B++,je++,Be=void 0,Ze=!0}}}return he[Te][1]._spread=Y,je}function s(he,Te){return je;function je(B){o.call(this,he(B),B),Te&&Te.call(this,B)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(he,Te,je){this.stack[this.stack.length-1].children.push(he),this.stack.push(he),this.tokenStack.push([Te,je||void 0]),he.position={start:Ys(Te.start),end:void 0}}function l(he){return Te;function Te(je){he&&he.call(this,je),u.call(this,je)}}function u(he,Te){const je=this.stack.pop(),B=this.tokenStack.pop();if(B)B[0].type!==he.type&&(Te?Te.call(this,he,B[0]):(B[1]||VA).call(this,he,B[0]));else throw new Error("Cannot close `"+he.type+"` ("+wc({start:he.start,end:he.end})+"): its not open");je.position.end=Ys(he.end)}function d(){return ob(this.stack.pop())}function f(){this.data.expectingFirstListItemValue=!0}function p(he){if(this.data.expectingFirstListItemValue){const Te=this.stack[this.stack.length-2];Te.start=Number.parseInt(this.sliceSerialize(he),10),this.data.expectingFirstListItemValue=void 0}}function m(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.lang=he}function y(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.meta=he}function b(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.value=he.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function T(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.value=he.replace(/(\r?\n|\r)$/g,"")}function x(he){const Te=this.resume(),je=this.stack[this.stack.length-1];je.label=Te,je.identifier=or(this.sliceSerialize(he)).toLowerCase()}function S(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.title=he}function w(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.url=he}function C(he){const Te=this.stack[this.stack.length-1];if(!Te.depth){const je=this.sliceSerialize(he).length;Te.depth=je}}function I(){this.data.setextHeadingSlurpLineEnding=!0}function L(he){const Te=this.stack[this.stack.length-1];Te.depth=this.sliceSerialize(he).codePointAt(0)===61?1:2}function N(){this.data.setextHeadingSlurpLineEnding=void 0}function G(he){const je=this.stack[this.stack.length-1].children;let B=je[je.length-1];(!B||B.type!=="text")&&(B=dt(),B.position={start:Ys(he.start),end:void 0},je.push(B)),this.stack.push(B)}function O(he){const Te=this.stack.pop();Te.value+=this.sliceSerialize(he),Te.position.end=Ys(he.end)}function D(he){const Te=this.stack[this.stack.length-1];if(this.data.atHardBreak){const je=Te.children[Te.children.length-1];je.position.end=Ys(he.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(Te.type)&&(G.call(this,he),O.call(this,he))}function V(){this.data.atHardBreak=!0}function $(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.value=he}function J(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.value=he}function K(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.value=he}function j(){const he=this.stack[this.stack.length-1];if(this.data.inReference){const Te=this.data.referenceType||"shortcut";he.type+="Reference",he.referenceType=Te,delete he.url,delete he.title}else delete he.identifier,delete he.label;this.data.referenceType=void 0}function te(){const he=this.stack[this.stack.length-1];if(this.data.inReference){const Te=this.data.referenceType||"shortcut";he.type+="Reference",he.referenceType=Te,delete he.url,delete he.title}else delete he.identifier,delete he.label;this.data.referenceType=void 0}function ne(he){const Te=this.sliceSerialize(he),je=this.stack[this.stack.length-2];je.label=vV(Te),je.identifier=or(Te).toLowerCase()}function oe(){const he=this.stack[this.stack.length-1],Te=this.resume(),je=this.stack[this.stack.length-1];if(this.data.inReference=!0,je.type==="link"){const B=he.children;je.children=B}else je.alt=Te}function P(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.url=he}function ie(){const he=this.resume(),Te=this.stack[this.stack.length-1];Te.title=he}function le(){this.data.inReference=void 0}function q(){this.data.referenceType="collapsed"}function ye(he){const Te=this.resume(),je=this.stack[this.stack.length-1];je.label=Te,je.identifier=or(this.sliceSerialize(he)).toLowerCase(),this.data.referenceType="full"}function Pe(he){this.data.characterReferenceType=he.type}function we(he){const Te=this.sliceSerialize(he),je=this.data.characterReferenceType;let B;je?(B=fI(Te,je==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):B=lb(Te);const F=this.stack[this.stack.length-1];F.value+=B}function Me(he){const Te=this.stack.pop();Te.position.end=Ys(he.end)}function Fe(he){O.call(this,he);const Te=this.stack[this.stack.length-1];Te.url=this.sliceSerialize(he)}function $e(he){O.call(this,he);const Te=this.stack[this.stack.length-1];Te.url="mailto:"+this.sliceSerialize(he)}function Ye(){return{type:"blockquote",children:[]}}function fe(){return{type:"code",lang:null,meta:null,value:""}}function Ie(){return{type:"inlineCode",value:""}}function Le(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ke(){return{type:"emphasis",children:[]}}function Lt(){return{type:"heading",depth:0,children:[]}}function Qe(){return{type:"break"}}function k(){return{type:"html",value:""}}function X(){return{type:"image",title:null,url:"",alt:null}}function ue(){return{type:"link",title:null,url:"",children:[]}}function Se(he){return{type:"list",ordered:he.type==="listOrdered",start:null,spread:he._spread,children:[]}}function Oe(he){return{type:"listItem",spread:he._spread,checked:null,children:[]}}function ze(){return{type:"paragraph",children:[]}}function Ne(){return{type:"strong",children:[]}}function dt(){return{type:"text",value:""}}function mt(){return{type:"thematicBreak"}}}function Ys(t){return{line:t.line,column:t.column,offset:t.offset}}function OI(t,e){let n=-1;for(;++n<e.length;){const i=e[n];Array.isArray(i)?OI(t,i):sW(t,i)}}function sW(t,e){let n;for(n in e)if(DI.call(e,n))switch(n){case"canContainEols":{const i=e[n];i&&t[n].push(...i);break}case"transforms":{const i=e[n];i&&t[n].push(...i);break}case"enter":case"exit":{const i=e[n];i&&Object.assign(t[n],i);break}}}function VA(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+wc({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+wc({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+wc({start:e.start,end:e.end})+") is still open")}function aW(t){const e=this;e.parser=n;function n(i){return iW(i,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function oW(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function uW(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function lW(t,e){const n=e.value?e.value+`
`:"",i={};e.lang&&(i.className=["language-"+e.lang]);let r={type:"element",tagName:"code",properties:i,children:[{type:"text",value:n}]};return e.meta&&(r.data={meta:e.meta}),t.patch(e,r),r=t.applyData(e,r),r={type:"element",tagName:"pre",properties:{},children:[r]},t.patch(e,r),r}function cW(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function dW(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function fW(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",i=String(e.identifier).toUpperCase(),r=Zu(i.toLowerCase()),s=t.footnoteOrder.indexOf(i);let a,o=t.footnoteCounts.get(i);o===void 0?(o=0,t.footnoteOrder.push(i),a=t.footnoteOrder.length):a=s+1,o+=1,t.footnoteCounts.set(i,o);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+r,id:n+"fnref-"+r+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};t.patch(e,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return t.patch(e,u),t.applyData(e,u)}function hW(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function pW(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function PI(t,e){const n=e.referenceType;let i="]";if(n==="collapsed"?i+="[]":n==="full"&&(i+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+i}];const r=t.all(e),s=r[0];s&&s.type==="text"?s.value="["+s.value:r.unshift({type:"text",value:"["});const a=r[r.length-1];return a&&a.type==="text"?a.value+=i:r.push({type:"text",value:i}),r}function mW(t,e){const n=String(e.identifier).toUpperCase(),i=t.definitionById.get(n);if(!i)return PI(t,e);const r={src:Zu(i.url||""),alt:e.alt};i.title!==null&&i.title!==void 0&&(r.title=i.title);const s={type:"element",tagName:"img",properties:r,children:[]};return t.patch(e,s),t.applyData(e,s)}function gW(t,e){const n={src:Zu(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const i={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,i),t.applyData(e,i)}function yW(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const i={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,i),t.applyData(e,i)}function vW(t,e){const n=String(e.identifier).toUpperCase(),i=t.definitionById.get(n);if(!i)return PI(t,e);const r={href:Zu(i.url||"")};i.title!==null&&i.title!==void 0&&(r.title=i.title);const s={type:"element",tagName:"a",properties:r,children:t.all(e)};return t.patch(e,s),t.applyData(e,s)}function bW(t,e){const n={href:Zu(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const i={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function EW(t,e,n){const i=t.all(e),r=n?TW(n):kI(e),s={},a=[];if(typeof e.checked=="boolean"){const d=i[0];let f;d&&d.type==="element"&&d.tagName==="p"?f=d:(f={type:"element",tagName:"p",properties:{},children:[]},i.unshift(f)),f.children.length>0&&f.children.unshift({type:"text",value:" "}),f.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let o=-1;for(;++o<i.length;){const d=i[o];(r||o!==0||d.type!=="element"||d.tagName!=="p")&&a.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!r?a.push(...d.children):a.push(d)}const l=i[i.length-1];l&&(r||l.type!=="element"||l.tagName!=="p")&&a.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:s,children:a};return t.patch(e,u),t.applyData(e,u)}function TW(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let i=-1;for(;!e&&++i<n.length;)e=kI(n[i])}return e}function kI(t){const e=t.spread;return e??t.children.length>1}function xW(t,e){const n={},i=t.all(e);let r=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++r<i.length;){const a=i[r];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(i,!0)};return t.patch(e,s),t.applyData(e,s)}function SW(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function AW(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function wW(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function CW(t,e){const n=t.all(e),i=n.shift(),r=[];if(i){const a={type:"element",tagName:"thead",properties:{},children:t.wrap([i],!0)};t.patch(e.children[0],a),r.push(a)}if(n.length>0){const a={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},o=ys(e.children[1]),l=d0(e.children[e.children.length-1]);o&&l&&(a.position={start:o,end:l}),r.push(a)}const s={type:"element",tagName:"table",properties:{},children:t.wrap(r,!0)};return t.patch(e,s),t.applyData(e,s)}function RW(t,e,n){const i=n?n.children:void 0,s=(i?i.indexOf(e):1)===0?"th":"td",a=n&&n.type==="table"?n.align:void 0,o=a?a.length:e.children.length;let l=-1;const u=[];for(;++l<o;){const f=e.children[l],p={},m=a?a[l]:void 0;m&&(p.align=m);let y={type:"element",tagName:s,properties:p,children:[]};f&&(y.children=t.all(f),t.patch(f,y),y=t.applyData(f,y)),u.push(y)}const d={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,d),t.applyData(e,d)}function _W(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const GA=9,jA=32;function IW(t){const e=String(t),n=/\r?\n|\r/g;let i=n.exec(e),r=0;const s=[];for(;i;)s.push(WA(e.slice(r,i.index),r>0,!0),i[0]),r=i.index+i[0].length,i=n.exec(e);return s.push(WA(e.slice(r),r>0,!1)),s.join("")}function WA(t,e,n){let i=0,r=t.length;if(e){let s=t.codePointAt(i);for(;s===GA||s===jA;)i++,s=t.codePointAt(i)}if(n){let s=t.codePointAt(r-1);for(;s===GA||s===jA;)r--,s=t.codePointAt(r-1)}return r>i?t.slice(i,r):""}function LW(t,e){const n={type:"text",value:IW(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function DW(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const OW={blockquote:oW,break:uW,code:lW,delete:cW,emphasis:dW,footnoteReference:fW,heading:hW,html:pW,imageReference:mW,image:gW,inlineCode:yW,linkReference:vW,link:bW,listItem:EW,list:xW,paragraph:SW,root:AW,strong:wW,table:CW,tableCell:_W,tableRow:RW,text:LW,thematicBreak:DW,toml:If,yaml:If,definition:If,footnoteDefinition:If};function If(){}function PW(t,e){const n=[{type:"text",value:""}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function kW(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function NW(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||PW,i=t.options.footnoteBackLabel||kW,r=t.options.footnoteLabel||"Footnotes",s=t.options.footnoteLabelTagName||"h2",a=t.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[l]);if(!u)continue;const d=t.all(u),f=String(u.identifier).toUpperCase(),p=Zu(f.toLowerCase());let m=0;const y=[],b=t.footnoteCounts.get(f);for(;b!==void 0&&++m<=b;){y.length>0&&y.push({type:"text",value:" "});let x=typeof n=="string"?n:n(l,m);typeof x=="string"&&(x={type:"text",value:x}),y.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+p+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(l,m),className:["data-footnote-backref"]},children:Array.isArray(x)?x:[x]})}const E=d[d.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const x=E.children[E.children.length-1];x&&x.type==="text"?x.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...y)}else d.push(...y);const T={type:"element",tagName:"li",properties:{id:e+"fn-"+p},children:t.wrap(d,!0)};t.patch(u,T),o.push(T)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Uu(a),id:"footnote-label"},children:[{type:"text",value:r}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(o,!0)},{type:"text",value:`
`}]}}const Fy={}.hasOwnProperty,MW={};function BW(t,e){const n=e||MW,i=new Map,r=new Map,s=new Map,a={...OW,...n.handlers},o={all:u,applyData:UW,definitionById:i,footnoteById:r,footnoteCounts:s,footnoteOrder:[],handlers:a,one:l,options:n,patch:FW,wrap:zW};return ib(t,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const f=d.type==="definition"?i:r,p=String(d.identifier).toUpperCase();f.has(p)||f.set(p,d)}}),o;function l(d,f){const p=d.type,m=o.handlers[p];if(Fy.call(o.handlers,p)&&m)return m(o,d,f);if(o.options.passThrough&&o.options.passThrough.includes(p)){if("children"in d){const{children:b,...E}=d,T=Uu(E);return T.children=o.all(d),T}return Uu(d)}return(o.options.unknownHandler||HW)(o,d,f)}function u(d){const f=[];if("children"in d){const p=d.children;let m=-1;for(;++m<p.length;){const y=o.one(p[m],d);if(y){if(m&&p[m-1].type==="break"&&(!Array.isArray(y)&&y.type==="text"&&(y.value=$A(y.value)),!Array.isArray(y)&&y.type==="element")){const b=y.children[0];b&&b.type==="text"&&(b.value=$A(b.value))}Array.isArray(y)?f.push(...y):f.push(y)}}}return f}}function FW(t,e){t.position&&(e.position=SH(t))}function UW(t,e){let n=e;if(t&&t.data){const i=t.data.hName,r=t.data.hChildren,s=t.data.hProperties;if(typeof i=="string")if(n.type==="element")n.tagName=i;else{const a="children"in n?n.children:[n];n={type:"element",tagName:i,properties:{},children:a}}n.type==="element"&&s&&Object.assign(n.properties,Uu(s)),"children"in n&&n.children&&r!==null&&r!==void 0&&(n.children=r)}return n}function HW(t,e){const n=e.data||{},i="value"in e&&!(Fy.call(n,"hProperties")||Fy.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function zW(t,e){const n=[];let i=-1;for(e&&n.push({type:"text",value:`
`});++i<t.length;)i&&n.push({type:"text",value:`
`}),n.push(t[i]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function $A(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function YA(t,e){const n=BW(t,e),i=n.one(t,void 0),r=NW(n),s=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return r&&s.children.push({type:"text",value:`
`},r),s}function qW(t,e){return t&&"run"in t?async function(n,i){const r=YA(n,{file:i,...e});await t.run(r,i)}:function(n,i){return YA(n,{file:i,...t||e})}}function KA(t){if(t)throw t}var Ag,XA;function VW(){if(XA)return Ag;XA=1;var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,r=function(u){return typeof Array.isArray=="function"?Array.isArray(u):e.call(u)==="[object Array]"},s=function(u){if(!u||e.call(u)!=="[object Object]")return!1;var d=t.call(u,"constructor"),f=u.constructor&&u.constructor.prototype&&t.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!d&&!f)return!1;var p;for(p in u);return typeof p>"u"||t.call(u,p)},a=function(u,d){n&&d.name==="__proto__"?n(u,d.name,{enumerable:!0,configurable:!0,value:d.newValue,writable:!0}):u[d.name]=d.newValue},o=function(u,d){if(d==="__proto__")if(t.call(u,d)){if(i)return i(u,d).value}else return;return u[d]};return Ag=function l(){var u,d,f,p,m,y,b=arguments[0],E=1,T=arguments.length,x=!1;for(typeof b=="boolean"&&(x=b,b=arguments[1]||{},E=2),(b==null||typeof b!="object"&&typeof b!="function")&&(b={});E<T;++E)if(u=arguments[E],u!=null)for(d in u)f=o(b,d),p=o(u,d),b!==p&&(x&&p&&(s(p)||(m=r(p)))?(m?(m=!1,y=f&&r(f)?f:[]):y=f&&s(f)?f:{},a(b,{name:d,newValue:l(x,y,p)})):typeof p<"u"&&a(b,{name:d,newValue:p}));return b},Ag}var GW=VW();const wg=Wc(GW);function Uy(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function jW(){const t=[],e={run:n,use:i};return e;function n(...r){let s=-1;const a=r.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);o(null,...r);function o(l,...u){const d=t[++s];let f=-1;if(l){a(l);return}for(;++f<r.length;)(u[f]===null||u[f]===void 0)&&(u[f]=r[f]);r=u,d?WW(d,o)(...u):a(null,...u)}}function i(r){if(typeof r!="function")throw new TypeError("Expected `middelware` to be a function, not "+r);return t.push(r),e}}function WW(t,e){let n;return i;function i(...a){const o=t.length>a.length;let l;o&&a.push(r);try{l=t.apply(this,a)}catch(u){const d=u;if(o&&n)throw d;return r(d)}o||(l&&l.then&&typeof l.then=="function"?l.then(s,r):l instanceof Error?r(l):s(l))}function r(a,...o){n||(n=!0,e(a,...o))}function s(a){r(null,a)}}class hi extends Error{constructor(e,n,i){super(),typeof n=="string"&&(i=n,n=void 0);let r="",s={},a=!1;if(n&&("line"in n&&"column"in n?s={place:n}:"start"in n&&"end"in n?s={place:n}:"type"in n?s={ancestors:[n],place:n.position}:s={...n}),typeof e=="string"?r=e:!s.cause&&e&&(a=!0,r=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof i=="string"){const l=i.indexOf(":");l===-1?s.ruleId=i:(s.source=i.slice(0,l),s.ruleId=i.slice(l+1))}if(!s.place&&s.ancestors&&s.ancestors){const l=s.ancestors[s.ancestors.length-1];l&&(s.place=l.position)}const o=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file="",this.message=r,this.line=o?o.line:void 0,this.name=wc(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=a&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}hi.prototype.file="";hi.prototype.name="";hi.prototype.reason="";hi.prototype.message="";hi.prototype.stack="";hi.prototype.column=void 0;hi.prototype.line=void 0;hi.prototype.ancestors=void 0;hi.prototype.cause=void 0;hi.prototype.fatal=void 0;hi.prototype.place=void 0;hi.prototype.ruleId=void 0;hi.prototype.source=void 0;const br={basename:$W,dirname:YW,extname:KW,join:XW,sep:"/"};function $W(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');nd(t);let n=0,i=-1,r=t.length,s;if(e===void 0||e.length===0||e.length>t.length){for(;r--;)if(t.codePointAt(r)===47){if(s){n=r+1;break}}else i<0&&(s=!0,i=r+1);return i<0?"":t.slice(n,i)}if(e===t)return"";let a=-1,o=e.length-1;for(;r--;)if(t.codePointAt(r)===47){if(s){n=r+1;break}}else a<0&&(s=!0,a=r+1),o>-1&&(t.codePointAt(r)===e.codePointAt(o--)?o<0&&(i=r):(o=-1,i=a));return n===i?i=a:i<0&&(i=t.length),t.slice(n,i)}function YW(t){if(nd(t),t.length===0)return".";let e=-1,n=t.length,i;for(;--n;)if(t.codePointAt(n)===47){if(i){e=n;break}}else i||(i=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function KW(t){nd(t);let e=t.length,n=-1,i=0,r=-1,s=0,a;for(;e--;){const o=t.codePointAt(e);if(o===47){if(a){i=e+1;break}continue}n<0&&(a=!0,n=e+1),o===46?r<0?r=e:s!==1&&(s=1):r>-1&&(s=-1)}return r<0||n<0||s===0||s===1&&r===n-1&&r===i+1?"":t.slice(r,n)}function XW(...t){let e=-1,n;for(;++e<t.length;)nd(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":QW(n)}function QW(t){nd(t);const e=t.codePointAt(0)===47;let n=ZW(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function ZW(t,e){let n="",i=0,r=-1,s=0,a=-1,o,l;for(;++a<=t.length;){if(a<t.length)o=t.codePointAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(n.length<2||i!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",i=0):(n=n.slice(0,l),i=n.length-1-n.lastIndexOf("/")),r=a,s=0;continue}}else if(n.length>0){n="",i=0,r=a,s=0;continue}}e&&(n=n.length>0?n+"/..":"..",i=2)}else n.length>0?n+="/"+t.slice(r+1,a):n=t.slice(r+1,a),i=a-r-1;r=a,s=0}else o===46&&s>-1?s++:s=-1}return n}function nd(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const JW={cwd:e$};function e$(){return"/"}function Hy(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function t$(t){if(typeof t=="string")t=new URL(t);else if(!Hy(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return n$(t)}function n$(t){if(t.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const i=e.codePointAt(n+2);if(i===70||i===102){const r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(e)}const Cg=["history","path","basename","stem","extname","dirname"];class i${constructor(e){let n;e?Hy(e)?n={path:e}:typeof e=="string"||r$(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":JW.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<Cg.length;){const s=Cg[i];s in n&&n[s]!==void 0&&n[s]!==null&&(this[s]=s==="history"?[...n[s]]:n[s])}let r;for(r in n)Cg.includes(r)||(this[r]=n[r])}get basename(){return typeof this.path=="string"?br.basename(this.path):void 0}set basename(e){_g(e,"basename"),Rg(e,"basename"),this.path=br.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?br.dirname(this.path):void 0}set dirname(e){QA(this.basename,"dirname"),this.path=br.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?br.extname(this.path):void 0}set extname(e){if(Rg(e,"extname"),QA(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=br.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){Hy(e)&&(e=t$(e)),_g(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?br.basename(this.path,this.extname):void 0}set stem(e){_g(e,"stem"),Rg(e,"stem"),this.path=br.join(this.dirname||"",e+(this.extname||""))}fail(e,n,i){const r=this.message(e,n,i);throw r.fatal=!0,r}info(e,n,i){const r=this.message(e,n,i);return r.fatal=void 0,r}message(e,n,i){const r=new hi(e,n,i);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Rg(t,e){if(t&&t.includes(br.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+br.sep+"`")}function _g(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function QA(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function r$(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const s$=(function(t){const i=this.constructor.prototype,r=i[t],s=function(){return r.apply(s,arguments)};return Object.setPrototypeOf(s,i),s}),a$={}.hasOwnProperty;class fb extends s${constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=jW()}copy(){const e=new fb;let n=-1;for(;++n<this.attachers.length;){const i=this.attachers[n];e.use(...i)}return e.data(wg(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(Dg("data",this.frozen),this.namespace[e]=n,this):a$.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Dg("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const r=n.call(e,...i);typeof r=="function"&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Lf(e),i=this.parser||this.Parser;return Ig("parse",i),i(String(n),n)}process(e,n){const i=this;return this.freeze(),Ig("process",this.parser||this.Parser),Lg("process",this.compiler||this.Compiler),n?r(void 0,n):new Promise(r);function r(s,a){const o=Lf(e),l=i.parse(o);i.run(l,o,function(d,f,p){if(d||!f||!p)return u(d);const m=f,y=i.stringify(m,p);l$(y)?p.value=y:p.result=y,u(d,p)});function u(d,f){d||!f?a(d):s?s(f):n(void 0,f)}}}processSync(e){let n=!1,i;return this.freeze(),Ig("processSync",this.parser||this.Parser),Lg("processSync",this.compiler||this.Compiler),this.process(e,r),JA("processSync","process",n),i;function r(s,a){n=!0,KA(s),i=a}}run(e,n,i){ZA(e),this.freeze();const r=this.transformers;return!i&&typeof n=="function"&&(i=n,n=void 0),i?s(void 0,i):new Promise(s);function s(a,o){const l=Lf(n);r.run(e,l,u);function u(d,f,p){const m=f||e;d?o(d):a?a(m):i(void 0,m,p)}}}runSync(e,n){let i=!1,r;return this.run(e,n,s),JA("runSync","run",i),r;function s(a,o){KA(a),r=o,i=!0}}stringify(e,n){this.freeze();const i=Lf(n),r=this.compiler||this.Compiler;return Lg("stringify",r),ZA(e),r(e,i)}use(e,...n){const i=this.attachers,r=this.namespace;if(Dg("use",this.frozen),e!=null)if(typeof e=="function")l(e,n);else if(typeof e=="object")Array.isArray(e)?o(e):a(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(u){if(typeof u=="function")l(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...f]=u;l(d,f)}else a(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function a(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(u.plugins),u.settings&&(r.settings=wg(!0,r.settings,u.settings))}function o(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const f=u[d];s(f)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function l(u,d){let f=-1,p=-1;for(;++f<i.length;)if(i[f][0]===u){p=f;break}if(p===-1)i.push([u,...d]);else if(d.length>0){let[m,...y]=d;const b=i[p][1];Uy(b)&&Uy(m)&&(m=wg(!0,b,m)),i[p]=[u,m,...y]}}}}const o$=new fb().freeze();function Ig(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function Lg(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function Dg(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function ZA(t){if(!Uy(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function JA(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Lf(t){return u$(t)?t:new i$(t)}function u$(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function l$(t){return typeof t=="string"||c$(t)}function c$(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}var NI={exports:{}},ac={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e3;function d$(){if(e3)return ac;e3=1;var t=U,e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,u){var d,f={},p=null,m=null;u!==void 0&&(p=""+u),l.key!==void 0&&(p=""+l.key),l.ref!==void 0&&(m=l.ref);for(d in l)i.call(l,d)&&!s.hasOwnProperty(d)&&(f[d]=l[d]);if(o&&o.defaultProps)for(d in l=o.defaultProps,l)f[d]===void 0&&(f[d]=l[d]);return{$$typeof:e,type:o,key:p,ref:m,props:f,_owner:r.current}}return ac.Fragment=n,ac.jsx=a,ac.jsxs=a,ac}NI.exports=d$();var f$=NI.exports;async function h$(t){const e=await o$().use(aW).use(Ij).use(qW,{allowDangerousHtml:!0}).use(jH).use(Kz).processSync(t);return String(e)}function p$(t){const[e,n]=U.useState("");return U.useEffect(()=>{(async()=>{const i=await h$(t);n(i)})()},[t]),{html:e,jsx:f$.jsx("div",{dangerouslySetInnerHTML:{__html:e}})}}var Og,t3;function MI(){if(t3)return Og;t3=1;function t(l,u){this.message=l,this.error=u}t.prototype=Object.create(Error.prototype);const e=/([0-9]+)?:?([0-9]{2}):([0-9]{2}\.[0-9]{2,3})/;function n(l,u){u||(u={});const{meta:d=!1,strict:f=!0}=u;if(typeof l!="string")throw new t("Input must be a string");l=l.trim(),l=l.replace(/\r\n/g,`
`),l=l.replace(/\r/g,`
`);const p=l.split(`

`),m=p.shift();if(!m.startsWith("WEBVTT"))throw new t('Must start with "WEBVTT"');const y=m.split(`
`),b=y[0].replace("WEBVTT","");if(b.length>0&&b[0]!==" "&&b[0]!=="	")throw new t("Header comment must start with space or tab");if(p.length===0&&y.length===1)return{valid:!0,strict:f,cues:[],errors:[]};if(!d&&y.length>1&&y[1]!=="")throw new t("Missing blank line after signature");const{cues:E,errors:T}=r(p,f);if(f&&T.length>0)throw T[0];const x=d?i(y):null,S={valid:T.length===0,strict:f,cues:E,errors:T};return d&&(S.meta=x),S}function i(l){const u={};return l.slice(1).forEach(d=>{const f=d.indexOf(":"),p=d.slice(0,f).trim(),m=d.slice(f+1).trim();u[p]=m}),Object.keys(u).length>0?u:null}function r(l,u){const d=[];return{cues:l.map((p,m)=>{try{return s(p,m,u)}catch(y){return d.push(y),null}}).filter(Boolean),errors:d}}function s(l,u,d){let f="",p=0,m=.01,y="",b="";const E=l.split(`
`).filter(Boolean);if(E.length>0&&E[0].trim().startsWith("NOTE"))return null;if(E.length===1&&!E[0].includes("-->"))throw new t(`Cue identifier cannot be standalone (cue #${u})`);if(E.length>1&&!(E[0].includes("-->")||E[1].includes("-->"))){const x=`Cue identifier needs to be followed by timestamp (cue #${u})`;throw new t(x)}E.length>1&&E[1].includes("-->")&&(f=E.shift());const T=typeof E[0]=="string"&&E[0].split(" --> ");if(T.length!==2||!a(T[0])||!a(T[1]))throw new t(`Invalid cue timestamp (cue #${u})`);if(p=o(T[0]),m=o(T[1]),d){if(p>m)throw new t(`Start timestamp greater than end (cue #${u})`);if(m<=p)throw new t(`End must be greater than start (cue #${u})`)}if(!d&&m<p)throw new t(`End must be greater or equal to start when not strict (cue #${u})`);return b=T[1].replace(e,"").trim(),E.shift(),y=E.join(`
`),y?{identifier:f,start:p,end:m,text:y,styles:b}:!1}function a(l){return e.test(l)}function o(l){const u=l.match(e);let d=parseFloat(u[1]||0)*60*60;return d+=parseFloat(u[2])*60,d+=parseFloat(u[3]),d}return Og={ParserError:t,parse:n},Og}var Pg,n3;function m$(){if(n3)return Pg;n3=1;function t(u,d){this.message=u,this.error=d}t.prototype=Object.create(Error.prototype);function e(u){if(!u)throw new t("Input must be non-null");if(typeof u!="object")throw new t("Input must be an object");if(Array.isArray(u))throw new t("Input cannot be array");if(!u.valid)throw new t("Input must be valid");let d=`WEBVTT
`;if(u.meta){if(typeof u.meta!="object"||Array.isArray(u.meta))throw new t("Metadata must be an object");Object.entries(u.meta).forEach(p=>{if(typeof p[1]!="string")throw new t(`Metadata value for "${p[0]}" must be string`);d+=`${p[0]}: ${p[1]}
`})}let f=null;return u.cues.forEach((p,m)=>{if(f&&f>p.start)throw new t(`Cue number ${m} is not in chronological order`);f=p.start,d+=`
`,d+=n(p),d+=`
`}),d}function n(u){if(typeof u!="object")throw new t("Cue malformed: not of type object");if(typeof u.identifier!="string"&&typeof u.identifier!="number"&&u.identifier!==null)throw new t(`Cue malformed: identifier value is not a string.
    ${JSON.stringify(u)}`);if(isNaN(u.start))throw new t(`Cue malformed: null start value.
    ${JSON.stringify(u)}`);if(isNaN(u.end))throw new t(`Cue malformed: null end value.
    ${JSON.stringify(u)}`);if(u.start>=u.end)throw new t(`Cue malformed: start timestamp greater than end
    ${JSON.stringify(u)}`);if(typeof u.text!="string")throw new t(`Cue malformed: null text value.
    ${JSON.stringify(u)}`);if(typeof u.styles!="string")throw new t(`Cue malformed: null styles value.
    ${JSON.stringify(u)}`);let d="";u.identifier.length>0&&(d+=`${u.identifier}
`);const f=i(u.start),p=i(u.end);return d+=`${f} --> ${p}`,d+=u.styles?` ${u.styles}`:"",d+=`
${u.text}`,d}function i(u){const d=r(s(u),2),f=r(a(u),2),p=r(o(u),2),m=r(l(u),3);return`${d}:${f}:${p}.${m}`}function r(u,d){let f=`${u}`;for(;f.length<d;)f=`0${f}`;return f}function s(u){return Math.floor(u/60/60)}function a(u){return Math.floor(u/60)%60}function o(u){return Math.floor(u%60)}function l(u){return Math.floor((u%1).toFixed(4)*1e3)}return Pg={CompilerError:t,compile:e},Pg}var kg,i3;function BI(){if(i3)return kg;i3=1;const t=MI().parse;function e(a,o){o=o||10;const l=t(a),u=[];let d=[],f=null,p=0,m=0;return l.cues.forEach((y,b)=>{const E=b===0,T=b===l.cues.length-1,x=y.start,S=y.end,w=T?1/0:l.cues[b+1].start,C=E?S:S-x,I=E?0:x-l.cues[b-1].end;p=p+C+I,`${b}`,u.length+1,f&&(d.push(f),p+=f.end-m,f=null),d.push(y);let L=w-S<o&&I<o&&p>o;if(n(m,o,w,I)){const N=i(T,S,o,p,m);u.push({duration:N,cues:d}),m+=N,p=0,d=[]}else L=!1;L&&(f=y)}),u}function n(a,o,l,u){const d=r(u,o);return(u<=o||d+a<l)&&l-a>=o}function i(a,o,l,u,d){let f=l;return u>l&&(f=r(u-l,l)),a?f=parseFloat((o-d).toFixed(2)):f=Math.round(f),f}function r(a,o){return a+=o-a%o,a}function s(a){}return kg={segment:e},kg}var Ng,r3;function g$(){if(r3)return Ng;r3=1;const t=BI().segment;function e(d,f,p){typeof p>"u"&&(p="900000");const m=t(d,f),y=[];return m.forEach((b,E)=>{const T=`WEBVTT
X-TIMESTAMP-MAP=MPEGTS:${p},LOCAL:00:00:00.000

${o(b.cues)}
`,x=r(E);y.push({filename:x,content:T})}),y}function n(d,f){const p=t(d,f),m=s(p);return`#EXTM3U
#EXT-X-TARGETDURATION:${Math.round(a(p))}
#EXT-X-VERSION:3
#EXT-X-MEDIA-SEQUENCE:0
#EXT-X-PLAYLIST-TYPE:VOD
${m}
#EXT-X-ENDLIST
`}function i(d,f){return`${"0".repeat(Math.max(0,f-d.toString().length))}${d}`}function r(d){return`${d}.vtt`}function s(d){const f=[];return d.forEach((p,m)=>{f.push(`#EXTINF:${p.duration.toFixed(5)},
${r(m)}`)}),f.join(`
`)}function a(d){let f=0;return d.forEach(p=>{p.duration>f&&(f=p.duration)}),f}function o(d){const f=[];return d.forEach(p=>{f.push(l(p))}),f.join(`

`)}function l(d){const f=[];d.identifier&&f.push(d.identifier);const p=u(d.start),m=u(d.end),y=d.styles?`${d.styles}`:"";return f.push(`${p} --> ${m} ${y}`),f.push(d.text),f.join(`
`)}function u(d){const f=(d%1).toFixed(3);d=Math.round(d-f);const p=Math.floor(d/3600),m=Math.floor((d-p*3600)/60),y=d-p*3600-m*60;return`${`${i(p,2)}:`}${i(m,2)}:${i(y,2)}.${i(f*1e3,3)}`}return Ng={hlsSegment:e,hlsSegmentPlaylist:n},Ng}var Mg,s3;function y$(){if(s3)return Mg;s3=1;const t=MI().parse,e=m$().compile,n=BI().segment,i=g$();return Mg={parse:t,compile:e,segment:n,hls:i},Mg}var v$=y$();function hb(t){const[e,n]=H.useState(void 0);return Hn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let a,o;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;a=u.inlineSize,o=u.blockSize}else a=t.offsetWidth,o=t.offsetHeight;n({width:a,height:o})});return i.observe(t,{box:"border-box"}),()=>i.unobserve(t)}else n(void 0)},[t]),e}function pb(t){const e=H.useRef({value:t,previous:t});return H.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var mb="Radio",[b$,FI]=Pr(mb),[E$,T$]=b$(mb),UI=H.forwardRef((t,e)=>{const{__scopeRadio:n,name:i,checked:r=!1,required:s,disabled:a,value:o="on",onCheck:l,form:u,...d}=t,[f,p]=H.useState(null),m=Yt(e,E=>p(E)),y=H.useRef(!1),b=f?u||!!f.closest("form"):!0;return Ce.jsxs(E$,{scope:n,checked:r,disabled:a,children:[Ce.jsx(Ct.button,{type:"button",role:"radio","aria-checked":r,"data-state":VI(r),"data-disabled":a?"":void 0,disabled:a,value:o,...d,ref:m,onClick:xt(t.onClick,E=>{r||l==null||l(),b&&(y.current=E.isPropagationStopped(),y.current||E.stopPropagation())})}),b&&Ce.jsx(qI,{control:f,bubbles:!y.current,name:i,value:o,checked:r,required:s,disabled:a,form:u,style:{transform:"translateX(-100%)"}})]})});UI.displayName=mb;var HI="RadioIndicator",zI=H.forwardRef((t,e)=>{const{__scopeRadio:n,forceMount:i,...r}=t,s=T$(HI,n);return Ce.jsx(Yc,{present:i||s.checked,children:Ce.jsx(Ct.span,{"data-state":VI(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})})});zI.displayName=HI;var x$="RadioBubbleInput",qI=H.forwardRef(({__scopeRadio:t,control:e,checked:n,bubbles:i=!0,...r},s)=>{const a=H.useRef(null),o=Yt(a,s),l=pb(n),u=hb(e);return H.useEffect(()=>{const d=a.current;if(!d)return;const f=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(f,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:i});m.call(d,n),d.dispatchEvent(y)}},[l,n,i]),Ce.jsx(Ct.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:o,style:{...r.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});qI.displayName=x$;function VI(t){return t?"checked":"unchecked"}var S$=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],g0="RadioGroup",[A$]=Pr(g0,[i0,FI]),GI=i0(),jI=FI(),[w$,C$]=A$(g0),WI=H.forwardRef((t,e)=>{const{__scopeRadioGroup:n,name:i,defaultValue:r,value:s,required:a=!1,disabled:o=!1,orientation:l,dir:u,loop:d=!0,onValueChange:f,...p}=t,m=GI(n),y=n0(u),[b,E]=oa({prop:s,defaultProp:r??null,onChange:f,caller:g0});return Ce.jsx(w$,{scope:n,name:i,required:a,disabled:o,value:b,onValueChange:E,children:Ce.jsx(R_,{asChild:!0,...m,orientation:l,dir:y,loop:d,children:Ce.jsx(Ct.div,{role:"radiogroup","aria-required":a,"aria-orientation":l,"data-disabled":o?"":void 0,dir:y,...p,ref:e})})})});WI.displayName=g0;var $I="RadioGroupItem",YI=H.forwardRef((t,e)=>{const{__scopeRadioGroup:n,disabled:i,...r}=t,s=C$($I,n),a=s.disabled||i,o=GI(n),l=jI(n),u=H.useRef(null),d=Yt(e,u),f=s.value===r.value,p=H.useRef(!1);return H.useEffect(()=>{const m=b=>{S$.includes(b.key)&&(p.current=!0)},y=()=>p.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",y)}},[]),Ce.jsx(__,{asChild:!0,...o,focusable:!a,active:f,children:Ce.jsx(UI,{disabled:a,required:s.required,checked:f,...l,...r,name:s.name,ref:d,onCheck:()=>s.onValueChange(r.value),onKeyDown:xt(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:xt(r.onFocus,()=>{var m;p.current&&((m=u.current)==null||m.click())})})})});YI.displayName=$I;var R$="RadioGroupIndicator",_$=H.forwardRef((t,e)=>{const{__scopeRadioGroup:n,...i}=t,r=jI(n);return Ce.jsx(zI,{...r,...i,ref:e})});_$.displayName=R$;var KI=WI,XI=YI,Qi={},Zi={},Bg={},Ji={},Df={},a3;function I$(){return a3||(a3=1,Object.defineProperty(Df,"__esModule",{value:!0}),Df.default=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(function(t){return t.charCodeAt(0)}))),Df}var Of={},o3;function L$(){return o3||(o3=1,Object.defineProperty(Of,"__esModule",{value:!0}),Of.default=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(function(t){return t.charCodeAt(0)}))),Of}var Fg={},u3;function l3(){return u3||(u3=1,(function(t){var e;Object.defineProperty(t,"__esModule",{value:!0}),t.replaceCodePoint=t.fromCodePoint=void 0;var n=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);t.fromCodePoint=(e=String.fromCodePoint)!==null&&e!==void 0?e:function(s){var a="";return s>65535&&(s-=65536,a+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),a+=String.fromCharCode(s),a};function i(s){var a;return s>=55296&&s<=57343||s>1114111?65533:(a=n.get(s))!==null&&a!==void 0?a:s}t.replaceCodePoint=i;function r(s){return(0,t.fromCodePoint)(i(s))}t.default=r})(Fg)),Fg}var c3;function QI(){return c3||(c3=1,(function(t){var e=Ji&&Ji.__createBinding||(Object.create?(function(D,V,$,J){J===void 0&&(J=$);var K=Object.getOwnPropertyDescriptor(V,$);(!K||("get"in K?!V.__esModule:K.writable||K.configurable))&&(K={enumerable:!0,get:function(){return V[$]}}),Object.defineProperty(D,J,K)}):(function(D,V,$,J){J===void 0&&(J=$),D[J]=V[$]})),n=Ji&&Ji.__setModuleDefault||(Object.create?(function(D,V){Object.defineProperty(D,"default",{enumerable:!0,value:V})}):function(D,V){D.default=V}),i=Ji&&Ji.__importStar||function(D){if(D&&D.__esModule)return D;var V={};if(D!=null)for(var $ in D)$!=="default"&&Object.prototype.hasOwnProperty.call(D,$)&&e(V,D,$);return n(V,D),V},r=Ji&&Ji.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeXML=t.decodeHTMLStrict=t.decodeHTMLAttribute=t.decodeHTML=t.determineBranch=t.EntityDecoder=t.DecodingMode=t.BinTrieFlags=t.fromCodePoint=t.replaceCodePoint=t.decodeCodePoint=t.xmlDecodeTree=t.htmlDecodeTree=void 0;var s=r(I$());t.htmlDecodeTree=s.default;var a=r(L$());t.xmlDecodeTree=a.default;var o=i(l3());t.decodeCodePoint=o.default;var l=l3();Object.defineProperty(t,"replaceCodePoint",{enumerable:!0,get:function(){return l.replaceCodePoint}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return l.fromCodePoint}});var u;(function(D){D[D.NUM=35]="NUM",D[D.SEMI=59]="SEMI",D[D.EQUALS=61]="EQUALS",D[D.ZERO=48]="ZERO",D[D.NINE=57]="NINE",D[D.LOWER_A=97]="LOWER_A",D[D.LOWER_F=102]="LOWER_F",D[D.LOWER_X=120]="LOWER_X",D[D.LOWER_Z=122]="LOWER_Z",D[D.UPPER_A=65]="UPPER_A",D[D.UPPER_F=70]="UPPER_F",D[D.UPPER_Z=90]="UPPER_Z"})(u||(u={}));var d=32,f;(function(D){D[D.VALUE_LENGTH=49152]="VALUE_LENGTH",D[D.BRANCH_LENGTH=16256]="BRANCH_LENGTH",D[D.JUMP_TABLE=127]="JUMP_TABLE"})(f=t.BinTrieFlags||(t.BinTrieFlags={}));function p(D){return D>=u.ZERO&&D<=u.NINE}function m(D){return D>=u.UPPER_A&&D<=u.UPPER_F||D>=u.LOWER_A&&D<=u.LOWER_F}function y(D){return D>=u.UPPER_A&&D<=u.UPPER_Z||D>=u.LOWER_A&&D<=u.LOWER_Z||p(D)}function b(D){return D===u.EQUALS||y(D)}var E;(function(D){D[D.EntityStart=0]="EntityStart",D[D.NumericStart=1]="NumericStart",D[D.NumericDecimal=2]="NumericDecimal",D[D.NumericHex=3]="NumericHex",D[D.NamedEntity=4]="NamedEntity"})(E||(E={}));var T;(function(D){D[D.Legacy=0]="Legacy",D[D.Strict=1]="Strict",D[D.Attribute=2]="Attribute"})(T=t.DecodingMode||(t.DecodingMode={}));var x=(function(){function D(V,$,J){this.decodeTree=V,this.emitCodePoint=$,this.errors=J,this.state=E.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=T.Strict}return D.prototype.startEntity=function(V){this.decodeMode=V,this.state=E.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},D.prototype.write=function(V,$){switch(this.state){case E.EntityStart:return V.charCodeAt($)===u.NUM?(this.state=E.NumericStart,this.consumed+=1,this.stateNumericStart(V,$+1)):(this.state=E.NamedEntity,this.stateNamedEntity(V,$));case E.NumericStart:return this.stateNumericStart(V,$);case E.NumericDecimal:return this.stateNumericDecimal(V,$);case E.NumericHex:return this.stateNumericHex(V,$);case E.NamedEntity:return this.stateNamedEntity(V,$)}},D.prototype.stateNumericStart=function(V,$){return $>=V.length?-1:(V.charCodeAt($)|d)===u.LOWER_X?(this.state=E.NumericHex,this.consumed+=1,this.stateNumericHex(V,$+1)):(this.state=E.NumericDecimal,this.stateNumericDecimal(V,$))},D.prototype.addToNumericResult=function(V,$,J,K){if($!==J){var j=J-$;this.result=this.result*Math.pow(K,j)+parseInt(V.substr($,j),K),this.consumed+=j}},D.prototype.stateNumericHex=function(V,$){for(var J=$;$<V.length;){var K=V.charCodeAt($);if(p(K)||m(K))$+=1;else return this.addToNumericResult(V,J,$,16),this.emitNumericEntity(K,3)}return this.addToNumericResult(V,J,$,16),-1},D.prototype.stateNumericDecimal=function(V,$){for(var J=$;$<V.length;){var K=V.charCodeAt($);if(p(K))$+=1;else return this.addToNumericResult(V,J,$,10),this.emitNumericEntity(K,2)}return this.addToNumericResult(V,J,$,10),-1},D.prototype.emitNumericEntity=function(V,$){var J;if(this.consumed<=$)return(J=this.errors)===null||J===void 0||J.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(V===u.SEMI)this.consumed+=1;else if(this.decodeMode===T.Strict)return 0;return this.emitCodePoint((0,o.replaceCodePoint)(this.result),this.consumed),this.errors&&(V!==u.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},D.prototype.stateNamedEntity=function(V,$){for(var J=this.decodeTree,K=J[this.treeIndex],j=(K&f.VALUE_LENGTH)>>14;$<V.length;$++,this.excess++){var te=V.charCodeAt($);if(this.treeIndex=w(J,K,this.treeIndex+Math.max(1,j),te),this.treeIndex<0)return this.result===0||this.decodeMode===T.Attribute&&(j===0||b(te))?0:this.emitNotTerminatedNamedEntity();if(K=J[this.treeIndex],j=(K&f.VALUE_LENGTH)>>14,j!==0){if(te===u.SEMI)return this.emitNamedEntityData(this.treeIndex,j,this.consumed+this.excess);this.decodeMode!==T.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},D.prototype.emitNotTerminatedNamedEntity=function(){var V,$=this,J=$.result,K=$.decodeTree,j=(K[J]&f.VALUE_LENGTH)>>14;return this.emitNamedEntityData(J,j,this.consumed),(V=this.errors)===null||V===void 0||V.missingSemicolonAfterCharacterReference(),this.consumed},D.prototype.emitNamedEntityData=function(V,$,J){var K=this.decodeTree;return this.emitCodePoint($===1?K[V]&~f.VALUE_LENGTH:K[V+1],J),$===3&&this.emitCodePoint(K[V+2],J),J},D.prototype.end=function(){var V;switch(this.state){case E.NamedEntity:return this.result!==0&&(this.decodeMode!==T.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case E.NumericDecimal:return this.emitNumericEntity(0,2);case E.NumericHex:return this.emitNumericEntity(0,3);case E.NumericStart:return(V=this.errors)===null||V===void 0||V.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case E.EntityStart:return 0}},D})();t.EntityDecoder=x;function S(D){var V="",$=new x(D,function(J){return V+=(0,o.fromCodePoint)(J)});return function(K,j){for(var te=0,ne=0;(ne=K.indexOf("&",ne))>=0;){V+=K.slice(te,ne),$.startEntity(j);var oe=$.write(K,ne+1);if(oe<0){te=ne+$.end();break}te=ne+oe,ne=oe===0?te+1:te}var P=V+K.slice(te);return V="",P}}function w(D,V,$,J){var K=(V&f.BRANCH_LENGTH)>>7,j=V&f.JUMP_TABLE;if(K===0)return j!==0&&J===j?$:-1;if(j){var te=J-j;return te<0||te>=K?-1:D[$+te]-1}for(var ne=$,oe=ne+K-1;ne<=oe;){var P=ne+oe>>>1,ie=D[P];if(ie<J)ne=P+1;else if(ie>J)oe=P-1;else return D[P+K]}return-1}t.determineBranch=w;var C=S(s.default),I=S(a.default);function L(D,V){return V===void 0&&(V=T.Legacy),C(D,V)}t.decodeHTML=L;function N(D){return C(D,T.Attribute)}t.decodeHTMLAttribute=N;function G(D){return C(D,T.Strict)}t.decodeHTMLStrict=G;function O(D){return I(D,T.Strict)}t.decodeXML=O})(Ji)),Ji}var d3;function ZI(){return d3||(d3=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.QuoteType=void 0;var e=QI(),n;(function(p){p[p.Tab=9]="Tab",p[p.NewLine=10]="NewLine",p[p.FormFeed=12]="FormFeed",p[p.CarriageReturn=13]="CarriageReturn",p[p.Space=32]="Space",p[p.ExclamationMark=33]="ExclamationMark",p[p.Number=35]="Number",p[p.Amp=38]="Amp",p[p.SingleQuote=39]="SingleQuote",p[p.DoubleQuote=34]="DoubleQuote",p[p.Dash=45]="Dash",p[p.Slash=47]="Slash",p[p.Zero=48]="Zero",p[p.Nine=57]="Nine",p[p.Semi=59]="Semi",p[p.Lt=60]="Lt",p[p.Eq=61]="Eq",p[p.Gt=62]="Gt",p[p.Questionmark=63]="Questionmark",p[p.UpperA=65]="UpperA",p[p.LowerA=97]="LowerA",p[p.UpperF=70]="UpperF",p[p.LowerF=102]="LowerF",p[p.UpperZ=90]="UpperZ",p[p.LowerZ=122]="LowerZ",p[p.LowerX=120]="LowerX",p[p.OpeningSquareBracket=91]="OpeningSquareBracket"})(n||(n={}));var i;(function(p){p[p.Text=1]="Text",p[p.BeforeTagName=2]="BeforeTagName",p[p.InTagName=3]="InTagName",p[p.InSelfClosingTag=4]="InSelfClosingTag",p[p.BeforeClosingTagName=5]="BeforeClosingTagName",p[p.InClosingTagName=6]="InClosingTagName",p[p.AfterClosingTagName=7]="AfterClosingTagName",p[p.BeforeAttributeName=8]="BeforeAttributeName",p[p.InAttributeName=9]="InAttributeName",p[p.AfterAttributeName=10]="AfterAttributeName",p[p.BeforeAttributeValue=11]="BeforeAttributeValue",p[p.InAttributeValueDq=12]="InAttributeValueDq",p[p.InAttributeValueSq=13]="InAttributeValueSq",p[p.InAttributeValueNq=14]="InAttributeValueNq",p[p.BeforeDeclaration=15]="BeforeDeclaration",p[p.InDeclaration=16]="InDeclaration",p[p.InProcessingInstruction=17]="InProcessingInstruction",p[p.BeforeComment=18]="BeforeComment",p[p.CDATASequence=19]="CDATASequence",p[p.InSpecialComment=20]="InSpecialComment",p[p.InCommentLike=21]="InCommentLike",p[p.BeforeSpecialS=22]="BeforeSpecialS",p[p.SpecialStartSequence=23]="SpecialStartSequence",p[p.InSpecialTag=24]="InSpecialTag",p[p.BeforeEntity=25]="BeforeEntity",p[p.BeforeNumericEntity=26]="BeforeNumericEntity",p[p.InNamedEntity=27]="InNamedEntity",p[p.InNumericEntity=28]="InNumericEntity",p[p.InHexEntity=29]="InHexEntity"})(i||(i={}));function r(p){return p===n.Space||p===n.NewLine||p===n.Tab||p===n.FormFeed||p===n.CarriageReturn}function s(p){return p===n.Slash||p===n.Gt||r(p)}function a(p){return p>=n.Zero&&p<=n.Nine}function o(p){return p>=n.LowerA&&p<=n.LowerZ||p>=n.UpperA&&p<=n.UpperZ}function l(p){return p>=n.UpperA&&p<=n.UpperF||p>=n.LowerA&&p<=n.LowerF}var u;(function(p){p[p.NoValue=0]="NoValue",p[p.Unquoted=1]="Unquoted",p[p.Single=2]="Single",p[p.Double=3]="Double"})(u=t.QuoteType||(t.QuoteType={}));var d={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},f=(function(){function p(m,y){var b=m.xmlMode,E=b===void 0?!1:b,T=m.decodeEntities,x=T===void 0?!0:T;this.cbs=y,this.state=i.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=i.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=E,this.decodeEntities=x,this.entityTrie=E?e.xmlDecodeTree:e.htmlDecodeTree}return p.prototype.reset=function(){this.state=i.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=i.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},p.prototype.write=function(m){this.offset+=this.buffer.length,this.buffer=m,this.parse()},p.prototype.end=function(){this.running&&this.finish()},p.prototype.pause=function(){this.running=!1},p.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},p.prototype.getIndex=function(){return this.index},p.prototype.getSectionStart=function(){return this.sectionStart},p.prototype.stateText=function(m){m===n.Lt||!this.decodeEntities&&this.fastForwardTo(n.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=i.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&m===n.Amp&&(this.state=i.BeforeEntity)},p.prototype.stateSpecialStartSequence=function(m){var y=this.sequenceIndex===this.currentSequence.length,b=y?s(m):(m|32)===this.currentSequence[this.sequenceIndex];if(!b)this.isSpecial=!1;else if(!y){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=i.InTagName,this.stateInTagName(m)},p.prototype.stateInSpecialTag=function(m){if(this.sequenceIndex===this.currentSequence.length){if(m===n.Gt||r(m)){var y=this.index-this.currentSequence.length;if(this.sectionStart<y){var b=this.index;this.index=y,this.cbs.ontext(this.sectionStart,y),this.index=b}this.isSpecial=!1,this.sectionStart=y+2,this.stateInClosingTagName(m);return}this.sequenceIndex=0}(m|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===d.TitleEnd?this.decodeEntities&&m===n.Amp&&(this.state=i.BeforeEntity):this.fastForwardTo(n.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(m===n.Lt)},p.prototype.stateCDATASequence=function(m){m===d.Cdata[this.sequenceIndex]?++this.sequenceIndex===d.Cdata.length&&(this.state=i.InCommentLike,this.currentSequence=d.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=i.InDeclaration,this.stateInDeclaration(m))},p.prototype.fastForwardTo=function(m){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===m)return!0;return this.index=this.buffer.length+this.offset-1,!1},p.prototype.stateInCommentLike=function(m){m===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===d.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=i.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):m!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},p.prototype.isTagStartChar=function(m){return this.xmlMode?!s(m):o(m)},p.prototype.startSpecial=function(m,y){this.isSpecial=!0,this.currentSequence=m,this.sequenceIndex=y,this.state=i.SpecialStartSequence},p.prototype.stateBeforeTagName=function(m){if(m===n.ExclamationMark)this.state=i.BeforeDeclaration,this.sectionStart=this.index+1;else if(m===n.Questionmark)this.state=i.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(m)){var y=m|32;this.sectionStart=this.index,!this.xmlMode&&y===d.TitleEnd[2]?this.startSpecial(d.TitleEnd,3):this.state=!this.xmlMode&&y===d.ScriptEnd[2]?i.BeforeSpecialS:i.InTagName}else m===n.Slash?this.state=i.BeforeClosingTagName:(this.state=i.Text,this.stateText(m))},p.prototype.stateInTagName=function(m){s(m)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(m))},p.prototype.stateBeforeClosingTagName=function(m){r(m)||(m===n.Gt?this.state=i.Text:(this.state=this.isTagStartChar(m)?i.InClosingTagName:i.InSpecialComment,this.sectionStart=this.index))},p.prototype.stateInClosingTagName=function(m){(m===n.Gt||r(m))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.AfterClosingTagName,this.stateAfterClosingTagName(m))},p.prototype.stateAfterClosingTagName=function(m){(m===n.Gt||this.fastForwardTo(n.Gt))&&(this.state=i.Text,this.baseState=i.Text,this.sectionStart=this.index+1)},p.prototype.stateBeforeAttributeName=function(m){m===n.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=i.InSpecialTag,this.sequenceIndex=0):this.state=i.Text,this.baseState=this.state,this.sectionStart=this.index+1):m===n.Slash?this.state=i.InSelfClosingTag:r(m)||(this.state=i.InAttributeName,this.sectionStart=this.index)},p.prototype.stateInSelfClosingTag=function(m){m===n.Gt?(this.cbs.onselfclosingtag(this.index),this.state=i.Text,this.baseState=i.Text,this.sectionStart=this.index+1,this.isSpecial=!1):r(m)||(this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(m))},p.prototype.stateInAttributeName=function(m){(m===n.Eq||s(m))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.AfterAttributeName,this.stateAfterAttributeName(m))},p.prototype.stateAfterAttributeName=function(m){m===n.Eq?this.state=i.BeforeAttributeValue:m===n.Slash||m===n.Gt?(this.cbs.onattribend(u.NoValue,this.index),this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(m)):r(m)||(this.cbs.onattribend(u.NoValue,this.index),this.state=i.InAttributeName,this.sectionStart=this.index)},p.prototype.stateBeforeAttributeValue=function(m){m===n.DoubleQuote?(this.state=i.InAttributeValueDq,this.sectionStart=this.index+1):m===n.SingleQuote?(this.state=i.InAttributeValueSq,this.sectionStart=this.index+1):r(m)||(this.sectionStart=this.index,this.state=i.InAttributeValueNq,this.stateInAttributeValueNoQuotes(m))},p.prototype.handleInAttributeValue=function(m,y){m===y||!this.decodeEntities&&this.fastForwardTo(y)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(y===n.DoubleQuote?u.Double:u.Single,this.index),this.state=i.BeforeAttributeName):this.decodeEntities&&m===n.Amp&&(this.baseState=this.state,this.state=i.BeforeEntity)},p.prototype.stateInAttributeValueDoubleQuotes=function(m){this.handleInAttributeValue(m,n.DoubleQuote)},p.prototype.stateInAttributeValueSingleQuotes=function(m){this.handleInAttributeValue(m,n.SingleQuote)},p.prototype.stateInAttributeValueNoQuotes=function(m){r(m)||m===n.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(u.Unquoted,this.index),this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(m)):this.decodeEntities&&m===n.Amp&&(this.baseState=this.state,this.state=i.BeforeEntity)},p.prototype.stateBeforeDeclaration=function(m){m===n.OpeningSquareBracket?(this.state=i.CDATASequence,this.sequenceIndex=0):this.state=m===n.Dash?i.BeforeComment:i.InDeclaration},p.prototype.stateInDeclaration=function(m){(m===n.Gt||this.fastForwardTo(n.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=i.Text,this.sectionStart=this.index+1)},p.prototype.stateInProcessingInstruction=function(m){(m===n.Gt||this.fastForwardTo(n.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=i.Text,this.sectionStart=this.index+1)},p.prototype.stateBeforeComment=function(m){m===n.Dash?(this.state=i.InCommentLike,this.currentSequence=d.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=i.InDeclaration},p.prototype.stateInSpecialComment=function(m){(m===n.Gt||this.fastForwardTo(n.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=i.Text,this.sectionStart=this.index+1)},p.prototype.stateBeforeSpecialS=function(m){var y=m|32;y===d.ScriptEnd[3]?this.startSpecial(d.ScriptEnd,4):y===d.StyleEnd[3]?this.startSpecial(d.StyleEnd,4):(this.state=i.InTagName,this.stateInTagName(m))},p.prototype.stateBeforeEntity=function(m){this.entityExcess=1,this.entityResult=0,m===n.Number?this.state=i.BeforeNumericEntity:m===n.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=i.InNamedEntity,this.stateInNamedEntity(m))},p.prototype.stateInNamedEntity=function(m){if(this.entityExcess+=1,this.trieIndex=(0,e.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,m),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var y=this.trieCurrent&e.BinTrieFlags.VALUE_LENGTH;if(y){var b=(y>>14)-1;if(!this.allowLegacyEntity()&&m!==n.Semi)this.trieIndex+=b;else{var E=this.index-this.entityExcess+1;E>this.sectionStart&&this.emitPartial(this.sectionStart,E),this.entityResult=this.trieIndex,this.trieIndex+=b,this.entityExcess=0,this.sectionStart=this.index+1,b===0&&this.emitNamedEntity()}}},p.prototype.emitNamedEntity=function(){if(this.state=this.baseState,this.entityResult!==0){var m=(this.entityTrie[this.entityResult]&e.BinTrieFlags.VALUE_LENGTH)>>14;switch(m){case 1:{this.emitCodePoint(this.entityTrie[this.entityResult]&~e.BinTrieFlags.VALUE_LENGTH);break}case 2:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);break}case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}},p.prototype.stateBeforeNumericEntity=function(m){(m|32)===n.LowerX?(this.entityExcess++,this.state=i.InHexEntity):(this.state=i.InNumericEntity,this.stateInNumericEntity(m))},p.prototype.emitNumericEntity=function(m){var y=this.index-this.entityExcess-1,b=y+2+ +(this.state===i.InHexEntity);b!==this.index&&(y>this.sectionStart&&this.emitPartial(this.sectionStart,y),this.sectionStart=this.index+Number(m),this.emitCodePoint((0,e.replaceCodePoint)(this.entityResult))),this.state=this.baseState},p.prototype.stateInNumericEntity=function(m){m===n.Semi?this.emitNumericEntity(!0):a(m)?(this.entityResult=this.entityResult*10+(m-n.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},p.prototype.stateInHexEntity=function(m){m===n.Semi?this.emitNumericEntity(!0):a(m)?(this.entityResult=this.entityResult*16+(m-n.Zero),this.entityExcess++):l(m)?(this.entityResult=this.entityResult*16+((m|32)-n.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},p.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===i.Text||this.baseState===i.InSpecialTag)},p.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===i.Text||this.state===i.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===i.InAttributeValueDq||this.state===i.InAttributeValueSq||this.state===i.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},p.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},p.prototype.parse=function(){for(;this.shouldContinue();){var m=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case i.Text:{this.stateText(m);break}case i.SpecialStartSequence:{this.stateSpecialStartSequence(m);break}case i.InSpecialTag:{this.stateInSpecialTag(m);break}case i.CDATASequence:{this.stateCDATASequence(m);break}case i.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(m);break}case i.InAttributeName:{this.stateInAttributeName(m);break}case i.InCommentLike:{this.stateInCommentLike(m);break}case i.InSpecialComment:{this.stateInSpecialComment(m);break}case i.BeforeAttributeName:{this.stateBeforeAttributeName(m);break}case i.InTagName:{this.stateInTagName(m);break}case i.InClosingTagName:{this.stateInClosingTagName(m);break}case i.BeforeTagName:{this.stateBeforeTagName(m);break}case i.AfterAttributeName:{this.stateAfterAttributeName(m);break}case i.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(m);break}case i.BeforeAttributeValue:{this.stateBeforeAttributeValue(m);break}case i.BeforeClosingTagName:{this.stateBeforeClosingTagName(m);break}case i.AfterClosingTagName:{this.stateAfterClosingTagName(m);break}case i.BeforeSpecialS:{this.stateBeforeSpecialS(m);break}case i.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(m);break}case i.InSelfClosingTag:{this.stateInSelfClosingTag(m);break}case i.InDeclaration:{this.stateInDeclaration(m);break}case i.BeforeDeclaration:{this.stateBeforeDeclaration(m);break}case i.BeforeComment:{this.stateBeforeComment(m);break}case i.InProcessingInstruction:{this.stateInProcessingInstruction(m);break}case i.InNamedEntity:{this.stateInNamedEntity(m);break}case i.BeforeEntity:{this.stateBeforeEntity(m);break}case i.InHexEntity:{this.stateInHexEntity(m);break}case i.InNumericEntity:{this.stateInNumericEntity(m);break}default:this.stateBeforeNumericEntity(m)}this.index++}this.cleanup()},p.prototype.finish=function(){this.state===i.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},p.prototype.handleTrailingData=function(){var m=this.buffer.length+this.offset;this.state===i.InCommentLike?this.currentSequence===d.CdataEnd?this.cbs.oncdata(this.sectionStart,m,0):this.cbs.oncomment(this.sectionStart,m,0):this.state===i.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===i.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===i.InTagName||this.state===i.BeforeAttributeName||this.state===i.BeforeAttributeValue||this.state===i.AfterAttributeName||this.state===i.InAttributeName||this.state===i.InAttributeValueSq||this.state===i.InAttributeValueDq||this.state===i.InAttributeValueNq||this.state===i.InClosingTagName||this.cbs.ontext(this.sectionStart,m)},p.prototype.emitPartial=function(m,y){this.baseState!==i.Text&&this.baseState!==i.InSpecialTag?this.cbs.onattribdata(m,y):this.cbs.ontext(m,y)},p.prototype.emitCodePoint=function(m){this.baseState!==i.Text&&this.baseState!==i.InSpecialTag?this.cbs.onattribentity(m):this.cbs.ontextentity(m)},p})();t.default=f})(Bg)),Bg}var f3;function h3(){if(f3)return Zi;f3=1;var t=Zi&&Zi.__createBinding||(Object.create?(function(E,T,x,S){S===void 0&&(S=x);var w=Object.getOwnPropertyDescriptor(T,x);(!w||("get"in w?!T.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return T[x]}}),Object.defineProperty(E,S,w)}):(function(E,T,x,S){S===void 0&&(S=x),E[S]=T[x]})),e=Zi&&Zi.__setModuleDefault||(Object.create?(function(E,T){Object.defineProperty(E,"default",{enumerable:!0,value:T})}):function(E,T){E.default=T}),n=Zi&&Zi.__importStar||function(E){if(E&&E.__esModule)return E;var T={};if(E!=null)for(var x in E)x!=="default"&&Object.prototype.hasOwnProperty.call(E,x)&&t(T,E,x);return e(T,E),T};Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.Parser=void 0;var i=n(ZI()),r=QI(),s=new Set(["input","option","optgroup","select","button","datalist","textarea"]),a=new Set(["p"]),o=new Set(["thead","tbody"]),l=new Set(["dd","dt"]),u=new Set(["rt","rp"]),d=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",a],["h1",a],["h2",a],["h3",a],["h4",a],["h5",a],["h6",a],["select",s],["input",s],["output",s],["button",s],["datalist",s],["textarea",s],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",l],["dt",l],["address",a],["article",a],["aside",a],["blockquote",a],["details",a],["div",a],["dl",a],["fieldset",a],["figcaption",a],["figure",a],["footer",a],["form",a],["header",a],["hr",a],["main",a],["nav",a],["ol",a],["pre",a],["section",a],["table",a],["ul",a],["rt",u],["rp",u],["tbody",o],["tfoot",o]]),f=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),p=new Set(["math","svg"]),m=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),y=/\s|\//,b=(function(){function E(T,x){x===void 0&&(x={});var S,w,C,I,L;this.options=x,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=T??{},this.lowerCaseTagNames=(S=x.lowerCaseTags)!==null&&S!==void 0?S:!x.xmlMode,this.lowerCaseAttributeNames=(w=x.lowerCaseAttributeNames)!==null&&w!==void 0?w:!x.xmlMode,this.tokenizer=new((C=x.Tokenizer)!==null&&C!==void 0?C:i.default)(this.options,this),(L=(I=this.cbs).onparserinit)===null||L===void 0||L.call(I,this)}return E.prototype.ontext=function(T,x){var S,w,C=this.getSlice(T,x);this.endIndex=x-1,(w=(S=this.cbs).ontext)===null||w===void 0||w.call(S,C),this.startIndex=x},E.prototype.ontextentity=function(T){var x,S,w=this.tokenizer.getSectionStart();this.endIndex=w-1,(S=(x=this.cbs).ontext)===null||S===void 0||S.call(x,(0,r.fromCodePoint)(T)),this.startIndex=w},E.prototype.isVoidElement=function(T){return!this.options.xmlMode&&f.has(T)},E.prototype.onopentagname=function(T,x){this.endIndex=x;var S=this.getSlice(T,x);this.lowerCaseTagNames&&(S=S.toLowerCase()),this.emitOpenTag(S)},E.prototype.emitOpenTag=function(T){var x,S,w,C;this.openTagStart=this.startIndex,this.tagname=T;var I=!this.options.xmlMode&&d.get(T);if(I)for(;this.stack.length>0&&I.has(this.stack[this.stack.length-1]);){var L=this.stack.pop();(S=(x=this.cbs).onclosetag)===null||S===void 0||S.call(x,L,!0)}this.isVoidElement(T)||(this.stack.push(T),p.has(T)?this.foreignContext.push(!0):m.has(T)&&this.foreignContext.push(!1)),(C=(w=this.cbs).onopentagname)===null||C===void 0||C.call(w,T),this.cbs.onopentag&&(this.attribs={})},E.prototype.endOpenTag=function(T){var x,S;this.startIndex=this.openTagStart,this.attribs&&((S=(x=this.cbs).onopentag)===null||S===void 0||S.call(x,this.tagname,this.attribs,T),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},E.prototype.onopentagend=function(T){this.endIndex=T,this.endOpenTag(!1),this.startIndex=T+1},E.prototype.onclosetag=function(T,x){var S,w,C,I,L,N;this.endIndex=x;var G=this.getSlice(T,x);if(this.lowerCaseTagNames&&(G=G.toLowerCase()),(p.has(G)||m.has(G))&&this.foreignContext.pop(),this.isVoidElement(G))!this.options.xmlMode&&G==="br"&&((w=(S=this.cbs).onopentagname)===null||w===void 0||w.call(S,"br"),(I=(C=this.cbs).onopentag)===null||I===void 0||I.call(C,"br",{},!0),(N=(L=this.cbs).onclosetag)===null||N===void 0||N.call(L,"br",!1));else{var O=this.stack.lastIndexOf(G);if(O!==-1)if(this.cbs.onclosetag)for(var D=this.stack.length-O;D--;)this.cbs.onclosetag(this.stack.pop(),D!==0);else this.stack.length=O;else!this.options.xmlMode&&G==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=x+1},E.prototype.onselfclosingtag=function(T){this.endIndex=T,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=T+1):this.onopentagend(T)},E.prototype.closeCurrentTag=function(T){var x,S,w=this.tagname;this.endOpenTag(T),this.stack[this.stack.length-1]===w&&((S=(x=this.cbs).onclosetag)===null||S===void 0||S.call(x,w,!T),this.stack.pop())},E.prototype.onattribname=function(T,x){this.startIndex=T;var S=this.getSlice(T,x);this.attribname=this.lowerCaseAttributeNames?S.toLowerCase():S},E.prototype.onattribdata=function(T,x){this.attribvalue+=this.getSlice(T,x)},E.prototype.onattribentity=function(T){this.attribvalue+=(0,r.fromCodePoint)(T)},E.prototype.onattribend=function(T,x){var S,w;this.endIndex=x,(w=(S=this.cbs).onattribute)===null||w===void 0||w.call(S,this.attribname,this.attribvalue,T===i.QuoteType.Double?'"':T===i.QuoteType.Single?"'":T===i.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},E.prototype.getInstructionName=function(T){var x=T.search(y),S=x<0?T:T.substr(0,x);return this.lowerCaseTagNames&&(S=S.toLowerCase()),S},E.prototype.ondeclaration=function(T,x){this.endIndex=x;var S=this.getSlice(T,x);if(this.cbs.onprocessinginstruction){var w=this.getInstructionName(S);this.cbs.onprocessinginstruction("!".concat(w),"!".concat(S))}this.startIndex=x+1},E.prototype.onprocessinginstruction=function(T,x){this.endIndex=x;var S=this.getSlice(T,x);if(this.cbs.onprocessinginstruction){var w=this.getInstructionName(S);this.cbs.onprocessinginstruction("?".concat(w),"?".concat(S))}this.startIndex=x+1},E.prototype.oncomment=function(T,x,S){var w,C,I,L;this.endIndex=x,(C=(w=this.cbs).oncomment)===null||C===void 0||C.call(w,this.getSlice(T,x-S)),(L=(I=this.cbs).oncommentend)===null||L===void 0||L.call(I),this.startIndex=x+1},E.prototype.oncdata=function(T,x,S){var w,C,I,L,N,G,O,D,V,$;this.endIndex=x;var J=this.getSlice(T,x-S);this.options.xmlMode||this.options.recognizeCDATA?((C=(w=this.cbs).oncdatastart)===null||C===void 0||C.call(w),(L=(I=this.cbs).ontext)===null||L===void 0||L.call(I,J),(G=(N=this.cbs).oncdataend)===null||G===void 0||G.call(N)):((D=(O=this.cbs).oncomment)===null||D===void 0||D.call(O,"[CDATA[".concat(J,"]]")),($=(V=this.cbs).oncommentend)===null||$===void 0||$.call(V)),this.startIndex=x+1},E.prototype.onend=function(){var T,x;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var S=this.stack.length;S>0;this.cbs.onclosetag(this.stack[--S],!0));}(x=(T=this.cbs).onend)===null||x===void 0||x.call(T)},E.prototype.reset=function(){var T,x,S,w;(x=(T=this.cbs).onreset)===null||x===void 0||x.call(T),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(w=(S=this.cbs).onparserinit)===null||w===void 0||w.call(S,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},E.prototype.parseComplete=function(T){this.reset(),this.end(T)},E.prototype.getSlice=function(T,x){for(;T-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var S=this.buffers[0].slice(T-this.bufferOffset,x-this.bufferOffset);x-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),S+=this.buffers[0].slice(0,x-this.bufferOffset);return S},E.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},E.prototype.write=function(T){var x,S;if(this.ended){(S=(x=this.cbs).onerror)===null||S===void 0||S.call(x,new Error(".write() after done!"));return}this.buffers.push(T),this.tokenizer.running&&(this.tokenizer.write(T),this.writeIndex++)},E.prototype.end=function(T){var x,S;if(this.ended){(S=(x=this.cbs).onerror)===null||S===void 0||S.call(x,new Error(".end() after done!"));return}T&&this.write(T),this.ended=!0,this.tokenizer.end()},E.prototype.pause=function(){this.tokenizer.pause()},E.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},E.prototype.parseChunk=function(T){this.write(T)},E.prototype.done=function(T){this.end(T)},E})();return Zi.Parser=b,Zi}var qa={},Ug={},p3;function id(){return p3||(p3=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Doctype=t.CDATA=t.Tag=t.Style=t.Script=t.Comment=t.Directive=t.Text=t.Root=t.isTag=t.ElementType=void 0;var e;(function(i){i.Root="root",i.Text="text",i.Directive="directive",i.Comment="comment",i.Script="script",i.Style="style",i.Tag="tag",i.CDATA="cdata",i.Doctype="doctype"})(e=t.ElementType||(t.ElementType={}));function n(i){return i.type===e.Tag||i.type===e.Script||i.type===e.Style}t.isTag=n,t.Root=e.Root,t.Text=e.Text,t.Directive=e.Directive,t.Comment=e.Comment,t.Script=e.Script,t.Style=e.Style,t.Tag=e.Tag,t.CDATA=e.CDATA,t.Doctype=e.Doctype})(Ug)),Ug}var vt={},m3;function g3(){if(m3)return vt;m3=1;var t=vt&&vt.__extends||(function(){var C=function(I,L){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,G){N.__proto__=G}||function(N,G){for(var O in G)Object.prototype.hasOwnProperty.call(G,O)&&(N[O]=G[O])},C(I,L)};return function(I,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");C(I,L);function N(){this.constructor=I}I.prototype=L===null?Object.create(L):(N.prototype=L.prototype,new N)}})(),e=vt&&vt.__assign||function(){return e=Object.assign||function(C){for(var I,L=1,N=arguments.length;L<N;L++){I=arguments[L];for(var G in I)Object.prototype.hasOwnProperty.call(I,G)&&(C[G]=I[G])}return C},e.apply(this,arguments)};Object.defineProperty(vt,"__esModule",{value:!0}),vt.cloneNode=vt.hasChildren=vt.isDocument=vt.isDirective=vt.isComment=vt.isText=vt.isCDATA=vt.isTag=vt.Element=vt.Document=vt.CDATA=vt.NodeWithChildren=vt.ProcessingInstruction=vt.Comment=vt.Text=vt.DataNode=vt.Node=void 0;var n=id(),i=(function(){function C(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(C.prototype,"parentNode",{get:function(){return this.parent},set:function(I){this.parent=I},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"previousSibling",{get:function(){return this.prev},set:function(I){this.prev=I},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"nextSibling",{get:function(){return this.next},set:function(I){this.next=I},enumerable:!1,configurable:!0}),C.prototype.cloneNode=function(I){return I===void 0&&(I=!1),S(this,I)},C})();vt.Node=i;var r=(function(C){t(I,C);function I(L){var N=C.call(this)||this;return N.data=L,N}return Object.defineProperty(I.prototype,"nodeValue",{get:function(){return this.data},set:function(L){this.data=L},enumerable:!1,configurable:!0}),I})(i);vt.DataNode=r;var s=(function(C){t(I,C);function I(){var L=C!==null&&C.apply(this,arguments)||this;return L.type=n.ElementType.Text,L}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),I})(r);vt.Text=s;var a=(function(C){t(I,C);function I(){var L=C!==null&&C.apply(this,arguments)||this;return L.type=n.ElementType.Comment,L}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),I})(r);vt.Comment=a;var o=(function(C){t(I,C);function I(L,N){var G=C.call(this,N)||this;return G.name=L,G.type=n.ElementType.Directive,G}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),I})(r);vt.ProcessingInstruction=o;var l=(function(C){t(I,C);function I(L){var N=C.call(this)||this;return N.children=L,N}return Object.defineProperty(I.prototype,"firstChild",{get:function(){var L;return(L=this.children[0])!==null&&L!==void 0?L:null},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"childNodes",{get:function(){return this.children},set:function(L){this.children=L},enumerable:!1,configurable:!0}),I})(i);vt.NodeWithChildren=l;var u=(function(C){t(I,C);function I(){var L=C!==null&&C.apply(this,arguments)||this;return L.type=n.ElementType.CDATA,L}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),I})(l);vt.CDATA=u;var d=(function(C){t(I,C);function I(){var L=C!==null&&C.apply(this,arguments)||this;return L.type=n.ElementType.Root,L}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),I})(l);vt.Document=d;var f=(function(C){t(I,C);function I(L,N,G,O){G===void 0&&(G=[]),O===void 0&&(O=L==="script"?n.ElementType.Script:L==="style"?n.ElementType.Style:n.ElementType.Tag);var D=C.call(this,G)||this;return D.name=L,D.attribs=N,D.type=O,D}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"tagName",{get:function(){return this.name},set:function(L){this.name=L},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"attributes",{get:function(){var L=this;return Object.keys(this.attribs).map(function(N){var G,O;return{name:N,value:L.attribs[N],namespace:(G=L["x-attribsNamespace"])===null||G===void 0?void 0:G[N],prefix:(O=L["x-attribsPrefix"])===null||O===void 0?void 0:O[N]}})},enumerable:!1,configurable:!0}),I})(l);vt.Element=f;function p(C){return(0,n.isTag)(C)}vt.isTag=p;function m(C){return C.type===n.ElementType.CDATA}vt.isCDATA=m;function y(C){return C.type===n.ElementType.Text}vt.isText=y;function b(C){return C.type===n.ElementType.Comment}vt.isComment=b;function E(C){return C.type===n.ElementType.Directive}vt.isDirective=E;function T(C){return C.type===n.ElementType.Root}vt.isDocument=T;function x(C){return Object.prototype.hasOwnProperty.call(C,"children")}vt.hasChildren=x;function S(C,I){I===void 0&&(I=!1);var L;if(y(C))L=new s(C.data);else if(b(C))L=new a(C.data);else if(p(C)){var N=I?w(C.children):[],G=new f(C.name,e({},C.attribs),N);N.forEach(function($){return $.parent=G}),C.namespace!=null&&(G.namespace=C.namespace),C["x-attribsNamespace"]&&(G["x-attribsNamespace"]=e({},C["x-attribsNamespace"])),C["x-attribsPrefix"]&&(G["x-attribsPrefix"]=e({},C["x-attribsPrefix"])),L=G}else if(m(C)){var N=I?w(C.children):[],O=new u(N);N.forEach(function(J){return J.parent=O}),L=O}else if(T(C)){var N=I?w(C.children):[],D=new d(N);N.forEach(function(J){return J.parent=D}),C["x-mode"]&&(D["x-mode"]=C["x-mode"]),L=D}else if(E(C)){var V=new o(C.name,C.data);C["x-name"]!=null&&(V["x-name"]=C["x-name"],V["x-publicId"]=C["x-publicId"],V["x-systemId"]=C["x-systemId"]),L=V}else throw new Error("Not implemented yet: ".concat(C.type));return L.startIndex=C.startIndex,L.endIndex=C.endIndex,C.sourceCodeLocation!=null&&(L.sourceCodeLocation=C.sourceCodeLocation),L}vt.cloneNode=S;function w(C){for(var I=C.map(function(N){return S(N,!0)}),L=1;L<I.length;L++)I[L].prev=I[L-1],I[L-1].next=I[L];return I}return vt}var y3;function la(){return y3||(y3=1,(function(t){var e=qa&&qa.__createBinding||(Object.create?(function(o,l,u,d){d===void 0&&(d=u);var f=Object.getOwnPropertyDescriptor(l,u);(!f||("get"in f?!l.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return l[u]}}),Object.defineProperty(o,d,f)}):(function(o,l,u,d){d===void 0&&(d=u),o[d]=l[u]})),n=qa&&qa.__exportStar||function(o,l){for(var u in o)u!=="default"&&!Object.prototype.hasOwnProperty.call(l,u)&&e(l,o,u)};Object.defineProperty(t,"__esModule",{value:!0}),t.DomHandler=void 0;var i=id(),r=g3();n(g3(),t);var s={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},a=(function(){function o(l,u,d){this.dom=[],this.root=new r.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof u=="function"&&(d=u,u=s),typeof l=="object"&&(u=l,l=void 0),this.callback=l??null,this.options=u??s,this.elementCB=d??null}return o.prototype.onparserinit=function(l){this.parser=l},o.prototype.onreset=function(){this.dom=[],this.root=new r.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},o.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},o.prototype.onerror=function(l){this.handleCallback(l)},o.prototype.onclosetag=function(){this.lastNode=null;var l=this.tagStack.pop();this.options.withEndIndices&&(l.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(l)},o.prototype.onopentag=function(l,u){var d=this.options.xmlMode?i.ElementType.Tag:void 0,f=new r.Element(l,u,void 0,d);this.addNode(f),this.tagStack.push(f)},o.prototype.ontext=function(l){var u=this.lastNode;if(u&&u.type===i.ElementType.Text)u.data+=l,this.options.withEndIndices&&(u.endIndex=this.parser.endIndex);else{var d=new r.Text(l);this.addNode(d),this.lastNode=d}},o.prototype.oncomment=function(l){if(this.lastNode&&this.lastNode.type===i.ElementType.Comment){this.lastNode.data+=l;return}var u=new r.Comment(l);this.addNode(u),this.lastNode=u},o.prototype.oncommentend=function(){this.lastNode=null},o.prototype.oncdatastart=function(){var l=new r.Text(""),u=new r.CDATA([l]);this.addNode(u),l.parent=u,this.lastNode=l},o.prototype.oncdataend=function(){this.lastNode=null},o.prototype.onprocessinginstruction=function(l,u){var d=new r.ProcessingInstruction(l,u);this.addNode(d)},o.prototype.handleCallback=function(l){if(typeof this.callback=="function")this.callback(l,this.dom);else if(l)throw l},o.prototype.addNode=function(l){var u=this.tagStack[this.tagStack.length-1],d=u.children[u.children.length-1];this.options.withStartIndices&&(l.startIndex=this.parser.startIndex),this.options.withEndIndices&&(l.endIndex=this.parser.endIndex),u.children.push(l),d&&(l.prev=d,d.next=l),l.parent=u,this.lastNode=null},o})();t.DomHandler=a,t.default=a})(qa)),qa}var Va={},gr={},ai={},Hg={},er={},Pf={},v3;function D$(){return v3||(v3=1,Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.default=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(function(t){return t.charCodeAt(0)}))),Pf}var kf={},b3;function O$(){return b3||(b3=1,Object.defineProperty(kf,"__esModule",{value:!0}),kf.default=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(function(t){return t.charCodeAt(0)}))),kf}var zg={},E3;function T3(){return E3||(E3=1,(function(t){var e;Object.defineProperty(t,"__esModule",{value:!0}),t.replaceCodePoint=t.fromCodePoint=void 0;var n=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);t.fromCodePoint=(e=String.fromCodePoint)!==null&&e!==void 0?e:function(s){var a="";return s>65535&&(s-=65536,a+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),a+=String.fromCharCode(s),a};function i(s){var a;return s>=55296&&s<=57343||s>1114111?65533:(a=n.get(s))!==null&&a!==void 0?a:s}t.replaceCodePoint=i;function r(s){return(0,t.fromCodePoint)(i(s))}t.default=r})(zg)),zg}var x3;function S3(){return x3||(x3=1,(function(t){var e=er&&er.__createBinding||(Object.create?(function(D,V,$,J){J===void 0&&(J=$);var K=Object.getOwnPropertyDescriptor(V,$);(!K||("get"in K?!V.__esModule:K.writable||K.configurable))&&(K={enumerable:!0,get:function(){return V[$]}}),Object.defineProperty(D,J,K)}):(function(D,V,$,J){J===void 0&&(J=$),D[J]=V[$]})),n=er&&er.__setModuleDefault||(Object.create?(function(D,V){Object.defineProperty(D,"default",{enumerable:!0,value:V})}):function(D,V){D.default=V}),i=er&&er.__importStar||function(D){if(D&&D.__esModule)return D;var V={};if(D!=null)for(var $ in D)$!=="default"&&Object.prototype.hasOwnProperty.call(D,$)&&e(V,D,$);return n(V,D),V},r=er&&er.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeXML=t.decodeHTMLStrict=t.decodeHTMLAttribute=t.decodeHTML=t.determineBranch=t.EntityDecoder=t.DecodingMode=t.BinTrieFlags=t.fromCodePoint=t.replaceCodePoint=t.decodeCodePoint=t.xmlDecodeTree=t.htmlDecodeTree=void 0;var s=r(D$());t.htmlDecodeTree=s.default;var a=r(O$());t.xmlDecodeTree=a.default;var o=i(T3());t.decodeCodePoint=o.default;var l=T3();Object.defineProperty(t,"replaceCodePoint",{enumerable:!0,get:function(){return l.replaceCodePoint}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return l.fromCodePoint}});var u;(function(D){D[D.NUM=35]="NUM",D[D.SEMI=59]="SEMI",D[D.EQUALS=61]="EQUALS",D[D.ZERO=48]="ZERO",D[D.NINE=57]="NINE",D[D.LOWER_A=97]="LOWER_A",D[D.LOWER_F=102]="LOWER_F",D[D.LOWER_X=120]="LOWER_X",D[D.LOWER_Z=122]="LOWER_Z",D[D.UPPER_A=65]="UPPER_A",D[D.UPPER_F=70]="UPPER_F",D[D.UPPER_Z=90]="UPPER_Z"})(u||(u={}));var d=32,f;(function(D){D[D.VALUE_LENGTH=49152]="VALUE_LENGTH",D[D.BRANCH_LENGTH=16256]="BRANCH_LENGTH",D[D.JUMP_TABLE=127]="JUMP_TABLE"})(f=t.BinTrieFlags||(t.BinTrieFlags={}));function p(D){return D>=u.ZERO&&D<=u.NINE}function m(D){return D>=u.UPPER_A&&D<=u.UPPER_F||D>=u.LOWER_A&&D<=u.LOWER_F}function y(D){return D>=u.UPPER_A&&D<=u.UPPER_Z||D>=u.LOWER_A&&D<=u.LOWER_Z||p(D)}function b(D){return D===u.EQUALS||y(D)}var E;(function(D){D[D.EntityStart=0]="EntityStart",D[D.NumericStart=1]="NumericStart",D[D.NumericDecimal=2]="NumericDecimal",D[D.NumericHex=3]="NumericHex",D[D.NamedEntity=4]="NamedEntity"})(E||(E={}));var T;(function(D){D[D.Legacy=0]="Legacy",D[D.Strict=1]="Strict",D[D.Attribute=2]="Attribute"})(T=t.DecodingMode||(t.DecodingMode={}));var x=(function(){function D(V,$,J){this.decodeTree=V,this.emitCodePoint=$,this.errors=J,this.state=E.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=T.Strict}return D.prototype.startEntity=function(V){this.decodeMode=V,this.state=E.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},D.prototype.write=function(V,$){switch(this.state){case E.EntityStart:return V.charCodeAt($)===u.NUM?(this.state=E.NumericStart,this.consumed+=1,this.stateNumericStart(V,$+1)):(this.state=E.NamedEntity,this.stateNamedEntity(V,$));case E.NumericStart:return this.stateNumericStart(V,$);case E.NumericDecimal:return this.stateNumericDecimal(V,$);case E.NumericHex:return this.stateNumericHex(V,$);case E.NamedEntity:return this.stateNamedEntity(V,$)}},D.prototype.stateNumericStart=function(V,$){return $>=V.length?-1:(V.charCodeAt($)|d)===u.LOWER_X?(this.state=E.NumericHex,this.consumed+=1,this.stateNumericHex(V,$+1)):(this.state=E.NumericDecimal,this.stateNumericDecimal(V,$))},D.prototype.addToNumericResult=function(V,$,J,K){if($!==J){var j=J-$;this.result=this.result*Math.pow(K,j)+parseInt(V.substr($,j),K),this.consumed+=j}},D.prototype.stateNumericHex=function(V,$){for(var J=$;$<V.length;){var K=V.charCodeAt($);if(p(K)||m(K))$+=1;else return this.addToNumericResult(V,J,$,16),this.emitNumericEntity(K,3)}return this.addToNumericResult(V,J,$,16),-1},D.prototype.stateNumericDecimal=function(V,$){for(var J=$;$<V.length;){var K=V.charCodeAt($);if(p(K))$+=1;else return this.addToNumericResult(V,J,$,10),this.emitNumericEntity(K,2)}return this.addToNumericResult(V,J,$,10),-1},D.prototype.emitNumericEntity=function(V,$){var J;if(this.consumed<=$)return(J=this.errors)===null||J===void 0||J.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(V===u.SEMI)this.consumed+=1;else if(this.decodeMode===T.Strict)return 0;return this.emitCodePoint((0,o.replaceCodePoint)(this.result),this.consumed),this.errors&&(V!==u.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},D.prototype.stateNamedEntity=function(V,$){for(var J=this.decodeTree,K=J[this.treeIndex],j=(K&f.VALUE_LENGTH)>>14;$<V.length;$++,this.excess++){var te=V.charCodeAt($);if(this.treeIndex=w(J,K,this.treeIndex+Math.max(1,j),te),this.treeIndex<0)return this.result===0||this.decodeMode===T.Attribute&&(j===0||b(te))?0:this.emitNotTerminatedNamedEntity();if(K=J[this.treeIndex],j=(K&f.VALUE_LENGTH)>>14,j!==0){if(te===u.SEMI)return this.emitNamedEntityData(this.treeIndex,j,this.consumed+this.excess);this.decodeMode!==T.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},D.prototype.emitNotTerminatedNamedEntity=function(){var V,$=this,J=$.result,K=$.decodeTree,j=(K[J]&f.VALUE_LENGTH)>>14;return this.emitNamedEntityData(J,j,this.consumed),(V=this.errors)===null||V===void 0||V.missingSemicolonAfterCharacterReference(),this.consumed},D.prototype.emitNamedEntityData=function(V,$,J){var K=this.decodeTree;return this.emitCodePoint($===1?K[V]&~f.VALUE_LENGTH:K[V+1],J),$===3&&this.emitCodePoint(K[V+2],J),J},D.prototype.end=function(){var V;switch(this.state){case E.NamedEntity:return this.result!==0&&(this.decodeMode!==T.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case E.NumericDecimal:return this.emitNumericEntity(0,2);case E.NumericHex:return this.emitNumericEntity(0,3);case E.NumericStart:return(V=this.errors)===null||V===void 0||V.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case E.EntityStart:return 0}},D})();t.EntityDecoder=x;function S(D){var V="",$=new x(D,function(J){return V+=(0,o.fromCodePoint)(J)});return function(K,j){for(var te=0,ne=0;(ne=K.indexOf("&",ne))>=0;){V+=K.slice(te,ne),$.startEntity(j);var oe=$.write(K,ne+1);if(oe<0){te=ne+$.end();break}te=ne+oe,ne=oe===0?te+1:te}var P=V+K.slice(te);return V="",P}}function w(D,V,$,J){var K=(V&f.BRANCH_LENGTH)>>7,j=V&f.JUMP_TABLE;if(K===0)return j!==0&&J===j?$:-1;if(j){var te=J-j;return te<0||te>=K?-1:D[$+te]-1}for(var ne=$,oe=ne+K-1;ne<=oe;){var P=ne+oe>>>1,ie=D[P];if(ie<J)ne=P+1;else if(ie>J)oe=P-1;else return D[P+K]}return-1}t.determineBranch=w;var C=S(s.default),I=S(a.default);function L(D,V){return V===void 0&&(V=T.Legacy),C(D,V)}t.decodeHTML=L;function N(D){return C(D,T.Attribute)}t.decodeHTMLAttribute=N;function G(D){return C(D,T.Strict)}t.decodeHTMLStrict=G;function O(D){return I(D,T.Strict)}t.decodeXML=O})(er)),er}var es={},Nf={},A3;function P$(){if(A3)return Nf;A3=1,Object.defineProperty(Nf,"__esModule",{value:!0});function t(e){for(var n=1;n<e.length;n++)e[n][0]+=e[n-1][0]+1;return e}return Nf.default=new Map(t([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(t([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(t([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(t([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]])),Nf}var qg={},w3;function zy(){return w3||(w3=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.escapeText=t.escapeAttribute=t.escapeUTF8=t.escape=t.encodeXML=t.getCodePoint=t.xmlReplacer=void 0,t.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var e=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);t.getCodePoint=String.prototype.codePointAt!=null?function(r,s){return r.codePointAt(s)}:function(r,s){return(r.charCodeAt(s)&64512)===55296?(r.charCodeAt(s)-55296)*1024+r.charCodeAt(s+1)-56320+65536:r.charCodeAt(s)};function n(r){for(var s="",a=0,o;(o=t.xmlReplacer.exec(r))!==null;){var l=o.index,u=r.charCodeAt(l),d=e.get(u);d!==void 0?(s+=r.substring(a,l)+d,a=l+1):(s+="".concat(r.substring(a,l),"&#x").concat((0,t.getCodePoint)(r,l).toString(16),";"),a=t.xmlReplacer.lastIndex+=+((u&64512)===55296))}return s+r.substr(a)}t.encodeXML=n,t.escape=n;function i(r,s){return function(o){for(var l,u=0,d="";l=r.exec(o);)u!==l.index&&(d+=o.substring(u,l.index)),d+=s.get(l[0].charCodeAt(0)),u=l.index+1;return d+o.substring(u)}}t.escapeUTF8=i(/[&<>'"]/g,e),t.escapeAttribute=i(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),t.escapeText=i(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))})(qg)),qg}var C3;function R3(){if(C3)return es;C3=1;var t=es&&es.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(es,"__esModule",{value:!0}),es.encodeNonAsciiHTML=es.encodeHTML=void 0;var e=t(P$()),n=zy(),i=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function r(o){return a(i,o)}es.encodeHTML=r;function s(o){return a(n.xmlReplacer,o)}es.encodeNonAsciiHTML=s;function a(o,l){for(var u="",d=0,f;(f=o.exec(l))!==null;){var p=f.index;u+=l.substring(d,p);var m=l.charCodeAt(p),y=e.default.get(m);if(typeof y=="object"){if(p+1<l.length){var b=l.charCodeAt(p+1),E=typeof y.n=="number"?y.n===b?y.o:void 0:y.n.get(b);if(E!==void 0){u+=E,d=o.lastIndex+=1;continue}}y=y.v}if(y!==void 0)u+=y,d=p+1;else{var T=(0,n.getCodePoint)(l,p);u+="&#x".concat(T.toString(16),";"),d=o.lastIndex+=+(T!==m)}}return u+l.substr(d)}return es}var _3;function k$(){return _3||(_3=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.decodeXMLStrict=t.decodeHTML5Strict=t.decodeHTML4Strict=t.decodeHTML5=t.decodeHTML4=t.decodeHTMLAttribute=t.decodeHTMLStrict=t.decodeHTML=t.decodeXML=t.DecodingMode=t.EntityDecoder=t.encodeHTML5=t.encodeHTML4=t.encodeNonAsciiHTML=t.encodeHTML=t.escapeText=t.escapeAttribute=t.escapeUTF8=t.escape=t.encodeXML=t.encode=t.decodeStrict=t.decode=t.EncodingMode=t.EntityLevel=void 0;var e=S3(),n=R3(),i=zy(),r;(function(p){p[p.XML=0]="XML",p[p.HTML=1]="HTML"})(r=t.EntityLevel||(t.EntityLevel={}));var s;(function(p){p[p.UTF8=0]="UTF8",p[p.ASCII=1]="ASCII",p[p.Extensive=2]="Extensive",p[p.Attribute=3]="Attribute",p[p.Text=4]="Text"})(s=t.EncodingMode||(t.EncodingMode={}));function a(p,m){m===void 0&&(m=r.XML);var y=typeof m=="number"?m:m.level;if(y===r.HTML){var b=typeof m=="object"?m.mode:void 0;return(0,e.decodeHTML)(p,b)}return(0,e.decodeXML)(p)}t.decode=a;function o(p,m){var y;m===void 0&&(m=r.XML);var b=typeof m=="number"?{level:m}:m;return(y=b.mode)!==null&&y!==void 0||(b.mode=e.DecodingMode.Strict),a(p,b)}t.decodeStrict=o;function l(p,m){m===void 0&&(m=r.XML);var y=typeof m=="number"?{level:m}:m;return y.mode===s.UTF8?(0,i.escapeUTF8)(p):y.mode===s.Attribute?(0,i.escapeAttribute)(p):y.mode===s.Text?(0,i.escapeText)(p):y.level===r.HTML?y.mode===s.ASCII?(0,n.encodeNonAsciiHTML)(p):(0,n.encodeHTML)(p):(0,i.encodeXML)(p)}t.encode=l;var u=zy();Object.defineProperty(t,"encodeXML",{enumerable:!0,get:function(){return u.encodeXML}}),Object.defineProperty(t,"escape",{enumerable:!0,get:function(){return u.escape}}),Object.defineProperty(t,"escapeUTF8",{enumerable:!0,get:function(){return u.escapeUTF8}}),Object.defineProperty(t,"escapeAttribute",{enumerable:!0,get:function(){return u.escapeAttribute}}),Object.defineProperty(t,"escapeText",{enumerable:!0,get:function(){return u.escapeText}});var d=R3();Object.defineProperty(t,"encodeHTML",{enumerable:!0,get:function(){return d.encodeHTML}}),Object.defineProperty(t,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return d.encodeNonAsciiHTML}}),Object.defineProperty(t,"encodeHTML4",{enumerable:!0,get:function(){return d.encodeHTML}}),Object.defineProperty(t,"encodeHTML5",{enumerable:!0,get:function(){return d.encodeHTML}});var f=S3();Object.defineProperty(t,"EntityDecoder",{enumerable:!0,get:function(){return f.EntityDecoder}}),Object.defineProperty(t,"DecodingMode",{enumerable:!0,get:function(){return f.DecodingMode}}),Object.defineProperty(t,"decodeXML",{enumerable:!0,get:function(){return f.decodeXML}}),Object.defineProperty(t,"decodeHTML",{enumerable:!0,get:function(){return f.decodeHTML}}),Object.defineProperty(t,"decodeHTMLStrict",{enumerable:!0,get:function(){return f.decodeHTMLStrict}}),Object.defineProperty(t,"decodeHTMLAttribute",{enumerable:!0,get:function(){return f.decodeHTMLAttribute}}),Object.defineProperty(t,"decodeHTML4",{enumerable:!0,get:function(){return f.decodeHTML}}),Object.defineProperty(t,"decodeHTML5",{enumerable:!0,get:function(){return f.decodeHTML}}),Object.defineProperty(t,"decodeHTML4Strict",{enumerable:!0,get:function(){return f.decodeHTMLStrict}}),Object.defineProperty(t,"decodeHTML5Strict",{enumerable:!0,get:function(){return f.decodeHTMLStrict}}),Object.defineProperty(t,"decodeXMLStrict",{enumerable:!0,get:function(){return f.decodeXML}})})(Hg)),Hg}var Ga={},I3;function N$(){return I3||(I3=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.attributeNames=Ga.elementNames=void 0,Ga.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(function(t){return[t.toLowerCase(),t]})),Ga.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(function(t){return[t.toLowerCase(),t]}))),Ga}var L3;function M$(){if(L3)return ai;L3=1;var t=ai&&ai.__assign||function(){return t=Object.assign||function(w){for(var C,I=1,L=arguments.length;I<L;I++){C=arguments[I];for(var N in C)Object.prototype.hasOwnProperty.call(C,N)&&(w[N]=C[N])}return w},t.apply(this,arguments)},e=ai&&ai.__createBinding||(Object.create?(function(w,C,I,L){L===void 0&&(L=I);var N=Object.getOwnPropertyDescriptor(C,I);(!N||("get"in N?!C.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return C[I]}}),Object.defineProperty(w,L,N)}):(function(w,C,I,L){L===void 0&&(L=I),w[L]=C[I]})),n=ai&&ai.__setModuleDefault||(Object.create?(function(w,C){Object.defineProperty(w,"default",{enumerable:!0,value:C})}):function(w,C){w.default=C}),i=ai&&ai.__importStar||function(w){if(w&&w.__esModule)return w;var C={};if(w!=null)for(var I in w)I!=="default"&&Object.prototype.hasOwnProperty.call(w,I)&&e(C,w,I);return n(C,w),C};Object.defineProperty(ai,"__esModule",{value:!0}),ai.render=void 0;var r=i(id()),s=k$(),a=N$(),o=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function l(w){return w.replace(/"/g,"&quot;")}function u(w,C){var I;if(w){var L=((I=C.encodeEntities)!==null&&I!==void 0?I:C.decodeEntities)===!1?l:C.xmlMode||C.encodeEntities!=="utf8"?s.encodeXML:s.escapeAttribute;return Object.keys(w).map(function(N){var G,O,D=(G=w[N])!==null&&G!==void 0?G:"";return C.xmlMode==="foreign"&&(N=(O=a.attributeNames.get(N))!==null&&O!==void 0?O:N),!C.emptyAttrs&&!C.xmlMode&&D===""?N:"".concat(N,'="').concat(L(D),'"')}).join(" ")}}var d=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function f(w,C){C===void 0&&(C={});for(var I=("length"in w)?w:[w],L="",N=0;N<I.length;N++)L+=p(I[N],C);return L}ai.render=f,ai.default=f;function p(w,C){switch(w.type){case r.Root:return f(w.children,C);case r.Doctype:case r.Directive:return E(w);case r.Comment:return S(w);case r.CDATA:return x(w);case r.Script:case r.Style:case r.Tag:return b(w,C);case r.Text:return T(w,C)}}var m=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),y=new Set(["svg","math"]);function b(w,C){var I;C.xmlMode==="foreign"&&(w.name=(I=a.elementNames.get(w.name))!==null&&I!==void 0?I:w.name,w.parent&&m.has(w.parent.name)&&(C=t(t({},C),{xmlMode:!1}))),!C.xmlMode&&y.has(w.name)&&(C=t(t({},C),{xmlMode:"foreign"}));var L="<".concat(w.name),N=u(w.attribs,C);return N&&(L+=" ".concat(N)),w.children.length===0&&(C.xmlMode?C.selfClosingTags!==!1:C.selfClosingTags&&d.has(w.name))?(C.xmlMode||(L+=" "),L+="/>"):(L+=">",w.children.length>0&&(L+=f(w.children,C)),(C.xmlMode||!d.has(w.name))&&(L+="</".concat(w.name,">"))),L}function E(w){return"<".concat(w.data,">")}function T(w,C){var I,L=w.data||"";return((I=C.encodeEntities)!==null&&I!==void 0?I:C.decodeEntities)!==!1&&!(!C.xmlMode&&w.parent&&o.has(w.parent.name))&&(L=C.xmlMode||C.encodeEntities!=="utf8"?(0,s.encodeXML)(L):(0,s.escapeText)(L)),L}function x(w){return"<![CDATA[".concat(w.children[0].data,"]]>")}function S(w){return"<!--".concat(w.data,"-->")}return ai}var D3;function JI(){if(D3)return gr;D3=1;var t=gr&&gr.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(gr,"__esModule",{value:!0}),gr.getOuterHTML=r,gr.getInnerHTML=s,gr.getText=a,gr.textContent=o,gr.innerText=l;var e=la(),n=t(M$()),i=id();function r(u,d){return(0,n.default)(u,d)}function s(u,d){return(0,e.hasChildren)(u)?u.children.map(function(f){return r(f,d)}).join(""):""}function a(u){return Array.isArray(u)?u.map(a).join(""):(0,e.isTag)(u)?u.name==="br"?`
`:a(u.children):(0,e.isCDATA)(u)?a(u.children):(0,e.isText)(u)?u.data:""}function o(u){return Array.isArray(u)?u.map(o).join(""):(0,e.hasChildren)(u)&&!(0,e.isComment)(u)?o(u.children):(0,e.isText)(u)?u.data:""}function l(u){return Array.isArray(u)?u.map(l).join(""):(0,e.hasChildren)(u)&&(u.type===i.ElementType.Tag||(0,e.isCDATA)(u))?l(u.children):(0,e.isText)(u)?u.data:""}return gr}var tr={},O3;function B$(){if(O3)return tr;O3=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.getChildren=e,tr.getParent=n,tr.getSiblings=i,tr.getAttributeValue=r,tr.hasAttrib=s,tr.getName=a,tr.nextElementSibling=o,tr.prevElementSibling=l;var t=la();function e(u){return(0,t.hasChildren)(u)?u.children:[]}function n(u){return u.parent||null}function i(u){var d,f,p=n(u);if(p!=null)return e(p);for(var m=[u],y=u.prev,b=u.next;y!=null;)m.unshift(y),d=y,y=d.prev;for(;b!=null;)m.push(b),f=b,b=f.next;return m}function r(u,d){var f;return(f=u.attribs)===null||f===void 0?void 0:f[d]}function s(u,d){return u.attribs!=null&&Object.prototype.hasOwnProperty.call(u.attribs,d)&&u.attribs[d]!=null}function a(u){return u.name}function o(u){for(var d,f=u.next;f!==null&&!(0,t.isTag)(f);)d=f,f=d.next;return f}function l(u){for(var d,f=u.prev;f!==null&&!(0,t.isTag)(f);)d=f,f=d.prev;return f}return tr}var ts={},P3;function F$(){if(P3)return ts;P3=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.removeElement=t,ts.replaceElement=e,ts.appendChild=n,ts.append=i,ts.prependChild=r,ts.prepend=s;function t(a){if(a.prev&&(a.prev.next=a.next),a.next&&(a.next.prev=a.prev),a.parent){var o=a.parent.children,l=o.lastIndexOf(a);l>=0&&o.splice(l,1)}a.next=null,a.prev=null,a.parent=null}function e(a,o){var l=o.prev=a.prev;l&&(l.next=o);var u=o.next=a.next;u&&(u.prev=o);var d=o.parent=a.parent;if(d){var f=d.children;f[f.lastIndexOf(a)]=o,a.parent=null}}function n(a,o){if(t(o),o.next=null,o.parent=a,a.children.push(o)>1){var l=a.children[a.children.length-2];l.next=o,o.prev=l}else o.prev=null}function i(a,o){t(o);var l=a.parent,u=a.next;if(o.next=u,o.prev=a,a.next=o,o.parent=l,u){if(u.prev=o,l){var d=l.children;d.splice(d.lastIndexOf(u),0,o)}}else l&&l.children.push(o)}function r(a,o){if(t(o),o.parent=a,o.prev=null,a.children.unshift(o)!==1){var l=a.children[1];l.prev=o,o.next=l}else o.next=null}function s(a,o){t(o);var l=a.parent;if(l){var u=l.children;u.splice(u.indexOf(a),0,o)}a.prev&&(a.prev.next=o),o.parent=l,o.prev=a.prev,o.next=a,a.prev=o}return ts}var ns={},k3;function eL(){if(k3)return ns;k3=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.filter=e,ns.find=n,ns.findOneChild=i,ns.findOne=r,ns.existsOne=s,ns.findAll=a;var t=la();function e(o,l,u,d){return u===void 0&&(u=!0),d===void 0&&(d=1/0),n(o,Array.isArray(l)?l:[l],u,d)}function n(o,l,u,d){for(var f=[],p=[Array.isArray(l)?l:[l]],m=[0];;){if(m[0]>=p[0].length){if(m.length===1)return f;p.shift(),m.shift();continue}var y=p[0][m[0]++];if(o(y)&&(f.push(y),--d<=0))return f;u&&(0,t.hasChildren)(y)&&y.children.length>0&&(m.unshift(0),p.unshift(y.children))}}function i(o,l){return l.find(o)}function r(o,l,u){u===void 0&&(u=!0);for(var d=Array.isArray(l)?l:[l],f=0;f<d.length;f++){var p=d[f];if((0,t.isTag)(p)&&o(p))return p;if(u&&(0,t.hasChildren)(p)&&p.children.length>0){var m=r(o,p.children,!0);if(m)return m}}return null}function s(o,l){return(Array.isArray(l)?l:[l]).some(function(u){return(0,t.isTag)(u)&&o(u)||(0,t.hasChildren)(u)&&s(o,u.children)})}function a(o,l){for(var u=[],d=[Array.isArray(l)?l:[l]],f=[0];;){if(f[0]>=d[0].length){if(d.length===1)return u;d.shift(),f.shift();continue}var p=d[0][f[0]++];(0,t.isTag)(p)&&o(p)&&u.push(p),(0,t.hasChildren)(p)&&p.children.length>0&&(f.unshift(0),d.unshift(p.children))}}return ns}var is={},N3;function tL(){if(N3)return is;N3=1,Object.defineProperty(is,"__esModule",{value:!0}),is.testElement=a,is.getElements=o,is.getElementById=l,is.getElementsByTagName=u,is.getElementsByClassName=d,is.getElementsByTagType=f;var t=la(),e=eL(),n={tag_name:function(p){return typeof p=="function"?function(m){return(0,t.isTag)(m)&&p(m.name)}:p==="*"?t.isTag:function(m){return(0,t.isTag)(m)&&m.name===p}},tag_type:function(p){return typeof p=="function"?function(m){return p(m.type)}:function(m){return m.type===p}},tag_contains:function(p){return typeof p=="function"?function(m){return(0,t.isText)(m)&&p(m.data)}:function(m){return(0,t.isText)(m)&&m.data===p}}};function i(p,m){return typeof m=="function"?function(y){return(0,t.isTag)(y)&&m(y.attribs[p])}:function(y){return(0,t.isTag)(y)&&y.attribs[p]===m}}function r(p,m){return function(y){return p(y)||m(y)}}function s(p){var m=Object.keys(p).map(function(y){var b=p[y];return Object.prototype.hasOwnProperty.call(n,y)?n[y](b):i(y,b)});return m.length===0?null:m.reduce(r)}function a(p,m){var y=s(p);return y?y(m):!0}function o(p,m,y,b){b===void 0&&(b=1/0);var E=s(p);return E?(0,e.filter)(E,m,y,b):[]}function l(p,m,y){return y===void 0&&(y=!0),Array.isArray(m)||(m=[m]),(0,e.findOne)(i("id",p),m,y)}function u(p,m,y,b){return y===void 0&&(y=!0),b===void 0&&(b=1/0),(0,e.filter)(n.tag_name(p),m,y,b)}function d(p,m,y,b){return y===void 0&&(y=!0),b===void 0&&(b=1/0),(0,e.filter)(i("class",p),m,y,b)}function f(p,m,y,b){return y===void 0&&(y=!0),b===void 0&&(b=1/0),(0,e.filter)(n.tag_type(p),m,y,b)}return is}var Ks={},M3;function U$(){if(M3)return Ks;M3=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.DocumentPosition=void 0,Ks.removeSubsets=e,Ks.compareDocumentPosition=i,Ks.uniqueSort=r;var t=la();function e(s){for(var a=s.length;--a>=0;){var o=s[a];if(a>0&&s.lastIndexOf(o,a-1)>=0){s.splice(a,1);continue}for(var l=o.parent;l;l=l.parent)if(s.includes(l)){s.splice(a,1);break}}return s}var n;(function(s){s[s.DISCONNECTED=1]="DISCONNECTED",s[s.PRECEDING=2]="PRECEDING",s[s.FOLLOWING=4]="FOLLOWING",s[s.CONTAINS=8]="CONTAINS",s[s.CONTAINED_BY=16]="CONTAINED_BY"})(n||(Ks.DocumentPosition=n={}));function i(s,a){var o=[],l=[];if(s===a)return 0;for(var u=(0,t.hasChildren)(s)?s:s.parent;u;)o.unshift(u),u=u.parent;for(u=(0,t.hasChildren)(a)?a:a.parent;u;)l.unshift(u),u=u.parent;for(var d=Math.min(o.length,l.length),f=0;f<d&&o[f]===l[f];)f++;if(f===0)return n.DISCONNECTED;var p=o[f-1],m=p.children,y=o[f],b=l[f];return m.indexOf(y)>m.indexOf(b)?p===a?n.FOLLOWING|n.CONTAINED_BY:n.FOLLOWING:p===s?n.PRECEDING|n.CONTAINS:n.PRECEDING}function r(s){return s=s.filter(function(a,o,l){return!l.includes(a,o+1)}),s.sort(function(a,o){var l=i(a,o);return l&n.PRECEDING?-1:l&n.FOLLOWING?1:0}),s}return Ks}var Mf={},B3;function H$(){if(B3)return Mf;B3=1,Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.getFeed=n;var t=JI(),e=tL();function n(p){var m=l(f,p);return m?m.name==="feed"?i(m):r(m):null}function i(p){var m,y=p.children,b={type:"atom",items:(0,e.getElementsByTagName)("entry",y).map(function(x){var S,w=x.children,C={media:o(w)};d(C,"id","id",w),d(C,"title","title",w);var I=(S=l("link",w))===null||S===void 0?void 0:S.attribs.href;I&&(C.link=I);var L=u("summary",w)||u("content",w);L&&(C.description=L);var N=u("updated",w);return N&&(C.pubDate=new Date(N)),C})};d(b,"id","id",y),d(b,"title","title",y);var E=(m=l("link",y))===null||m===void 0?void 0:m.attribs.href;E&&(b.link=E),d(b,"description","subtitle",y);var T=u("updated",y);return T&&(b.updated=new Date(T)),d(b,"author","email",y,!0),b}function r(p){var m,y,b=(y=(m=l("channel",p.children))===null||m===void 0?void 0:m.children)!==null&&y!==void 0?y:[],E={type:p.name.substr(0,3),id:"",items:(0,e.getElementsByTagName)("item",p.children).map(function(x){var S=x.children,w={media:o(S)};d(w,"id","guid",S),d(w,"title","title",S),d(w,"link","link",S),d(w,"description","description",S);var C=u("pubDate",S)||u("dc:date",S);return C&&(w.pubDate=new Date(C)),w})};d(E,"title","title",b),d(E,"link","link",b),d(E,"description","description",b);var T=u("lastBuildDate",b);return T&&(E.updated=new Date(T)),d(E,"author","managingEditor",b,!0),E}var s=["url","type","lang"],a=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function o(p){return(0,e.getElementsByTagName)("media:content",p).map(function(m){for(var y=m.attribs,b={medium:y.medium,isDefault:!!y.isDefault},E=0,T=s;E<T.length;E++){var x=T[E];y[x]&&(b[x]=y[x])}for(var S=0,w=a;S<w.length;S++){var x=w[S];y[x]&&(b[x]=parseInt(y[x],10))}return y.expression&&(b.expression=y.expression),b})}function l(p,m){return(0,e.getElementsByTagName)(p,m,!0,1)[0]}function u(p,m,y){return y===void 0&&(y=!1),(0,t.textContent)((0,e.getElementsByTagName)(p,m,y,1)).trim()}function d(p,m,y,b,E){E===void 0&&(E=!1);var T=u(y,b,E);T&&(p[m]=T)}function f(p){return p==="rss"||p==="feed"||p==="rdf:RDF"}return Mf}var F3;function Vg(){return F3||(F3=1,(function(t){var e=Va&&Va.__createBinding||(Object.create?(function(r,s,a,o){o===void 0&&(o=a);var l=Object.getOwnPropertyDescriptor(s,a);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(r,o,l)}):(function(r,s,a,o){o===void 0&&(o=a),r[o]=s[a]})),n=Va&&Va.__exportStar||function(r,s){for(var a in r)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,r,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.hasChildren=t.isDocument=t.isComment=t.isText=t.isCDATA=t.isTag=void 0,n(JI(),t),n(B$(),t),n(F$(),t),n(eL(),t),n(tL(),t),n(U$(),t),n(H$(),t);var i=la();Object.defineProperty(t,"isTag",{enumerable:!0,get:function(){return i.isTag}}),Object.defineProperty(t,"isCDATA",{enumerable:!0,get:function(){return i.isCDATA}}),Object.defineProperty(t,"isText",{enumerable:!0,get:function(){return i.isText}}),Object.defineProperty(t,"isComment",{enumerable:!0,get:function(){return i.isComment}}),Object.defineProperty(t,"isDocument",{enumerable:!0,get:function(){return i.isDocument}}),Object.defineProperty(t,"hasChildren",{enumerable:!0,get:function(){return i.hasChildren}})})(Va)),Va}var U3;function z$(){return U3||(U3=1,(function(t){var e=Qi&&Qi.__createBinding||(Object.create?(function(T,x,S,w){w===void 0&&(w=S);var C=Object.getOwnPropertyDescriptor(x,S);(!C||("get"in C?!x.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return x[S]}}),Object.defineProperty(T,w,C)}):(function(T,x,S,w){w===void 0&&(w=S),T[w]=x[S]})),n=Qi&&Qi.__setModuleDefault||(Object.create?(function(T,x){Object.defineProperty(T,"default",{enumerable:!0,value:x})}):function(T,x){T.default=x}),i=Qi&&Qi.__importStar||function(T){if(T&&T.__esModule)return T;var x={};if(T!=null)for(var S in T)S!=="default"&&Object.prototype.hasOwnProperty.call(T,S)&&e(x,T,S);return n(x,T),x},r=Qi&&Qi.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomUtils=t.parseFeed=t.getFeed=t.ElementType=t.Tokenizer=t.createDomStream=t.parseDOM=t.parseDocument=t.DefaultHandler=t.DomHandler=t.Parser=void 0;var s=h3(),a=h3();Object.defineProperty(t,"Parser",{enumerable:!0,get:function(){return a.Parser}});var o=la(),l=la();Object.defineProperty(t,"DomHandler",{enumerable:!0,get:function(){return l.DomHandler}}),Object.defineProperty(t,"DefaultHandler",{enumerable:!0,get:function(){return l.DomHandler}});function u(T,x){var S=new o.DomHandler(void 0,x);return new s.Parser(S,x).end(T),S.root}t.parseDocument=u;function d(T,x){return u(T,x).children}t.parseDOM=d;function f(T,x,S){var w=new o.DomHandler(T,x,S);return new s.Parser(w,x)}t.createDomStream=f;var p=ZI();Object.defineProperty(t,"Tokenizer",{enumerable:!0,get:function(){return r(p).default}}),t.ElementType=i(id());var m=Vg(),y=Vg();Object.defineProperty(t,"getFeed",{enumerable:!0,get:function(){return y.getFeed}});var b={xmlMode:!0};function E(T,x){return x===void 0&&(x=b),(0,m.getFeed)(d(T,x))}t.parseFeed=E,t.DomUtils=i(Vg())})(Qi)),Qi}var Gg,H3;function q$(){return H3||(H3=1,Gg=t=>{if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}),Gg}var Bf={},z3;function V$(){if(z3)return Bf;z3=1,Object.defineProperty(Bf,"__esModule",{value:!0});/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function t(n){return Object.prototype.toString.call(n)==="[object Object]"}function e(n){var i,r;return t(n)===!1?!1:(i=n.constructor,i===void 0?!0:(r=i.prototype,!(t(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}return Bf.isPlainObject=e,Bf}var jg,q3;function G$(){if(q3)return jg;q3=1;var t=function(x){return e(x)&&!n(x)};function e(T){return!!T&&typeof T=="object"}function n(T){var x=Object.prototype.toString.call(T);return x==="[object RegExp]"||x==="[object Date]"||s(T)}var i=typeof Symbol=="function"&&Symbol.for,r=i?Symbol.for("react.element"):60103;function s(T){return T.$$typeof===r}function a(T){return Array.isArray(T)?[]:{}}function o(T,x){return x.clone!==!1&&x.isMergeableObject(T)?b(a(T),T,x):T}function l(T,x,S){return T.concat(x).map(function(w){return o(w,S)})}function u(T,x){if(!x.customMerge)return b;var S=x.customMerge(T);return typeof S=="function"?S:b}function d(T){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(T).filter(function(x){return Object.propertyIsEnumerable.call(T,x)}):[]}function f(T){return Object.keys(T).concat(d(T))}function p(T,x){try{return x in T}catch{return!1}}function m(T,x){return p(T,x)&&!(Object.hasOwnProperty.call(T,x)&&Object.propertyIsEnumerable.call(T,x))}function y(T,x,S){var w={};return S.isMergeableObject(T)&&f(T).forEach(function(C){w[C]=o(T[C],S)}),f(x).forEach(function(C){m(T,C)||(p(T,C)&&S.isMergeableObject(x[C])?w[C]=u(C,S)(T[C],x[C],S):w[C]=o(x[C],S))}),w}function b(T,x,S){S=S||{},S.arrayMerge=S.arrayMerge||l,S.isMergeableObject=S.isMergeableObject||t,S.cloneUnlessOtherwiseSpecified=o;var w=Array.isArray(x),C=Array.isArray(T),I=w===C;return I?w?S.arrayMerge(T,x,S):y(T,x,S):o(x,S)}b.all=function(x,S){if(!Array.isArray(x))throw new Error("first argument should be an array");return x.reduce(function(w,C){return b(w,C,S)},{})};var E=b;return jg=E,jg}var hh={exports:{}},j$=hh.exports,V3;function W$(){return V3||(V3=1,(function(t){(function(e,n){t.exports?t.exports=n():e.parseSrcset=n()})(j$,function(){return function(e){function n(w){return w===" "||w==="	"||w===`
`||w==="\f"||w==="\r"}function i(w){var C,I=w.exec(e.substring(E));if(I)return C=I[0],E+=C.length,C}for(var r=e.length,s=/^[ \t\n\r\u000c]+/,a=/^[, \t\n\r\u000c]+/,o=/^[^ \t\n\r\u000c]+/,l=/[,]+$/,u=/^\d+$/,d=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,f,p,m,y,b,E=0,T=[];;){if(i(a),E>=r)return T;f=i(o),p=[],f.slice(-1)===","?(f=f.replace(l,""),S()):x()}function x(){for(i(s),m="",y="in descriptor";;){if(b=e.charAt(E),y==="in descriptor")if(n(b))m&&(p.push(m),m="",y="after descriptor");else if(b===","){E+=1,m&&p.push(m),S();return}else if(b==="(")m=m+b,y="in parens";else if(b===""){m&&p.push(m),S();return}else m=m+b;else if(y==="in parens")if(b===")")m=m+b,y="in descriptor";else if(b===""){p.push(m),S();return}else m=m+b;else if(y==="after descriptor"&&!n(b))if(b===""){S();return}else y="in descriptor",E-=1;E+=1}}function S(){var w=!1,C,I,L,N,G={},O,D,V,$,J;for(N=0;N<p.length;N++)O=p[N],D=O[O.length-1],V=O.substring(0,O.length-1),$=parseInt(V,10),J=parseFloat(V),u.test(V)&&D==="w"?((C||I)&&(w=!0),$===0?w=!0:C=$):d.test(V)&&D==="x"?((C||I||L)&&(w=!0),J<0?w=!0:I=J):u.test(V)&&D==="h"?((L||I)&&(w=!0),$===0?w=!0:L=$):w=!0;w?console&&console.log&&console.log("Invalid srcset descriptor found in '"+e+"' at '"+O+"'."):(G.url=f,C&&(G.w=C),I&&(G.d=I),L&&(G.h=L),T.push(G))}}})})(hh)),hh.exports}var Ff={exports:{}},G3;function $$(){if(G3)return Ff.exports;G3=1;var t=String,e=function(){return{isColorSupported:!1,reset:t,bold:t,dim:t,italic:t,underline:t,inverse:t,hidden:t,strikethrough:t,black:t,red:t,green:t,yellow:t,blue:t,magenta:t,cyan:t,white:t,gray:t,bgBlack:t,bgRed:t,bgGreen:t,bgYellow:t,bgBlue:t,bgMagenta:t,bgCyan:t,bgWhite:t,blackBright:t,redBright:t,greenBright:t,yellowBright:t,blueBright:t,magentaBright:t,cyanBright:t,whiteBright:t,bgBlackBright:t,bgRedBright:t,bgGreenBright:t,bgYellowBright:t,bgBlueBright:t,bgMagentaBright:t,bgCyanBright:t,bgWhiteBright:t}};return Ff.exports=e(),Ff.exports.createColors=e,Ff.exports}const Y$={},K$=Object.freeze(Object.defineProperty({__proto__:null,default:Y$},Symbol.toStringTag,{value:"Module"})),ar=AN(K$);var Wg,j3;function gb(){if(j3)return Wg;j3=1;let t=$$(),e=ar;class n extends Error{constructor(r,s,a,o,l,u){super(r),this.name="CssSyntaxError",this.reason=r,l&&(this.file=l),o&&(this.source=o),u&&(this.plugin=u),typeof s<"u"&&typeof a<"u"&&(typeof s=="number"?(this.line=s,this.column=a):(this.line=s.line,this.column=s.column,this.endLine=a.line,this.endColumn=a.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,n)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(r){if(!this.source)return"";let s=this.source;r==null&&(r=t.isColorSupported);let a=m=>m,o=m=>m,l=m=>m;if(r){let{bold:m,gray:y,red:b}=t.createColors(!0);o=E=>m(b(E)),a=E=>y(E),e&&(l=E=>e(E))}let u=s.split(/\r?\n/),d=Math.max(this.line-3,0),f=Math.min(this.line+2,u.length),p=String(f).length;return u.slice(d,f).map((m,y)=>{let b=d+1+y,E=" "+(" "+b).slice(-p)+" | ";if(b===this.line){if(m.length>160){let x=20,S=Math.max(0,this.column-x),w=Math.max(this.column+x,this.endColumn+x),C=m.slice(S,w),I=a(E.replace(/\d/g," "))+m.slice(0,Math.min(this.column-1,x-1)).replace(/[^\t]/g," ");return o(">")+a(E)+l(C)+`
 `+I+o("^")}let T=a(E.replace(/\d/g," "))+m.slice(0,this.column-1).replace(/[^\t]/g," ");return o(">")+a(E)+l(m)+`
 `+T+o("^")}return" "+a(E)+l(m)}).join(`
`)}toString(){let r=this.showSourceCode();return r&&(r=`

`+r+`
`),this.name+": "+this.message+r}}return Wg=n,n.default=n,Wg}var $g,W3;function nL(){if(W3)return $g;W3=1;const t={after:`
`,beforeClose:`
`,beforeComment:`
`,beforeDecl:`
`,beforeOpen:" ",beforeRule:`
`,colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};function e(i){return i[0].toUpperCase()+i.slice(1)}class n{constructor(r){this.builder=r}atrule(r,s){let a="@"+r.name,o=r.params?this.rawValue(r,"params"):"";if(typeof r.raws.afterName<"u"?a+=r.raws.afterName:o&&(a+=" "),r.nodes)this.block(r,a+o);else{let l=(r.raws.between||"")+(s?";":"");this.builder(a+o+l,r)}}beforeAfter(r,s){let a;r.type==="decl"?a=this.raw(r,null,"beforeDecl"):r.type==="comment"?a=this.raw(r,null,"beforeComment"):s==="before"?a=this.raw(r,null,"beforeRule"):a=this.raw(r,null,"beforeClose");let o=r.parent,l=0;for(;o&&o.type!=="root";)l+=1,o=o.parent;if(a.includes(`
`)){let u=this.raw(r,null,"indent");if(u.length)for(let d=0;d<l;d++)a+=u}return a}block(r,s){let a=this.raw(r,"between","beforeOpen");this.builder(s+a+"{",r,"start");let o;r.nodes&&r.nodes.length?(this.body(r),o=this.raw(r,"after")):o=this.raw(r,"after","emptyBody"),o&&this.builder(o),this.builder("}",r,"end")}body(r){let s=r.nodes.length-1;for(;s>0&&r.nodes[s].type==="comment";)s-=1;let a=this.raw(r,"semicolon");for(let o=0;o<r.nodes.length;o++){let l=r.nodes[o],u=this.raw(l,"before");u&&this.builder(u),this.stringify(l,s!==o||a)}}comment(r){let s=this.raw(r,"left","commentLeft"),a=this.raw(r,"right","commentRight");this.builder("/*"+s+r.text+a+"*/",r)}decl(r,s){let a=this.raw(r,"between","colon"),o=r.prop+a+this.rawValue(r,"value");r.important&&(o+=r.raws.important||" !important"),s&&(o+=";"),this.builder(o,r)}document(r){this.body(r)}raw(r,s,a){let o;if(a||(a=s),s&&(o=r.raws[s],typeof o<"u"))return o;let l=r.parent;if(a==="before"&&(!l||l.type==="root"&&l.first===r||l&&l.type==="document"))return"";if(!l)return t[a];let u=r.root();if(u.rawCache||(u.rawCache={}),typeof u.rawCache[a]<"u")return u.rawCache[a];if(a==="before"||a==="after")return this.beforeAfter(r,a);{let d="raw"+e(a);this[d]?o=this[d](u,r):u.walk(f=>{if(o=f.raws[s],typeof o<"u")return!1})}return typeof o>"u"&&(o=t[a]),u.rawCache[a]=o,o}rawBeforeClose(r){let s;return r.walk(a=>{if(a.nodes&&a.nodes.length>0&&typeof a.raws.after<"u")return s=a.raws.after,s.includes(`
`)&&(s=s.replace(/[^\n]+$/,"")),!1}),s&&(s=s.replace(/\S/g,"")),s}rawBeforeComment(r,s){let a;return r.walkComments(o=>{if(typeof o.raws.before<"u")return a=o.raws.before,a.includes(`
`)&&(a=a.replace(/[^\n]+$/,"")),!1}),typeof a>"u"?a=this.raw(s,null,"beforeDecl"):a&&(a=a.replace(/\S/g,"")),a}rawBeforeDecl(r,s){let a;return r.walkDecls(o=>{if(typeof o.raws.before<"u")return a=o.raws.before,a.includes(`
`)&&(a=a.replace(/[^\n]+$/,"")),!1}),typeof a>"u"?a=this.raw(s,null,"beforeRule"):a&&(a=a.replace(/\S/g,"")),a}rawBeforeOpen(r){let s;return r.walk(a=>{if(a.type!=="decl"&&(s=a.raws.between,typeof s<"u"))return!1}),s}rawBeforeRule(r){let s;return r.walk(a=>{if(a.nodes&&(a.parent!==r||r.first!==a)&&typeof a.raws.before<"u")return s=a.raws.before,s.includes(`
`)&&(s=s.replace(/[^\n]+$/,"")),!1}),s&&(s=s.replace(/\S/g,"")),s}rawColon(r){let s;return r.walkDecls(a=>{if(typeof a.raws.between<"u")return s=a.raws.between.replace(/[^\s:]/g,""),!1}),s}rawEmptyBody(r){let s;return r.walk(a=>{if(a.nodes&&a.nodes.length===0&&(s=a.raws.after,typeof s<"u"))return!1}),s}rawIndent(r){if(r.raws.indent)return r.raws.indent;let s;return r.walk(a=>{let o=a.parent;if(o&&o!==r&&o.parent&&o.parent===r&&typeof a.raws.before<"u"){let l=a.raws.before.split(`
`);return s=l[l.length-1],s=s.replace(/\S/g,""),!1}}),s}rawSemicolon(r){let s;return r.walk(a=>{if(a.nodes&&a.nodes.length&&a.last.type==="decl"&&(s=a.raws.semicolon,typeof s<"u"))return!1}),s}rawValue(r,s){let a=r[s],o=r.raws[s];return o&&o.value===a?o.raw:a}root(r){this.body(r),r.raws.after&&this.builder(r.raws.after)}rule(r){this.block(r,this.rawValue(r,"selector")),r.raws.ownSemicolon&&this.builder(r.raws.ownSemicolon,r,"end")}stringify(r,s){if(!this[r.type])throw new Error("Unknown AST node type "+r.type+". Maybe you need to change PostCSS stringifier.");this[r.type](r,s)}}return $g=n,n.default=n,$g}var Yg,$3;function y0(){if($3)return Yg;$3=1;let t=nL();function e(n,i){new t(i).stringify(n)}return Yg=e,e.default=e,Yg}var Uf={},Y3;function yb(){return Y3||(Y3=1,Uf.isClean=Symbol("isClean"),Uf.my=Symbol("my")),Uf}var Kg,K3;function v0(){if(K3)return Kg;K3=1;let t=gb(),e=nL(),n=y0(),{isClean:i,my:r}=yb();function s(l,u){let d=new l.constructor;for(let f in l){if(!Object.prototype.hasOwnProperty.call(l,f)||f==="proxyCache")continue;let p=l[f],m=typeof p;f==="parent"&&m==="object"?u&&(d[f]=u):f==="source"?d[f]=p:Array.isArray(p)?d[f]=p.map(y=>s(y,d)):(m==="object"&&p!==null&&(p=s(p)),d[f]=p)}return d}function a(l,u){if(u&&typeof u.offset<"u")return u.offset;let d=1,f=1,p=0;for(let m=0;m<l.length;m++){if(f===u.line&&d===u.column){p=m;break}l[m]===`
`?(d=1,f+=1):d+=1}return p}class o{get proxyOf(){return this}constructor(u={}){this.raws={},this[i]=!1,this[r]=!0;for(let d in u)if(d==="nodes"){this.nodes=[];for(let f of u[d])typeof f.clone=="function"?this.append(f.clone()):this.append(f)}else this[d]=u[d]}addToError(u){if(u.postcssNode=this,u.stack&&this.source&&/\n\s{4}at /.test(u.stack)){let d=this.source;u.stack=u.stack.replace(/\n\s{4}at /,`$&${d.input.from}:${d.start.line}:${d.start.column}$&`)}return u}after(u){return this.parent.insertAfter(this,u),this}assign(u={}){for(let d in u)this[d]=u[d];return this}before(u){return this.parent.insertBefore(this,u),this}cleanRaws(u){delete this.raws.before,delete this.raws.after,u||delete this.raws.between}clone(u={}){let d=s(this);for(let f in u)d[f]=u[f];return d}cloneAfter(u={}){let d=this.clone(u);return this.parent.insertAfter(this,d),d}cloneBefore(u={}){let d=this.clone(u);return this.parent.insertBefore(this,d),d}error(u,d={}){if(this.source){let{end:f,start:p}=this.rangeBy(d);return this.source.input.error(u,{column:p.column,line:p.line},{column:f.column,line:f.line},d)}return new t(u)}getProxyProcessor(){return{get(u,d){return d==="proxyOf"?u:d==="root"?()=>u.root().toProxy():u[d]},set(u,d,f){return u[d]===f||(u[d]=f,(d==="prop"||d==="value"||d==="name"||d==="params"||d==="important"||d==="text")&&u.markDirty()),!0}}}markClean(){this[i]=!0}markDirty(){if(this[i]){this[i]=!1;let u=this;for(;u=u.parent;)u[i]=!1}}next(){if(!this.parent)return;let u=this.parent.index(this);return this.parent.nodes[u+1]}positionBy(u={}){let d=this.source.start;if(u.index)d=this.positionInside(u.index);else if(u.word){let f="document"in this.source.input?this.source.input.document:this.source.input.css,m=f.slice(a(f,this.source.start),a(f,this.source.end)).indexOf(u.word);m!==-1&&(d=this.positionInside(m))}return d}positionInside(u){let d=this.source.start.column,f=this.source.start.line,p="document"in this.source.input?this.source.input.document:this.source.input.css,m=a(p,this.source.start),y=m+u;for(let b=m;b<y;b++)p[b]===`
`?(d=1,f+=1):d+=1;return{column:d,line:f,offset:y}}prev(){if(!this.parent)return;let u=this.parent.index(this);return this.parent.nodes[u-1]}rangeBy(u={}){let d="document"in this.source.input?this.source.input.document:this.source.input.css,f={column:this.source.start.column,line:this.source.start.line,offset:a(d,this.source.start)},p=this.source.end?{column:this.source.end.column+1,line:this.source.end.line,offset:typeof this.source.end.offset=="number"?this.source.end.offset:a(d,this.source.end)+1}:{column:f.column+1,line:f.line,offset:f.offset+1};if(u.word){let y=d.slice(a(d,this.source.start),a(d,this.source.end)).indexOf(u.word);y!==-1&&(f=this.positionInside(y),p=this.positionInside(y+u.word.length))}else u.start?f={column:u.start.column,line:u.start.line,offset:a(d,u.start)}:u.index&&(f=this.positionInside(u.index)),u.end?p={column:u.end.column,line:u.end.line,offset:a(d,u.end)}:typeof u.endIndex=="number"?p=this.positionInside(u.endIndex):u.index&&(p=this.positionInside(u.index+1));return(p.line<f.line||p.line===f.line&&p.column<=f.column)&&(p={column:f.column+1,line:f.line,offset:f.offset+1}),{end:p,start:f}}raw(u,d){return new e().raw(this,u,d)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...u){if(this.parent){let d=this,f=!1;for(let p of u)p===this?f=!0:f?(this.parent.insertAfter(d,p),d=p):this.parent.insertBefore(d,p);f||this.remove()}return this}root(){let u=this;for(;u.parent&&u.parent.type!=="document";)u=u.parent;return u}toJSON(u,d){let f={},p=d==null;d=d||new Map;let m=0;for(let y in this){if(!Object.prototype.hasOwnProperty.call(this,y)||y==="parent"||y==="proxyCache")continue;let b=this[y];if(Array.isArray(b))f[y]=b.map(E=>typeof E=="object"&&E.toJSON?E.toJSON(null,d):E);else if(typeof b=="object"&&b.toJSON)f[y]=b.toJSON(null,d);else if(y==="source"){if(b==null)continue;let E=d.get(b.input);E==null&&(E=m,d.set(b.input,m),m++),f[y]={end:b.end,inputId:E,start:b.start}}else f[y]=b}return p&&(f.inputs=[...d.keys()].map(y=>y.toJSON())),f}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(u=n){u.stringify&&(u=u.stringify);let d="";return u(this,f=>{d+=f}),d}warn(u,d,f={}){let p={node:this};for(let m in f)p[m]=f[m];return u.warn(d,p)}}return Kg=o,o.default=o,Kg}var Xg,X3;function b0(){if(X3)return Xg;X3=1;let t=v0();class e extends t{constructor(i){super(i),this.type="comment"}}return Xg=e,e.default=e,Xg}var Qg,Q3;function E0(){if(Q3)return Qg;Q3=1;let t=v0();class e extends t{get variable(){return this.prop.startsWith("--")||this.prop[0]==="$"}constructor(i){i&&typeof i.value<"u"&&typeof i.value!="string"&&(i={...i,value:String(i.value)}),super(i),this.type="decl"}}return Qg=e,e.default=e,Qg}var Zg,Z3;function vo(){if(Z3)return Zg;Z3=1;let t=b0(),e=E0(),n=v0(),{isClean:i,my:r}=yb(),s,a,o,l;function u(p){return p.map(m=>(m.nodes&&(m.nodes=u(m.nodes)),delete m.source,m))}function d(p){if(p[i]=!1,p.proxyOf.nodes)for(let m of p.proxyOf.nodes)d(m)}class f extends n{get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}append(...m){for(let y of m){let b=this.normalize(y,this.last);for(let E of b)this.proxyOf.nodes.push(E)}return this.markDirty(),this}cleanRaws(m){if(super.cleanRaws(m),this.nodes)for(let y of this.nodes)y.cleanRaws(m)}each(m){if(!this.proxyOf.nodes)return;let y=this.getIterator(),b,E;for(;this.indexes[y]<this.proxyOf.nodes.length&&(b=this.indexes[y],E=m(this.proxyOf.nodes[b],b),E!==!1);)this.indexes[y]+=1;return delete this.indexes[y],E}every(m){return this.nodes.every(m)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let m=this.lastEach;return this.indexes[m]=0,m}getProxyProcessor(){return{get(m,y){return y==="proxyOf"?m:m[y]?y==="each"||typeof y=="string"&&y.startsWith("walk")?(...b)=>m[y](...b.map(E=>typeof E=="function"?(T,x)=>E(T.toProxy(),x):E)):y==="every"||y==="some"?b=>m[y]((E,...T)=>b(E.toProxy(),...T)):y==="root"?()=>m.root().toProxy():y==="nodes"?m.nodes.map(b=>b.toProxy()):y==="first"||y==="last"?m[y].toProxy():m[y]:m[y]},set(m,y,b){return m[y]===b||(m[y]=b,(y==="name"||y==="params"||y==="selector")&&m.markDirty()),!0}}}index(m){return typeof m=="number"?m:(m.proxyOf&&(m=m.proxyOf),this.proxyOf.nodes.indexOf(m))}insertAfter(m,y){let b=this.index(m),E=this.normalize(y,this.proxyOf.nodes[b]).reverse();b=this.index(m);for(let x of E)this.proxyOf.nodes.splice(b+1,0,x);let T;for(let x in this.indexes)T=this.indexes[x],b<T&&(this.indexes[x]=T+E.length);return this.markDirty(),this}insertBefore(m,y){let b=this.index(m),E=b===0?"prepend":!1,T=this.normalize(y,this.proxyOf.nodes[b],E).reverse();b=this.index(m);for(let S of T)this.proxyOf.nodes.splice(b,0,S);let x;for(let S in this.indexes)x=this.indexes[S],b<=x&&(this.indexes[S]=x+T.length);return this.markDirty(),this}normalize(m,y){if(typeof m=="string")m=u(a(m).nodes);else if(typeof m>"u")m=[];else if(Array.isArray(m)){m=m.slice(0);for(let E of m)E.parent&&E.parent.removeChild(E,"ignore")}else if(m.type==="root"&&this.type!=="document"){m=m.nodes.slice(0);for(let E of m)E.parent&&E.parent.removeChild(E,"ignore")}else if(m.type)m=[m];else if(m.prop){if(typeof m.value>"u")throw new Error("Value field is missed in node creation");typeof m.value!="string"&&(m.value=String(m.value)),m=[new e(m)]}else if(m.selector||m.selectors)m=[new l(m)];else if(m.name)m=[new s(m)];else if(m.text)m=[new t(m)];else throw new Error("Unknown node type in node creation");return m.map(E=>(E[r]||f.rebuild(E),E=E.proxyOf,E.parent&&E.parent.removeChild(E),E[i]&&d(E),E.raws||(E.raws={}),typeof E.raws.before>"u"&&y&&typeof y.raws.before<"u"&&(E.raws.before=y.raws.before.replace(/\S/g,"")),E.parent=this.proxyOf,E))}prepend(...m){m=m.reverse();for(let y of m){let b=this.normalize(y,this.first,"prepend").reverse();for(let E of b)this.proxyOf.nodes.unshift(E);for(let E in this.indexes)this.indexes[E]=this.indexes[E]+b.length}return this.markDirty(),this}push(m){return m.parent=this,this.proxyOf.nodes.push(m),this}removeAll(){for(let m of this.proxyOf.nodes)m.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(m){m=this.index(m),this.proxyOf.nodes[m].parent=void 0,this.proxyOf.nodes.splice(m,1);let y;for(let b in this.indexes)y=this.indexes[b],y>=m&&(this.indexes[b]=y-1);return this.markDirty(),this}replaceValues(m,y,b){return b||(b=y,y={}),this.walkDecls(E=>{y.props&&!y.props.includes(E.prop)||y.fast&&!E.value.includes(y.fast)||(E.value=E.value.replace(m,b))}),this.markDirty(),this}some(m){return this.nodes.some(m)}walk(m){return this.each((y,b)=>{let E;try{E=m(y,b)}catch(T){throw y.addToError(T)}return E!==!1&&y.walk&&(E=y.walk(m)),E})}walkAtRules(m,y){return y?m instanceof RegExp?this.walk((b,E)=>{if(b.type==="atrule"&&m.test(b.name))return y(b,E)}):this.walk((b,E)=>{if(b.type==="atrule"&&b.name===m)return y(b,E)}):(y=m,this.walk((b,E)=>{if(b.type==="atrule")return y(b,E)}))}walkComments(m){return this.walk((y,b)=>{if(y.type==="comment")return m(y,b)})}walkDecls(m,y){return y?m instanceof RegExp?this.walk((b,E)=>{if(b.type==="decl"&&m.test(b.prop))return y(b,E)}):this.walk((b,E)=>{if(b.type==="decl"&&b.prop===m)return y(b,E)}):(y=m,this.walk((b,E)=>{if(b.type==="decl")return y(b,E)}))}walkRules(m,y){return y?m instanceof RegExp?this.walk((b,E)=>{if(b.type==="rule"&&m.test(b.selector))return y(b,E)}):this.walk((b,E)=>{if(b.type==="rule"&&b.selector===m)return y(b,E)}):(y=m,this.walk((b,E)=>{if(b.type==="rule")return y(b,E)}))}}return f.registerParse=p=>{a=p},f.registerRule=p=>{l=p},f.registerAtRule=p=>{s=p},f.registerRoot=p=>{o=p},Zg=f,f.default=f,f.rebuild=p=>{p.type==="atrule"?Object.setPrototypeOf(p,s.prototype):p.type==="rule"?Object.setPrototypeOf(p,l.prototype):p.type==="decl"?Object.setPrototypeOf(p,e.prototype):p.type==="comment"?Object.setPrototypeOf(p,t.prototype):p.type==="root"&&Object.setPrototypeOf(p,o.prototype),p[r]=!0,p.nodes&&p.nodes.forEach(m=>{f.rebuild(m)})},Zg}var Jg,J3;function vb(){if(J3)return Jg;J3=1;let t=vo();class e extends t{constructor(i){super(i),this.type="atrule"}append(...i){return this.proxyOf.nodes||(this.nodes=[]),super.append(...i)}prepend(...i){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...i)}}return Jg=e,e.default=e,t.registerAtRule(e),Jg}var e1,ew;function bb(){if(ew)return e1;ew=1;let t=vo(),e,n;class i extends t{constructor(s){super({type:"document",...s}),this.nodes||(this.nodes=[])}toResult(s={}){return new e(new n,this,s).stringify()}}return i.registerLazyResult=r=>{e=r},i.registerProcessor=r=>{n=r},e1=i,i.default=i,e1}var t1,tw;function X$(){if(tw)return t1;tw=1;let t="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";return t1={nanoid:(i=21)=>{let r="",s=i|0;for(;s--;)r+=t[Math.random()*64|0];return r},customAlphabet:(i,r=21)=>(s=r)=>{let a="",o=s|0;for(;o--;)a+=i[Math.random()*i.length|0];return a}},t1}var n1,nw;function iL(){if(nw)return n1;nw=1;let{existsSync:t,readFileSync:e}=ar,{dirname:n,join:i}=ar,{SourceMapConsumer:r,SourceMapGenerator:s}=ar;function a(l){return Buffer?Buffer.from(l,"base64").toString():window.atob(l)}class o{constructor(u,d){if(d.map===!1)return;this.loadAnnotation(u),this.inline=this.startWith(this.annotation,"data:");let f=d.map?d.map.prev:void 0,p=this.loadMap(d.from,f);!this.mapFile&&d.from&&(this.mapFile=d.from),this.mapFile&&(this.root=n(this.mapFile)),p&&(this.text=p)}consumer(){return this.consumerCache||(this.consumerCache=new r(this.text)),this.consumerCache}decodeInline(u){let d=/^data:application\/json;charset=utf-?8;base64,/,f=/^data:application\/json;base64,/,p=/^data:application\/json;charset=utf-?8,/,m=/^data:application\/json,/,y=u.match(p)||u.match(m);if(y)return decodeURIComponent(u.substr(y[0].length));let b=u.match(d)||u.match(f);if(b)return a(u.substr(b[0].length));let E=u.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+E)}getAnnotationURL(u){return u.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(u){return typeof u!="object"?!1:typeof u.mappings=="string"||typeof u._mappings=="string"||Array.isArray(u.sections)}loadAnnotation(u){let d=u.match(/\/\*\s*# sourceMappingURL=/g);if(!d)return;let f=u.lastIndexOf(d.pop()),p=u.indexOf("*/",f);f>-1&&p>-1&&(this.annotation=this.getAnnotationURL(u.substring(f,p)))}loadFile(u){if(this.root=n(u),t(u))return this.mapFile=u,e(u,"utf-8").toString().trim()}loadMap(u,d){if(d===!1)return!1;if(d){if(typeof d=="string")return d;if(typeof d=="function"){let f=d(u);if(f){let p=this.loadFile(f);if(!p)throw new Error("Unable to load previous source map: "+f.toString());return p}}else{if(d instanceof r)return s.fromSourceMap(d).toString();if(d instanceof s)return d.toString();if(this.isMap(d))return JSON.stringify(d);throw new Error("Unsupported previous source map format: "+d.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let f=this.annotation;return u&&(f=i(n(u),f)),this.loadFile(f)}}}startWith(u,d){return u?u.substr(0,d.length)===d:!1}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}}return n1=o,o.default=o,n1}var i1,iw;function T0(){if(iw)return i1;iw=1;let{nanoid:t}=X$(),{isAbsolute:e,resolve:n}=ar,{SourceMapConsumer:i,SourceMapGenerator:r}=ar,{fileURLToPath:s,pathToFileURL:a}=ar,o=gb(),l=iL(),u=ar,d=Symbol("lineToIndexCache"),f=!!(i&&r),p=!!(n&&e);function m(b){if(b[d])return b[d];let E=b.css.split(`
`),T=new Array(E.length),x=0;for(let S=0,w=E.length;S<w;S++)T[S]=x,x+=E[S].length+1;return b[d]=T,T}class y{get from(){return this.file||this.id}constructor(E,T={}){if(E===null||typeof E>"u"||typeof E=="object"&&!E.toString)throw new Error(`PostCSS received ${E} instead of CSS string`);if(this.css=E.toString(),this.css[0]==="\uFEFF"||this.css[0]===""?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,this.document=this.css,T.document&&(this.document=T.document.toString()),T.from&&(!p||/^\w+:\/\//.test(T.from)||e(T.from)?this.file=T.from:this.file=n(T.from)),p&&f){let x=new l(this.css,T);if(x.text){this.map=x;let S=x.consumer().file;!this.file&&S&&(this.file=this.mapResolve(S))}}this.file||(this.id="<input css "+t(6)+">"),this.map&&(this.map.file=this.from)}error(E,T,x,S={}){let w,C,I,L,N;if(T&&typeof T=="object"){let O=T,D=x;if(typeof O.offset=="number"){L=O.offset;let V=this.fromOffset(L);T=V.line,x=V.col}else T=O.line,x=O.column,L=this.fromLineAndColumn(T,x);if(typeof D.offset=="number"){I=D.offset;let V=this.fromOffset(I);C=V.line,w=V.col}else C=D.line,w=D.column,I=this.fromLineAndColumn(D.line,D.column)}else if(x)L=this.fromLineAndColumn(T,x);else{L=T;let O=this.fromOffset(L);T=O.line,x=O.col}let G=this.origin(T,x,C,w);return G?N=new o(E,G.endLine===void 0?G.line:{column:G.column,line:G.line},G.endLine===void 0?G.column:{column:G.endColumn,line:G.endLine},G.source,G.file,S.plugin):N=new o(E,C===void 0?T:{column:x,line:T},C===void 0?x:{column:w,line:C},this.css,this.file,S.plugin),N.input={column:x,endColumn:w,endLine:C,endOffset:I,line:T,offset:L,source:this.css},this.file&&(a&&(N.input.url=a(this.file).toString()),N.input.file=this.file),N}fromLineAndColumn(E,T){return m(this)[E-1]+T-1}fromOffset(E){let T=m(this),x=T[T.length-1],S=0;if(E>=x)S=T.length-1;else{let w=T.length-2,C;for(;S<w;)if(C=S+(w-S>>1),E<T[C])w=C-1;else if(E>=T[C+1])S=C+1;else{S=C;break}}return{col:E-T[S]+1,line:S+1}}mapResolve(E){return/^\w+:\/\//.test(E)?E:n(this.map.consumer().sourceRoot||this.map.root||".",E)}origin(E,T,x,S){if(!this.map)return!1;let w=this.map.consumer(),C=w.originalPositionFor({column:T,line:E});if(!C.source)return!1;let I;typeof x=="number"&&(I=w.originalPositionFor({column:S,line:x}));let L;e(C.source)?L=a(C.source):L=new URL(C.source,this.map.consumer().sourceRoot||a(this.map.mapFile));let N={column:C.column,endColumn:I&&I.column,endLine:I&&I.line,line:C.line,url:L.toString()};if(L.protocol==="file:")if(s)N.file=s(L);else throw new Error("file: protocol is not available in this PostCSS build");let G=w.sourceContentFor(C.source);return G&&(N.source=G),N}toJSON(){let E={};for(let T of["hasBOM","css","file","id"])this[T]!=null&&(E[T]=this[T]);return this.map&&(E.map={...this.map},E.map.consumerCache&&(E.map.consumerCache=void 0)),E}}return i1=y,y.default=y,u&&u.registerInput&&u.registerInput(y),i1}var r1,rw;function rd(){if(rw)return r1;rw=1;let t=vo(),e,n;class i extends t{constructor(s){super(s),this.type="root",this.nodes||(this.nodes=[])}normalize(s,a,o){let l=super.normalize(s);if(a){if(o==="prepend")this.nodes.length>1?a.raws.before=this.nodes[1].raws.before:delete a.raws.before;else if(this.first!==a)for(let u of l)u.raws.before=a.raws.before}return l}removeChild(s,a){let o=this.index(s);return!a&&o===0&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[o].raws.before),super.removeChild(s)}toResult(s={}){return new e(new n,this,s).stringify()}}return i.registerLazyResult=r=>{e=r},i.registerProcessor=r=>{n=r},r1=i,i.default=i,t.registerRoot(i),r1}var s1,sw;function rL(){if(sw)return s1;sw=1;let t={comma(e){return t.split(e,[","],!0)},space(e){let n=[" ",`
`,"	"];return t.split(e,n)},split(e,n,i){let r=[],s="",a=!1,o=0,l=!1,u="",d=!1;for(let f of e)d?d=!1:f==="\\"?d=!0:l?f===u&&(l=!1):f==='"'||f==="'"?(l=!0,u=f):f==="("?o+=1:f===")"?o>0&&(o-=1):o===0&&n.includes(f)&&(a=!0),a?(s!==""&&r.push(s.trim()),s="",a=!1):s+=f;return(i||s!=="")&&r.push(s.trim()),r}};return s1=t,t.default=t,s1}var a1,aw;function Eb(){if(aw)return a1;aw=1;let t=vo(),e=rL();class n extends t{get selectors(){return e.comma(this.selector)}set selectors(r){let s=this.selector?this.selector.match(/,\s*/):null,a=s?s[0]:","+this.raw("between","beforeOpen");this.selector=r.join(a)}constructor(r){super(r),this.type="rule",this.nodes||(this.nodes=[])}}return a1=n,n.default=n,t.registerRule(n),a1}var o1,ow;function Q$(){if(ow)return o1;ow=1;let t=vb(),e=b0(),n=E0(),i=T0(),r=iL(),s=rd(),a=Eb();function o(l,u){if(Array.isArray(l))return l.map(p=>o(p));let{inputs:d,...f}=l;if(d){u=[];for(let p of d){let m={...p,__proto__:i.prototype};m.map&&(m.map={...m.map,__proto__:r.prototype}),u.push(m)}}if(f.nodes&&(f.nodes=l.nodes.map(p=>o(p,u))),f.source){let{inputId:p,...m}=f.source;f.source=m,p!=null&&(f.source.input=u[p])}if(f.type==="root")return new s(f);if(f.type==="decl")return new n(f);if(f.type==="rule")return new a(f);if(f.type==="comment")return new e(f);if(f.type==="atrule")return new t(f);throw new Error("Unknown node type: "+l.type)}return o1=o,o.default=o,o1}var u1,uw;function sL(){if(uw)return u1;uw=1;let{dirname:t,relative:e,resolve:n,sep:i}=ar,{SourceMapConsumer:r,SourceMapGenerator:s}=ar,{pathToFileURL:a}=ar,o=T0(),l=!!(r&&s),u=!!(t&&n&&e&&i);class d{constructor(p,m,y,b){this.stringify=p,this.mapOpts=y.map||{},this.root=m,this.opts=y,this.css=b,this.originalCSS=b,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let p;this.isInline()?p="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?p=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?p=this.mapOpts.annotation(this.opts.to,this.root):p=this.outputFile()+".map";let m=`
`;this.css.includes(`\r
`)&&(m=`\r
`),this.css+=m+"/*# sourceMappingURL="+p+" */"}applyPrevMaps(){for(let p of this.previous()){let m=this.toUrl(this.path(p.file)),y=p.root||t(p.file),b;this.mapOpts.sourcesContent===!1?(b=new r(p.text),b.sourcesContent&&(b.sourcesContent=null)):b=p.consumer(),this.map.applySourceMap(b,m,this.toUrl(this.path(y)))}}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let p;for(let m=this.root.nodes.length-1;m>=0;m--)p=this.root.nodes[m],p.type==="comment"&&p.text.startsWith("# sourceMappingURL=")&&this.root.removeChild(m)}else this.css&&(this.css=this.css.replace(/\n*\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),u&&l&&this.isMap())return this.generateMap();{let p="";return this.stringify(this.root,m=>{p+=m}),[p]}}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let p=this.previous()[0].consumer();p.file=this.outputFile(),this.map=s.fromSourceMap(p,{ignoreInvalidMapping:!0})}else this.map=new s({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new s({file:this.outputFile(),ignoreInvalidMapping:!0});let p=1,m=1,y="<no source>",b={generated:{column:0,line:0},original:{column:0,line:0},source:""},E,T;this.stringify(this.root,(x,S,w)=>{if(this.css+=x,S&&w!=="end"&&(b.generated.line=p,b.generated.column=m-1,S.source&&S.source.start?(b.source=this.sourcePath(S),b.original.line=S.source.start.line,b.original.column=S.source.start.column-1,this.map.addMapping(b)):(b.source=y,b.original.line=1,b.original.column=0,this.map.addMapping(b))),T=x.match(/\n/g),T?(p+=T.length,E=x.lastIndexOf(`
`),m=x.length-E):m+=x.length,S&&w!=="start"){let C=S.parent||{raws:{}};(!(S.type==="decl"||S.type==="atrule"&&!S.nodes)||S!==C.last||C.raws.semicolon)&&(S.source&&S.source.end?(b.source=this.sourcePath(S),b.original.line=S.source.end.line,b.original.column=S.source.end.column-1,b.generated.line=p,b.generated.column=m-2,this.map.addMapping(b)):(b.source=y,b.original.line=1,b.original.column=0,b.generated.line=p,b.generated.column=m-1,this.map.addMapping(b)))}})}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(p=>p.annotation):!0}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let p=this.mapOpts.annotation;return typeof p<"u"&&p!==!0?!1:this.previous().length?this.previous().some(m=>m.inline):!0}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(p=>p.withContent()):!0}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(p){if(this.mapOpts.absolute||p.charCodeAt(0)===60||/^\w+:\/\//.test(p))return p;let m=this.memoizedPaths.get(p);if(m)return m;let y=this.opts.to?t(this.opts.to):".";typeof this.mapOpts.annotation=="string"&&(y=t(n(y,this.mapOpts.annotation)));let b=e(y,p);return this.memoizedPaths.set(p,b),b}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(p=>{if(p.source&&p.source.input.map){let m=p.source.input.map;this.previousMaps.includes(m)||this.previousMaps.push(m)}});else{let p=new o(this.originalCSS,this.opts);p.map&&this.previousMaps.push(p.map)}return this.previousMaps}setSourcesContent(){let p={};if(this.root)this.root.walk(m=>{if(m.source){let y=m.source.input.from;if(y&&!p[y]){p[y]=!0;let b=this.usesFileUrls?this.toFileUrl(y):this.toUrl(this.path(y));this.map.setSourceContent(b,m.source.input.css)}}});else if(this.css){let m=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(m,this.css)}}sourcePath(p){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(p.source.input.from):this.toUrl(this.path(p.source.input.from))}toBase64(p){return Buffer?Buffer.from(p).toString("base64"):window.btoa(unescape(encodeURIComponent(p)))}toFileUrl(p){let m=this.memoizedFileURLs.get(p);if(m)return m;if(a){let y=a(p).toString();return this.memoizedFileURLs.set(p,y),y}else throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(p){let m=this.memoizedURLs.get(p);if(m)return m;i==="\\"&&(p=p.replace(/\\/g,"/"));let y=encodeURI(p).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(p,y),y}}return u1=d,u1}var l1,lw;function Z$(){if(lw)return l1;lw=1;const t=39,e=34,n=92,i=47,r=10,s=32,a=12,o=9,l=13,u=91,d=93,f=40,p=41,m=123,y=125,b=59,E=42,T=58,x=64,S=/[\t\n\f\r "#'()/;[\\\]{}]/g,w=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,C=/.[\r\n"'(/\\]/,I=/[\da-f]/i;return l1=function(N,G={}){let O=N.css.valueOf(),D=G.ignoreErrors,V,$,J,K,j,te,ne,oe,P,ie,le=O.length,q=0,ye=[],Pe=[];function we(){return q}function Me(fe){throw N.error("Unclosed "+fe,q)}function Fe(){return Pe.length===0&&q>=le}function $e(fe){if(Pe.length)return Pe.pop();if(q>=le)return;let Ie=fe?fe.ignoreUnclosed:!1;switch(V=O.charCodeAt(q),V){case r:case s:case o:case l:case a:{K=q;do K+=1,V=O.charCodeAt(K);while(V===s||V===r||V===o||V===l||V===a);te=["space",O.slice(q,K)],q=K-1;break}case u:case d:case m:case y:case T:case b:case p:{let Le=String.fromCharCode(V);te=[Le,Le,q];break}case f:{if(ie=ye.length?ye.pop()[1]:"",P=O.charCodeAt(q+1),ie==="url"&&P!==t&&P!==e&&P!==s&&P!==r&&P!==o&&P!==a&&P!==l){K=q;do{if(ne=!1,K=O.indexOf(")",K+1),K===-1)if(D||Ie){K=q;break}else Me("bracket");for(oe=K;O.charCodeAt(oe-1)===n;)oe-=1,ne=!ne}while(ne);te=["brackets",O.slice(q,K+1),q,K],q=K}else K=O.indexOf(")",q+1),$=O.slice(q,K+1),K===-1||C.test($)?te=["(","(",q]:(te=["brackets",$,q,K],q=K);break}case t:case e:{j=V===t?"'":'"',K=q;do{if(ne=!1,K=O.indexOf(j,K+1),K===-1)if(D||Ie){K=q+1;break}else Me("string");for(oe=K;O.charCodeAt(oe-1)===n;)oe-=1,ne=!ne}while(ne);te=["string",O.slice(q,K+1),q,K],q=K;break}case x:{S.lastIndex=q+1,S.test(O),S.lastIndex===0?K=O.length-1:K=S.lastIndex-2,te=["at-word",O.slice(q,K+1),q,K],q=K;break}case n:{for(K=q,J=!0;O.charCodeAt(K+1)===n;)K+=1,J=!J;if(V=O.charCodeAt(K+1),J&&V!==i&&V!==s&&V!==r&&V!==o&&V!==l&&V!==a&&(K+=1,I.test(O.charAt(K)))){for(;I.test(O.charAt(K+1));)K+=1;O.charCodeAt(K+1)===s&&(K+=1)}te=["word",O.slice(q,K+1),q,K],q=K;break}default:{V===i&&O.charCodeAt(q+1)===E?(K=O.indexOf("*/",q+2)+1,K===0&&(D||Ie?K=O.length:Me("comment")),te=["comment",O.slice(q,K+1),q,K],q=K):(w.lastIndex=q+1,w.test(O),w.lastIndex===0?K=O.length-1:K=w.lastIndex-2,te=["word",O.slice(q,K+1),q,K],ye.push(te),q=K);break}}return q++,te}function Ye(fe){Pe.push(fe)}return{back:Ye,endOfFile:Fe,nextToken:$e,position:we}},l1}var c1,cw;function J$(){if(cw)return c1;cw=1;let t=vb(),e=b0(),n=E0(),i=rd(),r=Eb(),s=Z$();const a={empty:!0,space:!0};function o(u){for(let d=u.length-1;d>=0;d--){let f=u[d],p=f[3]||f[2];if(p)return p}}class l{constructor(d){this.input=d,this.root=new i,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:d,start:{column:1,line:1,offset:0}}}atrule(d){let f=new t;f.name=d[1].slice(1),f.name===""&&this.unnamedAtrule(f,d),this.init(f,d[2]);let p,m,y,b=!1,E=!1,T=[],x=[];for(;!this.tokenizer.endOfFile();){if(d=this.tokenizer.nextToken(),p=d[0],p==="("||p==="["?x.push(p==="("?")":"]"):p==="{"&&x.length>0?x.push("}"):p===x[x.length-1]&&x.pop(),x.length===0)if(p===";"){f.source.end=this.getPosition(d[2]),f.source.end.offset++,this.semicolon=!0;break}else if(p==="{"){E=!0;break}else if(p==="}"){if(T.length>0){for(y=T.length-1,m=T[y];m&&m[0]==="space";)m=T[--y];m&&(f.source.end=this.getPosition(m[3]||m[2]),f.source.end.offset++)}this.end(d);break}else T.push(d);else T.push(d);if(this.tokenizer.endOfFile()){b=!0;break}}f.raws.between=this.spacesAndCommentsFromEnd(T),T.length?(f.raws.afterName=this.spacesAndCommentsFromStart(T),this.raw(f,"params",T),b&&(d=T[T.length-1],f.source.end=this.getPosition(d[3]||d[2]),f.source.end.offset++,this.spaces=f.raws.between,f.raws.between="")):(f.raws.afterName="",f.params=""),E&&(f.nodes=[],this.current=f)}checkMissedSemicolon(d){let f=this.colon(d);if(f===!1)return;let p=0,m;for(let y=f-1;y>=0&&(m=d[y],!(m[0]!=="space"&&(p+=1,p===2)));y--);throw this.input.error("Missed semicolon",m[0]==="word"?m[3]+1:m[2])}colon(d){let f=0,p,m,y;for(let[b,E]of d.entries()){if(m=E,y=m[0],y==="("&&(f+=1),y===")"&&(f-=1),f===0&&y===":")if(!p)this.doubleColon(m);else{if(p[0]==="word"&&p[1]==="progid")continue;return b}p=m}return!1}comment(d){let f=new e;this.init(f,d[2]),f.source.end=this.getPosition(d[3]||d[2]),f.source.end.offset++;let p=d[1].slice(2,-2);if(/^\s*$/.test(p))f.text="",f.raws.left=p,f.raws.right="";else{let m=p.match(/^(\s*)([^]*\S)(\s*)$/);f.text=m[2],f.raws.left=m[1],f.raws.right=m[3]}}createTokenizer(){this.tokenizer=s(this.input)}decl(d,f){let p=new n;this.init(p,d[0][2]);let m=d[d.length-1];for(m[0]===";"&&(this.semicolon=!0,d.pop()),p.source.end=this.getPosition(m[3]||m[2]||o(d)),p.source.end.offset++;d[0][0]!=="word";)d.length===1&&this.unknownWord(d),p.raws.before+=d.shift()[1];for(p.source.start=this.getPosition(d[0][2]),p.prop="";d.length;){let x=d[0][0];if(x===":"||x==="space"||x==="comment")break;p.prop+=d.shift()[1]}p.raws.between="";let y;for(;d.length;)if(y=d.shift(),y[0]===":"){p.raws.between+=y[1];break}else y[0]==="word"&&/\w/.test(y[1])&&this.unknownWord([y]),p.raws.between+=y[1];(p.prop[0]==="_"||p.prop[0]==="*")&&(p.raws.before+=p.prop[0],p.prop=p.prop.slice(1));let b=[],E;for(;d.length&&(E=d[0][0],!(E!=="space"&&E!=="comment"));)b.push(d.shift());this.precheckMissedSemicolon(d);for(let x=d.length-1;x>=0;x--){if(y=d[x],y[1].toLowerCase()==="!important"){p.important=!0;let S=this.stringFrom(d,x);S=this.spacesFromEnd(d)+S,S!==" !important"&&(p.raws.important=S);break}else if(y[1].toLowerCase()==="important"){let S=d.slice(0),w="";for(let C=x;C>0;C--){let I=S[C][0];if(w.trim().startsWith("!")&&I!=="space")break;w=S.pop()[1]+w}w.trim().startsWith("!")&&(p.important=!0,p.raws.important=w,d=S)}if(y[0]!=="space"&&y[0]!=="comment")break}d.some(x=>x[0]!=="space"&&x[0]!=="comment")&&(p.raws.between+=b.map(x=>x[1]).join(""),b=[]),this.raw(p,"value",b.concat(d),f),p.value.includes(":")&&!f&&this.checkMissedSemicolon(d)}doubleColon(d){throw this.input.error("Double colon",{offset:d[2]},{offset:d[2]+d[1].length})}emptyRule(d){let f=new r;this.init(f,d[2]),f.selector="",f.raws.between="",this.current=f}end(d){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(d[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(d)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(d){if(this.spaces+=d[1],this.current.nodes){let f=this.current.nodes[this.current.nodes.length-1];f&&f.type==="rule"&&!f.raws.ownSemicolon&&(f.raws.ownSemicolon=this.spaces,this.spaces="",f.source.end=this.getPosition(d[2]),f.source.end.offset+=f.raws.ownSemicolon.length)}}getPosition(d){let f=this.input.fromOffset(d);return{column:f.col,line:f.line,offset:d}}init(d,f){this.current.push(d),d.source={input:this.input,start:this.getPosition(f)},d.raws.before=this.spaces,this.spaces="",d.type!=="comment"&&(this.semicolon=!1)}other(d){let f=!1,p=null,m=!1,y=null,b=[],E=d[1].startsWith("--"),T=[],x=d;for(;x;){if(p=x[0],T.push(x),p==="("||p==="[")y||(y=x),b.push(p==="("?")":"]");else if(E&&m&&p==="{")y||(y=x),b.push("}");else if(b.length===0)if(p===";")if(m){this.decl(T,E);return}else break;else if(p==="{"){this.rule(T);return}else if(p==="}"){this.tokenizer.back(T.pop()),f=!0;break}else p===":"&&(m=!0);else p===b[b.length-1]&&(b.pop(),b.length===0&&(y=null));x=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(f=!0),b.length>0&&this.unclosedBracket(y),f&&m){if(!E)for(;T.length&&(x=T[T.length-1][0],!(x!=="space"&&x!=="comment"));)this.tokenizer.back(T.pop());this.decl(T,E)}else this.unknownWord(T)}parse(){let d;for(;!this.tokenizer.endOfFile();)switch(d=this.tokenizer.nextToken(),d[0]){case"space":this.spaces+=d[1];break;case";":this.freeSemicolon(d);break;case"}":this.end(d);break;case"comment":this.comment(d);break;case"at-word":this.atrule(d);break;case"{":this.emptyRule(d);break;default:this.other(d);break}this.endFile()}precheckMissedSemicolon(){}raw(d,f,p,m){let y,b,E=p.length,T="",x=!0,S,w;for(let C=0;C<E;C+=1)y=p[C],b=y[0],b==="space"&&C===E-1&&!m?x=!1:b==="comment"?(w=p[C-1]?p[C-1][0]:"empty",S=p[C+1]?p[C+1][0]:"empty",!a[w]&&!a[S]?T.slice(-1)===","?x=!1:T+=y[1]:x=!1):T+=y[1];if(!x){let C=p.reduce((I,L)=>I+L[1],"");d.raws[f]={raw:C,value:T}}d[f]=T}rule(d){d.pop();let f=new r;this.init(f,d[0][2]),f.raws.between=this.spacesAndCommentsFromEnd(d),this.raw(f,"selector",d),this.current=f}spacesAndCommentsFromEnd(d){let f,p="";for(;d.length&&(f=d[d.length-1][0],!(f!=="space"&&f!=="comment"));)p=d.pop()[1]+p;return p}spacesAndCommentsFromStart(d){let f,p="";for(;d.length&&(f=d[0][0],!(f!=="space"&&f!=="comment"));)p+=d.shift()[1];return p}spacesFromEnd(d){let f,p="";for(;d.length&&(f=d[d.length-1][0],f==="space");)p=d.pop()[1]+p;return p}stringFrom(d,f){let p="";for(let m=f;m<d.length;m++)p+=d[m][1];return d.splice(f,d.length-f),p}unclosedBlock(){let d=this.current.source.start;throw this.input.error("Unclosed block",d.line,d.column)}unclosedBracket(d){throw this.input.error("Unclosed bracket",{offset:d[2]},{offset:d[2]+1})}unexpectedClose(d){throw this.input.error("Unexpected }",{offset:d[2]},{offset:d[2]+1})}unknownWord(d){throw this.input.error("Unknown word "+d[0][1],{offset:d[0][2]},{offset:d[0][2]+d[0][1].length})}unnamedAtrule(d,f){throw this.input.error("At-rule without name",{offset:f[2]},{offset:f[2]+f[1].length})}}return c1=l,c1}var d1,dw;function Tb(){if(dw)return d1;dw=1;let t=vo(),e=T0(),n=J$();function i(r,s){let a=new e(r,s),o=new n(a);try{o.parse()}catch(l){throw l}return o.root}return d1=i,i.default=i,t.registerParse(i),d1}var f1,fw;function aL(){if(fw)return f1;fw=1;class t{constructor(n,i={}){if(this.type="warning",this.text=n,i.node&&i.node.source){let r=i.node.rangeBy(i);this.line=r.start.line,this.column=r.start.column,this.endLine=r.end.line,this.endColumn=r.end.column}for(let r in i)this[r]=i[r]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}}return f1=t,t.default=t,f1}var h1,hw;function xb(){if(hw)return h1;hw=1;let t=aL();class e{get content(){return this.css}constructor(i,r,s){this.processor=i,this.messages=[],this.root=r,this.opts=s,this.css="",this.map=void 0}toString(){return this.css}warn(i,r={}){r.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(r.plugin=this.lastPlugin.postcssPlugin);let s=new t(i,r);return this.messages.push(s),s}warnings(){return this.messages.filter(i=>i.type==="warning")}}return h1=e,e.default=e,h1}var p1,pw;function oL(){if(pw)return p1;pw=1;let t=vo(),e=bb(),n=sL(),i=Tb(),r=xb(),s=rd(),a=y0(),{isClean:o,my:l}=yb();const u={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},d={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},f={Once:!0,postcssPlugin:!0,prepare:!0},p=0;function m(S){return typeof S=="object"&&typeof S.then=="function"}function y(S){let w=!1,C=u[S.type];return S.type==="decl"?w=S.prop.toLowerCase():S.type==="atrule"&&(w=S.name.toLowerCase()),w&&S.append?[C,C+"-"+w,p,C+"Exit",C+"Exit-"+w]:w?[C,C+"-"+w,C+"Exit",C+"Exit-"+w]:S.append?[C,p,C+"Exit"]:[C,C+"Exit"]}function b(S){let w;return S.type==="document"?w=["Document",p,"DocumentExit"]:S.type==="root"?w=["Root",p,"RootExit"]:w=y(S),{eventIndex:0,events:w,iterator:0,node:S,visitorIndex:0,visitors:[]}}function E(S){return S[o]=!1,S.nodes&&S.nodes.forEach(w=>E(w)),S}let T={};class x{get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}constructor(w,C,I){this.stringified=!1,this.processed=!1;let L;if(typeof C=="object"&&C!==null&&(C.type==="root"||C.type==="document"))L=E(C);else if(C instanceof x||C instanceof r)L=E(C.root),C.map&&(typeof I.map>"u"&&(I.map={}),I.map.inline||(I.map.inline=!1),I.map.prev=C.map);else{let N=i;I.syntax&&(N=I.syntax.parse),I.parser&&(N=I.parser),N.parse&&(N=N.parse);try{L=N(C,I)}catch(G){this.processed=!0,this.error=G}L&&!L[l]&&t.rebuild(L)}this.result=new r(w,L,I),this.helpers={...T,postcss:T,result:this.result},this.plugins=this.processor.plugins.map(N=>typeof N=="object"&&N.prepare?{...N,...N.prepare(this.result)}:N)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(w){return this.async().catch(w)}finally(w){return this.async().then(w,w)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(w,C){let I=this.result.lastPlugin;try{C&&C.addToError(w),this.error=w,w.name==="CssSyntaxError"&&!w.plugin?(w.plugin=I.postcssPlugin,w.setMessage()):I.postcssVersion}catch(L){console&&console.error&&console.error(L)}return w}prepareVisitors(){this.listeners={};let w=(C,I,L)=>{this.listeners[I]||(this.listeners[I]=[]),this.listeners[I].push([C,L])};for(let C of this.plugins)if(typeof C=="object")for(let I in C){if(!d[I]&&/^[A-Z]/.test(I))throw new Error(`Unknown event ${I} in ${C.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!f[I])if(typeof C[I]=="object")for(let L in C[I])L==="*"?w(C,I,C[I][L]):w(C,I+"-"+L.toLowerCase(),C[I][L]);else typeof C[I]=="function"&&w(C,I,C[I])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let w=0;w<this.plugins.length;w++){let C=this.plugins[w],I=this.runOnRoot(C);if(m(I))try{await I}catch(L){throw this.handleError(L)}}if(this.prepareVisitors(),this.hasListener){let w=this.result.root;for(;!w[o];){w[o]=!0;let C=[b(w)];for(;C.length>0;){let I=this.visitTick(C);if(m(I))try{await I}catch(L){let N=C[C.length-1].node;throw this.handleError(L,N)}}}if(this.listeners.OnceExit)for(let[C,I]of this.listeners.OnceExit){this.result.lastPlugin=C;try{if(w.type==="document"){let L=w.nodes.map(N=>I(N,this.helpers));await Promise.all(L)}else await I(w,this.helpers)}catch(L){throw this.handleError(L)}}}return this.processed=!0,this.stringify()}runOnRoot(w){this.result.lastPlugin=w;try{if(typeof w=="object"&&w.Once){if(this.result.root.type==="document"){let C=this.result.root.nodes.map(I=>w.Once(I,this.helpers));return m(C[0])?Promise.all(C):C}return w.Once(this.result.root,this.helpers)}else if(typeof w=="function")return w(this.result.root,this.result)}catch(C){throw this.handleError(C)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let w=this.result.opts,C=a;w.syntax&&(C=w.syntax.stringify),w.stringifier&&(C=w.stringifier),C.stringify&&(C=C.stringify);let L=new n(C,this.result.root,this.result.opts).generate();return this.result.css=L[0],this.result.map=L[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let w of this.plugins){let C=this.runOnRoot(w);if(m(C))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let w=this.result.root;for(;!w[o];)w[o]=!0,this.walkSync(w);if(this.listeners.OnceExit)if(w.type==="document")for(let C of w.nodes)this.visitSync(this.listeners.OnceExit,C);else this.visitSync(this.listeners.OnceExit,w)}return this.result}then(w,C){return this.async().then(w,C)}toString(){return this.css}visitSync(w,C){for(let[I,L]of w){this.result.lastPlugin=I;let N;try{N=L(C,this.helpers)}catch(G){throw this.handleError(G,C.proxyOf)}if(C.type!=="root"&&C.type!=="document"&&!C.parent)return!0;if(m(N))throw this.getAsyncError()}}visitTick(w){let C=w[w.length-1],{node:I,visitors:L}=C;if(I.type!=="root"&&I.type!=="document"&&!I.parent){w.pop();return}if(L.length>0&&C.visitorIndex<L.length){let[G,O]=L[C.visitorIndex];C.visitorIndex+=1,C.visitorIndex===L.length&&(C.visitors=[],C.visitorIndex=0),this.result.lastPlugin=G;try{return O(I.toProxy(),this.helpers)}catch(D){throw this.handleError(D,I)}}if(C.iterator!==0){let G=C.iterator,O;for(;O=I.nodes[I.indexes[G]];)if(I.indexes[G]+=1,!O[o]){O[o]=!0,w.push(b(O));return}C.iterator=0,delete I.indexes[G]}let N=C.events;for(;C.eventIndex<N.length;){let G=N[C.eventIndex];if(C.eventIndex+=1,G===p){I.nodes&&I.nodes.length&&(I[o]=!0,C.iterator=I.getIterator());return}else if(this.listeners[G]){C.visitors=this.listeners[G];return}}w.pop()}walkSync(w){w[o]=!0;let C=y(w);for(let I of C)if(I===p)w.nodes&&w.each(L=>{L[o]||this.walkSync(L)});else{let L=this.listeners[I];if(L&&this.visitSync(L,w.toProxy()))return}}warnings(){return this.sync().warnings()}}return x.registerPostcss=S=>{T=S},p1=x,x.default=x,s.registerLazyResult(x),e.registerLazyResult(x),p1}var m1,mw;function eY(){if(mw)return m1;mw=1;let t=sL(),e=Tb();const n=xb();let i=y0();class r{get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let a,o=e;try{a=o(this._css,this._opts)}catch(l){this.error=l}if(this.error)throw this.error;return this._root=a,a}get[Symbol.toStringTag](){return"NoWorkResult"}constructor(a,o,l){o=o.toString(),this.stringified=!1,this._processor=a,this._css=o,this._opts=l,this._map=void 0;let u,d=i;this.result=new n(this._processor,u,this._opts),this.result.css=o;let f=this;Object.defineProperty(this.result,"root",{get(){return f.root}});let p=new t(d,u,this._opts,o);if(p.isMap()){let[m,y]=p.generate();m&&(this.result.css=m),y&&(this.result.map=y)}else p.clearAnnotation(),this.result.css=p.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(a){return this.async().catch(a)}finally(a){return this.async().then(a,a)}sync(){if(this.error)throw this.error;return this.result}then(a,o){return this.async().then(a,o)}toString(){return this._css}warnings(){return[]}}return m1=r,r.default=r,m1}var g1,gw;function tY(){if(gw)return g1;gw=1;let t=bb(),e=oL(),n=eY(),i=rd();class r{constructor(a=[]){this.version="8.5.6",this.plugins=this.normalize(a)}normalize(a){let o=[];for(let l of a)if(l.postcss===!0?l=l():l.postcss&&(l=l.postcss),typeof l=="object"&&Array.isArray(l.plugins))o=o.concat(l.plugins);else if(typeof l=="object"&&l.postcssPlugin)o.push(l);else if(typeof l=="function")o.push(l);else if(!(typeof l=="object"&&(l.parse||l.stringify)))throw new Error(l+" is not a PostCSS plugin");return o}process(a,o={}){return!this.plugins.length&&!o.parser&&!o.stringifier&&!o.syntax?new n(this,a,o):new e(this,a,o)}use(a){return this.plugins=this.plugins.concat(this.normalize([a])),this}}return g1=r,r.default=r,i.registerProcessor(r),t.registerProcessor(r),g1}var y1,yw;function nY(){if(yw)return y1;yw=1;var t={};let e=vb(),n=b0(),i=vo(),r=gb(),s=E0(),a=bb(),o=Q$(),l=T0(),u=oL(),d=rL(),f=v0(),p=Tb(),m=tY(),y=xb(),b=rd(),E=Eb(),T=y0(),x=aL();function S(...w){return w.length===1&&Array.isArray(w[0])&&(w=w[0]),new m(w)}return S.plugin=function(C,I){let L=!1;function N(...O){console&&console.warn&&!L&&(L=!0,console.warn(C+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),t.LANG&&t.LANG.startsWith("cn")&&console.warn(C+`:  postcss.plugin . :
https://www.w3ctech.com/topic/2226`));let D=I(...O);return D.postcssPlugin=C,D.postcssVersion=new m().version,D}let G;return Object.defineProperty(N,"postcss",{get(){return G||(G=N()),G}}),N.process=function(O,D,V){return S([N(V)]).process(O,D)},N},S.stringify=T,S.parse=p,S.fromJSON=o,S.list=d,S.comment=w=>new n(w),S.atRule=w=>new e(w),S.decl=w=>new s(w),S.rule=w=>new E(w),S.root=w=>new b(w),S.document=w=>new a(w),S.CssSyntaxError=r,S.Declaration=s,S.Container=i,S.Processor=m,S.Document=a,S.Comment=n,S.Warning=x,S.AtRule=e,S.Result=y,S.Input=l,S.Rule=E,S.Root=b,S.Node=f,u.registerPostcss(S),y1=S,S.default=S,y1}var v1,vw;function iY(){if(vw)return v1;vw=1;const t=z$(),e=q$(),{isPlainObject:n}=V$(),i=G$(),r=W$(),{parse:s}=nY(),a=["img","audio","video","picture","svg","object","map","iframe","embed"],o=["script","style"];function l(E,T){E&&Object.keys(E).forEach(function(x){T(E[x],x)})}function u(E,T){return{}.hasOwnProperty.call(E,T)}function d(E,T){const x=[];return l(E,function(S){T(S)&&x.push(S)}),x}function f(E){for(const T in E)if(u(E,T))return!1;return!0}function p(E){return E.map(function(T){if(!T.url)throw new Error("URL missing");return T.url+(T.w?` ${T.w}w`:"")+(T.h?` ${T.h}h`:"")+(T.d?` ${T.d}x`:"")}).join(", ")}v1=y;const m=/^[^\0\t\n\f\r /<=>]+$/;function y(E,T,x){if(E==null)return"";typeof E=="number"&&(E=E.toString());let S="",w="";function C(fe,Ie){const Le=this;this.tag=fe,this.attribs=Ie||{},this.tagPosition=S.length,this.text="",this.openingTagLength=0,this.mediaChildren=[],this.updateParentNodeText=function(){if(j.length){const Ke=j[j.length-1];Ke.text+=Le.text}},this.updateParentNodeMediaChildren=function(){j.length&&a.includes(this.tag)&&j[j.length-1].mediaChildren.push(this.tag)}}T=Object.assign({},y.defaults,T),T.parser=Object.assign({},b,T.parser);const I=function(fe){return T.allowedTags===!1||(T.allowedTags||[]).indexOf(fe)>-1};o.forEach(function(fe){I(fe)&&!T.allowVulnerableTags&&console.warn(`

 Your \`allowedTags\` option includes, \`${fe}\`, which is inherently
vulnerable to XSS attacks. Please remove it from \`allowedTags\`.
Or, to disable this warning, add the \`allowVulnerableTags\` option
and ensure you are accounting for this risk.

`)});const L=T.nonTextTags||["script","style","textarea","option"];let N,G;T.allowedAttributes&&(N={},G={},l(T.allowedAttributes,function(fe,Ie){N[Ie]=[];const Le=[];fe.forEach(function(Ke){typeof Ke=="string"&&Ke.indexOf("*")>=0?Le.push(e(Ke).replace(/\\\*/g,".*")):N[Ie].push(Ke)}),Le.length&&(G[Ie]=new RegExp("^("+Le.join("|")+")$"))}));const O={},D={},V={};l(T.allowedClasses,function(fe,Ie){if(N&&(u(N,Ie)||(N[Ie]=[]),N[Ie].push("class")),O[Ie]=fe,Array.isArray(fe)){const Le=[];O[Ie]=[],V[Ie]=[],fe.forEach(function(Ke){typeof Ke=="string"&&Ke.indexOf("*")>=0?Le.push(e(Ke).replace(/\\\*/g,".*")):Ke instanceof RegExp?V[Ie].push(Ke):O[Ie].push(Ke)}),Le.length&&(D[Ie]=new RegExp("^("+Le.join("|")+")$"))}});const $={};let J;l(T.transformTags,function(fe,Ie){let Le;typeof fe=="function"?Le=fe:typeof fe=="string"&&(Le=y.simpleTransform(fe)),Ie==="*"?J=Le:$[Ie]=Le});let K,j,te,ne,oe,P,ie=!1;q();const le=new t.Parser({onopentag:function(fe,Ie){if(T.onOpenTag&&T.onOpenTag(fe,Ie),T.enforceHtmlBoundary&&fe==="html"&&q(),oe){P++;return}const Le=new C(fe,Ie);j.push(Le);let Ke=!1;const Lt=!!Le.text;let Qe;if(u($,fe)&&(Qe=$[fe](fe,Ie),Le.attribs=Ie=Qe.attribs,Qe.text!==void 0&&(Le.innerText=Qe.text),fe!==Qe.tagName&&(Le.name=fe=Qe.tagName,ne[K]=Qe.tagName)),J&&(Qe=J(fe,Ie),Le.attribs=Ie=Qe.attribs,fe!==Qe.tagName&&(Le.name=fe=Qe.tagName,ne[K]=Qe.tagName)),(!I(fe)||T.disallowedTagsMode==="recursiveEscape"&&!f(te)||T.nestingLimit!=null&&K>=T.nestingLimit)&&(Ke=!0,te[K]=!0,(T.disallowedTagsMode==="discard"||T.disallowedTagsMode==="completelyDiscard")&&L.indexOf(fe)!==-1&&(oe=!0,P=1)),K++,Ke){if(T.disallowedTagsMode==="discard"||T.disallowedTagsMode==="completelyDiscard"){if(Le.innerText&&!Lt){const ue=ye(Le.innerText);T.textFilter?S+=T.textFilter(ue,fe):S+=ue,ie=!0}return}w=S,S=""}S+="<"+fe,fe==="script"&&(T.allowedScriptHostnames||T.allowedScriptDomains)&&(Le.innerText=""),Ke&&(T.disallowedTagsMode==="escape"||T.disallowedTagsMode==="recursiveEscape")&&T.preserveEscapedAttributes?l(Ie,function(ue,Se){S+=" "+Se+'="'+ye(ue||"",!0)+'"'}):(!N||u(N,fe)||N["*"])&&l(Ie,function(ue,Se){if(!m.test(Se)){delete Le.attribs[Se];return}if(ue===""&&!T.allowedEmptyAttributes.includes(Se)&&(T.nonBooleanAttributes.includes(Se)||T.nonBooleanAttributes.includes("*"))){delete Le.attribs[Se];return}let Oe=!1;if(!N||u(N,fe)&&N[fe].indexOf(Se)!==-1||N["*"]&&N["*"].indexOf(Se)!==-1||u(G,fe)&&G[fe].test(Se)||G["*"]&&G["*"].test(Se))Oe=!0;else if(N&&N[fe]){for(const ze of N[fe])if(n(ze)&&ze.name&&ze.name===Se){Oe=!0;let Ne="";if(ze.multiple===!0){const dt=ue.split(" ");for(const mt of dt)ze.values.indexOf(mt)!==-1&&(Ne===""?Ne=mt:Ne+=" "+mt)}else ze.values.indexOf(ue)>=0&&(Ne=ue);ue=Ne}}if(Oe){if(T.allowedSchemesAppliedToAttributes.indexOf(Se)!==-1&&Pe(fe,ue)){delete Le.attribs[Se];return}if(fe==="script"&&Se==="src"){let ze=!0;try{const Ne=we(ue);if(T.allowedScriptHostnames||T.allowedScriptDomains){const dt=(T.allowedScriptHostnames||[]).find(function(he){return he===Ne.url.hostname}),mt=(T.allowedScriptDomains||[]).find(function(he){return Ne.url.hostname===he||Ne.url.hostname.endsWith(`.${he}`)});ze=dt||mt}}catch{ze=!1}if(!ze){delete Le.attribs[Se];return}}if(fe==="iframe"&&Se==="src"){let ze=!0;try{const Ne=we(ue);if(Ne.isRelativeUrl)ze=u(T,"allowIframeRelativeUrls")?T.allowIframeRelativeUrls:!T.allowedIframeHostnames&&!T.allowedIframeDomains;else if(T.allowedIframeHostnames||T.allowedIframeDomains){const dt=(T.allowedIframeHostnames||[]).find(function(he){return he===Ne.url.hostname}),mt=(T.allowedIframeDomains||[]).find(function(he){return Ne.url.hostname===he||Ne.url.hostname.endsWith(`.${he}`)});ze=dt||mt}}catch{ze=!1}if(!ze){delete Le.attribs[Se];return}}if(Se==="srcset")try{let ze=r(ue);if(ze.forEach(function(Ne){Pe("srcset",Ne.url)&&(Ne.evil=!0)}),ze=d(ze,function(Ne){return!Ne.evil}),ze.length)ue=p(d(ze,function(Ne){return!Ne.evil})),Le.attribs[Se]=ue;else{delete Le.attribs[Se];return}}catch{delete Le.attribs[Se];return}if(Se==="class"){const ze=O[fe],Ne=O["*"],dt=D[fe],mt=V[fe],he=V["*"],Te=D["*"],je=[dt,Te].concat(mt,he).filter(function(B){return B});if(ze&&Ne?ue=Ye(ue,i(ze,Ne),je):ue=Ye(ue,ze||Ne,je),!ue.length){delete Le.attribs[Se];return}}if(Se==="style"){if(T.parseStyleAttributes)try{const ze=s(fe+" {"+ue+"}",{map:!1}),Ne=Me(ze,T.allowedStyles);if(ue=Fe(Ne),ue.length===0){delete Le.attribs[Se];return}}catch{typeof window<"u"&&console.warn('Failed to parse "'+fe+" {"+ue+`}", If you're running this in a browser, we recommend to disable style parsing: options.parseStyleAttributes: false, since this only works in a node environment due to a postcss dependency, More info: https://github.com/apostrophecms/sanitize-html/issues/547`),delete Le.attribs[Se];return}else if(T.allowedStyles)throw new Error("allowedStyles option cannot be used together with parseStyleAttributes: false.")}S+=" "+Se,ue&&ue.length?S+='="'+ye(ue,!0)+'"':T.allowedEmptyAttributes.includes(Se)&&(S+='=""')}else delete Le.attribs[Se]}),T.selfClosing.indexOf(fe)!==-1?S+=" />":(S+=">",Le.innerText&&!Lt&&!T.textFilter&&(S+=ye(Le.innerText),ie=!0)),Ke&&(S=w+ye(S),w=""),Le.openingTagLength=S.length-Le.tagPosition},ontext:function(fe){if(oe)return;const Ie=j[j.length-1];let Le;if(Ie&&(Le=Ie.tag,fe=Ie.innerText!==void 0?Ie.innerText:fe),T.disallowedTagsMode==="completelyDiscard"&&!I(Le))fe="";else if((T.disallowedTagsMode==="discard"||T.disallowedTagsMode==="completelyDiscard")&&(Le==="script"||Le==="style"))S+=fe;else if(!ie){const Ke=ye(fe,!1);T.textFilter?S+=T.textFilter(Ke,Le):S+=Ke}if(j.length){const Ke=j[j.length-1];Ke.text+=fe}},onclosetag:function(fe,Ie){if(T.onCloseTag&&T.onCloseTag(fe,Ie),oe)if(P--,!P)oe=!1;else return;const Le=j.pop();if(!Le)return;if(Le.tag!==fe){j.push(Le);return}oe=T.enforceHtmlBoundary?fe==="html":!1,K--;const Ke=te[K];if(Ke){if(delete te[K],T.disallowedTagsMode==="discard"||T.disallowedTagsMode==="completelyDiscard"){Le.updateParentNodeText();return}w=S,S=""}if(ne[K]&&(fe=ne[K],delete ne[K]),T.exclusiveFilter){const Lt=T.exclusiveFilter(Le);if(Lt==="excludeTag"){Ke&&(S=w,w=""),S=S.substring(0,Le.tagPosition)+S.substring(Le.tagPosition+Le.openingTagLength);return}else if(Lt){S=S.substring(0,Le.tagPosition);return}}if(Le.updateParentNodeMediaChildren(),Le.updateParentNodeText(),T.selfClosing.indexOf(fe)!==-1||Ie&&!I(fe)&&["escape","recursiveEscape"].indexOf(T.disallowedTagsMode)>=0){Ke&&(S=w,w="");return}S+="</"+fe+">",Ke&&(S=w+ye(S),w=""),ie=!1}},T.parser);return le.write(E),le.end(),S;function q(){S="",K=0,j=[],te={},ne={},oe=!1,P=0}function ye(fe,Ie){return typeof fe!="string"&&(fe=fe+""),T.parser.decodeEntities&&(fe=fe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Ie&&(fe=fe.replace(/"/g,"&quot;"))),fe=fe.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Ie&&(fe=fe.replace(/"/g,"&quot;")),fe}function Pe(fe,Ie){for(Ie=Ie.replace(/[\x00-\x20]+/g,"");;){const Lt=Ie.indexOf("<!--");if(Lt===-1)break;const Qe=Ie.indexOf("-->",Lt+4);if(Qe===-1)break;Ie=Ie.substring(0,Lt)+Ie.substring(Qe+3)}const Le=Ie.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!Le)return Ie.match(/^[/\\]{2}/)?!T.allowProtocolRelative:!1;const Ke=Le[1].toLowerCase();return u(T.allowedSchemesByTag,fe)?T.allowedSchemesByTag[fe].indexOf(Ke)===-1:!T.allowedSchemes||T.allowedSchemes.indexOf(Ke)===-1}function we(fe){if(fe=fe.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//"),fe.startsWith("relative:"))throw new Error("relative: exploit attempt");let Ie="relative://relative-site";for(let Lt=0;Lt<100;Lt++)Ie+=`/${Lt}`;const Le=new URL(fe,Ie);return{isRelativeUrl:Le&&Le.hostname==="relative-site"&&Le.protocol==="relative:",url:Le}}function Me(fe,Ie){if(!Ie)return fe;const Le=fe.nodes[0];let Ke;return Ie[Le.selector]&&Ie["*"]?Ke=i(Ie[Le.selector],Ie["*"]):Ke=Ie[Le.selector]||Ie["*"],Ke&&(fe.nodes[0].nodes=Le.nodes.reduce($e(Ke),[])),fe}function Fe(fe){return fe.nodes[0].nodes.reduce(function(Ie,Le){return Ie.push(`${Le.prop}:${Le.value}${Le.important?" !important":""}`),Ie},[]).join(";")}function $e(fe){return function(Ie,Le){return u(fe,Le.prop)&&fe[Le.prop].some(function(Lt){return Lt.test(Le.value)})&&Ie.push(Le),Ie}}function Ye(fe,Ie,Le){return Ie?(fe=fe.split(/\s+/),fe.filter(function(Ke){return Ie.indexOf(Ke)!==-1||Le.some(function(Lt){return Lt.test(Ke)})}).join(" ")):fe}}const b={decodeEntities:!0};return y.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","menu","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],nonBooleanAttributes:["abbr","accept","accept-charset","accesskey","action","allow","alt","as","autocapitalize","autocomplete","blocking","charset","cite","class","color","cols","colspan","content","contenteditable","coords","crossorigin","data","datetime","decoding","dir","dirname","download","draggable","enctype","enterkeyhint","fetchpriority","for","form","formaction","formenctype","formmethod","formtarget","headers","height","hidden","high","href","hreflang","http-equiv","id","imagesizes","imagesrcset","inputmode","integrity","is","itemid","itemprop","itemref","itemtype","kind","label","lang","list","loading","low","max","maxlength","media","method","min","minlength","name","nonce","optimum","pattern","ping","placeholder","popover","popovertarget","popovertargetaction","poster","preload","referrerpolicy","rel","rows","rowspan","sandbox","scope","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","value","width","wrap","onauxclick","onafterprint","onbeforematch","onbeforeprint","onbeforeunload","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onformdata","onhashchange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onlanguagechange","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmessageerror","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onoffline","ononline","onpagehide","onpageshow","onpaste","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreset","onresize","onrejectionhandled","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onslotchange","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","ontoggle","onunhandledrejection","onunload","onvolumechange","onwaiting","onwheel"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},allowedEmptyAttributes:["alt"],selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1,parseStyleAttributes:!0,preserveEscapedAttributes:!1},y.simpleTransform=function(E,T,x){return x=x===void 0?!0:x,T=T||{},function(S,w){let C;if(x)for(C in T)w[C]=T[C];else w=T;return{tagName:E,attribs:w}}},v1}var rY=iY();const sY=Wc(rY),We=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)},aY=Number.isSafeInteger||function(t){return typeof t=="number"&&Math.abs(t)<=oY},oY=Number.MAX_SAFE_INTEGER||9007199254740991;let it=(function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t})({}),pe=(function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",t.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",t.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.ASSET_LIST_LOAD_ERROR="assetListLoadError",t.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",t.ASSET_LIST_PARSING_ERROR="assetListParsingError",t.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.ATTACH_MEDIA_ERROR="attachMediaError",t.UNKNOWN="unknown",t})({}),M=(function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.MEDIA_ENDED="hlsMediaEnded",t.STALL_RESOLVED="hlsStallResolved",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFERED_TO_END="hlsBufferedToEnd",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",t.ASSET_LIST_LOADING="hlsAssetListLoading",t.ASSET_LIST_LOADED="hlsAssetListLoaded",t.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",t.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",t.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",t.INTERSTITIAL_STARTED="hlsInterstitialStarted",t.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",t.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",t.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",t.INTERSTITIAL_ENDED="hlsInterstitialEnded",t.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",t.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",t.EVENT_CUE_ENTER="hlsEventCueEnter",t})({});var At={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Xe={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class pu{constructor(e,n=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=n,this.totalWeight_=i}sample(e,n){const i=Math.pow(this.alpha_,e);this.estimate_=n*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class uY{constructor(e,n,i,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new pu(e),this.fast_=new pu(n),this.defaultTTFB_=r,this.ttfb_=new pu(e)}update(e,n){const{slow_:i,fast_:r,ttfb_:s}=this;i.halfLife!==e&&(this.slow_=new pu(e,i.getEstimate(),i.getTotalWeight())),r.halfLife!==n&&(this.fast_=new pu(n,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new pu(e,s.getEstimate(),s.getTotalWeight()))}sample(e,n){e=Math.max(e,this.minDelayMs_);const i=8*n,r=e/1e3,s=i/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const n=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(n,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function lY(t,e,n){return(e=dY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vt(){return Vt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Vt.apply(null,arguments)}function bw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Bt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bw(Object(n),!0).forEach(function(i){lY(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bw(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function cY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dY(t){var e=cY(t,"string");return typeof e=="symbol"?e:e+""}class $i{constructor(e,n){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${e}]:`;this.trace=na,this.debug=n.debug.bind(null,i),this.log=n.log.bind(null,i),this.warn=n.warn.bind(null,i),this.info=n.info.bind(null,i),this.error=n.error.bind(null,i)}}const na=function(){},fY={trace:na,debug:na,log:na,warn:na,info:na,error:na};function qy(){return Vt({},fY)}function hY(t,e){const n=self.console[t];return n?n.bind(self.console,`${e?"["+e+"] ":""}[${t}] >`):na}function Ew(t,e,n){return e[t]?e[t].bind(e):hY(t,n)}const Vy=qy();function pY(t,e,n){const i=qy();if(typeof console=="object"&&t===!0||typeof t=="object"){const r=["debug","log","info","warn","error"];r.forEach(s=>{i[s]=Ew(s,t,n)});try{i.log(`Debug logs enabled for "${e}" in hls.js version 1.6.12`)}catch{return qy()}r.forEach(s=>{Vy[s]=Ew(s,t)})}else Vt(Vy,i);return i}const Ft=Vy;function ca(t=!0){return typeof self>"u"?void 0:(t||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function mY(t){return typeof self<"u"&&t===self.ManagedMediaSource}function uL(t,e){const n=Object.keys(t),i=Object.keys(e),r=n.length,s=i.length;return!r||!s||r===s&&!n.some(a=>i.indexOf(a)===-1)}function _i(t,e=!1){if(typeof TextDecoder<"u"){const u=new TextDecoder("utf-8").decode(t);if(e){const d=u.indexOf("\0");return d!==-1?u.substring(0,d):u}return u.replace(/\0/g,"")}const n=t.length;let i,r,s,a="",o=0;for(;o<n;){if(i=t[o++],i===0&&e)return a;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=t[o++],a+=String.fromCharCode((i&31)<<6|r&63);break;case 14:r=t[o++],s=t[o++],a+=String.fromCharCode((i&15)<<12|(r&63)<<6|(s&63)<<0);break}}return a}function li(t){let e="";for(let n=0;n<t.length;n++){let i=t[n].toString(16);i.length<2&&(i="0"+i),e+=i}return e}function lL(t){return Uint8Array.from(t.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function gY(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var b1={exports:{}},Tw;function yY(){return Tw||(Tw=1,(function(t,e){(function(n){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,u,d){if(d=d||{},l=l.trim(),u=u.trim(),!u){if(!d.alwaysNormalize)return l;var f=o.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");return f.path=o.normalizePath(f.path),o.buildURLFromParts(f)}var p=o.parseURL(u);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return d.alwaysNormalize?(p.path=o.normalizePath(p.path),o.buildURLFromParts(p)):u;var m=o.parseURL(l);if(!m)throw new Error("Error trying to parse base URL.");if(!m.netLoc&&m.path&&m.path[0]!=="/"){var y=r.exec(m.path);m.netLoc=y[1],m.path=y[2]}m.netLoc&&!m.path&&(m.path="/");var b={scheme:m.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(b.netLoc=m.netLoc,p.path[0]!=="/"))if(!p.path)b.path=m.path,p.params||(b.params=m.params,p.query||(b.query=m.query));else{var E=m.path,T=E.substring(0,E.lastIndexOf("/")+1)+p.path;b.path=o.normalizePath(T)}return b.path===null&&(b.path=d.alwaysNormalize?o.normalizePath(p.path):p.path),o.buildURLFromParts(b)},parseURL:function(l){var u=i.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};t.exports=o})()})(b1)),b1.exports}var Sb=yY();class Ab{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var jt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class cL{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,bY(this,"stats")}setByteRange(e,n){const i=e.split("@",2);let r;i.length===1?r=(n==null?void 0:n.byteRangeEndOffset)||0:r=parseInt(i[1]),this._byteRange=[r,parseInt(i[0])+r]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[jt.AUDIO]:null,[jt.VIDEO]:null,[jt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Ab),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Sb.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[jt.AUDIO]=null,e[jt.VIDEO]=null,e[jt.AUDIOVIDEO]=null}}function bn(t){return t.sn!=="initSegment"}class E1 extends cL{constructor(e,n){super(n),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],n=this.byteRange[1];if(We(e)&&We(n))return n-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const n=this.levelkeys.identity;if(n)this._decryptdata=n.getDecryptData(this.sn);else{const i=Object.keys(this.levelkeys);if(i.length===1){const r=this._decryptdata=this.levelkeys[i[0]]||null;if(r)return r.getDecryptData(this.sn)}}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=We(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var n;const i=Object.keys(this.levelkeys),r=i.length;if(r>1||r===1&&(n=this.levelkeys[i[0]])!=null&&n.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!We(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return bn(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const n=this.levelkeys[e];n&&!this._decryptdata&&(this._decryptdata=n.getDecryptData(this.sn))}}abortRequests(){var e,n;(e=this.loader)==null||e.abort(),(n=this.keyLoader)==null||n.abort()}setElementaryStreamInfo(e,n,i,r,s,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:n,endPTS:i,startDTS:r,endDTS:s,partial:a};return}l.startPTS=Math.min(l.startPTS,n),l.endPTS=Math.max(l.endPTS,i),l.startDTS=Math.min(l.startDTS,r),l.endDTS=Math.max(l.endDTS,s)}}class vY extends cL{constructor(e,n,i,r,s){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=n,this.index=r;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function dL(t,e){const n=Object.getPrototypeOf(t);if(n){const i=Object.getOwnPropertyDescriptor(n,e);return i||dL(n,e)}}function bY(t,e){const n=dL(t,e);n&&(n.enumerable=!0,Object.defineProperty(t,e,n))}const xw=Math.pow(2,32)-1,EY=[].push,fL={video:1,audio:2,id3:3,text:4};function Sn(t){return String.fromCharCode.apply(null,t)}function hL(t,e){const n=t[e]<<8|t[e+1];return n<0?65536+n:n}function ft(t,e){const n=pL(t,e);return n<0?4294967296+n:n}function Sw(t,e){let n=ft(t,e);return n*=Math.pow(2,32),n+=ft(t,e+4),n}function pL(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function TY(t){const e=t.byteLength;for(let n=0;n<e;){const i=ft(t,n);if(i>8&&t[n+4]===109&&t[n+5]===111&&t[n+6]===111&&t[n+7]===102)return!0;n=i>1?n+i:e}return!1}function Tt(t,e){const n=[];if(!e.length)return n;const i=t.byteLength;for(let r=0;r<i;){const s=ft(t,r),a=Sn(t.subarray(r+4,r+8)),o=s>1?r+s:i;if(a===e[0])if(e.length===1)n.push(t.subarray(r+8,o));else{const l=Tt(t.subarray(r+8,o),e.slice(1));l.length&&EY.apply(n,l)}r=o}return n}function xY(t){const e=[],n=t[0];let i=8;const r=ft(t,i);i+=4;let s=0,a=0;n===0?(s=ft(t,i),a=ft(t,i+4),i+=8):(s=Sw(t,i),a=Sw(t,i+8),i+=16),i+=2;let o=t.length+a;const l=hL(t,i);i+=2;for(let u=0;u<l;u++){let d=i;const f=ft(t,d);d+=4;const p=f&2147483647;if((f&2147483648)>>>31===1)return Ft.warn("SIDX has hierarchical references (not supported)"),null;const y=ft(t,d);d+=4,e.push({referenceSize:p,subsegmentDuration:y,info:{duration:y/r,start:o,end:o+p-1}}),o+=p,d+=4,i=d}return{earliestPresentationTime:s,timescale:r,version:n,referencesCount:l,references:e}}function mL(t){const e=[],n=Tt(t,["moov","trak"]);for(let r=0;r<n.length;r++){const s=n[r],a=Tt(s,["tkhd"])[0];if(a){let o=a[0];const l=ft(a,o===0?12:20),u=Tt(s,["mdia","mdhd"])[0];if(u){o=u[0];const d=ft(u,o===0?12:20),f=Tt(s,["mdia","hdlr"])[0];if(f){const p=Sn(f.subarray(8,12)),m={soun:jt.AUDIO,vide:jt.VIDEO}[p],y=Tt(s,["mdia","minf","stbl","stsd"])[0],b=SY(y);m?(e[l]={timescale:d,type:m,stsd:b},e[m]=Bt({timescale:d,id:l},b)):e[l]={timescale:d,type:p,stsd:b}}}}}return Tt(t,["moov","mvex","trex"]).forEach(r=>{const s=ft(r,4),a=e[s];a&&(a.default={duration:ft(r,12),flags:ft(r,20)})}),e}function SY(t){const e=t.subarray(8),n=e.subarray(86),i=Sn(e.subarray(4,8));let r=i,s;const a=i==="enca"||i==="encv";if(a){const u=Tt(e,[i])[0].subarray(i==="enca"?28:78);Tt(u,["sinf"]).forEach(f=>{const p=Tt(f,["schm"])[0];if(p){const m=Sn(p.subarray(4,8));if(m==="cbcs"||m==="cenc"){const y=Tt(f,["frma"])[0];y&&(r=Sn(y))}}})}const o=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const l=Tt(n,["avcC"])[0];l&&l.length>3&&(r+="."+zf(l[1])+zf(l[2])+zf(l[3]),s=Hf(o==="avc1"?"dva1":"dvav",n));break}case"mp4a":{const l=Tt(e,[i])[0],u=Tt(l.subarray(28),["esds"])[0];if(u&&u.length>7){let d=4;if(u[d++]!==3)break;d=T1(u,d),d+=2;const f=u[d++];if(f&128&&(d+=2),f&64&&(d+=u[d++]),u[d++]!==4)break;d=T1(u,d);const p=u[d++];if(p===64)r+="."+zf(p);else break;if(d+=12,u[d++]!==5)break;d=T1(u,d);const m=u[d++];let y=(m&248)>>3;y===31&&(y+=1+((m&7)<<3)+((u[d]&224)>>5)),r+="."+y}break}case"hvc1":case"hev1":{const l=Tt(n,["hvcC"])[0];if(l&&l.length>12){const u=l[1],d=["","A","B","C"][u>>6],f=u&31,p=ft(l,2),m=(u&32)>>5?"H":"L",y=l[12],b=l.subarray(6,12);r+="."+d+f,r+="."+AY(p).toString(16).toUpperCase(),r+="."+m+y;let E="";for(let T=b.length;T--;){const x=b[T];(x||E)&&(E="."+x.toString(16).toUpperCase()+E)}r+=E}s=Hf(o=="hev1"?"dvhe":"dvh1",n);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{r=Hf(r,n)||r;break}case"vp09":{const l=Tt(n,["vpcC"])[0];if(l&&l.length>6){const u=l[4],d=l[5],f=l[6]>>4&15;r+="."+Er(u)+"."+Er(d)+"."+Er(f)}break}case"av01":{const l=Tt(n,["av1C"])[0];if(l&&l.length>2){const u=l[1]>>>5,d=l[1]&31,f=l[2]>>>7?"H":"M",p=(l[2]&64)>>6,m=(l[2]&32)>>5,y=u===2&&p?m?12:10:p?10:8,b=(l[2]&16)>>4,E=(l[2]&8)>>3,T=(l[2]&4)>>2,x=l[2]&3;r+="."+u+"."+Er(d)+f+"."+Er(y)+"."+b+"."+E+T+x+"."+Er(1)+"."+Er(1)+"."+Er(1)+"."+0,s=Hf("dav1",n)}break}}return{codec:r,encrypted:a,supplemental:s}}function Hf(t,e){const n=Tt(e,["dvvC"]),i=n.length?n[0]:Tt(e,["dvcC"])[0];if(i){const r=i[2]>>1&127,s=i[2]<<5&32|i[3]>>3&31;return t+"."+Er(r)+"."+Er(s)}}function AY(t){let e=0;for(let n=0;n<32;n++)e|=(t>>n&1)<<31-n;return e>>>0}function T1(t,e){const n=e+5;for(;t[e++]&128&&e<n;);return e}function zf(t){return("0"+t.toString(16).toUpperCase()).slice(-2)}function Er(t){return(t<10?"0":"")+t}function wY(t,e){if(!t||!e)return;const n=e.keyId;n&&e.isCommonEncryption&&Tt(t,["moov","trak"]).forEach(r=>{const a=Tt(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=Tt(a,["enca"]);const l=o.length>0;l||(o=Tt(a,["encv"])),o.forEach(u=>{const d=l?u.subarray(28):u.subarray(78);Tt(d,["sinf"]).forEach(p=>{const m=gL(p);if(m){const y=m.subarray(8,24);y.some(b=>b!==0)||(Ft.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${li(y)} -> ${li(n)}`),m.set(n,8))}})})})}function gL(t){const e=Tt(t,["schm"])[0];if(e){const n=Sn(e.subarray(4,8));if(n==="cbcs"||n==="cenc")return Tt(t,["schi","tenc"])[0]}return null}function CY(t,e,n){const i={},r=Tt(t,["moof","traf"]);for(let s=0;s<r.length;s++){const a=r[s],o=Tt(a,["tfhd"])[0],l=ft(o,4),u=e[l];if(!u)continue;i[l]||(i[l]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type});const d=i[l],f=Tt(a,["tfdt"])[0];if(f){const S=f[0];let w=ft(f,4);S===1&&(w===xw?n.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(w*=xw+1,w+=ft(f,8))),We(w)&&(!We(d.start)||w<d.start)&&(d.start=w)}const p=u.default,m=ft(o,0)|(p==null?void 0:p.flags);let y=(p==null?void 0:p.duration)||0;m&8&&(m&2?y=ft(o,12):y=ft(o,8));const b=Tt(a,["trun"]);let E=d.start||0,T=0,x=y;for(let S=0;S<b.length;S++){const w=b[S],C=ft(w,4),I=d.sampleCount;d.sampleCount+=C;const L=w[3]&1,N=w[3]&4,G=w[2]&1,O=w[2]&2,D=w[2]&4,V=w[2]&8;let $=8,J=C;for(L&&($+=4),N&&C&&(!(w[$+1]&1)&&d.keyFrameIndex===void 0&&(d.keyFrameIndex=I),$+=4,G?(x=ft(w,$),$+=4):x=y,O&&($+=4),V&&($+=4),E+=x,T+=x,J--);J--;)G?(x=ft(w,$),$+=4):x=y,O&&($+=4),D&&(w[$+1]&1||d.keyFrameIndex===void 0&&(d.keyFrameIndex=d.sampleCount-(J+1),d.keyFrameStart=E),$+=4),V&&($+=4),E+=x,T+=x;!T&&y&&(T+=y*C)}d.duration+=T}if(!Object.keys(i).some(s=>i[s].duration)){let s=1/0,a=0;const o=Tt(t,["sidx"]);for(let l=0;l<o.length;l++){const u=xY(o[l]);if(u!=null&&u.references){s=Math.min(s,u.earliestPresentationTime/u.timescale);const d=u.references.reduce((f,p)=>f+p.info.duration||0,0);a=Math.max(a,d+u.earliestPresentationTime/u.timescale)}}a&&We(a)&&Object.keys(i).forEach(l=>{i[l].duration||(i[l].duration=a*i[l].timescale-i[l].start)})}return i}function RY(t){const e={valid:null,remainder:null},n=Tt(t,["moof"]);if(n.length<2)return e.remainder=t,e;const i=n[n.length-1];return e.valid=t.slice(0,i.byteOffset-8),e.remainder=t.slice(i.byteOffset-8),e}function ji(t,e){const n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}function Aw(t,e){const n=[],i=e.samples,r=e.timescale,s=e.id;let a=!1;return Tt(i,["moof"]).map(l=>{const u=l.byteOffset-8;Tt(l,["traf"]).map(f=>{const p=Tt(f,["tfdt"]).map(m=>{const y=m[0];let b=ft(m,4);return y===1&&(b*=Math.pow(2,32),b+=ft(m,8)),b/r})[0];return p!==void 0&&(t=p),Tt(f,["tfhd"]).map(m=>{const y=ft(m,4),b=ft(m,0)&16777215,E=(b&1)!==0,T=(b&2)!==0,x=(b&8)!==0;let S=0;const w=(b&16)!==0;let C=0;const I=(b&32)!==0;let L=8;y===s&&(E&&(L+=8),T&&(L+=4),x&&(S=ft(m,L),L+=4),w&&(C=ft(m,L),L+=4),I&&(L+=4),e.type==="video"&&(a=x0(e.codec)),Tt(f,["trun"]).map(N=>{const G=N[0],O=ft(N,0)&16777215,D=(O&1)!==0;let V=0;const $=(O&4)!==0,J=(O&256)!==0;let K=0;const j=(O&512)!==0;let te=0;const ne=(O&1024)!==0,oe=(O&2048)!==0;let P=0;const ie=ft(N,4);let le=8;D&&(V=ft(N,le),le+=4),$&&(le+=4);let q=V+u;for(let ye=0;ye<ie;ye++){if(J?(K=ft(N,le),le+=4):K=S,j?(te=ft(N,le),le+=4):te=C,ne&&(le+=4),oe&&(G===0?P=ft(N,le):P=pL(N,le),le+=4),e.type===jt.VIDEO){let Pe=0;for(;Pe<te;){const we=ft(i,q);if(q+=4,_Y(a,i[q])){const Me=i.subarray(q,q+we);wb(Me,a?2:1,t+P/r,n)}q+=we,Pe+=we+4}}t+=K/r}}))})})}),n}function x0(t){if(!t)return!1;const e=t.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function _Y(t,e){if(t){const n=e>>1&63;return n===39||n===40}else return(e&31)===6}function wb(t,e,n,i){const r=yL(t);let s=0;s+=e;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(l===255);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(l===255);const u=r.length-s;let d=s;if(o<u)s+=o;else if(o>u){Ft.error(`Malformed SEI payload. ${o} is too small, only ${u} bytes left to parse.`);break}if(a===4){if(r[d++]===181){const p=hL(r,d);if(d+=2,p===49){const m=ft(r,d);if(d+=4,m===1195456820){const y=r[d++];if(y===3){const b=r[d++],E=31&b,T=64&b,x=T?2+E*3:0,S=new Uint8Array(x);if(T){S[0]=b;for(let w=1;w<x;w++)S[w]=r[d++]}i.push({type:y,payloadType:a,pts:n,bytes:S})}}}}}else if(a===5&&o>16){const f=[];for(let y=0;y<16;y++){const b=r[d++].toString(16);f.push(b.length==1?"0"+b:b),(y===3||y===5||y===7||y===9)&&f.push("-")}const p=o-16,m=new Uint8Array(p);for(let y=0;y<p;y++)m[y]=r[d++];i.push({payloadType:a,pts:n,uuid:f.join(""),userData:_i(m),userDataBytes:m})}}}function yL(t){const e=t.byteLength,n=[];let i=1;for(;i<e-2;)t[i]===0&&t[i+1]===0&&t[i+2]===3?(n.push(i+2),i+=2):i++;if(n.length===0)return t;const r=e-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=t[a];return s}function IY(t){const e=t[0];let n="",i="",r=0,s=0,a=0,o=0,l=0,u=0;if(e===0){for(;Sn(t.subarray(u,u+1))!=="\0";)n+=Sn(t.subarray(u,u+1)),u+=1;for(n+=Sn(t.subarray(u,u+1)),u+=1;Sn(t.subarray(u,u+1))!=="\0";)i+=Sn(t.subarray(u,u+1)),u+=1;i+=Sn(t.subarray(u,u+1)),u+=1,r=ft(t,12),s=ft(t,16),o=ft(t,20),l=ft(t,24),u=28}else if(e===1){u+=4,r=ft(t,u),u+=4;const f=ft(t,u);u+=4;const p=ft(t,u);for(u+=4,a=2**32*f+p,aY(a)||(a=Number.MAX_SAFE_INTEGER,Ft.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=ft(t,u),u+=4,l=ft(t,u),u+=4;Sn(t.subarray(u,u+1))!=="\0";)n+=Sn(t.subarray(u,u+1)),u+=1;for(n+=Sn(t.subarray(u,u+1)),u+=1;Sn(t.subarray(u,u+1))!=="\0";)i+=Sn(t.subarray(u,u+1)),u+=1;i+=Sn(t.subarray(u,u+1)),u+=1}const d=t.subarray(u,t.byteLength);return{schemeIdUri:n,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:d}}function LY(t,...e){const n=e.length;let i=8,r=n;for(;r--;)i+=e[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=i&255,s.set(t,4),r=0,i=8;r<n;r++)s.set(e[r],i),i+=e[r].byteLength;return s}function DY(t,e,n){if(t.byteLength!==16)throw new RangeError("Invalid system id");let i,r;i=0,r=new Uint8Array;let s;i>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),LY([112,115,115,104],new Uint8Array([i,0,0,0]),t,s,r,a,n)}function OY(t){const e=[];if(t instanceof ArrayBuffer){const n=t.byteLength;let i=0;for(;i+32<n;){const r=new DataView(t,i),s=PY(r);e.push(s),i+=s.size}}return e}function PY(t){const e=t.getUint32(0),n=t.byteOffset,i=t.byteLength;if(i<e)return{offset:n,size:i};if(t.getUint32(4)!==1886614376)return{offset:n,size:e};const s=t.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:n,size:e};const a=t.buffer,o=li(new Uint8Array(a,n+12,16));let l=null,u=null,d=0;if(s===0)d=28;else{const p=t.getUint32(28);if(!p||i<32+p*16)return{offset:n,size:e};l=[];for(let m=0;m<p;m++)l.push(new Uint8Array(a,n+32+m*16,16));d=32+p*16}if(!d)return{offset:n,size:e};const f=t.getUint32(d);return e-32<f?{offset:n,size:e}:(u=new Uint8Array(a,n+d+4,f),{version:s,systemId:o,kids:l,data:u,offset:n,size:e})}const vL=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),qu={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Cb(t,e){const n=qu[e];return!!n&&!!n[t.slice(0,4)]}function Mc(t,e,n=!0){return!t.split(",").some(i=>!Rb(i,e,n))}function Rb(t,e,n=!0){var i;const r=ca(n);return(i=r==null?void 0:r.isTypeSupported(Bc(t,e)))!=null?i:!1}function Bc(t,e){return`${e}/mp4;codecs=${t}`}function ww(t){if(t){const e=t.substring(0,4);return qu.video[e]}return 2}function Fh(t){const e=vL();return t.split(",").reduce((n,i)=>{const s=e&&x0(i)?9:qu.video[i];return s?(s*2+n)/(n?3:2):(qu.audio[i]+n)/(n?2:1)},0)}const x1={};function kY(t,e=!0){if(x1[t])return x1[t];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[t];for(let r=0;r<n.length;r++){var i;if(Rb(n[r],"audio",e))return x1[t]=n[r],n[r];if(n[r]==="mp3"&&(i=ca(e))!=null&&i.isTypeSupported("audio/mpeg"))return""}return t}const NY=/flac|opus|mp4a\.40\.34/i;function Uh(t,e=!0){return t.replace(NY,n=>kY(n.toLowerCase(),e))}function MY(t,e){const n=[];if(t){const i=t.split(",");for(let r=0;r<i.length;r++)Cb(i[r],"video")||n.push(i[r])}return e&&n.push(e),n.join(",")}function ph(t,e){if(t&&(t.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(t)!==-1)&&(Cw(t,"audio")||Cw(t,"video")))return t;if(e){const n=e.split(",");if(n.length>1){if(t){for(let i=n.length;i--;)if(n[i].substring(0,4)===t.substring(0,4))return n[i]}return n[0]}}return e||t}function Cw(t,e){return Cb(t,e)&&Rb(t,e)}function BY(t){const e=t.split(",");for(let n=0;n<e.length;n++){const i=e[n].split(".");i.length>2&&i[0]==="avc1"&&(e[n]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return e.join(",")}function FY(t){if(t.startsWith("av01.")){const e=t.split("."),n=["0","111","01","01","01","0"];for(let i=e.length;i>4&&i<10;i++)e[i]=n[i-4];return e.join(".")}return t}function Rw(t){const e=ca(t)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Gy(t){return t.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const UY={supported:!0,powerEfficient:!0,smooth:!0},HY={supported:!1,smooth:!1,powerEfficient:!1},bL={supported:!0,configurations:[],decodingInfoResults:[UY]};function EL(t,e){return{supported:!1,configurations:e,decodingInfoResults:[HY],error:t}}function zY(t,e,n,i,r,s){const a=t.videoCodec,o=t.audioCodec?t.audioGroups:null,l=s==null?void 0:s.audioCodec,u=s==null?void 0:s.channels,d=u?parseInt(u):l?1/0:2;let f=null;if(o!=null&&o.length)try{o.length===1&&o[0]?f=e.groups[o[0]].channels:f=o.reduce((p,m)=>{if(m){const y=e.groups[m];if(!y)throw new Error(`Audio track group ${m} not found`);Object.keys(y.channels).forEach(b=>{p[b]=(p[b]||0)+y.channels[b]})}return p},{2:0})}catch{return!0}return a!==void 0&&(a.split(",").some(p=>x0(p))||t.width>1920&&t.height>1088||t.height>1920&&t.width>1088||t.frameRate>Math.max(i,30)||t.videoRange!=="SDR"&&t.videoRange!==n||t.bitrate>Math.max(r,8e6))||!!f&&We(d)&&Object.keys(f).some(p=>parseInt(p)>d)}function TL(t,e,n,i={}){const r=t.videoCodec;if(!r&&!t.audioCodec||!n)return Promise.resolve(bL);const s=[],a=qY(t),o=a.length,l=VY(t,e,o>0),u=l.length;for(let d=o||1*u||1;d--;){const f={type:"media-source"};if(o&&(f.video=a[d%o]),u){f.audio=l[d%u];const p=f.audio.bitrate;f.video&&p&&(f.video.bitrate-=p)}s.push(f)}if(r){const d=navigator.userAgent;if(r.split(",").some(f=>x0(f))&&vL())return Promise.resolve(EL(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${d})`),s))}return Promise.all(s.map(d=>{const f=jY(d);return i[f]||(i[f]=n.decodingInfo(d))})).then(d=>({supported:!d.some(f=>!f.supported),configurations:s,decodingInfoResults:d})).catch(d=>({supported:!1,configurations:s,decodingInfoResults:[],error:d}))}function qY(t){var e;const n=(e=t.videoCodec)==null?void 0:e.split(","),i=xL(t),r=t.width||640,s=t.height||480,a=t.frameRate||30,o=t.videoRange.toLowerCase();return n?n.map(l=>{const u={contentType:Bc(FY(l),"video"),width:r,height:s,bitrate:i,framerate:a};return o!=="sdr"&&(u.transferFunction=o),u}):[]}function VY(t,e,n){var i;const r=(i=t.audioCodec)==null?void 0:i.split(","),s=xL(t);return r&&t.audioGroups?t.audioGroups.reduce((a,o)=>{var l;const u=o?(l=e.groups[o])==null?void 0:l.tracks:null;return u?u.reduce((d,f)=>{if(f.groupId===o){const p=parseFloat(f.channels||"");r.forEach(m=>{const y={contentType:Bc(m,"audio"),bitrate:n?GY(m,s):s};p&&(y.channels=""+p),d.push(y)})}return d},a):a},[]):[]}function GY(t,e){if(e<=1)return 1;let n=128e3;return t==="ec-3"?n=768e3:t==="ac-3"&&(n=64e4),Math.min(e/2,n)}function xL(t){return Math.ceil(Math.max(t.bitrate*.9,t.averageBitrate)/1e3)*1e3||1}function jY(t){let e="";const{audio:n,video:i}=t;if(i){const r=Gy(i.contentType);e+=`${r}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`}if(n){const r=Gy(n.contentType);e+=`${i?"_":""}${r}_c${n.channels}`}return e}const jy=["NONE","TYPE-0","TYPE-1",null];function WY(t){return jy.indexOf(t)>-1}const Hh=["SDR","PQ","HLG"];function $Y(t){return!!t&&Hh.indexOf(t)>-1}var mh={No:"",Yes:"YES",v2:"v2"};function _w(t){const{canSkipUntil:e,canSkipDateRanges:n,age:i}=t,r=i<e/2;return e&&r?n?mh.v2:mh.Yes:mh.No}class Iw{constructor(e,n,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=n,this.skip=i}addDirectives(e){const n=new self.URL(e);return this.msn!==void 0&&n.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&n.searchParams.set("_HLS_part",this.part.toString()),this.skip&&n.searchParams.set("_HLS_skip",this.skip),n.href}}class Fc{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in e){var n;this.supplemental=e.supplemental;const i=(n=e.supplemental)==null?void 0:n.videoCodec;i&&i!==e.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return Lw(this._audioGroups,e)}hasSubtitleGroup(e){return Lw(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,n){if(n){if(e==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(n)===-1&&i.push(n)}else if(e==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(n)===-1&&i.push(n)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function Lw(t,e){return!e||!t?!1:t.indexOf(e)!==-1}function YY(){if(typeof matchMedia=="function"){const t=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(t.media!==e.media)return t.matches===!0}return!1}function KY(t,e){let n=!1,i=[];if(t&&(n=t!=="SDR",i=[t]),e){i=e.allowedVideoRanges||Hh.slice(0);const r=i.join("")!=="SDR"&&!e.videoCodec;n=e.preferHDR!==void 0?e.preferHDR:r&&YY(),n||(i=["SDR"])}return{preferHDR:n,allowedVideoRanges:i}}const XY=t=>{const e=new WeakSet;return(n,i)=>{if(t&&(i=t(n,i)),typeof i=="object"&&i!==null){if(e.has(i))return;e.add(i)}return i}},Wt=(t,e)=>JSON.stringify(t,XY(e));function QY(t,e,n,i,r){const s=Object.keys(t),a=i==null?void 0:i.channels,o=i==null?void 0:i.audioCodec,l=r==null?void 0:r.videoCodec,u=a&&parseInt(a)===2;let d=!1,f=!1,p=1/0,m=1/0,y=1/0,b=1/0,E=0,T=[];const{preferHDR:x,allowedVideoRanges:S}=KY(e,r);for(let N=s.length;N--;){const G=t[s[N]];d||(d=G.channels[2]>0),p=Math.min(p,G.minHeight),m=Math.min(m,G.minFramerate),y=Math.min(y,G.minBitrate),S.filter(D=>G.videoRanges[D]>0).length>0&&(f=!0)}p=We(p)?p:0,m=We(m)?m:0;const w=Math.max(1080,p),C=Math.max(30,m);y=We(y)?y:n,n=Math.max(y,n),f||(e=void 0);const I=s.length>1;return{codecSet:s.reduce((N,G)=>{const O=t[G];if(G===N)return N;if(T=f?S.filter(D=>O.videoRanges[D]>0):[],I){if(O.minBitrate>n)return yr(G,`min bitrate of ${O.minBitrate} > current estimate of ${n}`),N;if(!O.hasDefaultAudio)return yr(G,"no renditions with default or auto-select sound found"),N;if(o&&G.indexOf(o.substring(0,4))%5!==0)return yr(G,`audio codec preference "${o}" not found`),N;if(a&&!u){if(!O.channels[a])return yr(G,`no renditions with ${a} channel sound found (channels options: ${Object.keys(O.channels)})`),N}else if((!o||u)&&d&&O.channels[2]===0)return yr(G,"no renditions with stereo sound found"),N;if(O.minHeight>w)return yr(G,`min resolution of ${O.minHeight} > maximum of ${w}`),N;if(O.minFramerate>C)return yr(G,`min framerate of ${O.minFramerate} > maximum of ${C}`),N;if(!T.some(D=>O.videoRanges[D]>0))return yr(G,`no variants with VIDEO-RANGE of ${Wt(T)} found`),N;if(l&&G.indexOf(l.substring(0,4))%5!==0)return yr(G,`video codec preference "${l}" not found`),N;if(O.maxScore<E)return yr(G,`max score of ${O.maxScore} < selected max of ${E}`),N}return N&&(Fh(G)>=Fh(N)||O.fragmentError>t[N].fragmentError)?N:(b=O.minIndex,E=O.maxScore,G)},void 0),videoRanges:T,preferHDR:x,minFramerate:m,minBitrate:y,minIndex:b}}function yr(t,e){Ft.log(`[abr] start candidates with "${t}" ignored because ${e}`)}function SL(t){return t.reduce((e,n)=>{let i=e.groups[n.groupId];i||(i=e.groups[n.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(n);const r=n.channels||"2";return i.channels[r]=(i.channels[r]||0)+1,i.hasDefault=i.hasDefault||n.default,i.hasAutoSelect=i.hasAutoSelect||n.autoselect,i.hasDefault&&(e.hasDefaultAudio=!0),i.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function ZY(t,e,n,i){return t.slice(n,i+1).reduce((r,s,a)=>{if(!s.codecSet)return r;const o=s.audioGroups;let l=r[s.codecSet];l||(r[s.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,s.bitrate);const u=Math.min(s.height,s.width);return l.minHeight=Math.min(l.minHeight,u),l.minFramerate=Math.min(l.minFramerate,s.frameRate),l.minIndex=Math.min(l.minIndex,a),l.maxScore=Math.max(l.maxScore,s.score),l.fragmentError+=s.fragmentError,l.videoRanges[s.videoRange]=(l.videoRanges[s.videoRange]||0)+1,o&&o.forEach(d=>{if(!d)return;const f=e.groups[d];f&&(l.hasDefaultAudio=l.hasDefaultAudio||e.hasDefaultAudio?f.hasDefault:f.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(f.channels).forEach(p=>{l.channels[p]=(l.channels[p]||0)+f.channels[p]}))}),r},{})}function Dw(t){if(!t)return t;const{lang:e,assocLang:n,characteristics:i,channels:r,audioCodec:s}=t;return{lang:e,assocLang:n,characteristics:i,channels:r,audioCodec:s}}function wr(t,e,n){if("attrs"in t){const i=e.indexOf(t);if(i!==-1)return i}for(let i=0;i<e.length;i++){const r=e[i];if(so(t,r,n))return i}return-1}function so(t,e,n){const{groupId:i,name:r,lang:s,assocLang:a,default:o}=t,l=t.forced;return(i===void 0||e.groupId===i)&&(r===void 0||e.name===r)&&(s===void 0||JY(s,e.lang))&&(s===void 0||e.assocLang===a)&&(o===void 0||e.default===o)&&(l===void 0||e.forced===l)&&(!("characteristics"in t)||eK(t.characteristics||"",e.characteristics))&&(n===void 0||n(t,e))}function JY(t,e="--"){return t.length===e.length?t===e:t.startsWith(e)||e.startsWith(t)}function eK(t,e=""){const n=t.split(","),i=e.split(",");return n.length===i.length&&!n.some(r=>i.indexOf(r)===-1)}function $a(t,e){const{audioCodec:n,channels:i}=t;return(n===void 0||(e.audioCodec||"").substring(0,4)===n.substring(0,4))&&(i===void 0||i===(e.channels||"2"))}function tK(t,e,n,i,r){const s=e[i],o=e.reduce((p,m,y)=>{const b=m.uri;return(p[b]||(p[b]=[])).push(y),p},{})[s.uri];o.length>1&&(i=Math.max.apply(Math,o));const l=s.videoRange,u=s.frameRate,d=s.codecSet.substring(0,4),f=Ow(e,i,p=>{if(p.videoRange!==l||p.frameRate!==u||p.codecSet.substring(0,4)!==d)return!1;const m=p.audioGroups,y=n.filter(b=>!m||m.indexOf(b.groupId)!==-1);return wr(t,y,r)>-1});return f>-1?f:Ow(e,i,p=>{const m=p.audioGroups,y=n.filter(b=>!m||m.indexOf(b.groupId)!==-1);return wr(t,y,r)>-1})}function Ow(t,e,n){for(let i=e;i>-1;i--)if(n(t[i]))return i;for(let i=e+1;i<t.length;i++)if(n(t[i]))return i;return-1}function zh(t,e){var n;return!!t&&t!==((n=e.loadLevelObj)==null?void 0:n.uri)}class nK extends $i{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=n=>{var i;const{fragCurrent:r,partCurrent:s,hls:a}=this,{autoLevelEnabled:o,media:l}=a;if(!r||!l)return;const u=performance.now(),d=s?s.stats:r.stats,f=s?s.duration:r.duration,p=u-d.loading.start,m=a.minAutoLevel,y=r.level,b=this._nextAutoLevel;if(d.aborted||d.loaded&&d.loaded===d.total||y<=m){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o)return;const E=b>-1&&b!==y,T=!!n||E;if(!T&&(l.paused||!l.playbackRate||!l.readyState))return;const x=a.mainForwardBufferInfo;if(!T&&x===null)return;const S=this.bwEstimator.getEstimateTTFB(),w=Math.abs(l.playbackRate);if(p<=Math.max(S,1e3*(f/(w*2))))return;const C=x?x.len/w:0,I=d.loading.first?d.loading.first-d.loading.start:-1,L=d.loaded&&I>-1,N=this.getBwEstimate(),G=a.levels,O=G[y],D=Math.max(d.loaded,Math.round(f*(r.bitrate||O.averageBitrate)/8));let V=L?p-I:p;V<1&&L&&(V=Math.min(p,d.loaded*8/N));const $=L?d.loaded*1e3/V:0,J=S/1e3,K=$?(D-d.loaded)/$:D*8/N+J;if(K<=C)return;const j=$?$*8:N,te=((i=(n==null?void 0:n.details)||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,ne=this.hls.config.abrBandWidthUpFactor;let oe=Number.POSITIVE_INFINITY,P;for(P=y-1;P>m;P--){const ye=G[P].maxBitrate,Pe=!G[P].details||te;if(oe=this.getTimeToLoadFrag(J,j,f*ye,Pe),oe<Math.min(C,f+J))break}if(oe>=K||oe>f*10)return;L?this.bwEstimator.sample(p-Math.min(S,I),d.loaded):this.bwEstimator.sampleTTFB(p);const ie=G[P].maxBitrate;this.getBwEstimate()*ne>ie&&this.resetEstimator(ie);const le=this.findBestLevel(ie,m,P,0,C,1,1);le>-1&&(P=le),this.warn(`Fragment ${r.sn}${s?" part "+s.index:""} of level ${y} is loading too slowly;
      Fragment duration: ${r.duration.toFixed(3)}
      Time to underbuffer: ${C.toFixed(3)} s
      Estimated load time for current fragment: ${K.toFixed(3)} s
      Estimated load time for down switch fragment: ${oe.toFixed(3)} s
      TTFB estimate: ${I|0} ms
      Current BW estimate: ${We(N)?N|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${P} @ ${ie|0} bps`),a.nextLoadLevel=a.nextAutoLevel=P,this.clearTimer();const q=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===P&&P>0){const ye=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${P>0?"and switching down":""}
      Fragment duration: ${r.duration.toFixed(3)} s
      Time to underbuffer: ${ye.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,P>m){let Pe=this.findBestLevel(this.hls.levels[m].bitrate,m,P,0,ye,1,1);Pe===-1&&(Pe=m),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Pe,this.resetEstimator(this.hls.levels[Pe].bitrate)}}};E||K>oe*2?q():this.timer=self.setInterval(q,oe*1e3),a.trigger(M.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:s,stats:d})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new uY(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.FRAG_LOADING,this.onFragLoading,this),e.on(M.FRAG_LOADED,this.onFragLoaded,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this),e.on(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(M.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.FRAG_LOADING,this.onFragLoading,this),e.off(M.FRAG_LOADED,this.onFragLoaded,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this),e.off(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(M.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(M.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,n){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,n){const i=n.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var r;this.fragCurrent=i,this.partCurrent=(r=n.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,n){this.clearTimer()}onError(e,n){if(!n.fatal)switch(n.details){case pe.BUFFER_ADD_CODEC_ERROR:case pe.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case pe.FRAG_LOAD_TIMEOUT:{const i=n.frag,{fragCurrent:r,partCurrent:s}=this;if(i&&r&&i.sn===r.sn&&i.level===r.level){const a=performance.now(),o=s?s.stats:i.stats,l=a-o.loading.start,u=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&u>-1){const f=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(f,u),o.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,n,i,r){const s=e+i/n,a=r?e+this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,n){const i=this.hls.config,{loading:r}=n.stats,s=r.end-r.first;We(s)&&(this.lastLevelLoadSec=s/1e3),n.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(n.levelInfo)}onFragLoaded(e,{frag:n,part:i}){const r=i?i.stats:n.stats;if(n.type===Xe.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(n)){if(this.clearTimer(),n.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=i?i.duration:n.duration,a=this.hls.levels[n.level],o=(a.loaded?a.loaded.bytes:0)+r.loaded,l=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(n.bitrateTest){const s={stats:r,frag:n,part:i,id:n.type};this.onFragBuffered(M.FRAG_BUFFERED,s),n.bitrateTest=!1}else this.lastLoadedFragLevel=n.level}}onFragBuffered(e,n){const{frag:i,part:r}=n,s=r!=null&&r.stats.loaded?r.stats:i.stats;if(s.aborted||this.ignoreFragment(i))return;const a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Xe.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:n}=this.hls,i=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,s=this.findBestLevel(i,n,e,0,r,1,1);if(s>-1)return s;const a=this.hls.firstLevel,o=Math.min(Math.max(a,n),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!i||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=i&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,s)&&a[e].loadError<=a[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:n,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:r,config:s,minAutoLevel:a}=i,o=n?n.duration:e?e.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay();let d=s.abrBandWidthFactor,f=s.abrBandWidthUpFactor;if(u){const E=this.findBestLevel(l,a,r,u,0,d,f);if(E>=0)return this.rebufferNotice=-1,E}let p=o?Math.min(o,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const E=this.bitrateTestDelay;E&&(p=(o?Math.min(o,s.maxLoadingDelay):s.maxLoadingDelay)-E,this.info(`bitrate test took ${Math.round(1e3*E)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),d=f=1)}const m=this.findBestLevel(l,a,r,u,p,d,f);if(this.rebufferNotice!==m&&(this.rebufferNotice=m,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${m}`)),m>-1)return m;const y=i.levels[a],b=i.loadLevelObj;return b&&(y==null?void 0:y.bitrate)<b.bitrate?a:i.loadLevel}getStarvationDelay(){const e=this.hls,n=e.media;if(!n)return 1/0;const i=n&&n.playbackRate!==0?Math.abs(n.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,n,i,r,s,a,o){var l;const u=r+s,d=this.lastLoadedFragLevel,f=d===-1?this.hls.firstLevel:d,{fragCurrent:p,partCurrent:m}=this,{levels:y,allAudioTracks:b,loadLevel:E,config:T}=this.hls;if(y.length===1)return 0;const x=y[f],S=!!((l=this.hls.latestLevelDetails)!=null&&l.live),w=E===-1||d===-1;let C,I="SDR",L=(x==null?void 0:x.frameRate)||0;const{audioPreference:N,videoPreference:G}=T,O=this.audioTracksByGroup||(this.audioTracksByGroup=SL(b));let D=-1;if(w){if(this.firstSelection!==-1)return this.firstSelection;const j=this.codecTiers||(this.codecTiers=ZY(y,O,n,i)),te=QY(j,I,e,N,G),{codecSet:ne,videoRanges:oe,minFramerate:P,minBitrate:ie,minIndex:le,preferHDR:q}=te;D=le,C=ne,I=q?oe[oe.length-1]:oe[0],L=P,e=Math.max(e,ie),this.log(`picked start tier ${Wt(te)}`)}else C=x==null?void 0:x.codecSet,I=x==null?void 0:x.videoRange;const V=m?m.duration:p?p.duration:0,$=this.bwEstimator.getEstimateTTFB()/1e3,J=[];for(let j=i;j>=n;j--){var K;const te=y[j],ne=j>f;if(!te)continue;if(T.useMediaCapabilities&&!te.supportedResult&&!te.supportedPromise){const Pe=navigator.mediaCapabilities;typeof(Pe==null?void 0:Pe.decodingInfo)=="function"&&zY(te,O,I,L,e,N)?(te.supportedPromise=TL(te,O,Pe,this.supportedCache),te.supportedPromise.then(we=>{if(!this.hls)return;te.supportedResult=we;const Me=this.hls.levels,Fe=Me.indexOf(te);we.error?this.warn(`MediaCapabilities decodingInfo error: "${we.error}" for level ${Fe} ${Wt(we)}`):we.supported?we.decodingInfoResults.some($e=>$e.smooth===!1||$e.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Fe} not smooth or powerEfficient: ${Wt(we)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Fe} ${Wt(we)}`),Fe>-1&&Me.length>1&&(this.log(`Removing unsupported level ${Fe}`),this.hls.removeLevel(Fe),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(we=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${we}`)})):te.supportedResult=bL}if((C&&te.codecSet!==C||I&&te.videoRange!==I||ne&&L>te.frameRate||!ne&&L>0&&L<te.frameRate||(K=te.supportedResult)!=null&&(K=K.decodingInfoResults)!=null&&K.some(Pe=>Pe.smooth===!1))&&(!w||j!==D)){J.push(j);continue}const oe=te.details,P=(m?oe==null?void 0:oe.partTarget:oe==null?void 0:oe.averagetargetduration)||V;let ie;ne?ie=o*e:ie=a*e;const le=V&&r>=V*2&&s===0?te.averageBitrate:te.maxBitrate,q=this.getTimeToLoadFrag($,ie,le*P,oe===void 0);if(ie>=le&&(j===d||te.loadError===0&&te.fragmentError===0)&&(q<=$||!We(q)||S&&!this.bitrateTestDelay||q<u)){const Pe=this.forcedAutoLevel;return j!==E&&(Pe===-1||Pe!==E)&&(J.length&&this.trace(`Skipped level(s) ${J.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${y[J[0]].codecs}" ${y[J[0]].videoRange}; not compatible with "${C}" ${I}`),this.info(`switch candidate:${f}->${j} adjustedbw(${Math.round(ie)})-bitrate=${Math.round(ie-le)} ttfb:${$.toFixed(1)} avgDuration:${P.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${q.toFixed(1)} firstSelection:${w} codecSet:${te.codecSet} videoRange:${te.videoRange} hls.loadLevel:${E}`)),w&&(this.firstSelection=j),j}}return-1}set nextAutoLevel(e){const n=this.deriveNextAutoLevel(e);this._nextAutoLevel!==n&&(this.nextAutoLevelKey="",this._nextAutoLevel=n)}deriveNextAutoLevel(e){const{maxAutoLevel:n,minAutoLevel:i}=this.hls;return Math.min(Math.max(e,i),n)}}const AL={search:function(t,e){let n=0,i=t.length-1,r=null,s=null;for(;n<=i;){r=(n+i)/2|0,s=t[r];const a=e(s);if(a>0)n=r+1;else if(a<0)i=r-1;else return s}return null}};function iK(t,e,n){if(e===null||!Array.isArray(t)||!t.length||!We(e))return null;const i=t[0].programDateTime;if(e<(i||0))return null;const r=t[t.length-1].endProgramDateTime;if(e>=(r||0))return null;for(let s=0;s<t.length;++s){const a=t[s];if(sK(e,n,a))return a}return null}function lo(t,e,n=0,i=0,r=.005){let s=null;if(t){s=e[1+t.sn-e[0].sn]||null;const o=t.endDTS-n;o>0&&o<15e-7&&(n+=15e-7),s&&t.level!==s.level&&s.end<=t.end&&(s=e[2+t.sn-e[0].sn]||null)}else n===0&&e[0].start===0&&(s=e[0]);if(s&&((!t||t.level===s.level)&&Pw(n,i,s)===0||rK(s,t,Math.min(r,i))))return s;const a=AL.search(e,Pw.bind(null,n,i));return a&&(a!==t||!s)?a:s}function rK(t,e,n){if(e&&e.start===0&&e.level<t.level&&(e.endPTS||0)>0){const i=e.tagList.reduce((r,s)=>(s[0]==="INF"&&(r+=parseFloat(s[1])),r),n);return t.start<=i}return!1}function Pw(t=0,e=0,n){if(n.start<=t&&n.start+n.duration>t)return 0;const i=Math.min(e,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=t?1:n.start-i>t&&n.start?-1:0}function sK(t,e,n){const i=Math.min(e,n.duration+(n.deltaPTS?n.deltaPTS:0))*1e3;return(n.endProgramDateTime||0)-i>t}function wL(t,e,n){if(t&&t.startCC<=e&&t.endCC>=e){let i=t.fragments;const{fragmentHint:r}=t;r&&(i=i.concat(r));let s;return AL.search(i,a=>a.cc<e?1:a.cc>e?-1:(s=a,a.end<=n?1:a.start>n?-1:0)),s||null}return null}function qh(t){switch(t.details){case pe.FRAG_LOAD_TIMEOUT:case pe.KEY_LOAD_TIMEOUT:case pe.LEVEL_LOAD_TIMEOUT:case pe.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function CL(t){return t.details.startsWith("key")}function RL(t){return CL(t)&&!!t.frag&&!t.frag.decryptdata}function kw(t,e){const n=qh(e);return t.default[`${n?"timeout":"error"}Retry`]}function _b(t,e){const n=t.backoff==="linear"?1:Math.pow(2,e);return Math.min(n*t.retryDelayMs,t.maxRetryDelayMs)}function Nw(t){return Bt(Bt({},t),{errorRetry:null,timeoutRetry:null})}function Vh(t,e,n,i){if(!t)return!1;const r=i==null?void 0:i.code,s=e<t.maxNumRetry&&(aK(r)||!!n);return t.shouldRetry?t.shouldRetry(t,e,n,i,s):s}function aK(t){return Wy(t)||!!t&&(t<400||t>499)}function Wy(t){return t===0&&navigator.onLine===!1}var Fn={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Ai={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class oK extends $i{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(M.ERROR,this.onError,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(M.ERROR,this.onError,this),e.off(M.ERROR,this.onErrorOut,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Xe.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const n=this.hls,i=n.currentLevel;return(e=n.loadLevelObj)!=null&&e.details||i===-1?n.loadLevel:i}variantHasKey(e,n){if(e){var i;if((i=e.details)!=null&&i.hasKey(n))return!0;const r=e.audioGroups;if(r)return this.hls.allAudioTracks.filter(a=>r.indexOf(a.groupId)>=0).some(a=>{var o;return(o=a.details)==null?void 0:o.hasKey(n)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,n){var i;if(n.fatal)return;const r=this.hls,s=n.context;switch(n.details){case pe.FRAG_LOAD_ERROR:case pe.FRAG_LOAD_TIMEOUT:case pe.KEY_LOAD_ERROR:case pe.KEY_LOAD_TIMEOUT:n.errorAction=this.getFragRetryOrSwitchAction(n);return;case pe.FRAG_PARSING_ERROR:if((i=n.frag)!=null&&i.gap){n.errorAction=Ou();return}case pe.FRAG_GAP:case pe.FRAG_DECRYPT_ERROR:{n.errorAction=this.getFragRetryOrSwitchAction(n),n.errorAction.action=Fn.SendAlternateToPenaltyBox;return}case pe.LEVEL_EMPTY_ERROR:case pe.LEVEL_PARSING_ERROR:{var a;const l=n.parent===Xe.MAIN?n.level:r.loadLevel;n.details===pe.LEVEL_EMPTY_ERROR&&((a=n.context)!=null&&(a=a.levelDetails)!=null&&a.live)?n.errorAction=this.getPlaylistRetryOrSwitchAction(n,l):(n.levelRetry=!1,n.errorAction=this.getLevelSwitchAction(n,l))}return;case pe.LEVEL_LOAD_ERROR:case pe.LEVEL_LOAD_TIMEOUT:typeof(s==null?void 0:s.level)=="number"&&(n.errorAction=this.getPlaylistRetryOrSwitchAction(n,s.level));return;case pe.AUDIO_TRACK_LOAD_ERROR:case pe.AUDIO_TRACK_LOAD_TIMEOUT:case pe.SUBTITLE_LOAD_ERROR:case pe.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const l=r.loadLevelObj;if(l&&(s.type===At.AUDIO_TRACK&&l.hasAudioGroup(s.groupId)||s.type===At.SUBTITLE_TRACK&&l.hasSubtitleGroup(s.groupId))){n.errorAction=this.getPlaylistRetryOrSwitchAction(n,r.loadLevel),n.errorAction.action=Fn.SendAlternateToPenaltyBox,n.errorAction.flags=Ai.MoveAllAlternatesMatchingHost;return}}return;case pe.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:n.errorAction={action:Fn.SendAlternateToPenaltyBox,flags:Ai.MoveAllAlternatesMatchingHDCP};return;case pe.KEY_SYSTEM_SESSION_UPDATE_FAILED:case pe.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case pe.KEY_SYSTEM_NO_SESSION:n.errorAction={action:Fn.SendAlternateToPenaltyBox,flags:Ai.MoveAllAlternatesMatchingKey};return;case pe.BUFFER_ADD_CODEC_ERROR:case pe.REMUX_ALLOC_ERROR:case pe.BUFFER_APPEND_ERROR:if(!n.errorAction){var o;n.errorAction=this.getLevelSwitchAction(n,(o=n.level)!=null?o:r.loadLevel)}return;case pe.INTERNAL_EXCEPTION:case pe.BUFFER_APPENDING_ERROR:case pe.BUFFER_FULL_ERROR:case pe.LEVEL_SWITCH_ERROR:case pe.BUFFER_STALLED_ERROR:case pe.BUFFER_SEEK_OVER_HOLE:case pe.BUFFER_NUDGE_ON_STALL:n.errorAction=Ou();return}n.type===it.KEY_SYSTEM_ERROR&&(n.levelRetry=!1,n.errorAction=Ou())}getPlaylistRetryOrSwitchAction(e,n){const i=this.hls,r=kw(i.config.playlistLoadPolicy,e),s=this.playlistError++;if(Vh(r,s,qh(e),e.response))return{action:Fn.RetryRequest,flags:Ai.None,retryConfig:r,retryCount:s};const o=this.getLevelSwitchAction(e,n);return r&&(o.retryConfig=r,o.retryCount=s),o}getFragRetryOrSwitchAction(e){const n=this.hls,i=this.getVariantLevelIndex(e.frag),r=n.levels[i],{fragLoadPolicy:s,keyLoadPolicy:a}=n.config,o=kw(CL(e)?a:s,e),l=n.levels.reduce((d,f)=>d+f.fragmentError,0);if(r&&(e.details!==pe.FRAG_GAP&&r.fragmentError++,!RL(e)&&Vh(o,l,qh(e),e.response)))return{action:Fn.RetryRequest,flags:Ai.None,retryConfig:o,retryCount:l};const u=this.getLevelSwitchAction(e,i);return o&&(u.retryConfig=o,u.retryCount=l),u}getLevelSwitchAction(e,n){const i=this.hls;n==null&&(n=i.loadLevel);const r=this.hls.levels[n];if(r){var s,a;const u=e.details;r.loadError++,u===pe.BUFFER_APPEND_ERROR&&r.fragmentError++;let d=-1;const{levels:f,loadLevel:p,minAutoLevel:m,maxAutoLevel:y}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const b=(s=e.frag)==null?void 0:s.type,T=(b===Xe.AUDIO&&u===pe.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===pe.BUFFER_ADD_CODEC_ERROR||u===pe.BUFFER_APPEND_ERROR))&&f.some(({audioCodec:I})=>r.audioCodec!==I),S=e.sourceBufferName==="video"&&(u===pe.BUFFER_ADD_CODEC_ERROR||u===pe.BUFFER_APPEND_ERROR)&&f.some(({codecSet:I,audioCodec:L})=>r.codecSet!==I&&r.audioCodec===L),{type:w,groupId:C}=(a=e.context)!=null?a:{};for(let I=f.length;I--;){const L=(I+p)%f.length;if(L!==p&&L>=m&&L<=y&&f[L].loadError===0){var o,l;const N=f[L];if(u===pe.FRAG_GAP&&b===Xe.MAIN&&e.frag){const G=f[L].details;if(G){const O=lo(e.frag,G.fragments,e.frag.start);if(O!=null&&O.gap)continue}}else{if(w===At.AUDIO_TRACK&&N.hasAudioGroup(C)||w===At.SUBTITLE_TRACK&&N.hasSubtitleGroup(C))continue;if(b===Xe.AUDIO&&(o=r.audioGroups)!=null&&o.some(G=>N.hasAudioGroup(G))||b===Xe.SUBTITLE&&(l=r.subtitleGroups)!=null&&l.some(G=>N.hasSubtitleGroup(G))||T&&r.audioCodec===N.audioCodec||S&&r.codecSet===N.codecSet||!T&&r.codecSet!==N.codecSet)continue}d=L;break}}if(d>-1&&i.loadLevel!==d)return e.levelRetry=!0,this.playlistError=0,{action:Fn.SendAlternateToPenaltyBox,flags:Ai.None,nextAutoLevel:d}}return{action:Fn.SendAlternateToPenaltyBox,flags:Ai.MoveAllAlternatesMatchingHost}}onErrorOut(e,n){var i;switch((i=n.errorAction)==null?void 0:i.action){case Fn.DoNothing:break;case Fn.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(n),!n.errorAction.resolved&&n.details!==pe.FRAG_GAP?n.fatal=!0:/MediaSource readyState: ended/.test(n.error.message)&&(this.warn(`MediaSource ended after "${n.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(n.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const n=this.hls,i=e.errorAction;if(!i)return;const{flags:r}=i,s=i.nextAutoLevel;switch(r){case Ai.None:this.switchLevel(e,s);break;case Ai.MoveAllAlternatesMatchingHDCP:{const l=this.getVariantLevelIndex(e.frag),u=n.levels[l],d=u==null?void 0:u.attrs["HDCP-LEVEL"];if(i.hdcpLevel=d,d==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(d){n.maxHdcpLevel=jy[jy.indexOf(d)-1],i.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${n.maxHdcpLevel}" or lower`);break}}case Ai.MoveAllAlternatesMatchingKey:{const l=e.decryptdata;if(l){const u=this.hls.levels,d=u.length;for(let p=d;p--;)if(this.variantHasKey(u[p],l)){var a,o;this.log(`Banned key found in level ${p} (${u[p].bitrate}bps) or audio group "${(a=u[p].audioGroups)==null?void 0:a.join(",")}" (${(o=e.frag)==null?void 0:o.type} fragment) ${li(l.keyId||[])}`),u[p].fragmentError++,u[p].loadError++,this.log(`Removing level ${p} with key error (${e.error})`),this.hls.removeLevel(p)}const f=e.frag;if(this.hls.levels.length<d)i.resolved=!0;else if(f&&f.type!==Xe.MAIN){const p=f.decryptdata;p&&!l.matches(p)&&(i.resolved=!0)}}break}}i.resolved||this.switchLevel(e,s)}switchLevel(e,n){if(n!==void 0&&e.errorAction&&(this.warn(`switching to level ${n} after ${e.details}`),this.hls.nextAutoLevel=n,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===pe.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const i=Gy(e.mimeType),r=this.hls.levels;for(let s=r.length;s--;)r[s][`${e.sourceBufferName}Codec`]===i&&(this.log(`Removing level ${s} for ${e.details} ("${i}" not supported)`),this.hls.removeLevel(s))}}}function Ou(t){const e={action:Fn.DoNothing,flags:Ai.None};return t&&(e.resolved=!0),e}var wn={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class uK{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.BUFFER_APPENDED,this.onBufferAppended,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this),e.on(M.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.BUFFER_APPENDED,this.onBufferAppended,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this),e.off(M.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,n){const i=this.activePartLists[n];if(i)for(let r=i.length;r--;){const s=i[r];if(!s)break;if(s.start<=e&&e<=s.end&&s.loaded)return s}return this.getBufferedFrag(e,n)}getBufferedFrag(e,n){return this.getFragAtPos(e,n,!0)}getFragAtPos(e,n,i){const{fragments:r}=this,s=Object.keys(r);for(let a=s.length;a--;){const o=r[s[a]];if((o==null?void 0:o.body.type)===n&&(!i||o.buffered)){const l=o.body;if(l.start<=e&&e<=l.end)return l}}return null}detectEvictedFragments(e,n,i,r,s){this.timeRanges&&(this.timeRanges[e]=n);const a=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l||a>=l.body.sn)return;if(!l.buffered&&(!l.loaded||s)){l.body.type===i&&this.removeFragment(l.body);return}const u=l.range[e];if(u){if(u.time.length===0){this.removeFragment(l.body);return}u.time.some(d=>{const f=!this.isTimeBuffered(d.startPTS,d.endPTS,n);return f&&this.removeFragment(l.body),f})}})}detectPartialFragments(e){const n=this.timeRanges;if(!n||e.frag.sn==="initSegment")return;const i=e.frag,r=mu(i),s=this.fragments[r];if(!s||s.buffered&&i.gap)return;const a=!i.relurl;Object.keys(n).forEach(o=>{const l=i.elementaryStreams[o];if(!l)return;const u=n[o],d=a||l.partial===!0;s.range[o]=this.getBufferedTimes(i,e.part,d,u)}),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=i.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),qf(s)||this.removeParts(i.sn-1,i.type)):this.removeFragment(s.body)}removeParts(e,n){const i=this.activePartLists[n];i&&(this.activePartLists[n]=Mw(i,r=>r.fragment.sn>=e))}fragBuffered(e,n){const i=mu(e);let r=this.fragments[i];!r&&n&&(r=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,n,i,r){const s={time:[],partial:i},a=e.start,o=e.end,l=e.minEndPTS||o,u=e.maxStartPTS||a;for(let d=0;d<r.length;d++){const f=r.start(d)-this.bufferPadding,p=r.end(d)+this.bufferPadding;if(u>=f&&l<=p){s.time.push({startPTS:Math.max(a,r.start(d)),endPTS:Math.min(o,r.end(d))});break}else if(a<p&&o>f){const m=Math.max(a,r.start(d)),y=Math.min(o,r.end(d));y>m&&(s.partial=!0,s.time.push({startPTS:m,endPTS:y}))}else if(o<=f)break}return s}getPartialFragment(e){let n=null,i,r,s,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(u=>{const d=l[u];d&&qf(d)&&(r=d.body.start-o,s=d.body.end+o,e>=r&&e<=s&&(i=Math.min(e-r,s-e),a<=i&&(n=d.body,a=i)))}),n}isEndListAppended(e){const n=this.endListFragments[e];return n!==void 0&&(n.buffered||qf(n))}getState(e){const n=mu(e),i=this.fragments[n];return i?i.buffered?qf(i)?wn.PARTIAL:wn.OK:wn.APPENDING:wn.NOT_LOADED}isTimeBuffered(e,n,i){let r,s;for(let a=0;a<i.length;a++){if(r=i.start(a)-this.bufferPadding,s=i.end(a)+this.bufferPadding,e>=r&&n<=s)return!0;if(n<=r)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,n){if(n.frag.sn==="initSegment"||n.frag.bitrateTest)return;const i=n.frag,r=n.part?null:n,s=mu(i);this.fragments[s]={body:i,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,n){const{frag:i,part:r,timeRanges:s,type:a}=n;if(i.sn==="initSegment")return;const o=i.type;if(r){let u=this.activePartLists[o];u||(this.activePartLists[o]=u=[]),u.push(r)}this.timeRanges=s;const l=s[a];this.detectEvictedFragments(a,l,o,r)}onFragBuffered(e,n){this.detectPartialFragments(n)}hasFragment(e){const n=mu(e);return!!this.fragments[n]}hasFragments(e){const{fragments:n}=this,i=Object.keys(n);if(!e)return i.length>0;for(let r=i.length;r--;){const s=n[i[r]];if((s==null?void 0:s.body.type)===e)return!0}return!1}hasParts(e){var n;return!!((n=this.activePartLists[e])!=null&&n.length)}removeFragmentsInRange(e,n,i,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==i||r&&!l.gap||l.start<n&&l.end>e&&(o.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const n=mu(e);e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const r=e.sn;this.activePartLists[e.type]=Mw(i,s=>s.fragment.sn!==r)}delete this.fragments[n],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const n=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;n&&n.forEach(i=>i.clearElementaryStreamInfo())}}function qf(t){var e,n,i;return t.buffered&&!!(t.body.gap||(e=t.range.video)!=null&&e.partial||(n=t.range.audio)!=null&&n.partial||(i=t.range.audiovideo)!=null&&i.partial)}function mu(t){return`${t.type}_${t.level}_${t.sn}`}function Mw(t,e){return t.filter(n=>{const i=e(n);return i||n.clearElementaryStreamInfo(),i})}var da={cbc:0,ctr:1};class lK{constructor(e,n,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=n,this.aesMode=i}decrypt(e,n){switch(this.aesMode){case da.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},n,e);case da.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},n,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function cK(t){const e=t.byteLength,n=e&&new DataView(t.buffer).getUint8(e-1);return n?t.slice(0,e-n):t}class dK{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const n=new DataView(e),i=new Uint32Array(4);for(let r=0;r<4;r++)i[r]=n.getUint32(r*4);return i}initTable(){const e=this.sBox,n=this.invSBox,i=this.subMix,r=i[0],s=i[1],a=i[2],o=i[3],l=this.invSubMix,u=l[0],d=l[1],f=l[2],p=l[3],m=new Uint32Array(256);let y=0,b=0,E=0;for(E=0;E<256;E++)E<128?m[E]=E<<1:m[E]=E<<1^283;for(E=0;E<256;E++){let T=b^b<<1^b<<2^b<<3^b<<4;T=T>>>8^T&255^99,e[y]=T,n[T]=y;const x=m[y],S=m[x],w=m[S];let C=m[T]*257^T*16843008;r[y]=C<<24|C>>>8,s[y]=C<<16|C>>>16,a[y]=C<<8|C>>>24,o[y]=C,C=w*16843009^S*65537^x*257^y*16843008,u[T]=C<<24|C>>>8,d[T]=C<<16|C>>>16,f[T]=C<<8|C>>>24,p[T]=C,y?(y=x^m[m[m[w^x]]],b^=m[m[b]]):y=b=1}}expandKey(e){const n=this.uint8ArrayToUint32Array_(e);let i=!0,r=0;for(;r<n.length&&i;)i=n[r]===this.key[r],r++;if(i)return;this.key=n;const s=this.keySize=n.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const a=this.ksRows=(s+6+1)*4;let o,l;const u=this.keySchedule=new Uint32Array(a),d=this.invKeySchedule=new Uint32Array(a),f=this.sBox,p=this.rcon,m=this.invSubMix,y=m[0],b=m[1],E=m[2],T=m[3];let x,S;for(o=0;o<a;o++){if(o<s){x=u[o]=n[o];continue}S=x,o%s===0?(S=S<<8|S>>>24,S=f[S>>>24]<<24|f[S>>>16&255]<<16|f[S>>>8&255]<<8|f[S&255],S^=p[o/s|0]<<24):s>6&&o%s===4&&(S=f[S>>>24]<<24|f[S>>>16&255]<<16|f[S>>>8&255]<<8|f[S&255]),u[o]=x=(u[o-s]^S)>>>0}for(l=0;l<a;l++)o=a-l,l&3?S=u[o]:S=u[o-4],l<4||o<=4?d[l]=S:d[l]=y[f[S>>>24]]^b[f[S>>>16&255]]^E[f[S>>>8&255]]^T[f[S&255]],d[l]=d[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,n,i){const r=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],u=o[1],d=o[2],f=o[3],p=this.uint8ArrayToUint32Array_(i);let m=p[0],y=p[1],b=p[2],E=p[3];const T=new Int32Array(e),x=new Int32Array(T.length);let S,w,C,I,L,N,G,O,D,V,$,J,K,j;const te=this.networkToHostOrderSwap;for(;n<T.length;){for(D=te(T[n]),V=te(T[n+1]),$=te(T[n+2]),J=te(T[n+3]),L=D^s[0],N=J^s[1],G=$^s[2],O=V^s[3],K=4,j=1;j<r;j++)S=l[L>>>24]^u[N>>16&255]^d[G>>8&255]^f[O&255]^s[K],w=l[N>>>24]^u[G>>16&255]^d[O>>8&255]^f[L&255]^s[K+1],C=l[G>>>24]^u[O>>16&255]^d[L>>8&255]^f[N&255]^s[K+2],I=l[O>>>24]^u[L>>16&255]^d[N>>8&255]^f[G&255]^s[K+3],L=S,N=w,G=C,O=I,K=K+4;S=a[L>>>24]<<24^a[N>>16&255]<<16^a[G>>8&255]<<8^a[O&255]^s[K],w=a[N>>>24]<<24^a[G>>16&255]<<16^a[O>>8&255]<<8^a[L&255]^s[K+1],C=a[G>>>24]<<24^a[O>>16&255]<<16^a[L>>8&255]<<8^a[N&255]^s[K+2],I=a[O>>>24]<<24^a[L>>16&255]<<16^a[N>>8&255]<<8^a[G&255]^s[K+3],x[n]=te(S^m),x[n+1]=te(I^y),x[n+2]=te(C^b),x[n+3]=te(w^E),m=D,y=V,b=$,E=J,n=n+4}return x.buffer}}class fK{constructor(e,n,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=n,this.aesMode=i}expandKey(){const e=hK(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function hK(t){switch(t){case da.cbc:return"AES-CBC";case da.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${t}`)}}const pK=16;class Ib{constructor(e,{removePKCS7Padding:n=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=n,n)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:n}=this;if(!e||n)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?cK(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,n,i,r){return this.useSoftware?new Promise((s,a)=>{const o=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(o,n,i,r);const l=this.flush();l?s(l.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),n,i,r)}softwareDecrypt(e,n,i,r){const{currentIV:s,currentResult:a,remainderData:o}=this;if(r!==da.cbc||n.byteLength!==16)return Ft.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(e=ji(o,e),this.remainderData=null);const l=this.getValidChunk(e);if(!l.length)return null;s&&(i=s);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new dK),u.expandKey(n);const d=a;return this.currentResult=u.decrypt(l.buffer,0,i),this.currentIV=l.slice(-16).buffer,d||null}webCryptoDecrypt(e,n,i,r){if(this.key!==n||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,n,i,r));this.key=n,this.fastAesKey=new fK(this.subtle,n,r)}return this.fastAesKey.expandKey().then(s=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new lK(this.subtle,new Uint8Array(i),r).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(Ft.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,n,i,r)))}onWebCryptoError(e,n,i,r){const s=this.enableSoftwareAES;if(s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,n,i,r);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(s?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let n=e;const i=e.length-e.length%pK;return i!==e.length&&(n=e.slice(0,i),this.remainderData=e.slice(i)),n}logOnce(e){this.logEnabled&&(Ft.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Bw=Math.pow(2,17);class mK{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,n){const i=e.url;if(!i)return Promise.reject(new os({type:it.NETWORK_ERROR,details:pe.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,a=r.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(y=>y[0]==="GAP")){l(Uw(e));return}else e.gap=!1;const u=this.loader=s?new s(r):new a(r),d=Fw(e);e.loader=u;const f=Nw(r.fragLoadPolicy.default),p={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Bw};e.stats=u.stats;const m={onSuccess:(y,b,E,T)=>{this.resetLoader(e,u);let x=y.data;E.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(x.slice(0,16)),x=x.slice(16)),o({frag:e,part:null,payload:x,networkDetails:T})},onError:(y,b,E,T)=>{this.resetLoader(e,u),l(new os({type:it.NETWORK_ERROR,details:pe.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Bt({url:i,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:E,stats:T}))},onAbort:(y,b,E)=>{this.resetLoader(e,u),l(new os({type:it.NETWORK_ERROR,details:pe.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:E,stats:y}))},onTimeout:(y,b,E)=>{this.resetLoader(e,u),l(new os({type:it.NETWORK_ERROR,details:pe.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:E,stats:y}))}};n&&(m.onProgress=(y,b,E,T)=>n({frag:e,part:null,payload:E,networkDetails:T})),u.load(d,p,m)})}loadPart(e,n,i){this.abort();const r=this.config,s=r.fLoader,a=r.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||n.gap){l(Uw(e,n));return}const u=this.loader=s?new s(r):new a(r),d=Fw(e,n);e.loader=u;const f=Nw(r.fragLoadPolicy.default),p={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Bw};n.stats=u.stats,u.load(d,p,{onSuccess:(m,y,b,E)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,n);const T={frag:e,part:n,payload:m.data,networkDetails:E};i(T),o(T)},onError:(m,y,b,E)=>{this.resetLoader(e,u),l(new os({type:it.NETWORK_ERROR,details:pe.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:n,response:Bt({url:d.url,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:b,stats:E}))},onAbort:(m,y,b)=>{e.stats.aborted=n.stats.aborted,this.resetLoader(e,u),l(new os({type:it.NETWORK_ERROR,details:pe.INTERNAL_ABORTED,fatal:!1,frag:e,part:n,error:new Error("Aborted"),networkDetails:b,stats:m}))},onTimeout:(m,y,b)=>{this.resetLoader(e,u),l(new os({type:it.NETWORK_ERROR,details:pe.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:n,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:b,stats:m}))}})})}updateStatsFromPart(e,n){const i=e.stats,r=n.stats,s=r.total;if(i.loaded+=r.loaded,s){const l=Math.round(e.duration/n.duration),u=Math.min(Math.round(i.loaded/s),l),f=(l-u)*Math.round(i.loaded/u);i.total=i.loaded+f}else i.total=Math.max(i.loaded,i.total);const a=i.loading,o=r.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,n){e.loader=null,this.loader===n&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),n.destroy()}}function Fw(t,e=null){const n=e||t,i={frag:t,part:e,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},r=n.byteRangeStartOffset,s=n.byteRangeEndOffset;if(We(r)&&We(s)){var a;let o=r,l=s;if(t.sn==="initSegment"&&gK((a=t.decryptdata)==null?void 0:a.method)){const u=s-r;u%16&&(l=s+(16-u%16)),r!==0&&(i.resetIV=!0,o=r-16)}i.rangeStart=o,i.rangeEnd=l}return i}function Uw(t,e){const n=new Error(`GAP ${t.gap?"tag":"attribute"} found`),i={type:it.MEDIA_ERROR,details:pe.FRAG_GAP,fatal:!1,frag:t,error:n,networkDetails:null};return e&&(i.part=e),(e||t).stats.aborted=!0,new os(i)}function gK(t){return t==="AES-128"||t==="AES-256"}class os extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class _L extends $i{constructor(e,n){super(e,n),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Lb{constructor(e,n,i,r=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Vf(),this.buffering={audio:Vf(),video:Vf(),audiovideo:Vf()},this.level=e,this.sn=n,this.id=i,this.size=r,this.part=s,this.partial=a}}function Vf(){return{start:0,executeStart:0,executeEnd:0,end:0}}const Hw={length:0,start:()=>0,end:()=>0};class pt{static isBuffered(e,n){if(e){const i=pt.getBuffered(e);for(let r=i.length;r--;)if(n>=i.start(r)&&n<=i.end(r))return!0}return!1}static bufferedRanges(e){if(e){const n=pt.getBuffered(e);return pt.timeRangesToArray(n)}return[]}static timeRangesToArray(e){const n=[];for(let i=0;i<e.length;i++)n.push({start:e.start(i),end:e.end(i)});return n}static bufferInfo(e,n,i){if(e){const r=pt.bufferedRanges(e);if(r.length)return pt.bufferedInfo(r,n,i)}return{len:0,start:n,end:n,bufferedIndex:-1}}static bufferedInfo(e,n,i){n=Math.max(0,n),e.length>1&&e.sort((d,f)=>d.start-f.start||f.end-d.end);let r=-1,s=[];if(i)for(let d=0;d<e.length;d++){n>=e[d].start&&n<=e[d].end&&(r=d);const f=s.length;if(f){const p=s[f-1].end;e[d].start-p<i?e[d].end>p&&(s[f-1].end=e[d].end):s.push(e[d])}else s.push(e[d])}else s=e;let a=0,o,l=n,u=n;for(let d=0;d<s.length;d++){const f=s[d].start,p=s[d].end;if(r===-1&&n>=f&&n<=p&&(r=d),n+i>=f&&n<p)l=f,u=p,a=u-n;else if(n+i<f){o=f;break}}return{len:a,start:l||0,end:u||0,nextStart:o,buffered:e,bufferedIndex:r}}static getBuffered(e){try{return e.buffered||Hw}catch(n){return Ft.log("failed to get media.buffered",n),Hw}}}const IL=/\{\$([a-zA-Z0-9-_]+)\}/g;function zw(t){return IL.test(t)}function $y(t,e){if(t.variableList!==null||t.hasVariableRefs){const n=t.variableList;return e.replace(IL,i=>{const r=i.substring(2,i.length-1),s=n==null?void 0:n[r];return s===void 0?(t.playlistParsingError||(t.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),i):s})}return e}function qw(t,e,n){let i=t.variableList;i||(t.variableList=i={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const a=new self.URL(n).searchParams;if(a.has(r))s=a.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${n}"`)}catch(a){t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else r=e.NAME,s=e.VALUE;r in i?t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):i[r]=s||""}function yK(t,e,n){const i=e.IMPORT;if(n&&i in n){let r=t.variableList;r||(t.variableList=r={}),r[i]=n[i]}else t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const vK=/^(\d+)x(\d+)$/,Vw=/(.+?)=(".*?"|.*?)(?:,|$)/g;class sn{constructor(e,n){typeof e=="string"&&(e=sn.parseAttrList(e,n)),Vt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const n=parseInt(this[e],10);return n>Number.MAX_SAFE_INTEGER?1/0:n}hexadecimalInteger(e){if(this[e]){let n=(this[e]||"0x").slice(2);n=(n.length&1?"0":"")+n;const i=new Uint8Array(n.length/2);for(let r=0;r<n.length/2;r++)i[r]=parseInt(n.slice(r*2,r*2+2),16);return i}return null}hexadecimalIntegerAsNumber(e){const n=parseInt(this[e],16);return n>Number.MAX_SAFE_INTEGER?1/0:n}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,n){const i=this[e];return i?parseFloat(i):n}enumeratedString(e){return this[e]}enumeratedStringList(e,n){const i=this[e];return(i?i.split(/[ ,]+/):[]).reduce((r,s)=>(r[s.toLowerCase()]=!0,r),n)}bool(e){return this[e]==="YES"}decimalResolution(e){const n=vK.exec(this[e]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}}static parseAttrList(e,n){let i;const r={};for(Vw.lastIndex=0;(i=Vw.exec(e))!==null;){const a=i[1].trim();let o=i[2];const l=o.indexOf('"')===0&&o.lastIndexOf('"')===o.length-1;let u=!1;if(l)o=o.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(n&&(l||u))o=$y(n,o);else if(!u&&!l)switch(a){case"CLOSED-CAPTIONS":if(o==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Ft.warn(`${e}: attribute ${a} is missing quotes`)}r[a]=o}return r}}const bK="com.apple.hls.interstitial";function EK(t){return t!=="ID"&&t!=="CLASS"&&t!=="CUE"&&t!=="START-DATE"&&t!=="DURATION"&&t!=="END-DATE"&&t!=="END-ON-NEXT"}function TK(t){return t==="SCTE35-OUT"||t==="SCTE35-IN"||t==="SCTE35-CMD"}class LL{constructor(e,n,i=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(n==null?void 0:n.tagAnchor)||null,this.tagOrder=(r=n==null?void 0:n.tagOrder)!=null?r:i,n){const s=n.attr;for(const a in s)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==s[a]){Ft.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=Vt(new sn({}),s,e)}if(this.attr=e,n?(this._startDate=n._startDate,this._cue=n._cue,this._endDate=n._endDate,this._dateAtEnd=n._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const s=(n==null?void 0:n.endDate)||new Date(this.attr["END-DATE"]);We(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Ft.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const n=this.duration;return n!==null?this._dateAtEnd=new Date(this._startDate.getTime()+n*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(We(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===bK}get isValid(){return!!this.id&&!this._badValueForSameId&&We(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const xK=10;class SK{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const n=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!n||!this.live,this.advanced=this.endSN>e.endSN||n>0||n===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(n=>{let i=n.decryptdata;return i||(n.setKeyFormat(e.keyFormat),i=n.decryptdata),!!i&&e.matches(i)})}get hasProgramDateTime(){return this.fragments.length?We(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||xK}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const n=this.lastPartIndex;if(n!==-1){for(let i=e.length;i--;)if(e[i].index>n)return e[i].index;return n}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Db(t,e){return t.length===e.length?!t.some((n,i)=>n!==e[i]):!1}function Gw(t,e){return!t&&!e?!0:!t||!e?!1:Db(t,e)}function Pu(t){return t==="AES-128"||t==="AES-256"||t==="AES-256-CTR"}function Ob(t){switch(t){case"AES-128":case"AES-256":return da.cbc;case"AES-256-CTR":return da.ctr;default:throw new Error(`invalid full segment method ${t}`)}}function Pb(t){return Uint8Array.from(atob(t),e=>e.charCodeAt(0))}function Yy(t){return Uint8Array.from(unescape(encodeURIComponent(t)),e=>e.charCodeAt(0))}function AK(t){const e=Yy(t).subarray(0,16),n=new Uint8Array(16);return n.set(e,16-e.length),n}function DL(t){const e=function(i,r,s){const a=i[r];i[r]=i[s],i[s]=a};e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}function wK(t){const e=t.split(":");let n=null;if(e[0]==="data"&&e.length===2){const i=e[1].split(";"),r=i[i.length-1].split(",");if(r.length===2){const s=r[0]==="base64",a=r[1];s?(i.splice(-1,1),n=Pb(a)):n=AK(a)}}return n}const Gh=typeof self<"u"?self:void 0;var an={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Qn={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function gh(t){switch(t){case Qn.FAIRPLAY:return an.FAIRPLAY;case Qn.PLAYREADY:return an.PLAYREADY;case Qn.WIDEVINE:return an.WIDEVINE;case Qn.CLEARKEY:return an.CLEARKEY}}function S1(t){switch(t){case an.FAIRPLAY:return Qn.FAIRPLAY;case an.PLAYREADY:return Qn.PLAYREADY;case an.WIDEVINE:return Qn.WIDEVINE;case an.CLEARKEY:return Qn.CLEARKEY}}function dc(t){const{drmSystems:e,widevineLicenseUrl:n}=t,i=e?[an.FAIRPLAY,an.WIDEVINE,an.PLAYREADY,an.CLEARKEY].filter(r=>!!e[r]):[];return!i[an.WIDEVINE]&&n&&i.push(an.WIDEVINE),i}const OL=(function(t){return Gh!=null&&(t=Gh.navigator)!=null&&t.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function CK(t,e,n,i){let r;switch(t){case an.FAIRPLAY:r=["cenc","sinf"];break;case an.WIDEVINE:case an.PLAYREADY:r=["cenc"];break;case an.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${t}`)}return RK(r,e,n,i)}function RK(t,e,n,i){return[{initDataTypes:t,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs=${s}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:n.map(s=>({contentType:`video/mp4; codecs=${s}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function _K(t){var e;return!!t&&(t.sessionType==="persistent-license"||!!((e=t.sessionTypes)!=null&&e.some(n=>n==="persistent-license")))}function IK(t){const e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),n=String.fromCharCode.apply(null,Array.from(e)),i=n.substring(n.indexOf("<"),n.length),a=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(a){const o=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(o){const l=Pb(o).subarray(0,16);return DL(l),l}}return null}let Gf={};class Uc{static clearKeyUriToKeyIdMap(){Gf={}}static setKeyIdForUri(e,n){Gf[e]=n}constructor(e,n,i,r=[1],s=null,a){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=n,this.keyFormat=i,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Pu(e),a!=null&&a.startsWith("0x")&&(this.keyId=new Uint8Array(lL(a)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Db(e.keyFormatVersions,this.keyFormatVersions)&&Gw(e.iv,this.iv)&&Gw(e.keyId,this.keyId)}isSupported(){if(this.method){if(Pu(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Qn.FAIRPLAY:case Qn.WIDEVINE:case Qn.PLAYREADY:case Qn.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(Pu(this.method)){let r=this.iv;return r||(typeof e!="number"&&(Ft.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),r=LK(e)),new Uc(this.method,this.uri,"identity",this.keyFormatVersions,r)}if(this.pssh&&this.keyId)return this;const n=wK(this.uri);if(n)switch(this.keyFormat){case Qn.WIDEVINE:if(this.pssh=n,!this.keyId){const r=OY(n.buffer);if(r.length){var i;const s=r[0];this.keyId=(i=s.kids)!=null&&i.length?s.kids[0]:null}}if(!this.keyId){const r=n.length-22;this.keyId=n.subarray(r,r+16)}break;case Qn.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=DY(r,null,n),this.keyId=IK(n);break}default:{let r=n.subarray(0,16);if(r.length!==16){const s=new Uint8Array(16);s.set(r,16-r.length),r=s}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=Gf[this.uri];if(!r){const s=Object.keys(Gf).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,s),Uc.setKeyIdForUri(this.uri,r)}this.keyId=r}return this}}function LK(t){const e=new Uint8Array(16);for(let n=12;n<16;n++)e[n]=t>>8*(15-n)&255;return e}const jw=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ww=/#EXT-X-MEDIA:(.*)/g,DK=/^#EXT(?:INF|-X-TARGETDURATION):/m,A1=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),OK=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Cr{static findGroup(e,n){for(let i=0;i<e.length;i++){const r=e[i];if(r.id===n)return r}}static resolve(e,n){return Sb.buildAbsoluteURL(n,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return DK.test(e)}static parseMasterPlaylist(e,n){const i=zw(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},s=[];if(jw.lastIndex=0,!e.startsWith("#EXTM3U"))return r.playlistParsingError=new Error("no EXTM3U delimiter"),r;let a;for(;(a=jw.exec(e))!=null;)if(a[1]){var o;const u=new sn(a[1],r),d=$y(r,a[2]),f={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:Cr.resolve(d,n)},p=u.decimalResolution("RESOLUTION");p&&(f.width=p.width,f.height=p.height),Kw(u.CODECS,f);const m=u["SUPPLEMENTAL-CODECS"];m&&(f.supplemental={},Kw(m,f.supplemental)),(o=f.unknownCodecs)!=null&&o.length||s.push(f),r.levels.push(f)}else if(a[3]){const u=a[3],d=a[4];switch(u){case"SESSION-DATA":{const f=new sn(d,r),p=f["DATA-ID"];p&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[p]=f);break}case"SESSION-KEY":{const f=$w(d,n,r);f.encrypted&&f.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(f)):Ft.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${d}"`);break}case"DEFINE":{{const f=new sn(d,r);qw(r,f,n)}break}case"CONTENT-STEERING":{const f=new sn(d,r);r.contentSteering={uri:Cr.resolve(f["SERVER-URI"],n),pathwayId:f["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=Yw(d);break}}}const l=s.length>0&&s.length<r.levels.length;return r.levels=l?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,n,i){let r;const s={},a=i.levels,o={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(Ww.lastIndex=0;(r=Ww.exec(e))!==null;){const u=new sn(r[1],i),d=u.TYPE;if(d){const f=o[d],p=s[d]||[];s[d]=p;const m=u.LANGUAGE,y=u["ASSOC-LANGUAGE"],b=u.CHANNELS,E=u.CHARACTERISTICS,T=u["INSTREAM-ID"],x={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||m||"",type:d,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:m,url:u.URI?Cr.resolve(u.URI,n):""};if(y&&(x.assocLang=y),b&&(x.channels=b),E&&(x.characteristics=E),T&&(x.instreamId=T),f!=null&&f.length){const S=Cr.findGroup(f,x.groupId)||f[0];Xw(x,S,"audioCodec"),Xw(x,S,"textCodec")}p.push(x)}}return s}static parseLevelPlaylist(e,n,i,r,s,a){var o;const l={url:n},u=new SK(n),d=u.fragments,f=[];let p=null,m=0,y=0,b=0,E=0,T=0,x=null,S=new E1(r,l),w,C,I,L=-1,N=!1,G=null,O;if(A1.lastIndex=0,u.m3u8=e,u.hasVariableRefs=zw(e),((o=A1.exec(e))==null?void 0:o[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(w=A1.exec(e))!==null;){N&&(N=!1,S=new E1(r,l),S.playlistOffset=b,S.setStart(b),S.sn=m,S.cc=E,T&&(S.bitrate=T),S.level=i,p&&(S.initSegment=p,p.rawProgramDateTime&&(S.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null),G&&(S.setByteRange(G),G=null)));const J=w[1];if(J){S.duration=parseFloat(J);const K=(" "+w[2]).slice(1);S.title=K||null,S.tagList.push(K?["INF",J,K]:["INF",J])}else if(w[3]){if(We(S.duration)){S.playlistOffset=b,S.setStart(b),I&&Zw(S,I,u),S.sn=m,S.level=i,S.cc=E,d.push(S);const K=(" "+w[3]).slice(1);S.relurl=$y(u,K),Ky(S,x,f),x=S,b+=S.duration,m++,y=0,N=!0}}else{if(w=w[0].match(OK),!w){Ft.warn("No matches on slow regex match for level playlist!");continue}for(C=1;C<w.length&&w[C]===void 0;C++);const K=(" "+w[C]).slice(1),j=(" "+w[C+1]).slice(1),te=w[C+2]?(" "+w[C+2]).slice(1):null;switch(K){case"BYTERANGE":x?S.setByteRange(j,x):S.setByteRange(j);break;case"PROGRAM-DATE-TIME":S.rawProgramDateTime=j,S.tagList.push(["PROGRAM-DATE-TIME",j]),L===-1&&(L=d.length);break;case"PLAYLIST-TYPE":u.type&&rs(u,K,w),u.type=j.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?rs(u,K,w):d.length>0&&Jw(u,K,w),m=u.startSN=parseInt(j);break;case"SKIP":{u.skippedSegments&&rs(u,K,w);const ne=new sn(j,u),oe=ne.decimalInteger("SKIPPED-SEGMENTS");if(We(oe)){u.skippedSegments+=oe;for(let ie=oe;ie--;)d.push(null);m+=oe}const P=ne.enumeratedString("RECENTLY-REMOVED-DATERANGES");P&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(P.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&rs(u,K,w),u.targetduration=Math.max(parseInt(j),1);break;case"VERSION":u.version!==null&&rs(u,K,w),u.version=parseInt(j);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||rs(u,K,w),u.live=!1;break;case"#":(j||te)&&S.tagList.push(te?[j,te]:[j]);break;case"DISCONTINUITY":E++,S.tagList.push(["DIS"]);break;case"GAP":S.gap=!0,S.tagList.push([K]);break;case"BITRATE":S.tagList.push([K,j]),T=parseInt(j)*1e3,We(T)?S.bitrate=T:T=0;break;case"DATERANGE":{const ne=new sn(j,u),oe=new LL(ne,u.dateRanges[ne.ID],u.dateRangeTagCount);u.dateRangeTagCount++,oe.isValid||u.skippedSegments?u.dateRanges[oe.id]=oe:Ft.warn(`Ignoring invalid DATERANGE tag: "${j}"`),S.tagList.push(["EXT-X-DATERANGE",j]);break}case"DEFINE":{{const ne=new sn(j,u);"IMPORT"in ne?yK(u,ne,a):qw(u,ne,n)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?rs(u,K,w):d.length>0&&Jw(u,K,w),u.startCC=E=parseInt(j);break;case"KEY":{const ne=$w(j,n,u);if(ne.isSupported()){if(ne.method==="NONE"){I=void 0;break}I||(I={});const oe=I[ne.keyFormat];oe!=null&&oe.matches(ne)||(oe&&(I=Vt({},I)),I[ne.keyFormat]=ne)}else Ft.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${j}"`);break}case"START":u.startTimeOffset=Yw(j);break;case"MAP":{const ne=new sn(j,u);if(S.duration){const oe=new E1(r,l);Qw(oe,ne,i,I),p=oe,S.initSegment=p,p.rawProgramDateTime&&!S.rawProgramDateTime&&(S.rawProgramDateTime=p.rawProgramDateTime)}else{const oe=S.byteRangeEndOffset;if(oe){const P=S.byteRangeStartOffset;G=`${oe-P}@${P}`}else G=null;Qw(S,ne,i,I),p=S,N=!0}p.cc=E;break}case"SERVER-CONTROL":{O&&rs(u,K,w),O=new sn(j),u.canBlockReload=O.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=O.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&O.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=O.optionalFloat("PART-HOLD-BACK",0),u.holdBack=O.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&rs(u,K,w);const ne=new sn(j);u.partTarget=ne.decimalFloatingPoint("PART-TARGET");break}case"PART":{let ne=u.partList;ne||(ne=u.partList=[]);const oe=y>0?ne[ne.length-1]:void 0,P=y++,ie=new sn(j,u),le=new vY(ie,S,l,P,oe);ne.push(le),S.duration+=le.duration;break}case"PRELOAD-HINT":{const ne=new sn(j,u);u.preloadHint=ne;break}case"RENDITION-REPORT":{const ne=new sn(j,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(ne);break}default:Ft.warn(`line parsed but not handled: ${w}`);break}}}x&&!x.relurl?(d.pop(),b-=x.duration,u.partList&&(u.fragmentHint=x)):u.partList&&(Ky(S,x,f),S.cc=E,u.fragmentHint=S,I&&Zw(S,I,u)),u.targetduration||(u.playlistParsingError=new Error("Missing Target Duration"));const D=d.length,V=d[0],$=d[D-1];if(b+=u.skippedSegments*u.targetduration,b>0&&D&&$){u.averagetargetduration=b/D;const J=$.sn;u.endSN=J!=="initSegment"?J:0,u.live||($.endList=!0),L>0&&(kK(d,L),V&&f.unshift(V))}return u.fragmentHint&&(b+=u.fragmentHint.duration),u.totalduration=b,f.length&&u.dateRangeTagCount&&V&&PL(f,u),u.endCC=E,u}}function PL(t,e){let n=t.length;if(!n)if(e.hasProgramDateTime){const o=e.fragments[e.fragments.length-1];t.push(o),n++}else return;const i=t[n-1],r=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let o=s.length;o--;){const l=e.dateRanges[s[o]],u=l.startDate.getTime();l.tagAnchor=i.ref;for(let d=n;d--;){var a;if(((a=t[d])==null?void 0:a.sn)<e.startSN)break;const f=PK(e,u,t,d,r);if(f!==-1){l.tagAnchor=e.fragments[f].ref;break}}}}function PK(t,e,n,i,r){const s=n[i];if(s){const o=s.programDateTime;if(e>=o||i===0){var a;const l=(((a=n[i+1])==null?void 0:a.start)||r)-s.start;if(e<=o+l*1e3){const u=n[i].sn-t.startSN;if(u<0)return-1;const d=t.fragments;if(d.length>n.length){const p=(n[i+1]||d[d.length-1]).sn-t.startSN;for(let m=p;m>u;m--){const y=d[m].programDateTime;if(e>=y&&e<y+d[m].duration*1e3)return m}}return u}}}return-1}function $w(t,e,n){var i,r;const s=new sn(t,n),a=(i=s.METHOD)!=null?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,d=(r=s.KEYFORMAT)!=null?r:"identity";o&&s.IV&&!l&&Ft.error(`Invalid IV: ${s.IV}`);const f=o?Cr.resolve(o,e):"",p=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Uc(a,f,d,p,l,s.KEYID)}function Yw(t){const n=new sn(t).decimalFloatingPoint("TIME-OFFSET");return We(n)?n:null}function Kw(t,e){let n=(t||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const r=n.filter(s=>Cb(s,i));r.length&&(e[`${i}Codec`]=r.map(s=>s.split("/")[0]).join(","),n=n.filter(s=>r.indexOf(s)===-1))}),e.unknownCodecs=n}function Xw(t,e,n){const i=e[n];i&&(t[n]=i)}function kK(t,e){let n=t[e];for(let i=e;i--;){const r=t[i];if(!r)return;r.programDateTime=n.programDateTime-r.duration*1e3,n=r}}function Ky(t,e,n){t.rawProgramDateTime?n.push(t):e!=null&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime)}function Qw(t,e,n,i){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=n,t.sn="initSegment",i&&(t.levelkeys=i),t.initSegment=null}function Zw(t,e,n){t.levelkeys=e;const{encryptedFragments:i}=n;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&i.push(t)}function rs(t,e,n){t.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${n[0]})`)}function Jw(t,e,n){t.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${n[0]})`)}function w1(t,e){const n=e.startPTS;if(We(n)){let i=0,r;e.sn>t.sn?(i=n-t.start,r=t):(i=t.start-n,r=e),r.duration!==i&&r.setDuration(i)}else e.sn>t.sn?t.cc===e.cc&&t.minEndPTS?e.setStart(t.start+(t.minEndPTS-t.start)):e.setStart(t.start+t.duration):e.setStart(Math.max(t.start-e.duration,0))}function kL(t,e,n,i,r,s,a){i-n<=0&&(a.warn("Fragment should have a positive duration",e),i=n+e.duration,s=r+e.duration);let l=n,u=i;const d=e.startPTS,f=e.endPTS;if(We(d)){const T=Math.abs(d-n);t&&T>t.totalduration?a.warn(`media timestamps and playlist times differ by ${T}s for level ${e.level} ${t.url}`):We(e.deltaPTS)?e.deltaPTS=Math.max(T,e.deltaPTS):e.deltaPTS=T,l=Math.max(n,d),n=Math.min(n,d),r=e.startDTS!==void 0?Math.min(r,e.startDTS):r,u=Math.min(i,f),i=Math.max(i,f),s=e.endDTS!==void 0?Math.max(s,e.endDTS):s}const p=n-e.start;e.start!==0&&e.setStart(n),e.setDuration(i-e.start),e.startPTS=n,e.maxStartPTS=l,e.startDTS=r,e.endPTS=i,e.minEndPTS=u,e.endDTS=s;const m=e.sn;if(!t||m<t.startSN||m>t.endSN)return 0;let y;const b=m-t.startSN,E=t.fragments;for(E[b]=e,y=b;y>0;y--)w1(E[y],E[y-1]);for(y=b;y<E.length-1;y++)w1(E[y],E[y+1]);return t.fragmentHint&&w1(E[E.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,p}function NK(t,e,n){if(t===e)return;let i=null;const r=t.fragments;for(let d=r.length-1;d>=0;d--){const f=r[d].initSegment;if(f){i=f;break}}t.fragmentHint&&delete t.fragmentHint.endPTS;let s;FK(t,e,(d,f,p,m)=>{if((!e.startCC||e.skippedSegments)&&f.cc!==d.cc){const y=d.cc-f.cc;for(let b=p;b<m.length;b++)m[b].cc+=y;e.endCC=m[m.length-1].cc}We(d.startPTS)&&We(d.endPTS)&&(f.setStart(f.startPTS=d.startPTS),f.startDTS=d.startDTS,f.maxStartPTS=d.maxStartPTS,f.endPTS=d.endPTS,f.endDTS=d.endDTS,f.minEndPTS=d.minEndPTS,f.setDuration(d.endPTS-d.startPTS),f.duration&&(s=f),e.PTSKnown=e.alignedSliding=!0),d.hasStreams&&(f.elementaryStreams=d.elementaryStreams),f.loader=d.loader,d.hasStats&&(f.stats=d.stats),d.initSegment&&(f.initSegment=d.initSegment,i=d.initSegment)});const a=e.fragments,o=e.fragmentHint?a.concat(e.fragmentHint):a;if(i&&o.forEach(d=>{var f;d&&(!d.initSegment||d.initSegment.relurl===((f=i)==null?void 0:f.relurl))&&(d.initSegment=i)}),e.skippedSegments){if(e.deltaUpdateFailed=a.some(d=>!d),e.deltaUpdateFailed){n.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let d=e.skippedSegments;d--;)a.shift();e.startSN=a[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=MK(t.dateRanges,e,n));const d=t.fragments.filter(f=>f.rawProgramDateTime);if(t.hasProgramDateTime&&!e.hasProgramDateTime)for(let f=1;f<o.length;f++)o[f].programDateTime===null&&Ky(o[f],o[f-1],d);PL(d,e)}e.endCC=a[a.length-1].cc}if(!e.startCC){var l;const d=BL(t,e.startSN-1);e.startCC=(l=d==null?void 0:d.cc)!=null?l:a[0].cc}BK(t.partList,e.partList,(d,f)=>{f.elementaryStreams=d.elementaryStreams,f.stats=d.stats}),s?kL(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS,n):NL(t,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;const u=e.advancedDateTime;if(e.advanced&&u){const d=e.edge;e.driftStart||(e.driftStartTime=u,e.driftStart=d),e.driftEndTime=u,e.driftEnd=d}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=t.requestScheduled)}function MK(t,e,n){const{dateRanges:i,recentlyRemovedDateranges:r}=e,s=Vt({},t);r&&r.forEach(l=>{delete s[l]});const o=Object.keys(s).length;return o?(Object.keys(i).forEach(l=>{const u=s[l],d=new LL(i[l].attr,u);d.isValid?(s[l]=d,u||(d.tagOrder+=o)):n.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Wt(i[l].attr)}"`)}),s):i}function BK(t,e,n){if(t&&e){let i=0;for(let r=0,s=t.length;r<=s;r++){const a=t[r],o=e[r+i];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?n(a,o):i--}}}function FK(t,e,n){const i=e.skippedSegments,r=Math.max(t.startSN,e.startSN)-e.startSN,s=(t.fragmentHint?1:0)+(i?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,a=e.startSN-t.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;for(let u=r;u<=s;u++){const d=l[a+u];let f=o[u];if(i&&!f&&d&&(f=e.fragments[u]=d),d&&f){n(d,f,u,o);const p=d.relurl,m=f.relurl;if(p&&UK(p,m)){e.playlistParsingError=eC(`media sequence mismatch ${f.sn}:`,t,e,d,f);return}else if(d.cc!==f.cc){e.playlistParsingError=eC(`discontinuity sequence mismatch (${d.cc}!=${f.cc})`,t,e,d,f);return}}}}function eC(t,e,n,i,r){return new Error(`${t} ${r.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${n.startSN}
${n.m3u8}`)}function NL(t,e,n=!0){const i=e.startSN+e.skippedSegments-t.startSN,r=t.fragments,s=i>=0;let a=0;if(s&&i<r.length)a=r[i].start;else if(s&&e.startSN===t.endSN+1)a=t.fragmentEnd;else if(s&&n)a=t.fragmentStart+i*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=t.fragmentStart;else return;Xy(e,a)}function Xy(t,e){if(e){const n=t.fragments;for(let i=t.skippedSegments;i<n.length;i++)n[i].addStart(e);t.fragmentHint&&t.fragmentHint.addStart(e)}}function ML(t,e=1/0){let n=1e3*t.targetduration;if(t.updated){const i=t.fragments;if(i.length&&n*4>e){const s=i[i.length-1].duration*1e3;s<n&&(n=s)}}else n/=2;return Math.round(n)}function BL(t,e,n){if(!t)return null;let i=t.fragments[e-t.startSN];return i||(i=t.fragmentHint,i&&i.sn===e)?i:e<t.startSN&&n&&n.sn===e?n:null}function tC(t,e,n){return t?FL(t.partList,e,n):null}function FL(t,e,n){if(t)for(let i=t.length;i--;){const r=t[i];if(r.index===n&&r.fragment.sn===e)return r}return null}function UL(t){t.forEach((e,n)=>{var i;(i=e.details)==null||i.fragments.forEach(r=>{r.level=n,r.initSegment&&(r.initSegment.level=n)})})}function UK(t,e){return t!==e&&e?nC(t)!==nC(e):!1}function nC(t){return t.replace(/\?[^?]*$/,"")}function Cc(t,e){for(let i=0,r=t.length;i<r;i++){var n;if(((n=t[i])==null?void 0:n.cc)===e)return t[i]}return null}function HK(t,e){return!!(t&&e.startCC<t.endCC&&e.endCC>t.startCC)}function iC(t,e){const n=t.start+e;t.startPTS=n,t.setStart(n),t.endPTS=n+t.duration}function HL(t,e){const n=e.fragments;for(let i=0,r=n.length;i<r;i++)iC(n[i],t);e.fragmentHint&&iC(e.fragmentHint,t),e.alignedSliding=!0}function zK(t,e){t&&(zL(e,t),e.alignedSliding||jh(e,t),!e.alignedSliding&&!e.skippedSegments&&NL(t,e,!1))}function zL(t,e){if(!HK(e,t))return;const n=Math.min(e.endCC,t.endCC),i=Cc(e.fragments,n),r=Cc(t.fragments,n);if(!i||!r)return;Ft.log(`Aligning playlist at start of dicontinuity sequence ${n}`);const s=i.start-r.start;HL(s,t)}function jh(t,e){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;const n=t.fragments,i=e.fragments;if(!n.length||!i.length)return;let r,s;const a=Math.min(e.endCC,t.endCC);e.startCC<a&&t.startCC<a&&(r=Cc(i,a),s=Cc(n,a)),(!r||!s)&&(r=i[Math.floor(i.length/2)],s=Cc(n,r.cc)||n[Math.floor(n.length/2)]);const o=r.programDateTime,l=s.programDateTime;if(!o||!l)return;const u=(l-o)/1e3-(s.start-r.start);HL(u,t)}function Jn(t,e,n){ci(t,e,n),t.addEventListener(e,n)}function ci(t,e,n){t.removeEventListener(e,n)}const qK={toString:function(t){let e="";const n=t.length;for(let i=0;i<n;i++)e+=`[${t.start(i).toFixed(3)}-${t.end(i).toFixed(3)}]`;return e}},_e={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class kb extends _L{constructor(e,n,i,r,s){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=_e.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:o,media:l,mediaBuffer:u,state:d}=this,f=l?l.currentTime:0,p=pt.bufferInfo(u||l,f,a.maxBufferHole),m=!p.len;if(this.log(`Media seeking to ${We(f)?f.toFixed(3):f}, state: ${d}, ${m?"out of":"in"} buffer`),this.state===_e.ENDED)this.resetLoadingState();else if(o){const y=a.maxFragLookUpTolerance,b=o.start-y,E=o.start+o.duration+y;if(m||E<p.start||b>p.end){const T=f>E;(f<b||T)&&(T&&o.loader&&(this.log(`Cancelling fragment load for seek (sn: ${o.sn})`),o.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l){this.fragmentTracker.removeFragmentsInRange(f,1/0,this.playlistType,!0);const y=this.lastCurrentTime;if(f>y&&(this.lastCurrentTime=f),!this.loadingParts){const b=Math.max(p.end,f),E=this.shouldLoadParts(this.getLevelDetails(),b);E&&(this.log(`LL-Part loading ON after seeking to ${f.toFixed(2)} with buffer @${b.toFixed(2)}`),this.loadingParts=E)}}this.hls.hasEnoughToStart||(this.log(`Setting ${m?"startPosition":"nextLoadPosition"} to ${f} for seek without enough to start`),this.nextLoadPosition=f,m&&(this.startPosition=f)),m&&this.state===_e.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=e,this.fragmentLoader=new mK(e.config),this.keyLoader=i,this.fragmentTracker=n,this.config=e.config,this.decrypter=new Ib(e.config)}registerListeners(){const{hls:e}=this;e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(M.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===_e.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=_e.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:n}=this;return n===-1&&e?e:n}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,n){if(n.live||!this.media)return!1;const i=e.end||0,r=this.config.timelineOffset||0;if(i<=r)return!1;const s=e.buffered;this.config.maxBufferHole&&s&&s.length>1&&(e=pt.bufferedInfo(s,e.start,0));const a=e.nextStart;if(a&&a>r&&a<n.edge||this.media.currentTime<e.start)return!1;const l=n.partList;if(l!=null&&l.length){const d=l[l.length-1];return pt.isBuffered(this.media,d.start+d.duration/2)}const u=n.fragments[n.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(u)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var n;return((n=this.getLevelDetails())==null?void 0:n.appliedTimelineOffset)||e}return 0}onMediaAttached(e,n){const i=this.media=this.mediaBuffer=n.media;Jn(i,"seeking",this.onMediaSeeking),Jn(i,"ended",this.onMediaEnded);const r=this.config;this.levels&&r.autoStartLoad&&this.state===_e.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(e,n){const i=!!n.transferMedia,r=this.media;if(r!==null){if(r.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),ci(r,"seeking",this.onMediaSeeking),ci(r,"ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,n){}onManifestLoaded(e,n){this.startTimeOffset=n.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=_e.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,n,i){this.startFragRequested=!0,this._loadFragForPlayback(e,n,i)}_loadFragForPlayback(e,n,i){const r=s=>{const a=s.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${s.part?" part: "+s.part.index:""} of ${this.fragInfo(a,!1,s.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,n,i,r).then(s=>{if(!s)return;const a=this.state,o=s.frag;if(this.fragContextChanged(o)){(a===_e.FRAG_LOADING||!this.fragCurrent&&a===_e.PARSING)&&(this.fragmentTracker.removeFragment(o),this.state=_e.IDLE);return}"payload"in s&&(this.log(`Loaded ${o.type} sn: ${o.sn} of ${this.playlistLabel()} ${o.level}`),this.hls.trigger(M.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===_e.STOPPED||this.state===_e.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var n;const{fragmentTracker:i}=this;if(i.getState(e)===wn.APPENDING){const s=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(o,e.duration))&&i.removeFragment(e)}else((n=this.mediaBuffer)==null?void 0:n.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===wn.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const n=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:n,part:null,stats:n.stats,id:n.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const n=e.details;return(n==null?void 0:n.live)&&n.type!=="EVENT"&&(this.levelLastLoaded!==e||n.expired)}flushMainBuffer(e,n,i=null){if(!(e-n))return;const r={startOffset:e,endOffset:n,type:i};this.hls.trigger(M.BUFFER_FLUSHING,r)}_loadInitSegment(e,n){this._doFragLoad(e,n).then(i=>{const r=i==null?void 0:i.frag;if(!r||this.fragContextChanged(r)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:r}=this,{frag:s,payload:a}=i,o=s.decryptdata;if(a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&Pu(o.method)){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer,Ob(o.method)).catch(u=>{throw r.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:s}),u}).then(u=>{const d=self.performance.now();return r.trigger(M.FRAG_DECRYPTED,{frag:s,payload:u,stats:{tstart:l,tdecrypt:d}}),i.payload=u,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===_e.STOPPED||this.state===_e.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:n}=this;if(!n)throw new Error("init load aborted, missing levels");const i=e.frag.stats;this.state!==_e.STOPPED&&(this.state=_e.IDLE),e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,n){var i,r;const s=e.tracks;if(s&&!n.encrypted&&((i=s.audio)!=null&&i.encrypted||(r=s.video)!=null&&r.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const a=this.media,o=new Error(`Encrypted track with no key in ${this.fragInfo(n)} (media ${a?"attached mediaKeys: "+a.mediaKeys:"detached"})`);return this.warn(o.message),!a||a.mediaKeys?!1:(this.hls.trigger(M.ERROR,{type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_NO_KEYS,fatal:!1,error:o,frag:n}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:n}=this;return!e||!n||e.sn!==n.sn||e.level!==n.level}fragBufferedComplete(e,n){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${n?" part: "+n.index:""} of ${this.fragInfo(e,!1,n)} > buffer:${i?qK.toString(pt.getBuffered(i)):"(detached)"})`),bn(e)){var r;if(e.type!==Xe.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(o=>!!a[o])){this.state=_e.IDLE;return}}const s=(r=this.levels)==null?void 0:r[e.level];s!=null&&s.fragmentError&&(this.log(`Resetting level fragment error count of ${s.fragmentError} on frag buffered`),s.fragmentError=0)}this.state=_e.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:n}=this;if(!n)return;const{frag:i,part:r,partsLoaded:s}=e,a=!s||s.length===0||s.some(l=>!l),o=new Lb(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!a);n.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,n,i=null,r){var s;this.fragCurrent=e;const a=n.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)){if(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=_e.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(p=>{if(!this.fragContextChanged(p.frag))return this.hls.trigger(M.KEY_LOADED,p),this.state===_e.KEY_LOADING&&(this.state=_e.IDLE),p}),this.hls.trigger(M.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(o=this.keyLoader.loadClear(e,a.encryptedFragments,this.startFragRequested),o&&this.log("[eme] blocking frag load until media-keys acquired"));const l=this.fragPrevious;if(bn(e)&&(!l||e.sn!==l.sn)){const p=this.shouldLoadParts(n.details,e.end);p!==this.loadingParts&&(this.log(`LL-Part loading ${p?"ON":"OFF"} loading sn ${l==null?void 0:l.sn}->${e.sn}`),this.loadingParts=p)}if(i=Math.max(e.start,i||0),this.loadingParts&&bn(e)){const p=a.partList;if(p&&r){i>a.fragmentEnd&&a.fragmentHint&&(e=a.fragmentHint);const m=this.getNextPart(p,e,i);if(m>-1){const y=p[m];e=this.fragCurrent=y.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${y.index} (${m}/${p.length-1}) of ${this.fragInfo(e,!1,y)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=_e.FRAG_LOADING;let b;return o?b=o.then(E=>!E||this.fragContextChanged(E.frag)?null:this.doFragPartsLoad(e,y,n,r)).catch(E=>this.handleFragLoadError(E)):b=this.doFragPartsLoad(e,y,n,r).catch(E=>this.handleFragLoadError(E)),this.hls.trigger(M.FRAG_LOADING,{frag:e,part:y,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):b}else if(!e.url||this.loadedEndOfParts(p,i))return Promise.resolve(null)}}if(bn(e)&&this.loadingParts){var u;this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(u=a.partList)==null?void 0:u.filter(p=>p.loaded).map(p=>`[${p.start}-${p.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+a.startSN+"-"+a.endSN+"]"}, target: ${parseFloat(i.toFixed(3))}`),We(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=_e.FRAG_LOADING;const d=this.config.progressive;let f;return d&&o?f=o.then(p=>!p||this.fragContextChanged(p.frag)?null:this.fragmentLoader.load(e,r)).catch(p=>this.handleFragLoadError(p)):f=Promise.all([this.fragmentLoader.load(e,d?r:void 0),o]).then(([p])=>(!d&&r&&r(p),p)).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(M.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):f}doFragPartsLoad(e,n,i,r){return new Promise((s,a)=>{var o;const l=[],u=(o=i.details)==null?void 0:o.partList,d=f=>{this.fragmentLoader.loadPart(e,f,r).then(p=>{l[f.index]=p;const m=p.part;this.hls.trigger(M.FRAG_LOADED,p);const y=tC(i.details,e.sn,f.index+1)||FL(u,e.sn,f.index+1);if(y)d(y);else return s({frag:e,part:m,partsLoaded:l})}).catch(a)};d(n)})}handleFragLoadError(e){if("data"in e){const n=e.data;n.frag&&n.details===pe.INTERNAL_ABORTED?this.handleFragLoadAborted(n.frag,n.part):n.frag&&n.type===it.KEY_SYSTEM_ERROR?(n.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(n.frag)):this.hls.trigger(M.ERROR,n)}else this.hls.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const n=this.getCurrentContext(e);if(!n||this.state!==_e.PARSING){!this.fragCurrent&&this.state!==_e.STOPPED&&this.state!==_e.ERROR&&(this.state=_e.IDLE);return}const{frag:i,part:r,level:s}=n,a=self.performance.now();i.stats.parsing.end=a,r&&(r.stats.parsing.end=a);const o=this.getLevelDetails(),u=o&&i.sn>o.endSN||this.shouldLoadParts(o,i.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(i,r,s,e.partial)}shouldLoadParts(e,n){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var i;const s=e.partList[0];if(s.fragment.type===Xe.SUBTITLE)return!1;const a=s.end+(((i=e.fragmentHint)==null?void 0:i.duration)||0);if(n>=a){var r;if((this.hls.hasEnoughToStart?((r=this.media)==null?void 0:r.currentTime)||this.lastCurrentTime:this.getLoadPosition())>s.start-s.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:n,fragCurrent:i}=this,{level:r,sn:s,part:a}=e;if(!(n!=null&&n[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of ${this.playlistLabel()} ${r}. The current chunk will not be buffered.`),null;const o=n[r],l=o.details,u=a>-1?tC(l,s,a):null,d=u?u.fragment:BL(l,s,i);return d?(i&&i!==d&&(d.stats=i.stats),{frag:d,part:u,level:o}):null}bufferFragmentData(e,n,i,r,s){if(this.state!==_e.PARSING)return;const{data1:a,data2:o}=e;let l=a;if(o&&(l=ji(a,o)),!l.length)return;const u=this.initPTS[n.cc],d=u?-u.baseTime/u.timescale:void 0,f={type:e.type,frag:n,part:i,chunkMeta:r,offset:d,parent:n.type,data:l};if(this.hls.trigger(M.BUFFER_APPENDING,f),e.dropped&&e.independent&&!i){if(s)return;this.flushBufferGap(n)}}flushBufferGap(e){const n=this.media;if(!n)return;if(!pt.isBuffered(n,n.currentTime)){this.flushMainBuffer(0,e.start);return}const i=n.currentTime,r=pt.bufferInfo(n,i,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,r.end-a),i+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,n){var i;const r=this.getLoadPosition();if(!We(r))return null;const a=this.lastCurrentTime>r||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,n,a)}getFwdBufferInfoAtPos(e,n,i,r){const s=pt.bufferInfo(e,n,r);if(s.len===0&&s.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(n,i);if(a&&(s.nextStart<=a.end||a.gap)){const o=Math.max(Math.min(s.nextStart,a.end)-n,r);return pt.bufferInfo(e,n,o)}}return s}getMaxBufferLength(e){const{config:n}=this;let i;return e?i=Math.max(8*n.maxBufferSize/e,n.maxBufferLength):i=n.maxBufferLength,Math.min(i,n.maxMaxBufferLength)}reduceMaxBufferLength(e,n){const i=this.config,r=Math.max(Math.min(e-n,i.maxBufferLength),n),s=Math.max(e-n*3,i.maxMaxBufferLength/2,r);return s>=r?(i.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,n=Xe.MAIN){const i=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,n):null;return i&&"fragment"in i?i.fragment:i}getNextFragment(e,n){const i=n.fragments,r=i.length;if(!r)return null;const{config:s}=this,a=i[0].start,o=s.lowLatencyMode&&!!n.partList;let l=null;if(n.live){const f=s.initialLiveManifestSize;if(r<f)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${f})`),null;if(!n.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var u;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(n);const p=this.hls.startPosition,m=this.hls.liveSyncPosition,y=l?(p!==-1&&p>=a?p:m)||l.start:e;this.log(`Setting startPosition to ${y} to match start frag at live edge. mainStart: ${p} liveSyncPosition: ${m} frag.start: ${(u=l)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=y}}else e<=a&&(l=i[0]);if(!l){const f=this.loadingParts?n.partEnd:n.fragmentEnd;l=this.getFragmentAtPosition(e,f,n)}let d=this.filterReplacedPrimary(l,n);if(!d&&l){const f=l.sn-n.startSN;d=this.filterReplacedPrimary(i[f+1]||null,n)}return this.mapToInitFragWhenRequired(d)}isLoopLoading(e,n){const i=this.fragmentTracker.getState(e);return(i===wn.OK||i===wn.PARTIAL&&!!e.gap)&&this.nextLoadPosition>n}getNextFragmentLoopLoading(e,n,i,r,s){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,n),a&&!a.gap&&i.nextStart)){const o=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,r,0);if(o!==null&&i.len+o.len>=s){const l=a.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(rC(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,n){if(!e)return e;if(rC(this.config)&&e.type!==Xe.SUBTITLE){const i=this.hls.interstitialsManager,r=i==null?void 0:i.bufferingItem;if(r){const a=r.event;if(a){if(a.appendInPlace||Math.abs(e.start-r.start)>1||r.start===0)return null}else if(e.end<=r.start&&(n==null?void 0:n.live)===!1||e.start>r.end&&r.nextEvent&&(r.nextEvent.appendInPlace||e.start-r.end>1))return null}const s=i==null?void 0:i.playerQueue;if(s)for(let a=s.length;a--;){const o=s[a].interstitial;if(o.appendInPlace&&e.start>=o.startTime&&e.end<=o.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,n,i){let r=-1,s=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const u=e[o];if(a=a&&!u.independent,r>-1&&i<u.start)break;const d=u.loaded;d?r=-1:(s||(u.independent||a)&&u.fragment===n)&&(u.fragment!==n&&this.warn(`Need buffer at ${i} but next unloaded part starts at ${u.start}`),r=o),s=d}return r}loadedEndOfParts(e,n){let i;for(let r=e.length;r--;){if(i=e[r],!i.loaded)return!1;if(n>i.start)return!0}return!1}getInitialLiveFragment(e){const n=e.fragments,i=this.fragPrevious;let r=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),r=iK(n,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=i.sn+1;if(s>=e.startSN&&s<=e.endSN){const a=n[s-e.startSN];i.cc===a.cc&&(r=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=wL(e,i.cc,i.end),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,n,i){const{config:r}=this;let{fragPrevious:s}=this,{fragments:a,endSN:o}=i;const{fragmentHint:l}=i,{maxFragLookUpTolerance:u}=r,d=i.partList,f=!!(this.loadingParts&&d!=null&&d.length&&l);f&&!this.bitrateTest&&d[d.length-1].fragment.sn===l.sn&&(a=a.concat(l),o=l.sn);let p;if(e<n){var m;const b=e<this.lastCurrentTime||e>n-u||(m=this.media)!=null&&m.paused||!this.startFragRequested?0:u;p=lo(s,a,e,b)}else p=a[a.length-1];if(p){const y=p.sn-i.startSN,b=this.fragmentTracker.getState(p);if((b===wn.OK||b===wn.PARTIAL&&p.gap)&&(s=p),s&&p.sn===s.sn&&(!f||d[0].fragment.sn>p.sn||!i.live)&&p.level===s.level){const T=a[y+1];p.sn<o&&this.fragmentTracker.getState(T)!==wn.OK?p=T:p=null}}return p}alignPlaylists(e,n,i){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragmentStart,a=!n,o=e.alignedSliding&&We(s);if(a||!o&&!s){zK(i,e);const l=e.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${n?n.startSN:"na"}->${e.startSN} fragments: ${r}`),l}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,n){let i=this.startPosition;i<n&&(i=-1);const r=this.timelineOffset;if(i===-1){const s=this.startTimeOffset!==null,a=s?this.startTimeOffset:e.startTimeOffset;a!==null&&We(a)?(i=n+a,a<0&&(i+=e.edge),i=Math.min(Math.max(n,i),n+e.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${a} found in ${s?"multivariant":"media"} playlist`),this.startPosition=i):e.live?(i=this.hls.liveSyncPosition||n,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+r}this.nextLoadPosition=i+r}getLoadPosition(){var e;const{media:n}=this;let i=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&n?i=n.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(e,n){this.transmuxer&&e.type===this.playlistType&&bn(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${n?" part "+n.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==_e.FRAG_LOADING_WAITING_RETRY)&&(this.state=_e.IDLE)}onFragmentOrKeyLoadError(e,n){var i;if(n.chunkMeta&&!n.frag){const T=this.getCurrentContext(n.chunkMeta);T&&(n.frag=T.frag)}const r=n.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var s;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(s=this.fragCurrent)==null?void 0:s.url}`);return}const a=n.details===pe.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(r,!0);const o=n.errorAction;if(!o){this.state=_e.ERROR;return}const{action:l,flags:u,retryCount:d=0,retryConfig:f}=o,p=!!f,m=p&&l===Fn.RetryRequest,y=p&&!o.resolved&&u===Ai.MoveAllAlternatesMatchingHost,b=(i=this.hls.latestLevelDetails)==null?void 0:i.live;if(!m&&y&&bn(r)&&!r.endList&&b&&!RL(n))this.resetFragmentErrors(e),this.treatAsGap(r),o.resolved=!0;else if((m||y)&&d<f.maxNumRetry){var E;const T=Wy((E=n.response)==null?void 0:E.code),x=_b(f,d);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+x,this.state=_e.FRAG_LOADING_WAITING_RETRY,o.resolved=!0,T){this.log("Waiting for connection (offline)"),this.retryDate=1/0,n.reason="offline";return}this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${n.details}, retrying loading ${d+1}/${f.maxNumRetry} in ${x}ms`)}else if(f)if(this.resetFragmentErrors(e),d<f.maxNumRetry)!a&&l!==Fn.RemoveAlternatePermanently&&(o.resolved=!0);else{this.warn(`${n.details} reached or exceeded max retry (${d})`);return}else l===Fn.SendAlternateToPenaltyBox?this.state=_e.WAITING_LEVEL:this.state=_e.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),n=this.retryDate,i=n===1/0;(!n||e>=n||i&&!Wy(0))&&(i&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=_e.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===_e.PARSING||this.state===_e.PARSED){const n=e.frag,i=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,i),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len,(n==null?void 0:n.duration)||10);const a=!s;return a&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${i} buffer`),n&&(this.fragmentTracker.removeFragment(n),this.nextLoadPosition=n.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===Xe.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==_e.STOPPED&&(this.state=_e.IDLE)}afterBufferFlushed(e,n,i){if(!e)return;const r=pt.getBuffered(e);this.fragmentTracker.detectEvictedFragments(n,r,i),this.state===_e.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==_e.STOPPED&&(this.state=_e.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,n=e?e.details:null;n!=null&&n.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(n,n.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,n,i,r){const s=i.details;if(!s){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,u)=>{const d=e.elementaryStreams[u];if(d){const f=d.endPTS-d.startPTS;if(f<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${f})`),l||!1;const p=r?0:kL(s,e,d.startPTS,d.endPTS,d.startDTS,d.endDTS,this);return this.hls.trigger(M.LEVEL_PTS_UPDATED,{details:s,level:i,drift:p,type:u,frag:e,start:d.startPTS,end:d.endPTS}),!0}return l},!1)){var o;if(i.fragmentError===0&&this.treatAsGap(e,i),((o=this.transmuxer)==null?void 0:o.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=_e.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${n?" part: "+n.index:""} of ${this.fragInfo(e,!1,n)})`),this.hls.trigger(M.FRAG_PARSED,{frag:e,part:n})}playlistLabel(){return this.playlistType===Xe.MAIN?"level":"track"}fragInfo(e,n=!0,i){var r,s;return`${this.playlistLabel()} ${e.level} (${i?"part":"frag"}:[${((r=n&&!i?e.startPTS:(i||e).start)!=null?r:NaN).toFixed(3)}-${((s=n&&!i?e.endPTS:(i||e).end)!=null?s:NaN).toFixed(3)}]${i&&e.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(e,n){n&&n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const n=this._state;n!==e&&(this._state=e,this.log(`${n}->${e}`))}get state(){return this._state}}function rC(t){return!!t.interstitialsController&&t.enableInterstitialPlayback!==!1}class qL{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:n}=this;let i;if(e.length)e.length===1?i=e[0]:i=VK(e,n);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function VK(t,e){const n=new Uint8Array(e);let i=0;for(let r=0;r<t.length;r++){const s=t[r];n.set(s,i),i+=s.length}return n}var C1={exports:{}},sC;function GK(){return sC||(sC=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function r(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function s(l,u,d,f,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new r(d,f||l,p),y=n?n+u:u;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new i:delete l._events[u]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=n?n+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,m=f.length,y=new Array(m);p<m;p++)y[p]=f[p].fn;return y},o.prototype.listenerCount=function(u){var d=n?n+u:u,f=this._events[d];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,d,f,p,m,y){var b=n?n+u:u;if(!this._events[b])return!1;var E=this._events[b],T=arguments.length,x,S;if(E.fn){switch(E.once&&this.removeListener(u,E.fn,void 0,!0),T){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,d),!0;case 3:return E.fn.call(E.context,d,f),!0;case 4:return E.fn.call(E.context,d,f,p),!0;case 5:return E.fn.call(E.context,d,f,p,m),!0;case 6:return E.fn.call(E.context,d,f,p,m,y),!0}for(S=1,x=new Array(T-1);S<T;S++)x[S-1]=arguments[S];E.fn.apply(E.context,x)}else{var w=E.length,C;for(S=0;S<w;S++)switch(E[S].once&&this.removeListener(u,E[S].fn,void 0,!0),T){case 1:E[S].fn.call(E[S].context);break;case 2:E[S].fn.call(E[S].context,d);break;case 3:E[S].fn.call(E[S].context,d,f);break;case 4:E[S].fn.call(E[S].context,d,f,p);break;default:if(!x)for(C=1,x=new Array(T-1);C<T;C++)x[C-1]=arguments[C];E[S].fn.apply(E[S].context,x)}}return!0},o.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},o.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},o.prototype.removeListener=function(u,d,f,p){var m=n?n+u:u;if(!this._events[m])return this;if(!d)return a(this,m),this;var y=this._events[m];if(y.fn)y.fn===d&&(!p||y.once)&&(!f||y.context===f)&&a(this,m);else{for(var b=0,E=[],T=y.length;b<T;b++)(y[b].fn!==d||p&&!y[b].once||f&&y[b].context!==f)&&E.push(y[b]);E.length?this._events[m]=E.length===1?E[0]:E:a(this,m)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&a(this,d)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(C1)),C1.exports}var jK=GK(),Nb=gY(jK);const Hc="1.6.12",Vu={};function WK(){return typeof __HLS_WORKER_BUNDLE__=="function"}function $K(){const t=Vu[Hc];if(t)return t.clientCount++,t;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),n=self.URL.createObjectURL(e),r={worker:new self.Worker(n),objectURL:n,clientCount:1};return Vu[Hc]=r,r}function YK(t){const e=Vu[t];if(e)return e.clientCount++,e;const n=new self.URL(t,self.location.href).href,r={worker:new self.Worker(n),scriptURL:n,clientCount:1};return Vu[t]=r,r}function KK(t){const e=Vu[t||Hc];if(e&&e.clientCount--===1){const{worker:i,objectURL:r}=e;delete Vu[t||Hc],r&&self.URL.revokeObjectURL(r),i.terminate()}}function VL(t,e){return e+10<=t.length&&t[e]===51&&t[e+1]===68&&t[e+2]===73&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function Mb(t,e){return e+10<=t.length&&t[e]===73&&t[e+1]===68&&t[e+2]===51&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function S0(t,e){let n=0;return n=(t[e]&127)<<21,n|=(t[e+1]&127)<<14,n|=(t[e+2]&127)<<7,n|=t[e+3]&127,n}function zc(t,e){const n=e;let i=0;for(;Mb(t,e);){i+=10;const r=S0(t,e+6);i+=r,VL(t,e+10)&&(i+=10),e+=i}if(i>0)return t.subarray(n,n+i)}function XK(t,e,n,i){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=e[n+2],a=s>>2&15;if(a>12){const m=new Error(`invalid ADTS sampling index:${a}`);t.emit(M.ERROR,M.ERROR,{type:it.MEDIA_ERROR,details:pe.FRAG_PARSING_ERROR,fatal:!0,error:m,reason:m.message});return}const o=(s>>6&3)+1,l=e[n+3]>>6&3|(s&1)<<2,u="mp4a.40."+o,d=r[a];let f=a;(o===5||o===29)&&(f-=3);const p=[o<<3|(f&14)>>1,(f&1)<<7|l<<3];return Ft.log(`manifest codec:${i}, parsed codec:${u}, channels:${l}, rate:${d} (ADTS object type:${o} sampling index:${a})`),{config:p,samplerate:d,channelCount:l,codec:u,parsedCodec:u,manifestCodec:i}}function GL(t,e){return t[e]===255&&(t[e+1]&246)===240}function jL(t,e){return t[e+1]&1?7:9}function Bb(t,e){return(t[e+3]&3)<<11|t[e+4]<<3|(t[e+5]&224)>>>5}function QK(t,e){return e+5<t.length}function Wh(t,e){return e+1<t.length&&GL(t,e)}function ZK(t,e){return QK(t,e)&&GL(t,e)&&Bb(t,e)<=t.length-e}function JK(t,e){if(Wh(t,e)){const n=jL(t,e);if(e+n>=t.length)return!1;const i=Bb(t,e);if(i<=n)return!1;const r=e+i;return r===t.length||Wh(t,r)}return!1}function WL(t,e,n,i,r){if(!t.samplerate){const s=XK(e,n,i,r);if(!s)return;Vt(t,s)}}function $L(t){return 1024*9e4/t}function eX(t,e){const n=jL(t,e);if(e+n<=t.length){const i=Bb(t,e)-n;if(i>0)return{headerLength:n,frameLength:i}}}function YL(t,e,n,i,r){const s=$L(t.samplerate),a=i+r*s,o=eX(e,n);let l;if(o){const{frameLength:f,headerLength:p}=o,m=p+f,y=Math.max(0,n+m-e.length);y?(l=new Uint8Array(m-p),l.set(e.subarray(n+p,e.length),0)):l=e.subarray(n+p,n+m);const b={unit:l,pts:a};return y||t.samples.push(b),{sample:b,length:m,missing:y}}const u=e.length-n;return l=new Uint8Array(u),l.set(e.subarray(n,e.length),0),{sample:{unit:l,pts:a},length:u,missing:-1}}function tX(t,e){return Mb(t,e)&&S0(t,e+6)+10<=t.length-e}function nX(t){return t instanceof ArrayBuffer?t:t.byteOffset==0&&t.byteLength==t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer}function R1(t,e=0,n=1/0){return iX(t,e,n,Uint8Array)}function iX(t,e,n,i){const r=rX(t);let s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);const a=sX(t)?t.byteOffset:0,o=(a+t.byteLength)/s,l=(a+e)/s,u=Math.floor(Math.max(0,Math.min(l,o))),d=Math.floor(Math.min(u+Math.max(n,0),o));return new i(r,u,d-u)}function rX(t){return t instanceof ArrayBuffer?t:t.buffer}function sX(t){return t&&t.buffer instanceof ArrayBuffer&&t.byteLength!==void 0&&t.byteOffset!==void 0}function aX(t){const e={key:t.type,description:"",data:"",mimeType:null,pictureType:null},n=3;if(t.size<2)return;if(t.data[0]!==n){console.log("Ignore frame with unrecognized character encoding");return}const i=t.data.subarray(1).indexOf(0);if(i===-1)return;const r=_i(R1(t.data,1,i)),s=t.data[2+i],a=t.data.subarray(3+i).indexOf(0);if(a===-1)return;const o=_i(R1(t.data,3+i,a));let l;return r==="-->"?l=_i(R1(t.data,4+i+a)):l=nX(t.data.subarray(4+i+a)),e.mimeType=r,e.pictureType=s,e.description=o,e.data=l,e}function oX(t){if(t.size<2)return;const e=_i(t.data,!0),n=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:n.buffer}}function uX(t){if(t.size<2)return;if(t.type==="TXXX"){let n=1;const i=_i(t.data.subarray(n),!0);n+=i.length+1;const r=_i(t.data.subarray(n));return{key:t.type,info:i,data:r}}const e=_i(t.data.subarray(1));return{key:t.type,info:"",data:e}}function lX(t){if(t.type==="WXXX"){if(t.size<2)return;let n=1;const i=_i(t.data.subarray(n),!0);n+=i.length+1;const r=_i(t.data.subarray(n));return{key:t.type,info:i,data:r}}const e=_i(t.data);return{key:t.type,info:"",data:e}}function cX(t){return t.type==="PRIV"?oX(t):t.type[0]==="W"?lX(t):t.type==="APIC"?aX(t):uX(t)}function dX(t){const e=String.fromCharCode(t[0],t[1],t[2],t[3]),n=S0(t,4),i=10;return{type:e,size:n,data:t.subarray(i,i+n)}}const jf=10,fX=10;function KL(t){let e=0;const n=[];for(;Mb(t,e);){const i=S0(t,e+6);t[e+5]>>6&1&&(e+=jf),e+=jf;const r=e+i;for(;e+fX<r;){const s=dX(t.subarray(e)),a=cX(s);a&&n.push(a),e+=s.size+jf}VL(t,e)&&(e+=jf)}return n}function XL(t){return t&&t.key==="PRIV"&&t.info==="com.apple.streaming.transportStreamTimestamp"}function hX(t){if(t.data.byteLength===8){const e=new Uint8Array(t.data),n=e[3]&1;let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,n&&(i+=4772185884e-2),Math.round(i)}}function Fb(t){const e=KL(t);for(let n=0;n<e.length;n++){const i=e[n];if(XL(i))return hX(i)}}let wi=(function(t){return t.audioId3="org.id3",t.dateRange="com.apple.quicktime.HLS",t.emsg="https://aomedia.org/emsg/ID3",t.misbklv="urn:misb:KLV:bin:1910.1",t})({});function xr(t="",e=9e4){return{type:t,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Ub{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,n,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,n){return!1}appendFrame(e,n,i){}demux(e,n){this.cachedData&&(e=ji(this.cachedData,e),this.cachedData=null);let i=zc(e,0),r=i?i.length:0,s;const a=this._audioTrack,o=this._id3Track,l=i?Fb(i):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&We(l))&&(this.basePTS=pX(l,n,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:wi.audioId3,duration:Number.POSITIVE_INFINITY});r<u;){if(this.canParse(e,r)){const d=this.appendFrame(a,e,r);d?(this.frameIndex++,this.lastPTS=d.sample.pts,r+=d.length,s=r):r=u}else tX(e,r)?(i=zc(e,r),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:wi.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,s=r):r++;if(r===u&&s!==u){const d=e.slice(s);this.cachedData?this.cachedData=ji(this.cachedData,d):this.cachedData=d}}return{audioTrack:a,videoTrack:xr(),id3Track:o,textTrack:xr()}}demuxSampleAes(e,n,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const n=this.cachedData;return n&&(this.cachedData=null,this.demux(n,0)),{audioTrack:this._audioTrack,videoTrack:xr(),id3Track:this._id3Track,textTrack:xr()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const pX=(t,e,n)=>{if(We(t))return t*90;const i=n?n.baseTime*9e4/n.timescale:0;return e*9e4+i};let Wf=null;const mX=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],gX=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],yX=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],vX=[0,1,1,4];function QL(t,e,n,i,r){if(n+24>e.length)return;const s=ZL(e,n);if(s&&n+s.frameLength<=e.length){const a=s.samplesPerFrame*9e4/s.sampleRate,o=i+r*a,l={unit:e.subarray(n,n+s.frameLength),pts:o,dts:o};return t.config=[],t.channelCount=s.channelCount,t.samplerate=s.sampleRate,t.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function ZL(t,e){const n=t[e+1]>>3&3,i=t[e+1]>>1&3,r=t[e+2]>>4&15,s=t[e+2]>>2&3;if(n!==1&&r!==0&&r!==15&&s!==3){const a=t[e+2]>>1&1,o=t[e+3]>>6,l=n===3?3-i:i===3?3:4,u=mX[l*14+r-1]*1e3,f=gX[(n===3?0:n===2?1:2)*3+s],p=o===3?1:2,m=yX[n][i],y=vX[i],b=m*8*y,E=Math.floor(m*u/f+a)*y;if(Wf===null){const S=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Wf=S?parseInt(S[1]):0}return!!Wf&&Wf<=87&&i===2&&u>=224e3&&o===0&&(t[e+3]=t[e+3]|128),{sampleRate:f,channelCount:p,frameLength:E,samplesPerFrame:b}}}function Hb(t,e){return t[e]===255&&(t[e+1]&224)===224&&(t[e+1]&6)!==0}function JL(t,e){return e+1<t.length&&Hb(t,e)}function bX(t,e){return Hb(t,e)&&4<=t.length-e}function e4(t,e){if(e+1<t.length&&Hb(t,e)){const i=ZL(t,e);let r=4;i!=null&&i.frameLength&&(r=i.frameLength);const s=e+r;return s===t.length||JL(t,s)}return!1}class EX extends Ub{constructor(e,n){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=n}resetInitSegment(e,n,i,r){super.resetInitSegment(e,n,i,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:n,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e,n){if(!e)return!1;const i=zc(e,0);let r=(i==null?void 0:i.length)||0;if(e4(e,r))return!1;for(let s=e.length;r<s;r++)if(JK(e,r))return n.log("ADTS sync word found !"),!0;return!1}canParse(e,n){return ZK(e,n)}appendFrame(e,n,i){WL(e,this.observer,n,i,e.manifestCodec);const r=YL(e,n,i,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const t4=(t,e)=>{let n=0,i=5;e+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=t[e];const o=Math.min(i,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,n=n?n<<o|r[0]:r[0],e+=1,i-=o}return n};class TX extends Ub{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,n,i,r){super.resetInitSegment(e,n,i,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:n,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,n){return n+64<e.length}appendFrame(e,n,i){const r=n4(e,n,i,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const n=zc(e,0);if(!n)return!1;const i=n.length;return e[i]===11&&e[i+1]===119&&Fb(n)!==void 0&&t4(e,i)<16}}function n4(t,e,n,i,r){if(n+8>e.length||e[n]!==11||e[n+1]!==119)return-1;const s=e[n+4]>>6;if(s>=3)return-1;const o=[48e3,44100,32e3][s],l=e[n+4]&63,d=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(n+d>e.length)return-1;const f=e[n+6]>>5;let p=0;f===2?p+=2:(f&1&&f!==1&&(p+=2),f&4&&(p+=2));const m=(e[n+6]<<8|e[n+7])>>12-p&1,b=[2,1,2,3,3,4,4,5][f]+m,E=e[n+5]>>3,T=e[n+5]&7,x=new Uint8Array([s<<6|E<<1|T>>2,(T&3)<<6|f<<3|m<<2|l>>4,l<<4&224]),S=1536/o*9e4,w=i+r*S,C=e.subarray(n,n+d);return t.config=x,t.channelCount=b,t.samplerate=o,t.samples.push({unit:C,pts:w}),d}class xX extends Ub{resetInitSegment(e,n,i,r){super.resetInitSegment(e,n,i,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:n,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const n=zc(e,0);let i=(n==null?void 0:n.length)||0;if(n&&e[i]===11&&e[i+1]===119&&Fb(n)!==void 0&&t4(e,i)<=16)return!1;for(let r=e.length;i<r;i++)if(e4(e,i))return Ft.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,n){return bX(e,n)}appendFrame(e,n,i){if(this.basePTS!==null)return QL(e,n,i,this.basePTS,this.frameIndex)}}const SX=/\/emsg[-/]ID3/i;class AX{constructor(e,n){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=n}resetTimeStamp(){}resetInitSegment(e,n,i,r){const s=this.videoTrack=xr("video",1),a=this.audioTrack=xr("audio",1),o=this.txtTrack=xr("text",1);if(this.id3Track=xr("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=mL(e);if(l.video){const{id:u,timescale:d,codec:f,supplemental:p}=l.video;s.id=u,s.timescale=o.timescale=d,s.codec=f,s.supplemental=p}if(l.audio){const{id:u,timescale:d,codec:f}=l.audio;a.id=u,a.timescale=d,a.codec=f}o.id=fL.text,s.sampleDuration=0,s.duration=a.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return TY(e)}demux(e,n){this.timeOffset=n;let i=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=ji(this.remainderData,e));const o=RY(i);this.remainderData=o.remainder,r.samples=o.valid||new Uint8Array}else r.samples=i;const a=this.extractID3Track(r,n);return s.samples=Aw(n,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,n=this.videoTrack,i=this.txtTrack;n.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(n,this.timeOffset);return i.samples=Aw(e,n),{videoTrack:n,audioTrack:xr(),id3Track:r,textTrack:xr()}}extractID3Track(e,n){const i=this.id3Track;if(e.samples.length){const r=Tt(e.samples,["emsg"]);r&&r.forEach(s=>{const a=IY(s);if(SX.test(a.schemeIdUri)){const o=aC(a,n);let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=a.payload;i.samples.push({data:u,len:u.byteLength,dts:o,pts:o,type:wi.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const o=aC(a,n);i.samples.push({data:a.payload,len:a.payload.byteLength,dts:o,pts:o,type:wi.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(e,n,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function aC(t,e){return We(t.presentationTime)?t.presentationTime/t.timeScale:e+t.presentationTimeDelta/t.timeScale}class wX{constructor(e,n,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Ib(n,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,da.cbc)}decryptAacSample(e,n,i){const r=e[n].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);r.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,n+1,i)}).catch(i)}decryptAacSamples(e,n,i){for(;;n++){if(n>=e.length){i();return}if(!(e[n].unit.length<32)&&(this.decryptAacSample(e,n,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const n=Math.floor((e.length-48)/160)*16+16,i=new Int8Array(n);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)i.set(e.subarray(s,s+16),r);return i}getAvcDecryptedUnit(e,n){const i=new Uint8Array(n);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(i.subarray(r,r+16),s);return e}decryptAvcSample(e,n,i,r,s){const a=yL(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,n,i+1,r)}).catch(r)}decryptAvcSamples(e,n,i,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;n++,i=0){if(n>=e.length){r();return}const s=e[n].units;for(;!(i>=s.length);i++){const a=s[i];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,n,i,r,a),!this.decrypter.isSync()))return}}}}class i4{constructor(){this.VideoSample=null}createVideoSample(e,n,i){return{key:e,frame:!1,pts:n,dts:i,units:[],length:0}}getLastNalUnit(e){var n;let i=this.VideoSample,r;if((!i||i.units.length===0)&&(i=e[e.length-1]),(n=i)!=null&&n.units){const s=i.units;r=s[s.length-1]}return r}pushAccessUnit(e,n){if(e.units.length&&e.frame){if(e.pts===void 0){const i=n.samples,r=i.length;if(r){const s=i[r-1];e.pts=s.pts,e.dts=s.dts}else{n.dropped++;return}}n.samples.push(e)}}parseNALu(e,n,i){const r=n.byteLength;let s=e.naluState||0;const a=s,o=[];let l=0,u,d,f,p=-1,m=0;for(s===-1&&(p=0,m=this.getNALuType(n,0),s=0,l=1);l<r;){if(u=n[l++],!s){s=u?0:1;continue}if(s===1){s=u?0:2;continue}if(!u)s=3;else if(u===1){if(d=l-s-1,p>=0){const y={data:n.subarray(p,d),type:m};o.push(y)}else{const y=this.getLastNalUnit(e.samples);y&&(a&&l<=4-a&&y.state&&(y.data=y.data.subarray(0,y.data.byteLength-a)),d>0&&(y.data=ji(y.data,n.subarray(0,d)),y.state=0))}l<r?(f=this.getNALuType(n,l),p=l,m=f,s=0):s=-1}else s=0}if(p>=0&&s>=0){const y={data:n.subarray(p,r),type:m,state:s};o.push(y)}if(o.length===0){const y=this.getLastNalUnit(e.samples);y&&(y.data=ji(y.data,n))}return e.naluState=s,o}}class Rc{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,n=this.bytesAvailable,i=e.byteLength-n,r=new Uint8Array(4),s=Math.min(4,n);if(s===0)throw new Error("no bytes available");r.set(e.subarray(i,i+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let n;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,n=e>>3,e-=n<<3,this.bytesAvailable-=n,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let n=Math.min(this.bitsAvailable,e);const i=this.word>>>32-n;if(e>32&&Ft.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=n,this.bitsAvailable>0)this.word<<=n;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return n=e-n,n>0&&this.bitsAvailable?i<<n|this.readBits(n):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class CX extends i4{parsePES(e,n,i,r){const s=this.parseNALu(e,i.data,r);let a=this.VideoSample,o,l=!1;i.data=null,a&&s.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),s.forEach(u=>{var d,f;switch(u.type){case 1:{let b=!1;o=!0;const E=u.data;if(l&&E.length>4){const T=this.readSliceType(E);(T===2||T===4||T===7||T===9)&&(b=!0)}if(b){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.frame=!0,a.key=b;break}case 5:o=!0,(d=a)!=null&&d.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 6:{o=!0,wb(u.data,1,i.pts,n.samples);break}case 7:{var m,y;o=!0,l=!0;const b=u.data,E=this.readSPS(b);if(!e.sps||e.width!==E.width||e.height!==E.height||((m=e.pixelRatio)==null?void 0:m[0])!==E.pixelRatio[0]||((y=e.pixelRatio)==null?void 0:y[1])!==E.pixelRatio[1]){e.width=E.width,e.height=E.height,e.pixelRatio=E.pixelRatio,e.sps=[b];const T=b.subarray(1,4);let x="avc1.";for(let S=0;S<3;S++){let w=T[S].toString(16);w.length<2&&(w="0"+w),x+=w}e.codec=x}break}case 8:o=!0,e.pps=[u.data];break;case 9:o=!0,e.audFound=!0,(f=a)!=null&&f.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:o=!0;break;default:o=!1;break}a&&o&&a.units.push(u)}),r&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,n){return e[n]&31}readSliceType(e){const n=new Rc(e);return n.readUByte(),n.readUEG(),n.readUEG()}skipScalingList(e,n){let i=8,r=8,s;for(let a=0;a<e;a++)r!==0&&(s=n.readEG(),r=(i+s+256)%256),i=r===0?i:r}readSPS(e){const n=new Rc(e);let i=0,r=0,s=0,a=0,o,l,u;const d=n.readUByte.bind(n),f=n.readBits.bind(n),p=n.readUEG.bind(n),m=n.readBoolean.bind(n),y=n.skipBits.bind(n),b=n.skipEG.bind(n),E=n.skipUEG.bind(n),T=this.skipScalingList.bind(this);d();const x=d();if(f(5),y(3),d(),E(),x===100||x===110||x===122||x===244||x===44||x===83||x===86||x===118||x===128){const N=p();if(N===3&&y(1),E(),E(),y(1),m())for(l=N!==3?8:12,u=0;u<l;u++)m()&&(u<6?T(16,n):T(64,n))}E();const S=p();if(S===0)p();else if(S===1)for(y(1),b(),b(),o=p(),u=0;u<o;u++)b();E(),y(1);const w=p(),C=p(),I=f(1);I===0&&y(1),y(1),m()&&(i=p(),r=p(),s=p(),a=p());let L=[1,1];if(m()&&m())switch(d()){case 1:L=[1,1];break;case 2:L=[12,11];break;case 3:L=[10,11];break;case 4:L=[16,11];break;case 5:L=[40,33];break;case 6:L=[24,11];break;case 7:L=[20,11];break;case 8:L=[32,11];break;case 9:L=[80,33];break;case 10:L=[18,11];break;case 11:L=[15,11];break;case 12:L=[64,33];break;case 13:L=[160,99];break;case 14:L=[4,3];break;case 15:L=[3,2];break;case 16:L=[2,1];break;case 255:{L=[d()<<8|d(),d()<<8|d()];break}}return{width:Math.ceil((w+1)*16-i*2-r*2),height:(2-I)*(C+1)*16-(I?2:4)*(s+a),pixelRatio:L}}}class RX extends i4{constructor(...e){super(...e),this.initVPS=null}parsePES(e,n,i,r){const s=this.parseNALu(e,i.data,r);let a=this.VideoSample,o,l=!1;i.data=null,a&&s.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),s.forEach(u=>{var d,f;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.frame=!0,o=!0;break;case 16:case 17:case 18:case 21:if(o=!0,l){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:o=!0,(d=a)!=null&&d.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 39:o=!0,wb(u.data,2,i.pts,n.samples);break;case 32:o=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Vt(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(o=!0,l=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const m=this.readSPS(u.data);e.width=m.width,e.height=m.height,e.pixelRatio=m.pixelRatio,e.codec=m.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const y in m.params)e.params[y]=m.params[y]}this.pushParameterSet(e.sps,u.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0;break;case 34:if(o=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const m=this.readPPS(u.data);for(const y in m)e.params[y]=m[y]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:o=!0,e.audFound=!0,(f=a)!=null&&f.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:o=!1;break}a&&o&&a.units.push(u)}),r&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,n,i){(i&&i[0]===this.initVPS||!i&&!e.length)&&e.push(n)}getNALuType(e,n){return(e[n]&126)>>>1}ebsp2rbsp(e){const n=new Uint8Array(e.byteLength);let i=0;for(let r=0;r<e.byteLength;r++)r>=2&&e[r]===3&&e[r-1]===0&&e[r-2]===0||(n[i]=e[r],i++);return new Uint8Array(n.buffer,0,i)}pushAccessUnit(e,n){super.pushAccessUnit(e,n),this.initVPS&&(this.initVPS=null)}readVPS(e){const n=new Rc(e);n.readUByte(),n.readUByte(),n.readBits(4),n.skipBits(2),n.readBits(6);const i=n.readBits(3),r=n.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:r}}readSPS(e){const n=new Rc(this.ebsp2rbsp(e));n.readUByte(),n.readUByte(),n.readBits(4);const i=n.readBits(3);n.readBoolean();const r=n.readBits(2),s=n.readBoolean(),a=n.readBits(5),o=n.readUByte(),l=n.readUByte(),u=n.readUByte(),d=n.readUByte(),f=n.readUByte(),p=n.readUByte(),m=n.readUByte(),y=n.readUByte(),b=n.readUByte(),E=n.readUByte(),T=n.readUByte(),x=[],S=[];for(let Qe=0;Qe<i;Qe++)x.push(n.readBoolean()),S.push(n.readBoolean());if(i>0)for(let Qe=i;Qe<8;Qe++)n.readBits(2);for(let Qe=0;Qe<i;Qe++)x[Qe]&&(n.readUByte(),n.readUByte(),n.readUByte(),n.readUByte(),n.readUByte(),n.readUByte(),n.readUByte(),n.readUByte(),n.readUByte(),n.readUByte(),n.readUByte()),S[Qe]&&n.readUByte();n.readUEG();const w=n.readUEG();w==3&&n.skipBits(1);const C=n.readUEG(),I=n.readUEG(),L=n.readBoolean();let N=0,G=0,O=0,D=0;L&&(N+=n.readUEG(),G+=n.readUEG(),O+=n.readUEG(),D+=n.readUEG());const V=n.readUEG(),$=n.readUEG(),J=n.readUEG(),K=n.readBoolean();for(let Qe=K?0:i;Qe<=i;Qe++)n.skipUEG(),n.skipUEG(),n.skipUEG();if(n.skipUEG(),n.skipUEG(),n.skipUEG(),n.skipUEG(),n.skipUEG(),n.skipUEG(),n.readBoolean()&&n.readBoolean())for(let k=0;k<4;k++)for(let X=0;X<(k===3?2:6);X++)if(!n.readBoolean())n.readUEG();else{const Se=Math.min(64,1<<4+(k<<1));k>1&&n.readEG();for(let Oe=0;Oe<Se;Oe++)n.readEG()}n.readBoolean(),n.readBoolean(),n.readBoolean()&&(n.readUByte(),n.skipUEG(),n.skipUEG(),n.readBoolean());const ne=n.readUEG();let oe=0;for(let Qe=0;Qe<ne;Qe++){let k=!1;if(Qe!==0&&(k=n.readBoolean()),k){Qe===ne&&n.readUEG(),n.readBoolean(),n.readUEG();let X=0;for(let ue=0;ue<=oe;ue++){const Se=n.readBoolean();let Oe=!1;Se||(Oe=n.readBoolean()),(Se||Oe)&&X++}oe=X}else{const X=n.readUEG(),ue=n.readUEG();oe=X+ue;for(let Se=0;Se<X;Se++)n.readUEG(),n.readBoolean();for(let Se=0;Se<ue;Se++)n.readUEG(),n.readBoolean()}}if(n.readBoolean()){const Qe=n.readUEG();for(let k=0;k<Qe;k++){for(let X=0;X<J+4;X++)n.readBits(1);n.readBits(1)}}let ie=0,le=1,q=1,ye=!0,Pe=1,we=0;n.readBoolean(),n.readBoolean();let Me=!1;if(n.readBoolean()){if(n.readBoolean()){const ze=n.readUByte(),Ne=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],dt=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];ze>0&&ze<16?(le=Ne[ze-1],q=dt[ze-1]):ze===255&&(le=n.readBits(16),q=n.readBits(16))}if(n.readBoolean()&&n.readBoolean(),n.readBoolean()&&(n.readBits(3),n.readBoolean(),n.readBoolean()&&(n.readUByte(),n.readUByte(),n.readUByte())),n.readBoolean()&&(n.readUEG(),n.readUEG()),n.readBoolean(),n.readBoolean(),n.readBoolean(),Me=n.readBoolean(),Me&&(n.skipUEG(),n.skipUEG(),n.skipUEG(),n.skipUEG()),n.readBoolean()&&(Pe=n.readBits(32),we=n.readBits(32),n.readBoolean()&&n.readUEG(),n.readBoolean())){const dt=n.readBoolean(),mt=n.readBoolean();let he=!1;(dt||mt)&&(he=n.readBoolean(),he&&(n.readUByte(),n.readBits(5),n.readBoolean(),n.readBits(5)),n.readBits(4),n.readBits(4),he&&n.readBits(4),n.readBits(5),n.readBits(5),n.readBits(5));for(let Te=0;Te<=i;Te++){ye=n.readBoolean();const je=ye||n.readBoolean();let B=!1;je?n.readEG():B=n.readBoolean();const F=B?1:n.readUEG()+1;if(dt)for(let Y=0;Y<F;Y++)n.readUEG(),n.readUEG(),he&&(n.readUEG(),n.readUEG()),n.skipBits(1);if(mt)for(let Y=0;Y<F;Y++)n.readUEG(),n.readUEG(),he&&(n.readUEG(),n.readUEG()),n.skipBits(1)}}n.readBoolean()&&(n.readBoolean(),n.readBoolean(),n.readBoolean(),ie=n.readUEG())}let $e=C,Ye=I;if(L){let Qe=1,k=1;w===1?Qe=k=2:w==2&&(Qe=2),$e=C-Qe*G-Qe*N,Ye=I-k*D-k*O}const fe=r?["A","B","C"][r]:"",Ie=o<<24|l<<16|u<<8|d;let Le=0;for(let Qe=0;Qe<32;Qe++)Le=(Le|(Ie>>Qe&1)<<31-Qe)>>>0;let Ke=Le.toString(16);return a===1&&Ke==="2"&&(Ke="6"),{codecString:`hvc1.${fe}${a}.${Ke}.${s?"H":"L"}${T}.B0`,params:{general_tier_flag:s,general_profile_idc:a,general_profile_space:r,general_profile_compatibility_flags:[o,l,u,d],general_constraint_indicator_flags:[f,p,m,y,b,E],general_level_idc:T,bit_depth:V+8,bit_depth_luma_minus8:V,bit_depth_chroma_minus8:$,min_spatial_segmentation_idc:ie,chroma_format_idc:w,frame_rate:{fixed:ye,fps:we/Pe}},width:$e,height:Ye,pixelRatio:[le,q]}}readPPS(e){const n=new Rc(this.ebsp2rbsp(e));n.readUByte(),n.readUByte(),n.skipUEG(),n.skipUEG(),n.skipBits(2),n.skipBits(3),n.skipBits(2),n.skipUEG(),n.skipUEG(),n.skipEG(),n.skipBits(2),n.readBoolean()&&n.skipUEG(),n.skipEG(),n.skipEG(),n.skipBits(4);const r=n.readBoolean(),s=n.readBoolean();let a=1;return s&&r?a=0:s?a=3:r&&(a=2),{parallelismType:a}}matchSPS(e,n){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,n).substr(3)}}const Dn=188;class ia{constructor(e,n,i,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=n,this.typeSupported=i,this.logger=r,this.videoParser=null}static probe(e,n){const i=ia.syncOffset(e);return i>0&&n.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(e){const n=e.length;let i=Math.min(Dn*5,n-Dn)+1,r=0;for(;r<i;){let s=!1,a=-1,o=0;for(let l=r;l<n;l+=Dn)if(e[l]===71&&(n-l===Dn||e[l+Dn]===71)){if(o++,a===-1&&(a=l,a!==0&&(i=Math.min(a+Dn*99,e.length-Dn)+1)),s||(s=Qy(e,l)===0),s&&o>1&&(a===0&&o>2||l+Dn>i))return a}else{if(o)return-1;break}r++}return-1}static createTrack(e,n){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:fL[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?n:void 0}}resetInitSegment(e,n,i,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ia.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=ia.createTrack("audio",r),this._id3Track=ia.createTrack("id3"),this._txtTrack=ia.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=n,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:n,_id3Track:i}=this;e&&(e.pesData=null),n&&(n.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,n,i=!1,r=!1){i||(this.sampleAes=null);let s;const a=this._videoTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack;let d=a.pid,f=a.pesData,p=o.pid,m=l.pid,y=o.pesData,b=l.pesData,E=null,T=this.pmtParsed,x=this._pmtId,S=e.length;if(this.remainderData&&(e=ji(this.remainderData,e),S=e.length,this.remainderData=null),S<Dn&&!r)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};const w=Math.max(0,ia.syncOffset(e));S-=(S-w)%Dn,S<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,S,e.buffer.byteLength-S));let C=0;for(let L=w;L<S;L+=Dn)if(e[L]===71){const N=!!(e[L+1]&64),G=Qy(e,L),O=(e[L+3]&48)>>4;let D;if(O>1){if(D=L+5+e[L+4],D===L+Dn)continue}else D=L+4;switch(G){case d:N&&(f&&(s=gu(f,this.logger))&&(this.readyVideoParser(a.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(a,u,s,!1)),f={data:[],size:0}),f&&(f.data.push(e.subarray(D,L+Dn)),f.size+=L+Dn-D);break;case p:if(N){if(y&&(s=gu(y,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break;case"ac3":this.parseAC3PES(o,s);break}y={data:[],size:0}}y&&(y.data.push(e.subarray(D,L+Dn)),y.size+=L+Dn-D);break;case m:N&&(b&&(s=gu(b,this.logger))&&this.parseID3PES(l,s),b={data:[],size:0}),b&&(b.data.push(e.subarray(D,L+Dn)),b.size+=L+Dn-D);break;case 0:N&&(D+=e[D]+1),x=this._pmtId=_X(e,D);break;case x:{N&&(D+=e[D]+1);const V=IX(e,D,this.typeSupported,i,this.observer,this.logger);d=V.videoPid,d>0&&(a.pid=d,a.segmentCodec=V.segmentVideoCodec),p=V.audioPid,p>0&&(o.pid=p,o.segmentCodec=V.segmentAudioCodec),m=V.id3Pid,m>0&&(l.pid=m),E!==null&&!T&&(this.logger.warn(`MPEG-TS PMT found at ${L} after unknown PID '${E}'. Backtracking to sync byte @${w} to parse all TS packets.`),E=null,L=w-188),T=this.pmtParsed=!0;break}case 17:case 8191:break;default:E=G;break}}else C++;C>0&&Zy(this.observer,new Error(`Found ${C} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=f,o.pesData=y,l.pesData=b;const I={audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};return r&&this.extractRemainingSamples(I),I}flush(){const{remainderData:e}=this;this.remainderData=null;let n;return e?n=this.demux(e,-1,!1,!0):n={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(n),this.sampleAes?this.decrypt(n,this.sampleAes):n}extractRemainingSamples(e){const{audioTrack:n,videoTrack:i,id3Track:r,textTrack:s}=e,a=i.pesData,o=n.pesData,l=r.pesData;let u;if(a&&(u=gu(a,this.logger))?(this.readyVideoParser(i.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(i,s,u,!0),i.pesData=null)):i.pesData=a,o&&(u=gu(o,this.logger))){switch(n.segmentCodec){case"aac":this.parseAACPES(n,u);break;case"mp3":this.parseMPEGPES(n,u);break;case"ac3":this.parseAC3PES(n,u);break}n.pesData=null}else o!=null&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),n.pesData=o;l&&(u=gu(l,this.logger))?(this.parseID3PES(r,u),r.pesData=null):r.pesData=l}demuxSampleAes(e,n,i){const r=this.demux(e,i,!0,!this.config.progressive),s=this.sampleAes=new wX(this.observer,this.config,n);return this.decrypt(r,s)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new CX:e==="hevc"&&(this.videoParser=new RX))}decrypt(e,n){return new Promise(i=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?n.decryptAacSamples(r.samples,0,()=>{s.samples?n.decryptAvcSamples(s.samples,0,0,()=>{i(e)}):i(e)}):s.samples&&n.decryptAvcSamples(s.samples,0,0,()=>{i(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,n){let i=0;const r=this.aacOverFlow;let s=n.data;if(r){this.aacOverFlow=null;const f=r.missing,p=r.sample.unit.byteLength;if(f===-1)s=ji(r.sample.unit,s);else{const m=p-f;r.sample.unit.set(s.subarray(0,f),m),e.samples.push(r.sample),i=r.missing}}let a,o;for(a=i,o=s.length;a<o-1&&!Wh(s,a);a++);if(a!==i){let f;const p=a<o-1;if(p?f=`AAC PES did not start with ADTS header,offset:${a}`:f="No ADTS header found in AAC PES",Zy(this.observer,new Error(f),p,this.logger),!p)return}WL(e,this.observer,s,a,this.audioCodec);let l;if(n.pts!==void 0)l=n.pts;else if(r){const f=$L(e.samplerate);l=r.sample.pts+f}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,d;for(;a<o;)if(d=YL(e,s,a,l,u),a+=d.length,d.missing){this.aacOverFlow=d;break}else for(u++;a<o-1&&!Wh(s,a);a++);}parseMPEGPES(e,n){const i=n.data,r=i.length;let s=0,a=0;const o=n.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<r;)if(JL(i,a)){const l=QL(e,i,a,o,s);if(l)a+=l.length,s++;else break}else a++}parseAC3PES(e,n){{const i=n.data,r=n.pts;if(r===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=i.length;let a=0,o=0,l;for(;o<s&&(l=n4(e,i,o,r,a++))>0;)o+=l}}parseID3PES(e,n){if(n.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Vt({},n,{type:this._videoTrack?wi.emsg:wi.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function Qy(t,e){return((t[e+1]&31)<<8)+t[e+2]}function _X(t,e){return(t[e+10]&31)<<8|t[e+11]}function IX(t,e,n,i,r,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(t[e+1]&15)<<8|t[e+2],l=e+3+o-4,u=(t[e+10]&15)<<8|t[e+11];for(e+=12+u;e<l;){const d=Qy(t,e),f=(t[e+3]&15)<<8|t[e+4];switch(t[e]){case 207:if(!i){_1("ADTS AAC",s);break}case 15:a.audioPid===-1&&(a.audioPid=d);break;case 21:a.id3Pid===-1&&(a.id3Pid=d);break;case 219:if(!i){_1("H.264",s);break}case 27:a.videoPid===-1&&(a.videoPid=d);break;case 3:case 4:!n.mpeg&&!n.mp3?s.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=d,a.segmentAudioCodec="mp3");break;case 193:if(!i){_1("AC-3",s);break}case 129:n.ac3?a.audioPid===-1&&(a.audioPid=d,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&f>0){let p=e+5,m=f;for(;m>2;){switch(t[p]){case 106:n.ac3!==!0?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=d,a.segmentAudioCodec="ac3");break}const b=t[p+1]+2;p+=b,m-=b}}break;case 194:case 135:return Zy(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:a.videoPid===-1&&(a.videoPid=d,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"));break}e+=f+5}return a}function Zy(t,e,n,i){i.warn(`parsing error: ${e.message}`),t.emit(M.ERROR,M.ERROR,{type:it.MEDIA_ERROR,details:pe.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:e,reason:e.message})}function _1(t,e){e.log(`${t} with AES-128-CBC encryption found in unencrypted stream`)}function gu(t,e){let n=0,i,r,s,a,o;const l=t.data;if(!t||t.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=ji(l[0],l[1]),l.splice(1,1);if(i=l[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(r=(i[4]<<8)+i[5],r&&r>t.size-6)return null;const d=i[7];d&192&&(a=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,d&64?(o=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,a-o>60*9e4&&(e.warn(`${Math.round((a-o)/9e4)}s delta between PTS and DTS, align them`),a=o)):o=a),s=i[8];let f=s+9;if(t.size<=f)return null;t.size-=f;const p=new Uint8Array(t.size);for(let m=0,y=l.length;m<y;m++){i=l[m];let b=i.byteLength;if(f)if(f>b){f-=b;continue}else i=i.subarray(f),b-=f,f=0;p.set(i,n),n+=b}return r&&(r-=s+3),{data:p,pts:a,dts:o,len:r}}return null}class LX{static getSilentFrame(e,n){switch(e){case"mp4a.40.2":if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Xs=Math.pow(2,32)-1;class de{static init(){de.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in de.types)de.types.hasOwnProperty(e)&&(de.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);de.HDLR_TYPES={video:n,audio:i};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);de.STTS=de.STSC=de.STCO=s,de.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),de.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),de.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),de.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);de.FTYP=de.box(de.types.ftyp,a,l,a,o),de.DINF=de.box(de.types.dinf,de.box(de.types.dref,r))}static box(e,...n){let i=8,r=n.length;const s=r;for(;r--;)i+=n[r].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(e,4),r=0,i=8;r<s;r++)a.set(n[r],i),i+=n[r].byteLength;return a}static hdlr(e){return de.box(de.types.hdlr,de.HDLR_TYPES[e])}static mdat(e){return de.box(de.types.mdat,e)}static mdhd(e,n){n*=e;const i=Math.floor(n/(Xs+1)),r=Math.floor(n%(Xs+1));return de.box(de.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return de.box(de.types.mdia,de.mdhd(e.timescale||0,e.duration||0),de.hdlr(e.type),de.minf(e))}static mfhd(e){return de.box(de.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?de.box(de.types.minf,de.box(de.types.smhd,de.SMHD),de.DINF,de.stbl(e)):de.box(de.types.minf,de.box(de.types.vmhd,de.VMHD),de.DINF,de.stbl(e))}static moof(e,n,i){return de.box(de.types.moof,de.mfhd(e),de.traf(i,n))}static moov(e){let n=e.length;const i=[];for(;n--;)i[n]=de.trak(e[n]);return de.box.apply(null,[de.types.moov,de.mvhd(e[0].timescale||0,e[0].duration||0)].concat(i).concat(de.mvex(e)))}static mvex(e){let n=e.length;const i=[];for(;n--;)i[n]=de.trex(e[n]);return de.box.apply(null,[de.types.mvex,...i])}static mvhd(e,n){n*=e;const i=Math.floor(n/(Xs+1)),r=Math.floor(n%(Xs+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return de.box(de.types.mvhd,s)}static sdtp(e){const n=e.samples||[],i=new Uint8Array(4+n.length);let r,s;for(r=0;r<n.length;r++)s=n[r].flags,i[r+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return de.box(de.types.sdtp,i)}static stbl(e){return de.box(de.types.stbl,de.stsd(e),de.box(de.types.stts,de.STTS),de.box(de.types.stsc,de.STSC),de.box(de.types.stsz,de.STSZ),de.box(de.types.stco,de.STCO))}static avc1(e){let n=[],i=[],r,s,a;for(r=0;r<e.sps.length;r++)s=e.sps[r],a=s.byteLength,n.push(a>>>8&255),n.push(a&255),n=n.concat(Array.prototype.slice.call(s));for(r=0;r<e.pps.length;r++)s=e.pps[r],a=s.byteLength,i.push(a>>>8&255),i.push(a&255),i=i.concat(Array.prototype.slice.call(s));const o=de.box(de.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|e.sps.length].concat(n).concat([e.pps.length]).concat(i))),l=e.width,u=e.height,d=e.pixelRatio[0],f=e.pixelRatio[1];return de.box(de.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,de.box(de.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),de.box(de.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,f>>24,f>>16&255,f>>8&255,f&255])))}static esds(e){const n=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...n,6,1,2])}static audioStsd(e){const n=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,n>>8&255,n&255,0,0])}static mp4a(e){return de.box(de.types.mp4a,de.audioStsd(e),de.box(de.types.esds,de.esds(e)))}static mp3(e){return de.box(de.types[".mp3"],de.audioStsd(e))}static ac3(e){return de.box(de.types["ac-3"],de.audioStsd(e),de.box(de.types.dac3,e.config))}static stsd(e){const{segmentCodec:n}=e;if(e.type==="audio"){if(n==="aac")return de.box(de.types.stsd,de.STSD,de.mp4a(e));if(n==="ac3"&&e.config)return de.box(de.types.stsd,de.STSD,de.ac3(e));if(n==="mp3"&&e.codec==="mp3")return de.box(de.types.stsd,de.STSD,de.mp3(e))}else if(e.pps&&e.sps){if(n==="avc")return de.box(de.types.stsd,de.STSD,de.avc1(e));if(n==="hevc"&&e.vps)return de.box(de.types.stsd,de.STSD,de.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${n}/${e.codec})`)}static tkhd(e){const n=e.id,i=(e.duration||0)*(e.timescale||0),r=e.width||0,s=e.height||0,a=Math.floor(i/(Xs+1)),o=Math.floor(i%(Xs+1));return de.box(de.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,n){const i=de.sdtp(e),r=e.id,s=Math.floor(n/(Xs+1)),a=Math.floor(n%(Xs+1));return de.box(de.types.traf,de.box(de.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),de.box(de.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),de.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,de.box(de.types.trak,de.tkhd(e),de.mdia(e))}static trex(e){const n=e.id;return de.box(de.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,n){const i=e.samples||[],r=i.length,s=12+16*r,a=new Uint8Array(s);let o,l,u,d,f,p;for(n+=8+s,a.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0),o=0;o<r;o++)l=i[o],u=l.duration,d=l.size,f=l.flags,p=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,f.degradPrio&61440,f.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*o);return de.box(de.types.trun,a)}static initSegment(e){de.types||de.init();const n=de.moov(e);return ji(de.FTYP,n)}static hvc1(e){const n=e.params,i=[e.vps,e.sps,e.pps],r=4,s=new Uint8Array([1,n.general_profile_space<<6|(n.general_tier_flag?32:0)|n.general_profile_idc,n.general_profile_compatibility_flags[0],n.general_profile_compatibility_flags[1],n.general_profile_compatibility_flags[2],n.general_profile_compatibility_flags[3],n.general_constraint_indicator_flags[0],n.general_constraint_indicator_flags[1],n.general_constraint_indicator_flags[2],n.general_constraint_indicator_flags[3],n.general_constraint_indicator_flags[4],n.general_constraint_indicator_flags[5],n.general_level_idc,240|n.min_spatial_segmentation_idc>>8,255&n.min_spatial_segmentation_idc,252|n.parallelismType,252|n.chroma_format_idc,248|n.bit_depth_luma_minus8,248|n.bit_depth_chroma_minus8,0,parseInt(n.frame_rate.fps),r-1|n.temporal_id_nested<<2|n.num_temporal_layers<<3|(n.frame_rate.fixed?64:0),i.length]);let a=s.length;for(let y=0;y<i.length;y+=1){a+=3;for(let b=0;b<i[y].length;b+=1)a+=2+i[y][b].length}const o=new Uint8Array(a);o.set(s,0),a=s.length;const l=i.length-1;for(let y=0;y<i.length;y+=1){o.set(new Uint8Array([32+y|(y===l?128:0),0,i[y].length]),a),a+=3;for(let b=0;b<i[y].length;b+=1)o.set(new Uint8Array([i[y][b].length>>8,i[y][b].length&255]),a),a+=2,o.set(i[y][b],a),a+=i[y][b].length}const u=de.box(de.types.hvcC,o),d=e.width,f=e.height,p=e.pixelRatio[0],m=e.pixelRatio[1];return de.box(de.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,de.box(de.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),de.box(de.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,m>>24,m>>16&255,m>>8&255,m&255])))}}de.types=void 0;de.HDLR_TYPES=void 0;de.STTS=void 0;de.STSC=void 0;de.STCO=void 0;de.STSZ=void 0;de.VMHD=void 0;de.SMHD=void 0;de.STSD=void 0;de.FTYP=void 0;de.DINF=void 0;const r4=9e4;function zb(t,e,n=1,i=!1){const r=t*e*n;return i?Math.round(r):r}function DX(t,e,n=1,i=!1){return zb(t,e,1/n,i)}function oc(t,e=!1){return zb(t,1e3,1/r4,e)}function OX(t,e=1){return zb(t,r4,1/e)}const PX=10*1e3,kX=1024,NX=1152,MX=1536;let yu=null,I1=null;function oC(t,e,n,i){return{duration:e,size:n,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}class yh extends $i{constructor(e,n,i,r){if(super("mp4-remuxer",r),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=n,this.typeSupported=i,this.ISGenerated=!1,yu===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);yu=a?parseInt(a[1]):0}if(I1===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);I1=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let n=!1;const i=e[0].pts,r=e.reduce((s,a)=>{let o=a.pts,l=o-s;return l<-4294967296&&(n=!0,o=Hi(o,i),l=o-s),l>0?s:o},i);return n&&this.debug("PTS rollover detected"),r}remux(e,n,i,r,s,a,o,l){let u,d,f,p,m,y,b=s,E=s;const T=e.pid>-1,x=n.pid>-1,S=n.samples.length,w=e.samples.length>0,C=o&&S>0||S>1;if((!T||w)&&(!x||C)||this.ISGenerated||o){if(this.ISGenerated){var L,N,G,O;const J=this.videoTrackConfig;(J&&(n.width!==J.width||n.height!==J.height||((L=n.pixelRatio)==null?void 0:L[0])!==((N=J.pixelRatio)==null?void 0:N[0])||((G=n.pixelRatio)==null?void 0:G[1])!==((O=J.pixelRatio)==null?void 0:O[1]))||!J&&C||this.nextAudioTs===null&&w)&&this.resetInitSegment()}this.ISGenerated||(f=this.generateIS(e,n,s,a));const D=this.isVideoContiguous;let V=-1,$;if(C&&(V=BX(n.samples),!D&&this.config.forceKeyFrameOnDiscontinuity))if(y=!0,V>0){this.warn(`Dropped ${V} out of ${S} video samples due to a missing keyframe`);const J=this.getVideoStartPts(n.samples);n.samples=n.samples.slice(V),n.dropped+=V,E+=(n.samples[0].pts-J)/n.inputTimeScale,$=E}else V===-1&&(this.warn(`No keyframe found out of ${S} video samples`),y=!1);if(this.ISGenerated){if(w&&C){const J=this.getVideoStartPts(n.samples),j=(Hi(e.samples[0].pts,J)-J)/n.inputTimeScale;b+=Math.max(0,j),E+=Math.max(0,-j)}if(w){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),f=this.generateIS(e,n,s,a)),d=this.remuxAudio(e,b,this.isAudioContiguous,a,x||C||l===Xe.AUDIO?E:void 0),C){const J=d?d.endPTS-d.startPTS:0;n.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),f=this.generateIS(e,n,s,a)),u=this.remuxVideo(n,E,D,J)}}else C&&(u=this.remuxVideo(n,E,D,0));u&&(u.firstKeyFrame=V,u.independent=V!==-1,u.firstKeyFramePTS=$)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(m=s4(i,s,this._initPTS,this._initDTS)),r.samples.length&&(p=a4(r,s,this._initPTS))),{audio:d,video:u,initSegment:f,independent:y,text:p,id3:m}}generateIS(e,n,i,r){const s=e.samples,a=n.samples,o=this.typeSupported,l={},u=this._initPTS;let d=!u||r,f="audio/mp4",p,m,y,b=-1;if(d&&(p=m=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(f="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:f,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):de.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(b=e.id,y=e.inputTimeScale,!u||y!==u.timescale?p=m=s[0].pts-Math.round(y*i):d=!1)}if(n.sps&&n.pps&&a.length){if(n.timescale=n.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:n.codec,initSegment:de.initSegment([n]),metadata:{width:n.width,height:n.height}},d)if(b=n.id,y=n.inputTimeScale,!u||y!==u.timescale){const E=this.getVideoStartPts(a),T=Math.round(y*i);m=Math.min(m,Hi(a[0].dts,E)-T),p=Math.min(p,E-T)}else d=!1;this.videoTrackConfig={width:n.width,height:n.height,pixelRatio:n.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,d?(u&&this.warn(`Timestamps at playlist time: ${r?"":"~"}${i} ${p/y} != initPTS: ${u.baseTime/u.timescale} (${u.baseTime}/${u.timescale}) trackId: ${u.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${p/y} (${p}/${y}) trackId: ${b}`),this._initPTS={baseTime:p,timescale:y,trackId:b},this._initDTS={baseTime:m,timescale:y,trackId:b}):p=y=void 0,{tracks:l,initPTS:p,timescale:y,trackId:b}}remuxVideo(e,n,i,r){const s=e.inputTimeScale,a=e.samples,o=[],l=a.length,u=this._initPTS,d=u.baseTime*s/u.timescale;let f=this.nextVideoTs,p=8,m=this.videoSampleDuration,y,b,E=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,x=!1;if(!i||f===null){const ie=d+n*s,le=a[0].pts-Hi(a[0].dts,a[0].pts);yu&&f!==null&&Math.abs(ie-le-(f+d))<15e3?i=!0:f=ie-le-d}const S=f+d;for(let ie=0;ie<l;ie++){const le=a[ie];le.pts=Hi(le.pts,S),le.dts=Hi(le.dts,S),le.dts<a[ie>0?ie-1:ie].dts&&(x=!0)}x&&a.sort(function(ie,le){const q=ie.dts-le.dts,ye=ie.pts-le.pts;return q||ye}),y=a[0].dts,b=a[a.length-1].dts;const w=b-y,C=w?Math.round(w/(l-1)):m||e.inputTimeScale/30;if(i){const ie=y-S,le=ie>C,q=ie<-1;if((le||q)&&(le?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${oc(ie,!0)} ms (${ie}dts) hole between fragments detected at ${n.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${oc(-ie,!0)} ms (${ie}dts) overlapping between fragments detected at ${n.toFixed(3)}`),!q||S>=a[0].pts||yu)){y=S;const ye=a[0].pts-ie;if(le)a[0].dts=y,a[0].pts=ye;else{let Pe=!0;for(let we=0;we<a.length&&!(a[we].dts>ye&&Pe);we++){const Me=a[we].pts;if(a[we].dts-=ie,a[we].pts-=ie,we<a.length-1){const Fe=a[we+1].pts,$e=a[we].pts,Ye=Fe<=$e,fe=Fe<=Me;Pe=Ye==fe}}}this.log(`Video: Initial PTS/DTS adjusted: ${oc(ye,!0)}/${oc(y,!0)}, delta: ${oc(ie,!0)} ms`)}}y=Math.max(0,y);let I=0,L=0,N=y;for(let ie=0;ie<l;ie++){const le=a[ie],q=le.units,ye=q.length;let Pe=0;for(let we=0;we<ye;we++)Pe+=q[we].data.length;L+=Pe,I+=ye,le.length=Pe,le.dts<N?(le.dts=N,N+=C/4|0||1):N=le.dts,E=Math.min(le.pts,E),T=Math.max(le.pts,T)}b=a[l-1].dts;const G=L+4*I+8;let O;try{O=new Uint8Array(G)}catch(ie){this.observer.emit(M.ERROR,M.ERROR,{type:it.MUX_ERROR,details:pe.REMUX_ALLOC_ERROR,fatal:!1,error:ie,bytes:G,reason:`fail allocating video mdat ${G}`});return}const D=new DataView(O.buffer);D.setUint32(0,G),O.set(de.types.mdat,4);let V=!1,$=Number.POSITIVE_INFINITY,J=Number.POSITIVE_INFINITY,K=Number.NEGATIVE_INFINITY,j=Number.NEGATIVE_INFINITY;for(let ie=0;ie<l;ie++){const le=a[ie],q=le.units;let ye=0;for(let Me=0,Fe=q.length;Me<Fe;Me++){const $e=q[Me],Ye=$e.data,fe=$e.data.byteLength;D.setUint32(p,fe),p+=4,O.set(Ye,p),p+=fe,ye+=4+fe}let Pe;if(ie<l-1)m=a[ie+1].dts-le.dts,Pe=a[ie+1].pts-le.pts;else{const Me=this.config,Fe=ie>0?le.dts-a[ie-1].dts:C;if(Pe=ie>0?le.pts-a[ie-1].pts:C,Me.stretchShortVideoTrack&&this.nextAudioTs!==null){const $e=Math.floor(Me.maxBufferHole*s),Ye=(r?E+r*s:this.nextAudioTs+d)-le.pts;Ye>$e?(m=Ye-Fe,m<0?m=Fe:V=!0,this.log(`It is approximately ${Ye/90} ms to the next segment; using duration ${m/90} ms for the last video frame.`)):m=Fe}else m=Fe}const we=Math.round(le.pts-le.dts);$=Math.min($,m),K=Math.max(K,m),J=Math.min(J,Pe),j=Math.max(j,Pe),o.push(oC(le.key,m,ye,we))}if(o.length){if(yu){if(yu<70){const ie=o[0].flags;ie.dependsOn=2,ie.isNonSync=0}}else if(I1&&j-J<K-$&&C/K<.025&&o[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let ie=y;for(let le=0,q=o.length;le<q;le++){const ye=ie+o[le].duration,Pe=ie+o[le].cts;if(le<q-1){const we=ye+o[le+1].cts;o[le].duration=we-Pe}else o[le].duration=le?o[le-1].duration:C;o[le].cts=0,ie=ye}}}m=V||!m?C:m;const te=b+m;this.nextVideoTs=f=te-d,this.videoSampleDuration=m,this.isVideoContiguous=!0;const P={data1:de.moof(e.sequenceNumber++,y,Vt(e,{samples:o})),data2:O,startPTS:(E-d)/s,endPTS:(T+m-d)/s,startDTS:(y-d)/s,endDTS:f/s,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,P}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return NX;case"ac3":return MX;default:return kX}}remuxAudio(e,n,i,r,s){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,u=this.getSamplesPerFrame(e),d=u*l,f=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,m=[],y=s!==void 0;let b=e.samples,E=p?0:8,T=this.nextAudioTs||-1;const x=f.baseTime*a/f.timescale,S=x+n*a;if(this.isAudioContiguous=i=i||b.length&&T>0&&(r&&Math.abs(S-(T+x))<9e3||Math.abs(Hi(b[0].pts,S)-(T+x))<20*d),b.forEach(function(j){j.pts=Hi(j.pts,S)}),!i||T<0){if(b=b.filter(j=>j.pts>=0),!b.length)return;s===0?T=0:r&&!y?T=Math.max(0,S-x):T=b[0].pts-x}if(e.segmentCodec==="aac"){const j=this.config.maxAudioFramesDrift;for(let te=0,ne=T+x;te<b.length;te++){const oe=b[te],P=oe.pts,ie=P-ne,le=Math.abs(1e3*ie/a);if(ie<=-j*d&&y)te===0&&(this.warn(`Audio frame @ ${(P/a).toFixed(3)}s overlaps marker by ${Math.round(1e3*ie/a)} ms.`),this.nextAudioTs=T=P-x,ne=P);else if(ie>=j*d&&le<PX&&y){let q=Math.round(ie/d);for(ne=P-q*d;ne<0&&q&&d;)q--,ne+=d;te===0&&(this.nextAudioTs=T=ne-x),this.warn(`Injecting ${q} audio frames @ ${((ne-x)/a).toFixed(3)}s due to ${Math.round(1e3*ie/a)} ms gap.`);for(let ye=0;ye<q;ye++){let Pe=LX.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Pe||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),Pe=oe.unit.subarray()),b.splice(te,0,{unit:Pe,pts:ne}),ne+=d,te++}}oe.pts=ne,ne+=d}}let w=null,C=null,I,L=0,N=b.length;for(;N--;)L+=b[N].unit.byteLength;for(let j=0,te=b.length;j<te;j++){const ne=b[j],oe=ne.unit;let P=ne.pts;if(C!==null){const le=m[j-1];le.duration=Math.round((P-C)/l)}else if(i&&e.segmentCodec==="aac"&&(P=T+x),w=P,L>0){L+=E;try{I=new Uint8Array(L)}catch(le){this.observer.emit(M.ERROR,M.ERROR,{type:it.MUX_ERROR,details:pe.REMUX_ALLOC_ERROR,fatal:!1,error:le,bytes:L,reason:`fail allocating audio mdat ${L}`});return}p||(new DataView(I.buffer).setUint32(0,L),I.set(de.types.mdat,4))}else return;I.set(oe,E);const ie=oe.byteLength;E+=ie,m.push(oC(!0,u,ie,0)),C=P}const G=m.length;if(!G)return;const O=m[m.length-1];T=C-x,this.nextAudioTs=T+l*O.duration;const D=p?new Uint8Array(0):de.moof(e.sequenceNumber++,w/l,Vt({},e,{samples:m}));e.samples=[];const V=(w-x)/a,$=T/a,K={data1:D,data2:I,startPTS:V,endPTS:$,startDTS:V,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:G};return this.isAudioContiguous=!0,K}}function Hi(t,e){let n;if(e===null)return t;for(e<t?n=-8589934592:n=8589934592;Math.abs(t-e)>4294967296;)t+=n;return t}function BX(t){for(let e=0;e<t.length;e++)if(t[e].key)return e;return-1}function s4(t,e,n,i){const r=t.samples.length;if(!r)return;const s=t.inputTimeScale;for(let o=0;o<r;o++){const l=t.samples[o];l.pts=Hi(l.pts-n.baseTime*s/n.timescale,e*s)/s,l.dts=Hi(l.dts-i.baseTime*s/i.timescale,e*s)/s}const a=t.samples;return t.samples=[],{samples:a}}function a4(t,e,n){const i=t.samples.length;if(!i)return;const r=t.inputTimeScale;for(let a=0;a<i;a++){const o=t.samples[a];o.pts=Hi(o.pts-n.baseTime*r/n.timescale,e*r)/r}t.samples.sort((a,o)=>a.pts-o.pts);const s=t.samples;return t.samples=[],{samples:s}}class FX extends $i{constructor(e,n,i,r){super("passthrough-remuxer",r),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const n=this.initPTS;n&&e&&n.baseTime===e.baseTime&&n.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,n,i,r){this.audioCodec=n,this.videoCodec=i,this.generateInitSegment(e,r),this.emitInitSegment=!0}generateInitSegment(e,n){let{audioCodec:i,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:s,video:a}=this.initData=mL(e);if(n)wY(e,n);else{const l=s||a;l!=null&&l.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${l.codec}")!`)}s&&(i=uC(s,jt.AUDIO,this)),a&&(r=uC(a,jt.VIDEO,this));const o={};s&&a?o.audiovideo={container:"video/mp4",codec:i+","+r,supplemental:a.supplemental,encrypted:a.encrypted,initSegment:e,id:"main"}:s?o.audio={container:"audio/mp4",codec:i,encrypted:s.encrypted,initSegment:e,id:"audio"}:a?o.video={container:"video/mp4",codec:r,supplemental:a.supplemental,encrypted:a.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=o}remux(e,n,i,r,s,a){var o,l;let{initPTS:u,lastEndTime:d}=this;const f={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};We(d)||(d=this.lastEndTime=s||0);const p=n.samples;if(!p.length)return f;const m={initPTS:void 0,timescale:void 0,trackId:void 0};let y=this.initData;if((o=y)!=null&&o.length||(this.generateInitSegment(p),y=this.initData),!((l=y)!=null&&l.length))return this.warn("Failed to generate initSegment."),f;this.emitInitSegment&&(m.tracks=this.initTracks,this.emitInitSegment=!1);const b=CY(p,y,this),E=y.audio?b[y.audio.id]:null,T=y.video?b[y.video.id]:null,x=$f(T,1/0),S=$f(E,1/0),w=$f(T,0,!0),C=$f(E,0,!0);let I=s,L=0;const N=E&&(!T||!u&&S<x||u&&u.trackId===y.audio.id),G=N?E:T;if(G){const ne=G.timescale,oe=G.start-s*ne,P=N?y.audio.id:y.video.id;I=G.start/ne,L=N?C-S:w-x,(a||!u)&&(UX(u,I,s,L)||ne!==u.timescale)&&(u&&this.warn(`Timestamps at playlist time: ${a?"":"~"}${s} ${oe/ne} != initPTS: ${u.baseTime/u.timescale} (${u.baseTime}/${u.timescale}) trackId: ${u.trackId}`),this.log(`Found initPTS at playlist time: ${s} offset: ${I-s} (${oe}/${ne}) trackId: ${P}`),u=null,m.initPTS=oe,m.timescale=ne,m.trackId=P)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${s}`);u?(m.initPTS=u.baseTime,m.timescale=u.timescale,m.trackId=u.trackId):((!m.timescale||m.trackId===void 0||m.initPTS===void 0)&&(this.warn("Could not set initPTS"),m.initPTS=I,m.timescale=1,m.trackId=-1),this.initPTS=u={baseTime:m.initPTS,timescale:m.timescale,trackId:m.trackId});const O=I-u.baseTime/u.timescale,D=O+L;L>0?this.lastEndTime=D:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const V=!!y.audio,$=!!y.video;let J="";V&&(J+="audio"),$&&(J+="video");const K=(y.audio?y.audio.encrypted:!1)||(y.video?y.video.encrypted:!1),j={data1:p,startPTS:O,startDTS:O,endPTS:D,endDTS:D,type:J,hasAudio:V,hasVideo:$,nb:1,dropped:0,encrypted:K};f.audio=V&&!$?j:void 0,f.video=$?j:void 0;const te=T==null?void 0:T.sampleCount;if(te){const ne=T.keyFrameIndex,oe=ne!==-1;j.nb=te,j.dropped=ne===0||this.isVideoContiguous?0:oe?ne:te,j.independent=oe,j.firstKeyFrame=ne,oe&&T.keyFrameStart&&(j.firstKeyFramePTS=(T.keyFrameStart-u.baseTime)/u.timescale),this.isVideoContiguous||(f.independent=oe),this.isVideoContiguous||(this.isVideoContiguous=oe),j.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${ne}/${te} dropped: ${j.dropped} start: ${j.firstKeyFramePTS||"NA"}`)}return f.initSegment=m,f.id3=s4(i,s,u,u),r.samples.length&&(f.text=a4(r,s,u)),f}}function $f(t,e,n=!1){return(t==null?void 0:t.start)!==void 0?(t.start+(n?t.duration:0))/t.timescale:e}function UX(t,e,n,i){if(t===null)return!0;const r=Math.max(i,1),s=e-t.baseTime/t.timescale;return Math.abs(s-n)>r}function uC(t,e,n){const i=t.codec;return i&&i.length>4?i:e===jt.AUDIO?i==="ec-3"||i==="ac-3"||i==="alac"?i:i==="fLaC"||i==="Opus"?Uh(i,!1):(n.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(n.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}let us;try{us=self.performance.now.bind(self.performance)}catch{us=Date.now}const vh=[{demux:AX,remux:FX},{demux:ia,remux:yh},{demux:EX,remux:yh},{demux:xX,remux:yh}];vh.splice(2,0,{demux:TX,remux:yh});class lC{constructor(e,n,i,r,s,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=n,this.config=i,this.id=s,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,n,i,r){const s=i.transmuxing;s.executeStart=us();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;r&&(this.currentTransmuxState=r);const{contiguous:u,discontinuity:d,trackSwitch:f,accurateTimeOffset:p,timeOffset:m,initSegmentChange:y}=r||o,{audioCodec:b,videoCodec:E,defaultInitPts:T,duration:x,initSegmentData:S}=l,w=HX(a,n);if(w&&Pu(w.method)){const N=this.getDecrypter(),G=Ob(w.method);if(N.isSync()){let O=N.softwareDecrypt(a,w.key.buffer,w.iv.buffer,G);if(i.part>-1){const V=N.flush();O=V&&V.buffer}if(!O)return s.executeEnd=us(),L1(i);a=new Uint8Array(O)}else return this.asyncResult=!0,this.decryptionPromise=N.webCryptoDecrypt(a,w.key.buffer,w.iv.buffer,G).then(O=>{const D=this.push(O,null,i);return this.decryptionPromise=null,D}),this.decryptionPromise}const C=this.needsProbing(d,f);if(C){const N=this.configureTransmuxer(a);if(N)return this.logger.warn(`[transmuxer] ${N.message}`),this.observer.emit(M.ERROR,M.ERROR,{type:it.MEDIA_ERROR,details:pe.FRAG_PARSING_ERROR,fatal:!1,error:N,reason:N.message}),s.executeEnd=us(),L1(i)}(d||f||y||C)&&this.resetInitSegment(S,b,E,x,n),(d||y||C)&&this.resetInitialTimestamp(T),u||this.resetContiguity();const I=this.transmux(a,w,m,p,i);this.asyncResult=qc(I);const L=this.currentTransmuxState;return L.contiguous=!0,L.discontinuity=!1,L.trackSwitch=!1,s.executeEnd=us(),I}flush(e){const n=e.transmuxing;n.executeStart=us();const{decrypter:i,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return this.asyncResult=!0,s.then(()=>this.flush(e));const a=[],{timeOffset:o}=r;if(i){const f=i.flush();f&&a.push(this.push(f.buffer,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u){n.executeEnd=us();const f=[L1(e)];return this.asyncResult?Promise.resolve(f):f}const d=l.flush(o);return qc(d)?(this.asyncResult=!0,d.then(f=>(this.flushRemux(a,f,e),a))):(this.flushRemux(a,d,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=n,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===Xe.MAIN?"level":"track"} ${i.level}`);const d=this.remuxer.remux(r,s,a,o,u,l,!0,this.id);e.push({remuxResult:d,chunkMeta:i}),i.transmuxing.executeEnd=us()}resetInitialTimestamp(e){const{demuxer:n,remuxer:i}=this;!n||!i||(n.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:n}=this;!e||!n||(e.resetContiguity(),n.resetNextTimestamp())}resetInitSegment(e,n,i,r,s){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,n,i,r),o.resetInitSegment(e,n,i,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,n,i,r,s){let a;return n&&n.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,n,i,r,s):a=this.transmuxUnencrypted(e,i,r,s),a}transmuxUnencrypted(e,n,i,r){const{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,n,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,l,n,i,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,n,i,r,s){return this.demuxer.demuxSampleAes(e,n,i).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,i,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:n,observer:i,typeSupported:r}=this;let s;for(let f=0,p=vh.length;f<p;f++){var a;if((a=vh[f].demux)!=null&&a.probe(e,this.logger)){s=vh[f];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,u=s.remux,d=s.demux;(!l||!(l instanceof u))&&(this.remuxer=new u(i,n,r,this.logger)),(!o||!(o instanceof d))&&(this.demuxer=new d(i,n,r,this.logger),this.probe=d.probe)}needsProbing(e,n){return!this.demuxer||!this.remuxer||e||n}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Ib(this.config)),e}}function HX(t,e){let n=null;return t.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(n=e),n}const L1=t=>({remuxResult:{},chunkMeta:t});function qc(t){return"then"in t&&t.then instanceof Function}class zX{constructor(e,n,i,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=n,this.initSegmentData=i,this.duration=r,this.defaultInitPts=s||null}}class qX{constructor(e,n,i,r,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=n,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=a}}let cC=0;class o4{constructor(e,n,i,r){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=cC++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{const u=l.data,d=this.hls;if(!(!d||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var f;const p=(f=this.workerContext)==null?void 0:f.objectURL;p&&self.URL.revokeObjectURL(p);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{d.logger[u.data.logType]&&d.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,d.trigger(u.event,u.data);break}}},this.onWorkerError=l=>{if(!this.hls)return;const u=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const s=e.config;this.hls=e,this.id=n,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;const a=(l,u)=>{u=u||{},u.frag=this.frag||void 0,l===M.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(l,u)};this.observer=new Nb,this.observer.on(M.FRAG_DECRYPTED,a),this.observer.on(M.ERROR,a);const o=Rw(s.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const l=this.hls.logger;if(s.workerPath||WK()){try{s.workerPath?(l.log(`loading Web Worker ${s.workerPath} for "${n}"`),this.workerContext=YK(s.workerPath)):(l.log(`injecting Web Worker for "${n}"`),this.workerContext=$K());const{worker:d}=this.workerContext;d.addEventListener("message",this.onWorkerMessage),d.addEventListener("error",this.onWorkerError),d.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:o,id:n,config:Wt(s)})}catch(d){l.warn(`Error setting up "${n}" Web Worker, fallback to inline`,d),this.terminateWorker(),this.error=null,this.transmuxer=new lC(this.observer,o,s,"",n,e.logger)}return}}this.transmuxer=new lC(this.observer,o,s,"",n,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=cC++;const n=this.hls.config,i=Rw(n.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:i,id:this.id,config:Wt(n)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),KK(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const n=this.transmuxer;n&&(n.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,n,i,r,s,a,o,l,u,d){var f,p;u.transmuxing.start=self.performance.now();const{instanceNo:m,transmuxer:y}=this,b=a?a.start:s.start,E=s.decryptdata,T=this.frag,x=!(T&&s.cc===T.cc),S=!(T&&u.level===T.level),w=T?u.sn-T.sn:-1,C=this.part?u.part-this.part.index:-1,I=w===0&&u.id>1&&u.id===(T==null?void 0:T.stats.chunkCount),L=!S&&(w===1||w===0&&(C===1||I&&C<=0)),N=self.performance.now();(S||w||s.stats.parsing.start===0)&&(s.stats.parsing.start=N),a&&(C||!L)&&(a.stats.parsing.start=N);const G=!(T&&((f=s.initSegment)==null?void 0:f.url)===((p=T.initSegment)==null?void 0:p.url)),O=new qX(x,L,l,S,b,G);if(!L||x||G){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${s.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===Xe.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${x}
        trackSwitch: ${S}
        contiguous: ${L}
        accurateTimeOffset: ${l}
        timeOffset: ${b}
        initSegmentChange: ${G}`);const D=new zX(i,r,n,o,d);this.configureTransmuxer(D)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:m,cmd:"demux",data:e,decryptdata:E,chunkMeta:u,state:O},e instanceof ArrayBuffer?[e]:[]);else if(y){const D=y.push(e,E,u,O);qc(D)?D.then(V=>{this.handleTransmuxComplete(V)}).catch(V=>{this.transmuxerError(V,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(D)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:n,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:n,cmd:"flush",chunkMeta:e});else if(i){const r=i.flush(e);qc(r)?r.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")}):this.handleFlushResult(r,e)}}transmuxerError(e,n,i){this.hls&&(this.error=e,this.hls.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.FRAG_PARSING_ERROR,chunkMeta:n,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,n){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(n)}configureTransmuxer(e){const{instanceNo:n,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:n,cmd:"configure",config:e}):i&&i.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const dC=100;class VX extends kb{constructor(e,n,i){super(e,n,i,"audio-stream-controller",Xe.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(M.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(M.BUFFER_RESET,this.onBufferReset,this),e.on(M.BUFFER_CREATED,this.onBufferCreated,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(M.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(M.FRAG_LOADING,this.onFragLoading,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(M.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(M.BUFFER_RESET,this.onBufferReset,this),e.off(M.BUFFER_CREATED,this.onBufferCreated,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(M.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(M.FRAG_LOADING,this.onFragLoading,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:n,id:i,initPTS:r,timescale:s,trackId:a}){if(i===Xe.MAIN){const o=n.cc,l=this.fragCurrent;if(this.initPTS[o]={baseTime:r,timescale:s,trackId:a},this.log(`InitPTS for cc: ${o} found from main: ${r/s} (${r}/${s}) trackId: ${a}`),this.mainAnchor=n,this.state===_e.WAITING_INIT_PTS){const u=this.waitingData;(!u&&!this.loadingParts||u&&u.frag.cc!==o)&&this.syncWithAnchor(n,u==null?void 0:u.frag)}else!this.hls.hasEnoughToStart&&l&&l.cc!==o?(l.abortRequests(),this.syncWithAnchor(n,l)):this.state===_e.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,n){var i;const r=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(n&&(r==null?void 0:r.cc)===n.cc)return;const s=(r||e).cc,a=this.getLevelDetails(),o=this.getLoadPosition(),l=wL(a,s,o);l&&(this.log(`Syncing with main frag at ${l.start} cc ${l.cc}`),this.startFragRequested=!1,this.nextLoadPosition=l.start,this.resetLoadingState(),this.state===_e.IDLE&&this.doTickIdle())}startLoad(e,n){if(!this.levels){this.startPosition=e,this.state=_e.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(dC),i>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i,this.state=_e.IDLE):this.state=_e.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=n?-1:e,this.tick()}doTick(){switch(this.state){case _e.IDLE:this.doTickIdle();break;case _e.WAITING_TRACK:{const{levels:e,trackId:n}=this,i=e==null?void 0:e[n],r=i==null?void 0:i.details;if(r&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(r))break;this.state=_e.WAITING_INIT_PTS}break}case _e.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case _e.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:n,part:i,cache:r,complete:s}=e,a=this.mainAnchor;if(this.initPTS[n.cc]!==void 0){this.waitingData=null,this.state=_e.FRAG_LOADING;const o=r.flush().buffer,l={frag:n,part:i,payload:o,networkDetails:null};this._handleFragmentLoadProgress(l),s&&super._handleFragmentLoadComplete(l)}else a&&a.cc!==e.frag.cc&&this.syncWithAnchor(a,e.frag)}else this.state=_e.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:n,levels:i,media:r,trackId:s}=this,a=n.config;if(!this.buffering||!r&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(i!=null&&i[s]))return;const o=i[s],l=o.details;if(!l||this.waitForLive(o)||this.waitForCdnTuneIn(l)){this.state=_e.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,jt.AUDIO,Xe.AUDIO));const d=this.getFwdBufferInfo(u,Xe.AUDIO);if(d===null)return;if(!this.switchingTrack&&this._streamEnded(d,l)){n.trigger(M.BUFFER_EOS,{type:"audio"}),this.state=_e.ENDED;return}const f=d.len,p=n.maxBufferLength,m=l.fragments,y=m[0].start,b=this.getLoadPosition(),E=this.flushing?b:d.end;if(this.switchingTrack&&r){const S=b;l.PTSKnown&&S<y&&(d.end>y||d.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=y+.05)}if(f>=p&&!this.switchingTrack&&E<m[m.length-1].start)return;let T=this.getNextFragment(E,l);if(T&&this.isLoopLoading(T,E)&&(T=this.getNextFragmentLoopLoading(T,l,d,Xe.MAIN,p)),!T){this.bufferFlushed=!0;return}let x=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&x&&bn(T)&&!T.endList&&(!l.live||!this.loadingParts&&E<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(x)===wn.OK&&(this.mainFragLoading=x=null),x&&bn(x))){if(T.start>x.end){const w=this.fragmentTracker.getFragAtPos(E,Xe.MAIN);w&&w.end>x.end&&(x=w,this.mainFragLoading={frag:w,targetBufferTime:null})}if(T.start>x.end)return}this.loadFragment(T,o,E)}onMediaDetaching(e,n){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,n)}onAudioTracksUpdated(e,{audioTracks:n}){this.resetTransmuxer(),this.levels=n.map(i=>new Fc(i))}onAudioTrackSwitching(e,n){const i=!!n.url;this.trackId=n.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),i?(this.switchingTrack=n,this.flushAudioIfNeeded(n),this.state!==_e.STOPPED&&(this.setInterval(dC),this.state=_e.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=n,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,n){this.mainDetails=n.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(M.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(e,n){var i;const{levels:r}=this,{details:s,id:a,groupId:o,track:l}=n;if(!r){this.warn(`Audio tracks reset while loading track ${a} "${l.name}" of "${o}"`);return}const u=this.mainDetails;if(!u||s.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=n,this.state!==_e.STOPPED&&(this.state=_e.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${l.name}" of "${o}" loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const d=r[a];let f=0;if(s.live||(i=d.details)!=null&&i.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;if(d.details){var p;f=this.alignPlaylists(s,d.details,(p=this.levelLastLoaded)==null?void 0:p.details)}s.alignedSliding||(zL(s,u),s.alignedSliding||jh(s,u),f=s.fragmentStart)}d.details=s,this.levelLastLoaded=d,this.startFragRequested||this.setStartPosition(u,f),this.hls.trigger(M.AUDIO_TRACK_UPDATED,{details:s,id:a,groupId:n.groupId}),this.state===_e.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=_e.IDLE),this.tick()}_handleFragmentLoadProgress(e){var n;const i=e.frag,{part:r,payload:s}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const d=u.details;if(!d){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const f=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new o4(this.hls,Xe.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const m=this.initPTS[i.cc],y=(n=i.initSegment)==null?void 0:n.data;if(m!==void 0){const E=r?r.index:-1,T=E!==-1,x=new Lb(i.level,i.sn,i.stats.chunkCount,s.byteLength,E,T);p.push(s,y,f,"",i,r,d.totalduration,!1,x,m)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${d.startSN} ,${d.endSN}],track ${o}`);const{cache:b}=this.waitingData=this.waitingData||{frag:i,part:r,cache:new qL,complete:!1};b.push(new Uint8Array(s)),this.state!==_e.STOPPED&&(this.state=_e.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,n){this.bufferFlushed=this.flushing=!1;const i=n.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(e,n){!this.audioOnly&&n.frag.type===Xe.MAIN&&bn(n.frag)&&(this.mainFragLoading=n,this.state===_e.IDLE&&this.tick())}onFragBuffered(e,n){const{frag:i,part:r}=n;if(i.type!==Xe.AUDIO){!this.audioOnly&&i.type===Xe.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(bn(i)){this.fragPrevious=i;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(M.AUDIO_TRACK_SWITCHED,Bt({},s)))}this.fragBufferedComplete(i,r),this.media&&this.tick()}onError(e,n){var i;if(n.fatal){this.state=_e.ERROR;return}switch(n.details){case pe.FRAG_GAP:case pe.FRAG_PARSING_ERROR:case pe.FRAG_DECRYPT_ERROR:case pe.FRAG_LOAD_ERROR:case pe.FRAG_LOAD_TIMEOUT:case pe.KEY_LOAD_ERROR:case pe.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Xe.AUDIO,n);break;case pe.AUDIO_TRACK_LOAD_ERROR:case pe.AUDIO_TRACK_LOAD_TIMEOUT:case pe.LEVEL_PARSING_ERROR:!n.levelRetry&&this.state===_e.WAITING_TRACK&&((i=n.context)==null?void 0:i.type)===At.AUDIO_TRACK&&(this.state=_e.IDLE);break;case pe.BUFFER_ADD_CODEC_ERROR:case pe.BUFFER_APPEND_ERROR:if(n.parent!=="audio")return;this.reduceLengthAndFlushBuffer(n)||this.resetLoadingState();break;case pe.BUFFER_FULL_ERROR:if(n.parent!=="audio")return;this.reduceLengthAndFlushBuffer(n)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case pe.INTERNAL_EXCEPTION:this.recoverWorkerError(n);break}}onBufferFlushing(e,{type:n}){n!==jt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:n}){if(n!==jt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===_e.ENDED&&(this.state=_e.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,n,Xe.AUDIO),this.tick())}}_handleTransmuxComplete(e){var n;const i="audio",{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:d}=o,{details:f}=d,{audio:p,text:m,id3:y,initSegment:b}=s;if(this.fragContextChanged(l)||!f){this.fragmentTracker.removeFragment(l);return}if(this.state=_e.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),b!=null&&b.tracks){const E=l.initSegment||l;if(this.unhandledEncryptionError(b,l))return;this._bufferInitSegment(d,b.tracks,E,a),r.trigger(M.FRAG_PARSING_INIT_SEGMENT,{frag:E,id:i,tracks:b.tracks})}if(p){const{startPTS:E,endPTS:T,startDTS:x,endDTS:S}=p;u&&(u.elementaryStreams[jt.AUDIO]={startPTS:E,endPTS:T,startDTS:x,endDTS:S}),l.setElementaryStreamInfo(jt.AUDIO,E,T,x,S),this.bufferFragmentData(p,l,u,a)}if(y!=null&&(n=y.samples)!=null&&n.length){const E=Vt({id:i,frag:l,details:f},y);r.trigger(M.FRAG_PARSING_METADATA,E)}if(m){const E=Vt({id:i,frag:l,details:f},m);r.trigger(M.FRAG_PARSING_USERDATA,E)}}_bufferInitSegment(e,n,i,r){if(this.state!==_e.PARSING||(n.video&&delete n.video,n.audiovideo&&delete n.audiovideo,!n.audio))return;const s=n.audio;s.id=Xe.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${a}/${s.codec}]`),a&&a.split(",").length===1&&(s.levelCodec=a),this.hls.trigger(M.BUFFER_CODECS,n);const o=s.initSegment;if(o!=null&&o.byteLength){const l={type:"audio",frag:i,part:null,chunkMeta:r,parent:i.type,data:o};this.hls.trigger(M.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,n,i){const r=this.fragmentTracker.getState(e);if(this.switchingTrack||r===wn.NOT_LOADED||r===wn.PARTIAL){var s;if(!bn(e))this._loadInitSegment(e,n);else if((s=n.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=_e.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==n.details.fragmentStart&&jh(n.details,a)}else super.loadFragment(e,n,i)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=this.bufferedTrack;so({name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},e,$a)||(zh(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:n}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,n.trigger(M.AUDIO_TRACK_SWITCHED,Bt({},e))}}class qb extends $i{constructor(e,n){super(n,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,n,i){const r=n==null?void 0:n.renditionReports;if(r){let s=-1;for(let a=0;a<r.length;a++){const o=r[a];let l;try{l=new self.URL(o.URI,n.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),l=o.URI||""}if(l===e){s=a;break}else l===e.substring(0,l.length)&&(s=a)}if(s!==-1){const a=r[s],o=parseInt(a["LAST-MSN"])||n.lastPartSn;let l=parseInt(a["LAST-PART"])||n.lastPartIndex;if(this.hls.config.lowLatencyMode){const d=Math.min(n.age-n.partTarget,n.targetduration);l>=0&&d>n.partTarget&&(l+=1)}const u=i&&_w(i);return new Iw(o,l>=0?l:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,n){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,n){if(n)try{return n.addDirectives(e)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return e}playlistLoaded(e,n,i){const{details:r,stats:s}=n,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;r.advancedDateTime=Date.now()-o;const l=this.hls.config.timelineOffset;if(l!==r.appliedTimelineOffset){const d=Math.max(l||0,0);r.appliedTimelineOffset=d,r.fragments.forEach(f=>{f.setStart(f.playlistOffset+d)})}if(r.live||i!=null&&i.live){const d="levelInfo"in n?n.levelInfo:n.track;if(r.reloaded(i),i&&r.fragments.length>0){NK(i,r,this);const x=r.playlistParsingError;if(x){this.warn(x);const S=this.hls;if(!S.config.ignorePlaylistParsingErrors){var u;const{networkDetails:w}=n;S.trigger(M.ERROR,{type:it.NETWORK_ERROR,details:pe.LEVEL_PARSING_ERROR,fatal:!1,url:r.url,error:x,reason:x.message,level:n.level||void 0,parent:(u=r.fragments[0])==null?void 0:u.type,networkDetails:w,stats:s});return}r.playlistParsingError=null}}r.requestScheduled===-1&&(r.requestScheduled=s.loading.start);const f=this.hls.mainForwardBufferInfo,p=f?f.end-f.len:0,m=(r.edge-p)*1e3,y=ML(r,m);if(r.requestScheduled+y<a?r.requestScheduled=a:r.requestScheduled+=y,this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),!this.canLoad||!r.live)return;let b,E,T;if(r.canBlockReload&&r.endSN&&r.advanced){const x=this.hls.config.lowLatencyMode,S=r.lastPartSn,w=r.endSN,C=r.lastPartIndex,I=C!==-1,L=S===w;I?L?(E=w+1,T=x?0:C):(E=S,T=x?C+1:r.maxPartIndex):E=w+1;const N=r.age,G=N+r.ageHeader;let O=Math.min(G-r.partTarget,r.targetduration*1.5);if(O>0){if(G>r.targetduration*3)this.log(`Playlist last advanced ${N.toFixed(2)}s ago. Omitting segment and part directives.`),E=void 0,T=void 0;else if(i!=null&&i.tuneInGoal&&G-r.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${O} with playlist age: ${r.age}`),O=0;else{const D=Math.floor(O/r.targetduration);if(E+=D,T!==void 0){const V=Math.round(O%r.targetduration/r.partTarget);T+=V}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${N.toFixed(2)}s goal: ${O} skip sn ${D} to part ${T}`)}r.tuneInGoal=O}if(b=this.getDeliveryDirectives(r,n.deliveryDirectives,E,T),x||!L){r.requestScheduled=a,this.loadingPlaylist(d,b);return}}else(r.canBlockReload||r.canSkipUntil)&&(b=this.getDeliveryDirectives(r,n.deliveryDirectives,E,T));b&&E!==void 0&&r.canBlockReload&&(r.requestScheduled=s.loading.first+Math.max(y-o*2,y/2)),this.scheduleLoading(d,b,r)}else this.clearTimer()}scheduleLoading(e,n,i){const r=i||e.details;if(!r){this.loadingPlaylist(e,n);return}const s=self.performance.now(),a=r.requestScheduled;if(s>=a){this.loadingPlaylist(e,n);return}const o=a-s;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(o)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,n),o)}getDeliveryDirectives(e,n,i,r){let s=_w(e);return n!=null&&n.skip&&e.deltaUpdateFailed&&(i=n.msn,r=n.part,s=mh.No),new Iw(i,r,s)}checkRetry(e){const n=e.details,i=qh(e),r=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=r||{},l=!!r&&!!o&&(s===Fn.RetryRequest||!r.resolved&&s===Fn.SendAlternateToPenaltyBox);if(l){var u;if(a>=o.maxNumRetry)return!1;if(i&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${n}" without delivery-directives`),this.loadPlaylist();else{const d=_b(o,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),d),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${n}" in ${d}ms`)}e.levelRetry=!0,r.resolved=!0}return l}}function u4(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Vc(t[n].attrs,e[n].attrs))return!1;return!0}function Vc(t,e,n){const i=t["STABLE-RENDITION-ID"];return i&&!n?i===e["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>t[r]!==e[r])}function Jy(t,e){return e.label.toLowerCase()===t.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(t.lang||"").toLowerCase())}class GX extends qb{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.LEVEL_LOADING,this.onLevelLoading,this),e.on(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(M.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.LEVEL_LOADING,this.onLevelLoading,this),e.off(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(M.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(M.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,n){this.tracks=n.audioTracks||[]}onAudioTrackLoaded(e,n){const{id:i,groupId:r,details:s}=n,a=this.tracksInGroup[i];if(!a||a.groupId!==r){this.warn(`Audio track with id:${i} and group:${r} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=n.details,this.log(`Audio track ${i} "${a.name}" lang:${a.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,n,o)}onLevelLoading(e,n){this.switchLevel(n.level)}onLevelSwitching(e,n){this.switchLevel(n.level)}switchLevel(e){const n=this.hls.levels[e];if(!n)return;const i=n.audioGroups||null,r=this.groupIds;let s=this.currentTrack;if(!i||(r==null?void 0:r.length)!==(i==null?void 0:i.length)||i!=null&&i.some(o=>(r==null?void 0:r.indexOf(o))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(p=>!i||i.indexOf(p.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(p=>p.default)&&(this.selectDefaultTrack=!1),o.forEach((p,m)=>{p.id=m});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.audioPreference;if(!s&&l){const p=wr(l,o,$a);if(p>-1)s=o[p];else{const m=wr(l,this.tracks);s=this.tracks[m]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const d={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${i==null?void 0:i.join(",")}`),this.hls.trigger(M.AUDIO_TRACKS_UPDATED,d);const f=this.trackId;if(u!==-1&&f===-1)this.setAudioTrack(u);else if(o.length&&f===-1){var a;const p=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(p.message),this.hls.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}}onError(e,n){n.fatal||!n.context||n.context.type===At.AUDIO_TRACK&&n.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(n.context.groupId)!==-1)&&this.checkRetry(n)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const n=this.hls;if(n.config.audioPreference=e,e){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const r=this.currentTrack;if(r&&so(e,r,$a))return r;const s=wr(e,this.tracksInGroup,$a);if(s>-1){const a=this.tracksInGroup[s];return this.setAudioTrack(s),a}else if(r){let a=n.loadLevel;a===-1&&(a=n.firstAutoLevel);const o=tK(e,n.levels,i,a,$a);if(o===-1)return null;n.nextLoadLevel=o}if(e.channels||e.audioCodec){const a=wr(e,i);if(a>-1)return i[a]}}}return null}setAudioTrack(e){const n=this.tracksInGroup;if(e<0||e>=n.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,r=n[e],s=r.details&&!r.details.live;if(e===this.trackId&&r===i&&s||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(M.AUDIO_TRACK_SWITCHING,Bt({},r)),s))return;const a=this.switchParams(r.url,i==null?void 0:i.details,r.details);this.loadPlaylist(a)}findTrackId(e){const n=this.tracksInGroup;for(let i=0;i<n.length;i++){const r=n[i];if(!(this.selectDefaultTrack&&!r.default)&&(!e||so(e,r,$a)))return i}if(e){const{name:i,lang:r,assocLang:s,characteristics:a,audioCodec:o,channels:l}=e;for(let u=0;u<n.length;u++){const d=n[u];if(so({name:i,lang:r,assocLang:s,characteristics:a,audioCodec:o,channels:l},d,$a))return u}for(let u=0;u<n.length;u++){const d=n[u];if(Vc(e.attrs,d.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<n.length;u++){const d=n[u];if(Vc(e.attrs,d.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const n=this.currentTrack;this.shouldLoadPlaylist(n)&&zh(n.url,this.hls)&&this.scheduleLoading(n,e)}loadingPlaylist(e,n){super.loadingPlaylist(e,n);const i=e.id,r=e.groupId,s=this.getUrlWithDirectives(e.url,n),a=e.details,o=a==null?void 0:a.age;this.log(`Loading audio-track ${i} "${e.name}" lang:${e.lang} group:${r}${(n==null?void 0:n.msn)!==void 0?" at sn "+n.msn+" part "+n.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${s}`),this.hls.trigger(M.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:n||null,track:e})}}class jX{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,n,i){if(this.queues===null||this.tracks===null)return;const r=this.queues[n];r.push(e),r.length===1&&!i&&this.executeNext(n)}appendBlocker(e){return new Promise(n=>{const i={label:"async-blocker",execute:n,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,e)})}prependBlocker(e){return new Promise(n=>{if(this.queues){const i={label:"async-blocker-prepend",execute:n,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var n;const i=(n=e[0])==null?void 0:n.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const n=this.queues[e];if(n.length){const r=n[0];try{r.execute()}catch(s){var i;if(r.onError(s),this.queues===null||this.tracks===null)return;const a=(i=this.tracks[e])==null?void 0:i.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var n;return((n=this.queues)==null?void 0:n[e][0])||null}toString(){const{queues:e,tracks:n}=this;return e===null||n===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var n,i;return(n=this.queues)!=null&&n[e]||(i=this.tracks)!=null&&i[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var n;const i=(n=this.tracks)==null?void 0:n[e],r=i==null?void 0:i.buffer;return r?`SourceBuffer${r.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(e){var n;return((n=this.queues)==null?void 0:n[e].map(i=>i.label).join(", "))||""}}const fC=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,l4="HlsJsTrackRemovedError";class WX extends Error{constructor(e){super(e),this.name=l4}}class $X extends $i{constructor(e,n){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var r;this.hls&&((r=this.mediaSource)==null?void 0:r.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:r,mediaSource:s}=this;i&&this.log("Media source opened"),!(!r||!s)&&(s.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(M.MEDIA_ATTACHED,{media:r,mediaSource:s}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:r}=this;i!==r&&this.error(`Media element src was set while attaching MediaSource (${r} > ${i})`)},this.hls=e,this.fragmentTracker=n,this.appendSource=mY(ca(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.BUFFER_RESET,this.onBufferReset,this),e.on(M.BUFFER_APPENDING,this.onBufferAppending,this),e.on(M.BUFFER_CODECS,this.onBufferCodecs,this),e.on(M.BUFFER_EOS,this.onBufferEos,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(M.FRAG_PARSED,this.onFragParsed,this),e.on(M.FRAG_CHANGED,this.onFragChanged,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.BUFFER_RESET,this.onBufferReset,this),e.off(M.BUFFER_APPENDING,this.onBufferAppending,this),e.off(M.BUFFER_CODECS,this.onBufferCodecs,this),e.off(M.BUFFER_EOS,this.onBufferEos,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(M.FRAG_PARSED,this.onFragParsed,this),e.off(M.FRAG_CHANGED,this.onFragChanged,this),e.off(M.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:n}=this;if(!e)return null;const i={};if(this.operationQueue){const s=this.isUpdating();s||this.operationQueue.removeBlockers();const a=this.isQueued();(s||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${s?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const r=this.transferData;return!this.sourceBufferCount&&r&&r.mediaSource===n?Vt(i,r.tracks):this.sourceBuffers.forEach(s=>{const[a]=s;a&&(i[a]=Vt({},this.tracks[a]),this.removeBuffer(a)),s[0]=s[1]=null}),{media:e,mediaSource:n,tracks:i}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,n){var i;let r=2;(n.audio&&!n.video||!n.altAudio)&&(r=1),this.bufferCodecEventsTotal=r,this.log(`${r} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&r&&this.bufferCreated()}onMediaAttaching(e,n){const i=this.media=n.media;this.transferData=this.overrides=void 0;const r=ca(this.appendSource);if(r){const s=!!n.mediaSource;(s||n.overrides)&&(this.transferData=n,this.overrides=n.overrides);const a=this.mediaSource=n.mediaSource||new r;if(this.assignMediaSource(a),s)this._objectUrl=i.src,this.attachTransferred();else{const o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{i.removeAttribute("src");const l=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||l&&a instanceof l,hC(i),YX(i,o),i.load()}catch{i.src=o}else i.src=o}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var n,i;this.log(`${((n=this.transferData)==null?void 0:n.mediaSource)===e?"transferred":"created"} media source: ${(i=e.constructor)==null?void 0:i.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,n=this.transferData;if(!n||!e)return;const i=this.tracks,r=n.tracks,s=r?Object.keys(r):null,a=s?s.length:0,o=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(r&&s&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Wt(i,(l,u)=>l==="initSegment"?void 0:u)};
transfer tracks: ${Wt(r,(l,u)=>l==="initSegment"?void 0:u)}}`),!uL(r,i)){n.mediaSource=null,n.tracks=void 0;const l=e.currentTime,u=this.details,d=Math.max(l,(u==null?void 0:u.fragments[0].start)||0);if(d-l>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${d}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(r)}"->"${Object.keys(i)}") start time: ${d} currentTime: ${l}`),this.onMediaDetaching(M.MEDIA_DETACHING,{}),this.onMediaAttaching(M.MEDIA_ATTACHING,n),e.currentTime=d;return}this.transferData=void 0,s.forEach(l=>{const u=l,d=r[u];if(d){const f=d.buffer;if(f){const p=this.fragmentTracker,m=d.id;if(p.hasFragments(m)||p.hasParts(m)){const E=pt.getBuffered(f);p.detectEvictedFragments(u,E,m,null,!0)}const y=D1(u),b=[u,f];this.sourceBuffers[y]=b,f.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,d)}}}),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}get mediaSourceOpenOrEnded(){var e;const n=(e=this.mediaSource)==null?void 0:e.readyState;return n==="open"||n==="ended"}onMediaDetaching(e,n){const i=!!n.transferMedia;this.transferData=this.overrides=void 0;const{media:r,mediaSource:s,_objectUrl:a}=this;if(s){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([o])=>{o&&this.removeBuffer(o)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const o=s.readyState==="open";try{const l=s.sourceBuffers;for(let u=l.length;u--;)o&&l[u].abort(),s.removeSourceBuffer(l[u]);o&&s.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(s.removeEventListener("startstreaming",this._onStartStreaming),s.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}r&&(r.removeEventListener("emptied",this._onMediaEmptied),i||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(r.removeAttribute("src"),this.appendSource&&hC(r),r.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(M.MEDIA_DETACHED,n)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var n;const i=(n=this.tracks[e])==null?void 0:n.buffer;if(this.removeBuffer(e),i)try{var r;(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(s){this.warn(`onBufferReset ${e}`,s)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[D1(e)]=[null,null];const n=this.tracks[e];n&&(n.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new jX(this.tracks)}onBufferCodecs(e,n){var i;const r=this.tracks,s=Object.keys(n);this.log(`BUFFER_CODECS: "${s}" (current SB count ${this.sourceBufferCount})`);const a="audiovideo"in n&&(r.audio||r.video)||r.audiovideo&&("audio"in n||"video"in n),o=!a&&this.sourceBufferCount&&this.media&&s.some(l=>!r[l]);if(a||o){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${s}" SourceBuffers`);return}s.forEach(l=>{var u,d;const f=n[l],{id:p,codec:m,levelCodec:y,container:b,metadata:E,supplemental:T}=f;let x=r[l];const S=(u=this.transferData)==null||(u=u.tracks)==null?void 0:u[l],w=S!=null&&S.buffer?S:x,C=(w==null?void 0:w.pendingCodec)||(w==null?void 0:w.codec),I=w==null?void 0:w.levelCodec;x||(x=r[l]={buffer:void 0,listeners:[],codec:m,supplemental:T,container:b,levelCodec:y,metadata:E,id:p});const L=ph(C,I),N=L==null?void 0:L.replace(fC,"$1");let G=ph(m,y);const O=(d=G)==null?void 0:d.replace(fC,"$1");G&&L&&N!==O&&(l.slice(0,5)==="audio"&&(G=Uh(G,this.appendSource)),this.log(`switching codec ${C} to ${G}`),G!==(x.pendingCodec||x.codec)&&(x.pendingCodec=G),x.container=b,this.appendChangeType(l,b,G))}),(this.tracksReady||this.sourceBufferCount)&&(n.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!n.video&&((i=n.audio)==null?void 0:i.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,n)=>{const i=this.tracks[n];return e[n]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},e},{})}appendChangeType(e,n,i){const r=`${n};codecs=${i}`,s={label:`change-type=${r}`,execute:()=>{const a=this.tracks[e];if(a){const o=a.buffer;o!=null&&o.changeType&&(this.log(`changing ${e} sourceBuffer type to ${r}`),o.changeType(r),a.codec=i,a.container=n)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(s,e,this.isPending(this.tracks[e]))}blockAudio(e){var n;const i=e.start,r=i+e.duration*.05;if(((n=this.fragmentTracker.getAppendedFrag(i,Xe.MAIN))==null?void 0:n.gap)===!0)return;const a={label:"block-audio",execute:()=>{var o;const l=this.tracks.video;(this.lastVideoAppendEnd>r||l!=null&&l.buffer&&pt.isBuffered(l.buffer,r)||((o=this.fragmentTracker.getAppendedFrag(r,Xe.MAIN))==null?void 0:o.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn("Error executing block-audio operation",o)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:n}=this;e&&n&&(this.blockedAudioAppend=null,n.unblockAudio(e.op))}onBufferAppending(e,n){const{tracks:i}=this,{data:r,type:s,parent:a,frag:o,part:l,chunkMeta:u,offset:d}=n,f=u.buffering[s],{sn:p,cc:m}=o,y=self.performance.now();f.start=y;const b=o.stats.buffering,E=l?l.stats.buffering:null;b.start===0&&(b.start=y),E&&E.start===0&&(E.start=y);const T=i.audio;let x=!1;s==="audio"&&(T==null?void 0:T.container)==="audio/mpeg"&&(x=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const S=i.video,w=S==null?void 0:S.buffer;if(w&&p!=="initSegment"){const L=l||o,N=this.blockedAudioAppend;if(s==="audio"&&a!=="main"&&!this.blockedAudioAppend&&!(S.ending||S.ended)){const O=L.start+L.duration*.05,D=w.buffered,V=this.currentOp("video");!D.length&&!V?this.blockAudio(L):!V&&!pt.isBuffered(w,O)&&this.lastVideoAppendEnd<O&&this.blockAudio(L)}else if(s==="video"){const G=L.end;if(N){const O=N.frag.start;(G>O||G<this.lastVideoAppendEnd||pt.isBuffered(w,O))&&this.unblockAudio()}this.lastVideoAppendEnd=G}}const C=(l||o).start,I={label:`append-${s}`,execute:()=>{var L;f.executeStart=self.performance.now();const N=(L=this.tracks[s])==null?void 0:L.buffer;N&&(x?this.updateTimestampOffset(N,C,.1,s,p,m):d!==void 0&&We(d)&&this.updateTimestampOffset(N,d,1e-6,s,p,m)),this.appendExecutor(r,s)},onStart:()=>{},onComplete:()=>{const L=self.performance.now();f.executeEnd=f.end=L,b.first===0&&(b.first=L),E&&E.first===0&&(E.first=L);const N={};this.sourceBuffers.forEach(([G,O])=>{G&&(N[G]=pt.getBuffered(O))}),this.appendErrors[s]=0,s==="audio"||s==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(M.BUFFER_APPENDED,{type:s,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:N})},onError:L=>{var N;const G={type:it.MEDIA_ERROR,parent:o.type,details:pe.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:o,part:l,chunkMeta:u,error:L,err:L,fatal:!1},O=(N=this.media)==null?void 0:N.error;if(L.code===DOMException.QUOTA_EXCEEDED_ERR||L.name=="QuotaExceededError"||"quota"in L)G.details=pe.BUFFER_FULL_ERROR;else if(L.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!O)G.errorAction=Ou(!0);else if(L.name===l4&&this.sourceBufferCount===0)G.errorAction=Ou(!0);else{const D=++this.appendErrors[s];this.warn(`Failed ${D}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${s}" sourceBuffer (${O||"no media error"})`),(D>=this.hls.config.appendErrorMaxRetry||O)&&(G.fatal=!0)}this.hls.trigger(M.ERROR,G)}};this.log(`queuing "${s}" append sn: ${p}${l?" p: "+l.index:""} of ${o.type===Xe.MAIN?"level":"track"} ${o.level} cc: ${m}`),this.append(I,s,this.isPending(this.tracks[s]))}getFlushOp(e,n,i){return this.log(`queuing "${e}" remove ${n}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(e,n,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(M.BUFFER_FLUSHED,{type:e})},onError:r=>{this.warn(`Failed to remove ${n}-${i} from "${e}" SourceBuffer`,r)}}}onBufferFlushing(e,n){const{type:i,startOffset:r,endOffset:s}=n;i?this.append(this.getFlushOp(i,r,s),i):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,r,s),a)})}onFragParsed(e,n){const{frag:i,part:r}=n,s=[],a=r?r.elementaryStreams:i.elementaryStreams;a[jt.AUDIOVIDEO]?s.push("audiovideo"):(a[jt.AUDIO]&&s.push("audio"),a[jt.VIDEO]&&s.push("video"));const o=()=>{const l=self.performance.now();i.stats.buffering.end=l,r&&(r.stats.buffering.end=l);const u=r?r.stats:i.stats;this.hls.trigger(M.FRAG_BUFFERED,{frag:i,part:r,stats:u,id:i.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(o,s).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,n){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const n=this.tracks[e];if(n)return!n.ended||n.ending}return!1})}onBufferEos(e,n){var i;this.sourceBuffers.forEach(([a])=>{if(a){const o=this.tracks[a];(!n.type||n.type===a)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${a} buffer reached EOS`)))}});const r=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var o;return a&&!((o=this.tracks[a])!=null&&o.ended)})?r?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(M.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(M.BUFFERED_TO_END,void 0)):n.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const n=this.tracks[e];n&&(n.ending=!1)}})}onLevelUpdated(e,{details:n}){n.fragments.length&&(this.details=n,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,n){if(n.details===pe.BUFFER_APPEND_ERROR&&n.frag){var i;const r=(i=n.errorAction)==null?void 0:i.nextAutoLevel;We(r)&&r!==n.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:n,media:i}=this;if(!i||n===null||!this.sourceBufferCount)return;const r=e.config,s=i.currentTime,a=n.levelTargetDuration,o=n.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(We(o)&&o>=0){const u=Math.max(o,a),d=Math.floor(s/a)*a-u;this.flushBackBuffer(s,a,d)}const l=r.frontBufferFlushThreshold;if(We(l)&&l>0){const u=Math.max(r.maxBufferLength,l),d=Math.max(u,a),f=Math.floor(s/a)*a+d;this.flushFrontBuffer(s,a,f)}}flushBackBuffer(e,n,i){this.sourceBuffers.forEach(([r,s])=>{if(s){const o=pt.getBuffered(s);if(o.length>0&&i>o.start(0)){var a;this.hls.trigger(M.BACK_BUFFER_REACHED,{bufferEnd:i});const l=this.tracks[r];if((a=this.details)!=null&&a.live)this.hls.trigger(M.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(l!=null&&l.ended){this.log(`Cannot flush ${r} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(M.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:r})}}})}flushFrontBuffer(e,n,i){this.sourceBuffers.forEach(([r,s])=>{if(s){const a=pt.getBuffered(s),o=a.length;if(o<2)return;const l=a.start(o-1),u=a.end(o-1);if(i>l||e>=l&&e<=u)return;this.hls.trigger(M.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:r})}})}getDurationAndRange(){var e;const{details:n,mediaSource:i}=this;if(!n||!this.media||(i==null?void 0:i.readyState)!=="open")return null;const r=n.edge;if(n.live&&this.hls.config.liveDurationInfinity){if(n.fragments.length&&i.setLiveSeekableRange){const u=Math.max(0,n.fragmentStart),d=Math.max(u,r);return{duration:1/0,start:u,end:d}}return{duration:1/0}}const s=(e=this.overrides)==null?void 0:e.duration;if(s)return We(s)?{duration:s}:null;const a=this.media.duration,o=We(i.duration)?i.duration:0;return r>o&&r>a||!We(a)?{duration:r}:null}updateMediaSource({duration:e,start:n,end:i}){const r=this.mediaSource;!this.media||!r||r.readyState!=="open"||(r.duration!==e&&(We(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),n!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${n}-${i}.`),r.setLiveSeekableRange(n,i)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:n,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${n} codec events expected: ${e}) ${Wt(i)}`),this.tracksReady){var r;const s=(r=this.transferData)==null?void 0:r.tracks;s&&Object.keys(s).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([n,i])=>{if(n){const r=this.tracks[n];e[n]={buffer:i,container:r.container,codec:r.codec,supplemental:r.supplemental,levelCodec:r.levelCodec,id:r.id,metadata:r.metadata}}}),this.hls.trigger(M.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([n])=>{this.executeNext(n)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:n,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const a=s,o=e[a];if(this.isPending(o)){const l=this.getTrackCodec(o,a),u=`${o.container};codecs=${l}`;o.codec=l,this.log(`creating sourceBuffer(${u})${this.currentOp(a)?" Queued":""} ${Wt(o)}`);try{const d=i.addSourceBuffer(u),f=D1(a),p=[a,d];n[f]=p,o.buffer=d}catch(d){var r;this.error(`error while trying to add sourceBuffer: ${d.message}`),this.shiftAndExecuteNext(a),(r=this.operationQueue)==null||r.removeBlockers(),delete this.tracks[a],this.hls.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:d,sourceBufferName:a,mimeType:u,parent:o.id});return}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(e,n){const i=e.supplemental;let r=e.codec;i&&(n==="video"||n==="audiovideo")&&Mc(i,"video")&&(r=MY(r,i));const s=ph(r,e.levelCodec);return s?n.slice(0,5)==="audio"?Uh(s,this.appendSource):s:""}trackSourceBuffer(e,n){const i=n.buffer;if(!i)return;const r=this.getTrackCodec(n,e);this.tracks[e]={buffer:i,codec:r,container:n.container,levelCodec:n.levelCodec,supplemental:n.supplemental,metadata:n.metadata,id:n.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(s,a)=>{const o=a.removedRanges;o!=null&&o.length&&this.hls.trigger(M.BUFFER_FLUSHED,{type:s})})}get mediaSrc(){var e,n;const i=((e=this.media)==null||(n=e.querySelector)==null?void 0:n.call(e,"source"))||this.media;return i==null?void 0:i.src}onSBUpdateStart(e){const n=this.currentOp(e);n&&n.onStart()}onSBUpdateEnd(e){var n;if(((n=this.mediaSource)==null?void 0:n.readyState)==="closed"){this.resetBuffer(e);return}const i=this.currentOp(e);i&&(i.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,n){var i;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${r}`,n),this.hls.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const s=this.currentOp(e);s&&s.onError(r)}updateTimestampOffset(e,n,i,r,s,a){const o=n-e.timestampOffset;Math.abs(o)>=i&&(this.log(`Updating ${r} SourceBuffer timestampOffset to ${n} (sn: ${s} cc: ${a})`),e.timestampOffset=n)}removeExecutor(e,n,i){const{media:r,mediaSource:s}=this,a=this.tracks[e],o=a==null?void 0:a.buffer;if(!r||!s||!o){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const l=We(r.duration)?r.duration:1/0,u=We(s.duration)?s.duration:1/0,d=Math.max(0,n),f=Math.min(i,l,u);f>d&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${d},${f}] from the ${e} SourceBuffer`),o.remove(d,f)):this.shiftAndExecuteNext(e)}appendExecutor(e,n){const i=this.tracks[n],r=i==null?void 0:i.buffer;if(!r)throw new WX(`Attempting to append to the ${n} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,r.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(n=>{this.warn(`SourceBuffer blocked callback ${n}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(n){this.warn(`Callback run without blocking ${this.operationQueue} ${n}`)}}isUpdating(){return this.sourceBuffers.some(([e,n])=>e&&n.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,n=this.sourceBufferTypes){if(!n.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:i}=this,r=n.map(a=>this.appendBlocker(a));return n.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(r).then(a=>{i===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(n=>{var i;const r=(i=this.tracks[n])==null?void 0:i.buffer;!r||r.updating||this.shiftAndExecuteNext(n)})}append(e,n,i){this.operationQueue&&this.operationQueue.append(e,n,i)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,n)=>e+(this.isPending(this.tracks[n])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[n])=>e+(n?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,n,i){const r=this.tracks[e];if(!r)return;const s=r.buffer;if(!s)return;const a=i.bind(this,e);r.listeners.push({event:n,listener:a}),s.addEventListener(n,a)}removeBufferListeners(e){const n=this.tracks[e];if(!n)return;const i=n.buffer;i&&(n.listeners.forEach(r=>{i.removeEventListener(r.event,r.listener)}),n.listeners.length=0)}}function hC(t){const e=t.querySelectorAll("source");[].slice.call(e).forEach(n=>{t.removeChild(n)})}function YX(t,e){const n=self.document.createElement("source");n.type="video/mp4",n.src=e,t.appendChild(n)}function D1(t){return t==="audio"?1:0}class Vb{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(M.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(M.BUFFER_CODECS,this.onBufferCodecs,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(M.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(M.BUFFER_CODECS,this.onBufferCodecs,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,n){const i=this.hls.levels[n.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,n){this.media=n.media instanceof HTMLVideoElement?n.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,n){const i=this.hls;this.restrictedLevels=[],this.firstLevel=n.firstLevel,i.config.capLevelToPlayerSize&&n.video&&this.startCapping()}onLevelsUpdated(e,n){this.timer&&We(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,n){this.hls.config.capLevelToPlayerSize&&n.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const n=this.hls,i=this.getMaxLevel(e.length-1);i!==this.autoLevelCapping&&n.logger.log(`Setting autoLevelCapping to ${i}: ${e[i].height}p@${e[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),n.autoLevelCapping=i,n.autoLevelEnabled&&n.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping}}}getMaxLevel(e){const n=this.hls.levels;if(!n.length)return-1;const i=n.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,Vb.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,n={width:0,height:0};if(e){const i=e.getBoundingClientRect();n.width=i.width,n.height=i.height,!n.width&&!n.height&&(n.width=i.right-i.left||e.width||0,n.height=i.bottom-i.top||e.height||0)}return this.clientRect=n,n}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,n,i){if(!(e!=null&&e.length))return-1;const r=(o,l)=>l?o.width!==l.width||o.height!==l.height:!0;let s=e.length-1;const a=Math.max(n,i);for(let o=0;o<e.length;o+=1){const l=e[o];if((l.width>=a||l.height>=a)&&r(l,e[o+1])){s=o;break}}return s}}const KX={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},oi=KX,XX={HLS:"h"},QX=XX;class Ir{constructor(e,n){Array.isArray(e)&&(e=e.map(i=>i instanceof Ir?i:new Ir(i))),this.value=e,this.params=n}}const ZX="Dict";function JX(t){return Array.isArray(t)?JSON.stringify(t):t instanceof Map?"Map{}":t instanceof Set?"Set{}":typeof t=="object"?JSON.stringify(t):String(t)}function eQ(t,e,n,i){return new Error(`failed to ${t} "${JX(e)}" as ${n}`,{cause:i})}function Lr(t,e,n){return eQ("serialize",t,e,n)}class c4{constructor(e){this.description=e}}const pC="Bare Item",tQ="Boolean";function nQ(t){if(typeof t!="boolean")throw Lr(t,tQ);return t?"?1":"?0"}function iQ(t){return btoa(String.fromCharCode(...t))}const rQ="Byte Sequence";function sQ(t){if(ArrayBuffer.isView(t)===!1)throw Lr(t,rQ);return`:${iQ(t)}:`}const aQ="Integer";function oQ(t){return t<-999999999999999||999999999999999<t}function d4(t){if(oQ(t))throw Lr(t,aQ);return t.toString()}function uQ(t){return`@${d4(t.getTime()/1e3)}`}function f4(t,e){if(t<0)return-f4(-t,e);const n=Math.pow(10,e);if(Math.abs(t*n%1-.5)<Number.EPSILON){const r=Math.floor(t*n);return(r%2===0?r:r+1)/n}else return Math.round(t*n)/n}const lQ="Decimal";function cQ(t){const e=f4(t,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Lr(t,lQ);const n=e.toString();return n.includes(".")?n:`${n}.0`}const dQ="String",fQ=/[\x00-\x1f\x7f]+/;function hQ(t){if(fQ.test(t))throw Lr(t,dQ);return`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function pQ(t){return t.description||t.toString().slice(7,-1)}const mQ="Token";function mC(t){const e=pQ(t);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Lr(e,mQ);return e}function ev(t){switch(typeof t){case"number":if(!We(t))throw Lr(t,pC);return Number.isInteger(t)?d4(t):cQ(t);case"string":return hQ(t);case"symbol":return mC(t);case"boolean":return nQ(t);case"object":if(t instanceof Date)return uQ(t);if(t instanceof Uint8Array)return sQ(t);if(t instanceof c4)return mC(t);default:throw Lr(t,pC)}}const gQ="Key";function tv(t){if(/^[a-z*][a-z0-9\-_.*]*$/.test(t)===!1)throw Lr(t,gQ);return t}function Gb(t){return t==null?"":Object.entries(t).map(([e,n])=>n===!0?`;${tv(e)}`:`;${tv(e)}=${ev(n)}`).join("")}function h4(t){return t instanceof Ir?`${ev(t.value)}${Gb(t.params)}`:ev(t)}function yQ(t){return`(${t.value.map(h4).join(" ")})${Gb(t.params)}`}function vQ(t,e={whitespace:!0}){if(typeof t!="object"||t==null)throw Lr(t,ZX);const n=t instanceof Map?t.entries():Object.entries(t),i=e!=null&&e.whitespace?" ":"";return Array.from(n).map(([r,s])=>{s instanceof Ir||(s=new Ir(s));let a=tv(r);return s.value===!0?a+=Gb(s.params):(a+="=",Array.isArray(s.value)?a+=yQ(s):a+=h4(s)),a}).join(`,${i}`)}function p4(t,e){return vQ(t,e)}const vr="CMCD-Object",ln="CMCD-Request",ja="CMCD-Session",Qs="CMCD-Status",bQ={br:vr,ab:vr,d:vr,ot:vr,tb:vr,tpb:vr,lb:vr,tab:vr,lab:vr,url:vr,pb:ln,bl:ln,tbl:ln,dl:ln,ltc:ln,mtp:ln,nor:ln,nrr:ln,rc:ln,sn:ln,sta:ln,su:ln,ttfb:ln,ttfbb:ln,ttlb:ln,cmsdd:ln,cmsds:ln,smrt:ln,df:ln,cs:ln,ts:ln,cid:ja,pr:ja,sf:ja,sid:ja,st:ja,v:ja,msd:ja,bs:Qs,bsd:Qs,cdn:Qs,rtp:Qs,bg:Qs,pt:Qs,ec:Qs,e:Qs},EQ={REQUEST:ln};function TQ(t){return Object.keys(t).reduce((e,n)=>{var i;return(i=t[n])===null||i===void 0||i.forEach(r=>e[r]=n),e},{})}function xQ(t,e){const n={};if(!t)return n;const i=Object.keys(t),r=e?TQ(e):{};return i.reduce((s,a)=>{var o;const l=bQ[a]||r[a]||EQ.REQUEST,u=(o=s[l])!==null&&o!==void 0?o:s[l]={};return u[a]=t[a],s},n)}function SQ(t){return["ot","sf","st","e","sta"].includes(t)}function AQ(t){return typeof t=="number"?We(t):t!=null&&t!==""&&t!==!1}const m4="event";function wQ(t,e){const n=new URL(t),i=new URL(e);if(n.origin!==i.origin)return t;const r=n.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")+n.search+n.hash}const bh=t=>Math.round(t),nv=(t,e)=>Array.isArray(t)?t.map(n=>nv(n,e)):t instanceof Ir&&typeof t.value=="string"?new Ir(nv(t.value,e),t.params):(e.baseUrl&&(t=wQ(t,e.baseUrl)),e.version===1?encodeURIComponent(t):t),Yf=t=>bh(t/100)*100,CQ=(t,e)=>{let n=t;return e.version>=2&&(t instanceof Ir&&typeof t.value=="string"?n=new Ir([t]):typeof t=="string"&&(n=[t])),nv(n,e)},RQ={br:bh,d:bh,bl:Yf,dl:Yf,mtp:Yf,nor:CQ,rtp:Yf,tb:bh},g4="request",y4="response",jb=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],_Q=["e"],IQ=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function A0(t){return IQ.test(t)}function LQ(t){return jb.includes(t)||_Q.includes(t)||A0(t)}const v4=["d","dl","nor","ot","rtp","su"];function DQ(t){return jb.includes(t)||v4.includes(t)||A0(t)}const OQ=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function PQ(t){return jb.includes(t)||v4.includes(t)||OQ.includes(t)||A0(t)}const kQ=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function NQ(t){return kQ.includes(t)||A0(t)}const MQ={[y4]:PQ,[m4]:LQ,[g4]:DQ};function b4(t,e={}){const n={};if(t==null||typeof t!="object")return n;const i=e.version||t.v||1,r=e.reportingMode||g4,s=i===1?NQ:MQ[r];let a=Object.keys(t).filter(s);const o=e.filter;typeof o=="function"&&(a=a.filter(o));const l=r===y4||r===m4;l&&!a.includes("ts")&&a.push("ts"),i>1&&!a.includes("v")&&a.push("v");const u=Vt({},RQ,e.formatters),d={version:i,reportingMode:r,baseUrl:e.baseUrl};return a.sort().forEach(f=>{let p=t[f];const m=u[f];if(typeof m=="function"&&(p=m(p,d)),f==="v"){if(i===1)return;p=i}f=="pr"&&p===1||(l&&f==="ts"&&!We(p)&&(p=Date.now()),AQ(p)&&(SQ(f)&&typeof p=="string"&&(p=new c4(p)),n[f]=p))}),n}function BQ(t,e={}){const n={};if(!t)return n;const i=b4(t,e),r=xQ(i,e==null?void 0:e.customHeaderMap);return Object.entries(r).reduce((s,[a,o])=>{const l=p4(o,{whitespace:!1});return l&&(s[a]=l),s},n)}function FQ(t,e,n){return Vt(t,BQ(e,n))}const UQ="CMCD";function HQ(t,e={}){return t?p4(b4(t,e),{whitespace:!1}):""}function zQ(t,e={}){if(!t)return"";const n=HQ(t,e);return encodeURIComponent(n)}function qQ(t,e={}){if(!t)return"";const n=zQ(t,e);return`${UQ}=${n}`}const gC=/CMCD=[^&#]+/;function VQ(t,e,n){const i=qQ(e,n);if(!i)return t;if(gC.test(t))return t.replace(gC,i);const r=t.includes("?")?"&":"?";return`${t}${r}${i}`}class GQ{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:oi.MANIFEST,su:!this.initialized})}catch(s){this.hls.logger.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const{frag:s,part:a}=r,o=this.hls.levels[s.level],l=this.getObjectType(s),u={d:(a||s).duration*1e3,ot:l};(l===oi.VIDEO||l===oi.AUDIO||l==oi.MUXED)&&(u.br=o.bitrate/1e3,u.tb=this.getTopBandwidth(l)/1e3,u.bl=this.getBufferLength(l));const d=a?this.getNextPart(a):this.getNextFrag(s);d!=null&&d.url&&d.url!==s.url&&(u.nor=d.url),this.apply(r,u)}catch(s){this.hls.logger.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const n=this.config=e.config,{cmcd:i}=n;i!=null&&(n.pLoader=this.createPlaylistLoader(),n.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||e.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHED,this.onMediaDetached,this),e.on(M.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHED,this.onMediaDetached,this),e.off(M.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,n){this.media=n.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,n){var i,r;this.audioBuffer=(i=n.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(r=n.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:QX.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,n={}){Vt(n,this.createData());const i=n.ot===oi.INIT||n.ot===oi.VIDEO||n.ot===oi.MUXED;this.starved&&i&&(n.bs=!0,n.su=!0,this.starved=!1),n.su==null&&(n.su=this.buffering);const{includeKeys:r}=this;r&&(n=Object.keys(n).reduce((a,o)=>(r.includes(o)&&(a[o]=n[o]),a),{}));const s={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),FQ(e.headers,n,s)):e.url=VQ(e.url,n,s)}getNextFrag(e){var n;const i=(n=this.hls.levels[e.level])==null?void 0:n.details;if(i){const r=e.sn-i.startSN;return i.fragments[r+1]}}getNextPart(e){var n;const{index:i,fragment:r}=e,s=(n=this.hls.levels[r.level])==null||(n=n.details)==null?void 0:n.partList;if(s){const{sn:a}=r;for(let o=s.length-1;o>=0;o--){const l=s[o];if(l.index===i&&l.fragment.sn===a)return s[o+1]}}}getObjectType(e){const{type:n}=e;if(n==="subtitle")return oi.TIMED_TEXT;if(e.sn==="initSegment")return oi.INIT;if(n==="audio")return oi.AUDIO;if(n==="main")return this.hls.audioTracks.length?oi.VIDEO:oi.MUXED}getTopBandwidth(e){let n=0,i;const r=this.hls;if(e===oi.AUDIO)i=r.audioTracks;else{const s=r.maxAutoLevel,a=s>-1?s+1:r.levels.length;i=r.levels.slice(0,a)}return i.forEach(s=>{s.bitrate>n&&(n=s.bitrate)}),n>0?n:NaN}getBufferLength(e){const n=this.media,i=e===oi.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!n?NaN:pt.bufferInfo(i,n.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,n=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){n(s),this.loader.load(s,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,n=this.applyFragmentData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){n(s),this.loader.load(s,a,o)}}}}const jQ=3e5;class WQ extends $i{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,n)=>(e.indexOf(n.pathwayId)===-1&&e.push(n.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const n=this.levels;n&&(this.levels=n.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,n){const{contentSteering:i}=n;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,n){this.audioTracks=n.audioTracks,this.subtitleTracks=n.subtitleTracks}onError(e,n){const{errorAction:i}=n;if((i==null?void 0:i.action)===Fn.SendAlternateToPenaltyBox&&i.flags===Ai.MoveAllAlternatesMatchingHost){const r=this.levels;let s=this._pathwayPriority,a=this.pathwayId;if(n.context){const{groupId:o,pathwayId:l,type:u}=n.context;o&&r?a=this.getPathwayForGroupId(o,u,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!s&&r&&(s=this.pathways()),s&&s.length>1&&(this.updatePathwayPriority(s),i.resolved=this.pathwayId!==a),n.details===pe.BUFFER_APPEND_ERROR&&!n.fatal?i.resolved=!0:i.resolved||this.warn(`Could not resolve ${n.details} ("${n.error.message}") with content-steering for Pathway: ${a} levels: ${r&&r.length} priorities: ${Wt(s)} penalized: ${Wt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let n=this.getLevelsForPathway(this.pathwayId);if(n.length===0){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),n=this.getLevelsForPathway(i),this.pathwayId=i}return n.length!==e.length&&this.log(`Found ${n.length}/${e.length} levels in Pathway "${this.pathwayId}"`),n}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(n=>e===n.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let n;const i=this.penalizedPathways,r=performance.now();Object.keys(i).forEach(s=>{r-i[s]>jQ&&delete i[s]});for(let s=0;s<e.length;s++){const a=e[s];if(a in i)continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(n=this.getLevelsForPathway(a),n.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,UL(n),this.hls.trigger(M.LEVELS_UPDATED,{levels:n});const u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,n,i){const r=this.getLevelsForPathway(i).concat(this.levels||[]);for(let s=0;s<r.length;s++)if(n===At.AUDIO_TRACK&&r[s].hasAudioGroup(e)||n===At.SUBTITLE_TRACK&&r[s].hasSubtitleGroup(e))return r[s].pathwayId;return i}clonePathways(e){const n=this.levels;if(!n)return;const i={},r={};e.forEach(s=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=s;if(n.some(d=>d.pathwayId===a))return;const u=this.getLevelsForPathway(o).map(d=>{const f=new sn(d.attrs);f["PATHWAY-ID"]=a;const p=f.AUDIO&&`${f.AUDIO}_clone_${a}`,m=f.SUBTITLES&&`${f.SUBTITLES}_clone_${a}`;p&&(i[f.AUDIO]=p,f.AUDIO=p),m&&(r[f.SUBTITLES]=m,f.SUBTITLES=m);const y=E4(d.uri,f["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),b=new Fc({attrs:f,audioCodec:d.audioCodec,bitrate:d.bitrate,height:d.height,name:d.name,url:y,videoCodec:d.videoCodec,width:d.width});if(d.audioGroups)for(let E=1;E<d.audioGroups.length;E++)b.addGroupId("audio",`${d.audioGroups[E]}_clone_${a}`);if(d.subtitleGroups)for(let E=1;E<d.subtitleGroups.length;E++)b.addGroupId("text",`${d.subtitleGroups[E]}_clone_${a}`);return b});n.push(...u),yC(this.audioTracks,i,l,a),yC(this.subtitleTracks,r,l,a)})}loadSteeringManifest(e){const n=this.hls.config,i=n.loader;this.loader&&this.loader.destroy(),this.loader=new i(n);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const d=(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+d)}const s={responseType:"json",url:r.href},a=n.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(d,f,p,m)=>{this.log(`Loaded steering manifest: "${r}"`);const y=d.data;if((y==null?void 0:y.VERSION)!==1){this.log(`Steering VERSION ${y.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=y.TTL;const{"RELOAD-URI":b,"PATHWAY-CLONES":E,"PATHWAY-PRIORITY":T}=y;if(b)try{this.uri=new self.URL(b,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${b}`);return}this.scheduleRefresh(this.uri||p.url),E&&this.clonePathways(E);const x={steeringManifest:y,url:r.toString()};this.hls.trigger(M.STEERING_MANIFEST_LOADED,x),T&&this.updatePathwayPriority(T)},onError:(d,f,p,m)=>{if(this.log(`Error loading steering manifest: ${d.code} ${d.text} (${f.url})`),this.stopLoad(),d.code===410){this.enabled=!1,this.log(`Steering manifest ${f.url} no longer available`);return}let y=this.timeToLoad*1e3;if(d.code===429){const b=this.loader;if(typeof(b==null?void 0:b.getResponseHeader)=="function"){const E=b.getResponseHeader("Retry-After");E&&(y=parseFloat(E)*1e3)}this.log(`Steering manifest ${f.url} rate limited`);return}this.scheduleRefresh(this.uri||f.url,y)},onTimeout:(d,f,p)=>{this.log(`Timeout loading steering manifest (${f.url})`),this.scheduleRefresh(this.uri||f.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,l,u)}scheduleRefresh(e,n=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const r=(i=this.hls)==null?void 0:i.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},n)}}function yC(t,e,n,i){t&&Object.keys(e).forEach(r=>{const s=t.filter(a=>a.groupId===r).map(a=>{const o=Vt({},a);return o.details=void 0,o.attrs=new sn(o.attrs),o.url=o.attrs.URI=E4(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),o.groupId=o.attrs["GROUP-ID"]=e[r],o.attrs["PATHWAY-ID"]=i,o});t.push(...s)})}function E4(t,e,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;e&&(o=a==null?void 0:a[e],o&&(t=o));const l=new self.URL(t);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}class ku extends $i{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=ku.CDMCleanupPromise?[ku.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=n=>{const{initDataType:i,initData:r}=n,s=`"${n.type}" event: init data type: "${i}"`;if(this.debug(s),r!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=dc(this.config));const o=a.map(S1).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(o)}this.keyFormatPromise.then(a=>{const o=gh(a);if(i!=="sinf"||o!==an.FAIRPLAY){this.log(`Ignoring "${n.type}" event with init data type: "${i}" for selected key-system ${o}`);return}let l;try{const m=Sn(new Uint8Array(r)),y=Pb(JSON.parse(m).sinf),b=gL(y);if(!b)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=new Uint8Array(b.subarray(8,24))}catch(m){this.warn(`${s} Failed to parse sinf: ${m}`);return}const u=li(l),{keyIdToKeySessionPromise:d,mediaKeySessions:f}=this;let p=d[u];for(let m=0;m<f.length;m++){const y=f[m],b=y.decryptdata;if(!b.keyId)continue;const E=li(b.keyId);if(Db(l,b.keyId)||b.uri.replace(/-/g,"").indexOf(u)!==-1){if(p=d[E],!p)continue;if(b.pssh)break;delete d[E],b.pssh=new Uint8Array(r),b.keyId=l,p=d[u]=p.then(()=>this.generateRequestWithPreferredKeySession(y,i,r,"encrypted-event-key-match")),p.catch(T=>this.handleError(T));break}}p||this.handleError(new Error(`Key ID ${u} not encountered in playlist. Key-system sessions ${f.length}.`))}).catch(a=>this.handleError(a))}},this.onWaitingForKey=n=>{this.log(`"${n.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(M.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(M.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(M.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(M.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(M.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(M.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:n,widevineLicenseUrl:i}=this.config,r=n==null?void 0:n[e];if(r)return r.licenseUrl;if(e===an.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(e){const n=this.getLicenseServerUrl(e);if(n===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return n}getServerCertificateUrl(e){const{drmSystems:n}=this.config,i=n==null?void 0:n[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const n=this.hls.levels,i=(a,o,l)=>!!a&&l.indexOf(a)===o,r=n.map(a=>a.audioCodec).filter(i),s=n.map(a=>a.videoCodec).filter(i);return r.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{const l=u=>{const d=u.shift();this.getMediaKeysPromise(d,r,s).then(f=>a({keySystem:d,mediaKeys:f})).catch(f=>{u.length?l(u):f instanceof Si?o(f):o(new Si({type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_NO_ACCESS,error:f,fatal:!0},f.message))})};l(e)})}requestMediaKeySystemAccess(e,n){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${i}`;return OL===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return i(e,n)}getMediaKeysPromise(e,n,i){var r;const s=CK(e,n,i,this.config.drmSystemOptions||{});let a=this.keySystemAccessPromises[e],o=(r=a)==null?void 0:r.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Wt(s)}`),o=this.requestMediaKeySystemAccess(e,s);const l=a=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(u=>{this.log(`Failed to obtain access to key-system "${e}": ${u}`)}),o.then(u=>{this.log(`Access for key-system "${u.keySystem}" obtained`);const d=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const f=l.mediaKeys=u.createMediaKeys().then(p=>(this.log(`Media-keys created for "${e}"`),l.hasMediaKeys=!0,d.then(m=>m?this.setMediaKeysServerCertificate(p,e,m):p)));return f.catch(p=>{this.error(`Failed to create media-keys for "${e}"}: ${p}`)}),f})}return o.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:n,mediaKeys:i}){this.log(`Creating key-system session "${n}" keyId: ${li(e.keyId||[])} keyUri: ${e.uri}`);const r=i.createSession(),s={decryptdata:e,keySystem:n,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const n=e.decryptdata;if(n.pssh){const i=this.createMediaKeySessionContext(e),r=Kf(n),s="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(i,s,n.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,n){const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyId ${li(e.decryptdata.keyId||[])}
      } (data length: ${n.byteLength})`),i.update(n)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>S1(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:n,mediaKeys:i})=>this.attemptSetMediaKeys(n,i))}selectKeySystem(e){return new Promise((n,i)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:r})=>{const s=S1(r);s?n(s):i(new Error(`Unable to find format for key-system "${r}"`))}).catch(i)})}selectKeySystemFormat(e){const n=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)),this.keyFormatPromise}getKeyFormatPromise(e){const n=dc(this.config),i=e.map(gh).filter(r=>!!r&&n.indexOf(r)!==-1);return this.selectKeySystem(i)}getKeyStatus(e){const{mediaKeySessions:n}=this;for(let i=0;i<n.length;i++){const r=$Q(e,n[i]);if(r)return r}}loadKey(e){const n=e.keyInfo.decryptdata,i=Kf(n),r=this.bannedKeyIds[i];if(r||this.getKeyStatus(n)==="internal-error"){const o=vC(r||"internal-error",n);return this.handleError(o,e.frag),Promise.reject(o)}const s=`(keyId: ${i} format: "${n.keyFormat}" method: ${n.method} uri: ${n.uri})`;this.log(`Starting session for key ${s}`);const a=this.keyIdToKeySessionPromise[i];if(!a){const o=this.getKeySystemForKeyPromise(n).then(({keySystem:l,mediaKeys:u})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${s}`),this.attemptSetMediaKeys(l,u).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:l,mediaKeys:u,decryptdata:n}))))).then(l=>{const u="cenc",d=n.pssh?n.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(l,u,d,"playlist-key")});return o.catch(l=>this.handleError(l,e.frag)),this.keyIdToKeySessionPromise[i]=o,o}return a.catch(o=>{if(o instanceof Si){const l=Bt({},o.data);this.getKeyStatus(n)==="internal-error"&&(l.decryptdata=n);const u=new Si(l,o.message);this.handleError(u,e.frag)}}),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,n){if(this.hls)if(e instanceof Si){n&&(e.data.frag=n);const i=e.data.decryptdata;this.error(`${e.message}${i?` (${li(i.keyId||[])})`:""}`),this.hls.trigger(M.ERROR,e.data)}else this.error(e.message),this.hls.trigger(M.ERROR,{type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const n=Kf(e),i=this.keyIdToKeySessionPromise[n];if(!i){const r=gh(e.keyFormat),s=r?[r]:dc(this.config);return this.attemptKeySystemAccess(s)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=dc(this.config)),e.length===0)throw new Si({type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Wt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,n){if(this.mediaKeys===n)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(i).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(n)});return this.mediaKeys=n,this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>i.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,n,i,r){var s;const a=(s=this.config.drmSystems)==null||(s=s[e.keySystem])==null?void 0:s.generateRequest;if(a)try{const y=a.call(this.hls,n,i,e);if(!y)throw new Error("Invalid response from configured generateRequest filter");n=y.initDataType,i=y.initData?y.initData:null,e.decryptdata.pssh=i?new Uint8Array(i):null}catch(y){if(this.warn(y.message),this.hls&&this.hls.config.debug)throw y}if(i===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const o=Kf(e.decryptdata),l=e.decryptdata.uri;this.log(`Generating key-session request for "${r}" keyId: ${o} URI: ${l} (init data type: ${n} length: ${i.byteLength})`);const u=new Nb,d=e._onmessage=y=>{const b=e.mediaKeysSession;if(!b){u.emit("error",new Error("invalid state"));return}const{messageType:E,message:T}=y;this.log(`"${E}" message event for session "${b.sessionId}" message size: ${T.byteLength}`),E==="license-request"||E==="license-renewal"?this.renewLicense(e,T).catch(x=>{u.eventNames().length?u.emit("error",x):this.handleError(x)}):E==="license-release"?e.keySystem===an.FAIRPLAY&&this.updateKeySession(e,Yy("acknowledged")).then(()=>this.removeSession(e)).catch(x=>this.handleError(x)):this.warn(`unhandled media key message type "${E}"`)},f=(y,b)=>{b.keyStatus=y;let E;y.startsWith("usable")?u.emit("resolved"):y==="internal-error"||y==="output-restricted"||y==="output-downscaled"?E=vC(y,b.decryptdata):y==="expired"?E=new Error(`key expired (keyId: ${o})`):y==="released"?E=new Error("key released"):y==="status-pending"||this.warn(`unhandled key status change "${y}" (keyId: ${o})`),E&&(u.eventNames().length?u.emit("error",E):this.handleError(E))},p=e._onkeystatuseschange=y=>{if(!e.mediaKeysSession){u.emit("error",new Error("invalid state"));return}const E=this.getKeyStatuses(e);if(!Object.keys(E).some(w=>E[w]!=="status-pending"))return;if(E[o]==="expired"){this.log(`Expired key ${Wt(E)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let x=E[o];if(x)f(x,e);else{var S;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(S=e.keyStatusTimeouts)[o]||(S[o]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const C=this.getKeyStatus(e.decryptdata);if(C&&C!=="status-pending")return this.log(`No status for keyId ${o} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${C} from other session.`),f(C,e);this.log(`key status for ${o} in key-session "${e.mediaKeysSession.sessionId}" timed out after 0ms`),x="internal-error",f(x,e)},0)),this.log(`No status for keyId ${o} (${Wt(E)}).`)}};Jn(e.mediaKeysSession,"message",d),Jn(e.mediaKeysSession,"keystatuseschange",p);const m=new Promise((y,b)=>{u.on("error",b),u.on("resolved",y)});return e.mediaKeysSession.generateRequest(n,i).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${o} URI: ${l}`)}).catch(y=>{throw new Si({type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_NO_SESSION,error:y,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>m).catch(y=>(u.removeAllListeners(),this.removeSession(e).then(()=>{throw y}))).then(()=>(u.removeAllListeners(),e))}getKeyStatuses(e){const n={};return e.mediaKeysSession.keyStatuses.forEach((i,r)=>{if(typeof r=="string"&&typeof i=="object"){const o=r;r=i,i=o}const s="buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r);e.keySystem===an.PLAYREADY&&s.length===16&&DL(s);const a=li(s);i==="internal-error"&&(this.bannedKeyIds[a]=i),this.log(`key status change "${i}" for keyStatuses keyId: ${a} key-session "${e.mediaKeysSession.sessionId}"`),n[a]=i}),n}fetchServerCertificate(e){const n=this.config,i=n.loader,r=new i(n),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:s},u=n.certLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(p,m,y,b)=>{a(p.data)},onError:(p,m,y,b)=>{o(new Si({type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:Bt({url:l.url,data:void 0},p)},`"${e}" certificate request failed (${s}). Status: ${p.code} (${p.text})`))},onTimeout:(p,m,y)=>{o(new Si({type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(p,m,y)=>{o(new Error("aborted"))}};r.load(l,d,f)})):Promise.resolve()}setMediaKeysServerCertificate(e,n,i){return new Promise((r,s)=>{e.setServerCertificate(i).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${i.byteLength}) on "${n}"`),r(e)}).catch(a=>{s(new Si({type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,n){return this.requestLicense(e,new Uint8Array(n)).then(i=>this.updateKeySession(e,new Uint8Array(i)).catch(r=>{throw new Si({type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:r,fatal:!1},r.message)}))}unpackPlayReadyKeyMessage(e,n){const i=String.fromCharCode.apply(null,new Uint16Array(n.buffer));if(!i.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),n;const r=new DOMParser().parseFromString(i,"application/xml"),s=r.querySelectorAll("HttpHeader");if(s.length>0){let d;for(let f=0,p=s.length;f<p;f++){var a,o;d=s[f];const m=(a=d.querySelector("name"))==null?void 0:a.textContent,y=(o=d.querySelector("value"))==null?void 0:o.textContent;m&&y&&e.setRequestHeader(m,y)}}const l=r.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Yy(atob(u))}setupLicenseXHR(e,n,i,r){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,n,i,r)}).catch(a=>{if(!i.decryptdata)throw a;return e.open("POST",n,!0),s.call(this.hls,e,n,i,r)}).then(a=>(e.readyState||e.open("POST",n,!0),{xhr:e,licenseChallenge:a||r})):(e.open("POST",n,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,n){const i=this.config.keyLoadPolicy.default;return new Promise((r,s)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,o,a,e)}catch(d){this.error(d)}r(l)}else{const l=i.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||o.status>=400&&o.status<500)s(new Si({type:it.KEY_SYSTEM_ERROR,details:pe.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const d=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${d} attempts left`),this.requestLicense(e,n).then(r,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,n).then(({xhr:l,licenseChallenge:u})=>{e.keySystem==an.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)}).catch(s)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,n){if(!this.config.emeEnabled)return;const i=n.media;this.media=i,Jn(i,"encrypted",this.onMediaEncrypted),Jn(i,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(ci(e,"encrypted",this.onMediaEncrypted),ci(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const n=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Uc.clearKeyUriToKeyIdMap();const r=i.length;ku.CDMCleanupPromise=Promise.all(i.map(s=>this.removeSession(s)).concat((n==null||(e=n.setMediaKeys(null))==null?void 0:e.catch(s=>{this.log(`Could not clear media keys: ${s}`),this.hls&&this.hls.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${s}`)})}))||Promise.resolve())).catch(s=>{this.log(`Could not close sessions and clear media keys: ${s}`),this.hls&&this.hls.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${s}`)})}).then(()=>{r&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null,this.bannedKeyIds={}}onManifestLoaded(e,{sessionKeys:n}){if(!(!n||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=n.reduce((r,s)=>(r.indexOf(s.keyFormat)===-1&&r.push(s.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(e){const{mediaKeysSession:n,licenseXhr:i,decryptdata:r}=e;if(n){this.log(`Remove licenses and keys and close session "${n.sessionId}" keyId: ${li((r==null?void 0:r.keyId)||[])}`),e._onmessage&&(n.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(n.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(e);s>-1&&this.mediaKeySessions.splice(s,1);const{keyStatusTimeouts:a}=e;a&&Object.keys(a).forEach(u=>self.clearTimeout(a[u]));const{drmSystemOptions:o}=this.config;return(_K(o)?new Promise((u,d)=>{self.setTimeout(()=>d(new Error("MediaKeySession.remove() timeout")),8e3),n.remove().then(u).catch(d)}):Promise.resolve()).catch(u=>{this.log(`Could not remove session: ${u}`),this.hls&&this.hls.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${u}`)})}).then(()=>n.close()).catch(u=>{this.log(`Could not close session: ${u}`),this.hls&&this.hls.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${u}`)})})}return Promise.resolve()}}ku.CDMCleanupPromise=void 0;function Kf(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return li(t.keyId)}function $Q(t,e){if(t.keyId&&e.mediaKeysSession.keyStatuses.has(t.keyId))return e.mediaKeysSession.keyStatuses.get(t.keyId);if(t.matches(e.decryptdata))return e.keyStatus}class Si extends Error{constructor(e,n){super(n),this.data=void 0,e.error||(e.error=new Error(n)),this.data=e,e.err=e.error}}function vC(t,e){const n=t==="output-restricted",i=n?pe.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:pe.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new Si({type:it.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:e},n?"HDCP level output restricted":`key status changed to "${t}"`)}class YQ{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(M.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(M.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,n){const i=this.hls.config;if(i.capLevelOnFPSDrop){const r=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,n,i){const r=performance.now();if(n){if(this.lastTime){const s=r-this.lastTime,a=i-this.lastDroppedFrames,o=n-this.lastDecodedFrames,l=1e3*a/s,u=this.hls;if(u.trigger(M.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:i}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*o){let d=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=d)&&(d=d-1,u.trigger(M.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:u.currentLevel}),u.autoLevelCapping=d,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=n}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const n=e.getVideoPlaybackQuality();this.checkFPS(e,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function T4(t,e){let n;try{n=new Event("addtrack")}catch{n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=t,e.dispatchEvent(n)}function x4(t,e){const n=t.mode;if(n==="disabled"&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){Ft.debug(`[texttrack-utils]: ${i}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,t.addCue(r)}catch(r){Ft.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}n==="disabled"&&(t.mode=n)}function _u(t,e){const n=t.mode;if(n==="disabled"&&(t.mode="hidden"),t.cues)for(let i=t.cues.length;i--;)e&&t.cues[i].removeEventListener("enter",e),t.removeCue(t.cues[i]);n==="disabled"&&(t.mode=n)}function iv(t,e,n,i){const r=t.mode;if(r==="disabled"&&(t.mode="hidden"),t.cues&&t.cues.length>0){const s=XQ(t.cues,e,n);for(let a=0;a<s.length;a++)(!i||i(s[a]))&&t.removeCue(s[a])}r==="disabled"&&(t.mode=r)}function KQ(t,e){if(e<=t[0].startTime)return 0;const n=t.length-1;if(e>t[n].endTime)return-1;let i=0,r=n,s;for(;i<=r;)if(s=Math.floor((r+i)/2),e<t[s].startTime)r=s-1;else if(e>t[s].startTime&&i<n)i=s+1;else return s;return t[i].startTime-e<e-t[r].startTime?i:r}function XQ(t,e,n){const i=[],r=KQ(t,e);if(r>-1)for(let s=r,a=t.length;s<a;s++){const o=t[s];if(o.startTime>=e&&o.endTime<=n)i.push(o);else if(o.startTime>n)return i}return i}function Eh(t){const e=[];for(let n=0;n<t.length;n++){const i=t[n];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&e.push(t[n])}return e}class QQ extends qb{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let n=null;const i=Eh(this.media.textTracks);for(let s=0;s<i.length;s++)if(i[s].mode==="hidden")n=i[s];else if(i[s].mode==="showing"){n=i[s];break}const r=this.findTrackForTextTrack(n);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.LEVEL_LOADING,this.onLevelLoading,this),e.on(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(M.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.LEVEL_LOADING,this.onLevelLoading,this),e.off(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(M.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(M.ERROR,this.onError,this)}onMediaAttached(e,n){this.media=n.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,n){const i=this.media;if(!i)return;const r=!!n.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,r)return;Eh(i.textTracks).forEach(a=>{_u(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,n){this.tracks=n.subtitleTracks}onSubtitleTrackLoaded(e,n){const{id:i,groupId:r,details:s}=n,a=this.tracksInGroup[i];if(!a||a.groupId!==r){this.warn(`Subtitle track with id:${i} and group:${r} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=n.details,this.log(`Subtitle track ${i} "${a.name}" lang:${a.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,n,o)}onLevelLoading(e,n){this.switchLevel(n.level)}onLevelSwitching(e,n){this.switchLevel(n.level)}switchLevel(e){const n=this.hls.levels[e];if(!n)return;const i=n.subtitleGroups||null,r=this.groupIds;let s=this.currentTrack;if(!i||(r==null?void 0:r.length)!==(i==null?void 0:i.length)||i!=null&&i.some(a=>(r==null?void 0:r.indexOf(a))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(d=>!i||i.indexOf(d.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(d=>d.default)&&(this.selectDefaultTrack=!1),a.forEach((d,f)=>{d.id=f});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const o=this.hls.config.subtitlePreference;if(!s&&o){this.selectDefaultTrack=!1;const d=wr(o,a);if(d>-1)s=a[d];else{const f=wr(o,this.tracks);s=this.tracks[f]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const u={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${i==null?void 0:i.join(",")}" group-id`),this.hls.trigger(M.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}}findTrackId(e){const n=this.tracksInGroup,i=this.selectDefaultTrack;for(let r=0;r<n.length;r++){const s=n[r];if(!(i&&!s.default||!i&&!e)&&(!e||so(s,e)))return r}if(e){for(let r=0;r<n.length;r++){const s=n[r];if(Vc(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<n.length;r++){const s=n[r];if(Vc(e.attrs,s.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const n=this.tracksInGroup;for(let i=0;i<n.length;i++){const r=n[i];if(Jy(r,e))return i}}return-1}onError(e,n){n.fatal||!n.context||n.context.type===At.SUBTITLE_TRACK&&n.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(n.context.groupId)!==-1)&&this.checkRetry(n)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const n=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&so(e,i))return i;const r=wr(e,this.tracksInGroup);if(r>-1){const s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}else{if(i)return null;{const s=wr(e,n);if(s>-1)return n[s]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,n){super.loadingPlaylist(e,n);const i=e.id,r=e.groupId,s=this.getUrlWithDirectives(e.url,n),a=e.details,o=a==null?void 0:a.age;this.log(`Loading subtitle ${i} "${e.name}" lang:${e.lang} group:${r}${(n==null?void 0:n.msn)!==void 0?" at sn "+n.msn+" part "+n.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${s}`),this.hls.trigger(M.SUBTITLE_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:n||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const n=Eh(e.textTracks),i=this.currentTrack;let r;if(i&&(r=n.filter(s=>Jy(i,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(n).forEach(s=>{s.mode!=="disabled"&&s!==r&&(s.mode="disabled")}),r){const s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(e){const n=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=n.length||!We(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,r=n[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(M.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===i&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:a,groupId:o="",name:l,type:u,url:d}=r;this.hls.trigger(M.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:d});const f=this.switchParams(r.url,i==null?void 0:i.details,r.details);this.loadPlaylist(f)}}function ZQ(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),n=e.toString();return URL.revokeObjectURL(e),n.slice(n.lastIndexOf("/")+1)}catch{let n=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(r=="x"?s:s&3|8).toString(16)})}}}function _c(t){let e=5381,n=t.length;for(;n;)e=e*33^t.charCodeAt(--n);return(e>>>0).toString()}const Nu=.025;let $h=(function(t){return t[t.Point=0]="Point",t[t.Range=1]="Range",t})({});function JQ(t,e,n){return`${t.identifier}-${n+1}-${_c(e)}`}class eZ{constructor(e,n){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=n,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var n;if(e>0&&e>=this.assetList.length)return!0;const i=this.playoutLimit;return e<=0||isNaN(i)?!1:i===0?!0:(((n=this.assetList[e])==null?void 0:n.startOffset)||0)>i}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const n=this.dateRange.tagAnchor;if(n)return O1(e,n)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const n=this.dateRange.startTime,i=O1(n,e);return n-i<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,n=We(e)?e:this.duration;return this.cumulativeDuration+n}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const n=this.resumeAnchor;if(n)return O1(e,n)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Nu))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let n;return this._duration!==null?n=this._duration:this.dateRange.duration?n=this.dateRange.duration:n=this.dateRange.plannedDuration||0,!isNaN(e)&&e<n&&(n=e),n}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?$h.Range:$h.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return tZ(this)}}function O1(t,e){return t-e.start<e.duration/2&&!(Math.abs(t-(e.start+e.duration))<Nu)?e.start:e.start+e.duration}function S4(t,e,n){const i=new self.URL(t,n);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",e),i}function P1(t,e){for(;(n=t.assetList[++e])!=null&&n.error;)var n;return e}function tZ(t){return`["${t.identifier}" ${t.cue.pre?"<pre>":t.cue.post?"<post>":""}${t.timelineStart.toFixed(2)}-${t.resumeTime.toFixed(2)}]`}function wu(t){const e=t.timelineStart,n=t.duration||0;return`["${t.identifier}" ${e.toFixed(2)}-${(e+n).toFixed(2)}]`}class nZ{constructor(e,n,i,r){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(M.PLAYOUT_LIMIT_REACHED,{})};const s=this.hls=new e(n);this.interstitial=i,this.assetItem=r;const a=()=>{this.hasDetails=!0};s.once(M.LEVEL_LOADED,a),s.once(M.AUDIO_TRACK_LOADED,a),s.once(M.SUBTITLE_TRACK_LOADED,a),s.on(M.MEDIA_ATTACHING,(o,{media:l})=>{this.removeMediaListeners(),this.mediaAttached=l,this.interstitial.playoutLimit&&(l.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&s.on(M.BUFFER_APPENDED,()=>{const d=this.bufferedEnd;this.reachedPlayout(d)&&(this._bufferedEosTime=d,s.trigger(M.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let n=this.assetItem.uri;try{n=S4(n,e.config.primarySessionId||"").href}catch{}e.loadSource(n)}}bufferedInPlaceToEnd(e){var n;if(!this.appendInPlace)return!1;if((n=this.hls)!=null&&n.bufferedToEnd)return!0;if(!e)return!1;const i=Math.min(this._bufferedEosTime||1/0,this.duration),r=this.timelineOffset,s=pt.bufferInfo(e,r,0);return this.getAssetTime(s.end)>=i-.02}reachedPlayout(e){const i=this.interstitial.playoutLimit;return this.startOffset+e>=i}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const n=pt.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(n.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const n=this.interstitial.playoutLimit;if(n){const i=n-this.startOffset;if(i>0&&i<e)return i}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const n=this.timelineOffset;if(e!==n){const i=e-n;if(Math.abs(i)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const n=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,e-n),i)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var n;this.loadSource(),(n=this.hls)==null||n.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const n=i=>delete i.details;e.levels.forEach(n),e.allAudioTracks.forEach(n),e.allSubtitleTracks.forEach(n),this.hasDetails=!1}}on(e,n,i){var r;(r=this.hls)==null||r.on(e,n)}once(e,n,i){var r;(r=this.hls)==null||r.once(e,n)}off(e,n,i){var r;(r=this.hls)==null||r.off(e,n)}toString(){var e;return`HlsAssetPlayer: ${wu(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const bC=.033;class iZ extends $i{constructor(e,n){super("interstitials-sched",n),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,n){return this.events?this.events.reduce((i,r)=>e<=r.startOffset&&n>r.startOffset?(delete r.error,i+1):i,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,n){if(e.event)return this.findEventIndex(e.event.identifier);let i=-1;e.nextEvent?i=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(i=this.findEventIndex(e.previousEvent.identifier)+1);const r=this.items;if(r)for(r[i]||(n===void 0&&(n=e.start),i=this.findItemIndexAtTime(n));i>=0&&(s=r[i])!=null&&s.event;){var s;i--}return i}findItemIndexAtTime(e,n){const i=this.items;if(i)for(let r=0;r<i.length;r++){let s=i[r];if(n&&n!=="primary"&&(s=s[n]),e===s.start||e>s.start&&e<s.end)return r}return-1}findJumpRestrictedIndex(e,n){const i=this.items;if(i)for(let r=e;r<=n&&i[r];r++){const s=i[r].event;if(s!=null&&s.restrictions.jump&&!s.appendInPlace)return r}return-1}findEventIndex(e){const n=this.items;if(n)for(let r=n.length;r--;){var i;if(((i=n[r].event)==null?void 0:i.identifier)===e)return r}return-1}findAssetIndex(e,n){const i=e.assetList,r=i.length;if(r>1)for(let s=0;s<r;s++){const a=i[s];if(!a.error){const o=a.timelineStart;if(n===o||n>o&&(n<o+(a.duration||0)||s===r-1))return s}}return 0}get assetIdAtEnd(){var e;const n=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(n){const i=n.assetList,r=i[i.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,n){const i=e.main.details,{dateRanges:r}=i,s=this.events,a=this.parseDateRanges(r,{url:i.url},n),o=Object.keys(r),l=s?s.filter(u=>!o.includes(u.identifier)):[];a.length&&a.sort((u,d)=>{const f=u.cue.pre,p=u.cue.post,m=d.cue.pre,y=d.cue.post;if(f&&!m)return-1;if(m&&!f||p&&!y)return 1;if(y&&!p)return-1;if(!f&&!m&&!p&&!y){const b=u.startTime,E=d.startTime;if(b!==E)return b-E}return u.dateRange.tagOrder-d.dateRange.tagOrder}),this.events=a,l.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,l)}updateSchedule(e,n=[],i=!1){const r=this.events||[];if(r.length||n.length||this.length<2){const s=this.items,a=this.parseSchedule(r,e);(i||n.length||(s==null?void 0:s.length)!==a.length||a.some((l,u)=>Math.abs(l.playout.start-s[u].playout.start)>.005||Math.abs(l.playout.end-s[u].playout.end)>.005))&&(this.items=a,this.onScheduleUpdate(n,s))}}parseDateRanges(e,n,i){const r=[],s=Object.keys(e);for(let a=0;a<s.length;a++){const o=s[a],l=e[o];if(l.isInterstitial){let u=this.eventMap[o];u?u.setDateRange(l):(u=new eZ(l,n),this.eventMap[o]=u,i===!1&&(u.appendInPlace=i)),r.push(u)}}return r}parseSchedule(e,n){const i=[],r=n.main.details,s=r.live?1/0:r.edge;let a=0;if(e=e.filter(l=>!l.error&&!(l.cue.once&&l.hasPlayed)),e.length){this.resolveOffsets(e,n);let l=0,u=0;if(e.forEach((d,f)=>{const p=d.cue.pre,m=d.cue.post,y=e[f-1]||null,b=d.appendInPlace,E=m?s:d.startOffset,T=d.duration,x=d.timelineOccupancy===$h.Range?T:0,S=d.resumptionOffset,w=(y==null?void 0:y.startTime)===E,C=E+d.cumulativeDuration;let I=b?C+T:E+S;if(p||!m&&E<=0){const N=u;u+=x,d.timelineStart=C;const G=a;a+=T,i.push({event:d,start:C,end:I,playout:{start:G,end:a},integrated:{start:N,end:u}})}else if(E<=s){if(!w){const O=E-l;if(O>bC){const D=l,V=u;u+=O;const $=a;a+=O;const J={previousEvent:e[f-1]||null,nextEvent:d,start:D,end:D+O,playout:{start:$,end:a},integrated:{start:V,end:u}};i.push(J)}else O>0&&y&&(y.cumulativeDuration+=O,i[i.length-1].end=E)}m&&(I=C),d.timelineStart=C;const N=u;u+=x;const G=a;a+=T,i.push({event:d,start:C,end:I,playout:{start:G,end:a},integrated:{start:N,end:u}})}else return;const L=d.resumeTime;m||L>s?l=s:l=L}),l<s){var o;const d=l,f=u,p=s-l;u+=p;const m=a;a+=p,i.push({previousEvent:((o=i[i.length-1])==null?void 0:o.event)||null,nextEvent:null,start:l,end:d+p,playout:{start:m,end:a},integrated:{start:f,end:u}})}this.setDurations(s,a,u)}else i.push({previousEvent:null,nextEvent:null,start:0,end:s,playout:{start:0,end:s},integrated:{start:0,end:s}}),this.setDurations(s,s,s);return i}setDurations(e,n,i){this.durations={primary:e,playout:n,integrated:i}}resolveOffsets(e,n){const i=n.main.details,r=i.live?1/0:i.edge;let s=0,a=-1;e.forEach((o,l)=>{const u=o.cue.pre,d=o.cue.post,f=u?0:d?r:o.startTime;this.updateAssetDurations(o),a===f?o.cumulativeDuration=s:(s=0,a=f),!d&&o.snapOptions.in&&(o.resumeAnchor=lo(null,i.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(o,n)||(o.appendInPlace=!1)),!o.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<bC&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`));const m=We(o.resumeOffset)?o.resumeOffset:o.duration;s+=m})}primaryCanResumeInPlaceAt(e,n){const i=e.resumeTime,r=e.startTime+e.resumptionOffset;return Math.abs(i-r)>Nu?(this.log(`"${e.identifier}" resumption ${i} not aligned with estimated timeline end ${r}`),!1):!Object.keys(n).some(a=>{const o=n[a].details,l=o.edge;if(i>=l)return this.log(`"${e.identifier}" resumption ${i} past ${a} playlist end ${l}`),!1;const u=lo(null,o.fragments,i);if(!u)return this.log(`"${e.identifier}" resumption ${i} does not align with any fragments in ${a} playlist (${o.fragStart}-${o.fragmentEnd})`),!0;const d=a==="audio"?.175:0;return Math.abs(u.start-i)<Nu+d||Math.abs(u.end-i)<Nu+d?!1:(this.log(`"${e.identifier}" resumption ${i} not aligned with ${a} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const n=e.timelineStart;let i=0,r=!1,s=!1;for(let a=0;a<e.assetList.length;a++){const o=e.assetList[a],l=n+i;o.startOffset=i,o.timelineStart=l,r||(r=o.duration===null),s||(s=!!o.error);const u=o.error?0:o.duration||0;i+=u}r&&!s?e.duration=Math.max(i,e.duration):e.duration=i}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function nr(t){return`[${t.event?'"'+t.event.identifier+'"':"primary"}: ${t.start.toFixed(2)}-${t.end.toFixed(2)}]`}class rZ{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,n){const i=e.assetListUrl;let r;try{r=S4(i,this.hls.sessionId,e.baseUrl)}catch(p){const m=this.assignAssetListError(e,pe.ASSET_LIST_LOAD_ERROR,p,i);this.hls.trigger(M.ERROR,m);return}n&&r.protocol!=="data:"&&r.searchParams.set("_HLS_start_offset",""+n);const s=this.hls.config,a=s.loader,o=new a(s),l={responseType:"json",url:r.href},u=s.interstitialAssetListLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(p,m,y,b)=>{const E=p.data,T=E==null?void 0:E.ASSETS;if(!Array.isArray(T)){const x=this.assignAssetListError(e,pe.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),y.url,m,b);this.hls.trigger(M.ERROR,x);return}e.assetListResponse=E,this.hls.trigger(M.ASSET_LIST_LOADED,{event:e,assetListResponse:E,networkDetails:b})},onError:(p,m,y,b)=>{const E=this.assignAssetListError(e,pe.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${p.code} ${p.text} (${m.url})`),m.url,b,y);this.hls.trigger(M.ERROR,E)},onTimeout:(p,m,y)=>{const b=this.assignAssetListError(e,pe.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${m.url})`),m.url,p,y);this.hls.trigger(M.ERROR,b)}};return o.load(l,d,f),this.hls.trigger(M.ASSET_LIST_LOADING,{event:e}),o}assignAssetListError(e,n,i,r,s,a){return e.error=i,{type:it.NETWORK_ERROR,details:n,fatal:!1,interstitial:e,url:r,error:i,networkDetails:a,stats:s}}}function EC(t){t==null||t.play().catch(()=>{})}function Xf(t,e){return`[${t}] Advancing timeline position to ${e}`}class sZ extends $i{constructor(e,n){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled||!this.schedule)return;const r=i-this.timelinePos;if(Math.abs(r)<1/7056e5)return;const a=r<=-.01;this.timelinePos=i,this.bufferedPos=i;const o=this.playingItem;if(!o){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(i,i-r)&&this.updateSchedule(!0),this.checkBuffer(),a&&i<o.start||i>=o.end){var l;const m=this.findItemIndex(o);let y=this.schedule.findItemIndexAtTime(i);if(y===-1&&(y=m+(a?-1:1),this.log(`seeked ${a?"back ":""}to position not covered by schedule ${i} (resolving from ${m} to ${y})`)),!this.isInterstitial(o)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!a&&y>m){const b=this.schedule.findJumpRestrictedIndex(m+1,y);if(b>m){this.setSchedulePosition(b);return}}this.setSchedulePosition(y);return}const u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(o)){const m=o.event.assetList[0];m&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,m))}return}const d=u.timelineStart,f=u.duration||0;if(a&&i<d||i>=d+f){var p;(p=o.event)!=null&&p.appendInPlace&&(this.clearInterstitial(o.event,o),this.flushFrontBuffer(i)),this.setScheduleToAssetAtTime(i,u)}},this.onTimeupdate=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;const r=this.playingItem;if(!r||this.playingLastItem)return;if(i>=r.end){this.timelinePos=r.end;const o=this.findItemIndex(r);this.setSchedulePosition(o+1)}const s=this.playingAsset;if(!s)return;const a=s.timelineStart+(s.duration||0);i>=a&&this.setScheduleToAssetAtTime(i,s)},this.onScheduleUpdate=(i,r)=>{const s=this.schedule;if(!s)return;const a=this.playingItem,o=s.events||[],l=s.items||[],u=s.durations,d=i.map(b=>b.identifier),f=!!(o.length||d.length);(f||r)&&this.log(`INTERSTITIALS_UPDATED (${o.length}): ${o}
Schedule: ${l.map(b=>nr(b))} pos: ${this.timelinePos}`),d.length&&this.log(`Removed events ${d}`);let p=null,m=null;a&&(p=this.updateItem(a,this.timelinePos),this.itemsMatch(a,p)?this.playingItem=p:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const y=this.bufferingItem;if(y&&(m=this.updateItem(y,this.bufferedPos),this.itemsMatch(y,m)?this.bufferingItem=m:y.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(y.event,null))),i.forEach(b=>{b.assetList.forEach(E=>{this.clearAssetPlayer(E.identifier,null)})}),this.playerQueue.forEach(b=>{if(b.interstitial.appendInPlace){const E=b.assetItem.timelineStart,T=b.timelineOffset-E;if(T)try{b.timelineOffset=E}catch(x){Math.abs(T)>Nu&&this.warn(`${x} ("${b.assetId}" ${b.timelineOffset}->${E})`)}}}),f||r){if(this.hls.trigger(M.INTERSTITIALS_UPDATED,{events:o.slice(0),schedule:l.slice(0),durations:u,removedIds:d}),this.isInterstitial(a)&&d.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}a&&this.trimInPlace(p,a),y&&m!==p&&this.trimInPlace(m,y),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=n,this.assetListLoader=new rZ(e),this.schedule=new iZ(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(M.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(M.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(M.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(M.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(M.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(M.BUFFER_APPENDED,this.onBufferAppended,this),e.on(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(M.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(M.MEDIA_ENDED,this.onMediaEnded,this),e.on(M.ERROR,this.onError,this),e.on(M.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(M.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(M.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(M.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(M.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(M.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(M.BUFFER_CODECS,this.onBufferCodecs,this),e.off(M.BUFFER_APPENDED,this.onBufferAppended,this),e.off(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(M.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(M.MEDIA_ENDED,this.onMediaEnded,this),e.off(M.ERROR,this.onError,this),e.off(M.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){ci(e,"play",this.onPlay),ci(e,"pause",this.onPause),ci(e,"seeking",this.onSeeking),ci(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,n){const i=this.media=n.media;Jn(i,"seeking",this.onSeeking),Jn(i,"timeupdate",this.onTimeupdate),Jn(i,"play",this.onPlay),Jn(i,"pause",this.onPause)}onMediaAttached(e,n){const i=this.effectivePlayingItem,r=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!r){this.clearScheduleState();const s=this.findItemIndex(i);this.setSchedulePosition(s)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,n){const i=!!n.transferMedia,r=this.media;if(this.media=null,!i&&(r&&this.removeMediaListeners(r),this.detachedData)){const s=this.getBufferingPlayer();s&&(this.log(`Removing schedule state for detachedData and ${s}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,s.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,n=()=>e.bufferingItem||e.waitingItem,i=f=>f&&e.getAssetPlayer(f.identifier),r=(f,p,m,y,b)=>{if(f){let E=f[p].start;const T=f.event;if(T){if(p==="playout"||T.timelineOccupancy!==$h.Point){const x=i(m);(x==null?void 0:x.interstitial)===T&&(E+=x.assetItem.startOffset+x[b])}}else{const x=y==="bufferedPos"?a():e[y];E+=x-f.start}return E}return 0},s=(f,p)=>{var m;if(f!==0&&p!=="primary"&&(m=e.schedule)!=null&&m.length){var y;const b=e.schedule.findItemIndexAtTime(f),E=(y=e.schedule.items)==null?void 0:y[b];if(E){const T=E[p].start-E.start;return f+T}}return f},a=()=>{const f=e.bufferedPos;return f===Number.MAX_VALUE?o("primary"):Math.max(f,0)},o=f=>{var p,m;return(p=e.primaryDetails)!=null&&p.live?e.primaryDetails.edge:((m=e.schedule)==null?void 0:m.durations[f])||0},l=(f,p)=>{var m,y;const b=e.effectivePlayingItem;if(b!=null&&(m=b.event)!=null&&m.restrictions.skip||!e.schedule)return;e.log(`seek to ${f} "${p}"`);const E=e.effectivePlayingItem,T=e.schedule.findItemIndexAtTime(f,p),x=(y=e.schedule.items)==null?void 0:y[T],S=e.getBufferingPlayer(),w=S==null?void 0:S.interstitial,C=w==null?void 0:w.appendInPlace,I=E&&e.itemsMatch(E,x);if(E&&(C||I)){const L=i(e.playingAsset),N=(L==null?void 0:L.media)||e.primaryMedia;if(N){const G=p==="primary"?N.currentTime:r(E,p,e.playingAsset,"timelinePos","currentTime"),O=f-G,D=(C?G:N.currentTime)+O;if(D>=0&&(!L||C||D<=L.duration)){N.currentTime=D;return}}}if(x){let L=f;if(p!=="primary"){const G=x[p].start,O=f-G;L=x.start+O}const N=!e.isInterstitial(x);if((!e.isInterstitial(E)||E.event.appendInPlace)&&(N||x.event.appendInPlace)){const G=e.media||(C?S==null?void 0:S.media:null);G&&(G.currentTime=L)}else if(E){const G=e.findItemIndex(E);if(T>G){const D=e.schedule.findJumpRestrictedIndex(G+1,T);if(D>G){e.setSchedulePosition(D);return}}let O=0;if(N)e.timelinePos=L,e.checkBuffer();else{const D=x.event.assetList,V=f-(x[p]||x).start;for(let $=D.length;$--;){const J=D[$];if(J.duration&&V>=J.startOffset&&V<J.startOffset+J.duration){O=$;break}}}e.setSchedulePosition(T,O)}}},u=()=>{const f=e.effectivePlayingItem;if(e.isInterstitial(f))return f;const p=n();return e.isInterstitial(p)?p:null},d={get bufferedEnd(){const f=n(),p=e.bufferingItem;if(p&&p===f){var m;return r(p,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-p.playout.start||((m=e.bufferingAsset)==null?void 0:m.startOffset)||0}return 0},get currentTime(){const f=u(),p=e.effectivePlayingItem;return p&&p===f?r(p,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-p.playout.start:0},set currentTime(f){const p=u(),m=e.effectivePlayingItem;m&&m===p&&l(f+m.playout.start,"playout")},get duration(){const f=u();return f?f.playout.end-f.playout.start:0},get assetPlayers(){var f;const p=(f=u())==null?void 0:f.event.assetList;return p?p.map(m=>e.getAssetPlayer(m.identifier)):[]},get playingIndex(){var f;const p=(f=u())==null?void 0:f.event;return p&&e.effectivePlayingAsset?p.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};return this.manager={get events(){var f;return((f=e.schedule)==null||(f=f.events)==null?void 0:f.slice(0))||[]},get schedule(){var f;return((f=e.schedule)==null||(f=f.items)==null?void 0:f.slice(0))||[]},get interstitialPlayer(){return u()?d:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return n()},get bufferingIndex(){const f=n();return e.findItemIndex(f)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const f=e.effectivePlayingItem;return e.findItemIndex(f)},primary:{get bufferedEnd(){return a()},get currentTime(){const f=e.timelinePos;return f>0?f:0},set currentTime(f){l(f,"primary")},get duration(){return o("primary")},get seekableStart(){var f;return((f=e.primaryDetails)==null?void 0:f.fragmentStart)||0}},integrated:{get bufferedEnd(){return r(n(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return r(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(f){l(f,"integrated")},get duration(){return o("integrated")},get seekableStart(){var f;return s(((f=e.primaryDetails)==null?void 0:f.fragmentStart)||0,"integrated")}},skip:()=>{const f=e.effectivePlayingItem,p=f==null?void 0:f.event;if(p&&!p.restrictions.skip){const m=e.findItemIndex(f);if(p.appendInPlace){const y=f.playout.start+f.event.duration;l(y+.001,"playout")}else e.advanceAfterAssetEnded(p,m,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const n=this.playingItem,i=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!n||!i?!1:this.findItemIndex(n)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,n;if(this.mediaSelection===null)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(r=this.primaryMedia);const s=(n=r)==null?void 0:n.currentTime;if(!(s===void 0||!We(s)))return s}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,n){const i=this.getAssetPlayer(e);i&&this.transferMediaFromPlayer(i,n)}transferMediaFromPlayer(e,n){const i=e.interstitial.appendInPlace,r=e.media;if(i&&r===this.primaryMedia){if(this.bufferingAsset=null,(!n||this.isInterstitial(n)&&!n.event.appendInPlace)&&n&&r){this.detachedData={media:r};return}const s=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Wt(s)}`),this.detachedData=s}else n&&r&&(this.shouldPlay||(this.shouldPlay=!r.paused))}transferMediaTo(e,n){var i,r;if(e.media===n)return;let s=null;const a=this.hls,o=e!==a,l=o&&e.interstitial.appendInPlace,u=(i=this.detachedData)==null?void 0:i.mediaSource;let d;if(a.media)l&&(s=a.transferMedia(),this.detachedData=s),d="Primary";else if(u){const y=this.getBufferingPlayer();y?(s=y.transferMedia(),d=`${y}`):d="detached MediaSource"}else d="detached media";if(!s){if(u)s=this.detachedData,this.log(`using detachedData: MediaSource ${Wt(s)}`);else if(!this.detachedData||a.media===n){const y=this.playerQueue;y.length>1&&y.forEach(b=>{if(o&&b.interstitial.appendInPlace!==l){const E=b.interstitial;this.clearInterstitial(b.interstitial,null),E.appendInPlace=!1,E.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${E}`)}}),this.hls.detachMedia(),this.detachedData={media:n}}}const f=s&&"mediaSource"in s&&((r=s.mediaSource)==null?void 0:r.readyState)!=="closed",p=f&&s?s:n;this.log(`${f?"transfering MediaSource":"attaching media"} to ${o?e:"Primary"} from ${d} (media.currentTime: ${n.currentTime})`);const m=this.schedule;if(p===s&&m){const y=o&&e.assetId===m.assetIdAtEnd;p.overrides={duration:m.duration,endOfStream:!o||y,cueRemoval:!o}}e.attachMedia(p)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,n=e==null?void 0:e.events;if(!n||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const i=this.timelinePos,r=this.effectivePlayingItem;if(i===-1){const s=this.hls.startPosition;if(this.log(Xf("checkStart",s)),this.timelinePos=s,n.length&&n[0].cue.pre){const a=e.findEventIndex(n[0].identifier);this.setSchedulePosition(a)}else if(s>=0||!this.primaryLive){const a=this.timelinePos=s>0?s:0,o=e.findItemIndexAtTime(a);this.setSchedulePosition(o)}}else if(r&&!this.playingItem){const s=e.findItemIndex(r);this.setSchedulePosition(s)}}advanceAssetBuffering(e,n){const i=e.event,r=i.findAssetIndex(n),s=P1(i,r);if(!i.isAssetPastPlayoutLimit(s))this.bufferedToEvent(e,s);else if(this.schedule){var a;const o=(a=this.schedule.items)==null?void 0:a[this.findItemIndex(e)+1];o&&this.bufferedToItem(o)}}advanceAfterAssetEnded(e,n,i){const r=P1(e,i);if(e.isAssetPastPlayoutLimit(r)){if(this.schedule){const s=this.schedule.items;if(s){const a=n+1,o=s.length;if(a>=o){this.setSchedulePosition(-1);return}const l=e.resumeTime;this.timelinePos<l&&(this.log(Xf("advanceAfterAssetEnded",l)),this.timelinePos=l,e.appendInPlace&&this.advanceInPlace(l),this.checkBuffer(this.bufferedPos<l)),this.setSchedulePosition(a)}}}else{if(e.appendInPlace){const s=e.assetList[r];s&&this.advanceInPlace(s.timelineStart)}this.setSchedulePosition(n,r)}}setScheduleToAssetAtTime(e,n){const i=this.schedule;if(!i)return;const r=n.parentIdentifier,s=i.getEvent(r);if(s){const a=i.findEventIndex(r),o=i.findAssetIndex(s,e);this.advanceAfterAssetEnded(s,a,o-1)}}setSchedulePosition(e,n){var i;const r=(i=this.schedule)==null?void 0:i.items;if(!r||this.playbackDisabled)return;const s=e>=0?r[e]:null;this.log(`setSchedulePosition ${e}, ${n} (${s&&nr(s)}) pos: ${this.timelinePos}`);const a=this.waitingItem||this.playingItem,o=this.playingLastItem;if(this.isInterstitial(a)){const d=a.event,f=this.playingAsset,p=f==null?void 0:f.identifier,m=p?this.getAssetPlayer(p):null;if(m&&p&&(!this.eventItemsMatch(a,s)||n!==void 0&&p!==d.assetList[n].identifier)){var l;const y=d.findAssetIndex(f);if(this.log(`INTERSTITIAL_ASSET_ENDED ${y+1}/${d.assetList.length} ${wu(f)}`),this.endedAsset=f,this.playingAsset=null,this.hls.trigger(M.INTERSTITIAL_ASSET_ENDED,{asset:f,assetListIndex:y,event:d,schedule:r.slice(0),scheduleIndex:e,player:m}),a!==this.playingItem){this.itemsMatch(a,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(d,this.findItemIndex(this.playingItem),y);return}this.retreiveMediaSource(p,s),m.media&&!((l=this.detachedData)!=null&&l.mediaSource)&&m.detachMedia()}if(!this.eventItemsMatch(a,s)&&(this.endedItem=a,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${d} ${nr(a)}`),d.hasPlayed=!0,this.hls.trigger(M.INTERSTITIAL_ENDED,{event:d,schedule:r.slice(0),scheduleIndex:e}),d.cue.once)){var u;this.updateSchedule();const y=(u=this.schedule)==null?void 0:u.items;if(s&&y){const b=this.findItemIndex(s);this.advanceSchedule(b,y,n,a,o)}return}}this.advanceSchedule(e,r,n,a,o)}advanceSchedule(e,n,i,r,s){const a=this.schedule;if(!a)return;const o=n[e]||null,l=this.primaryMedia,u=this.playerQueue;if(u.length&&u.forEach(d=>{const f=d.interstitial,p=a.findEventIndex(f.identifier);(p<e||p>e+1)&&this.clearInterstitial(f,o)}),this.isInterstitial(o)){this.timelinePos=Math.min(Math.max(this.timelinePos,o.start),o.end);const d=o.event;if(i===void 0){i=a.findAssetIndex(d,this.timelinePos);const y=P1(d,i-1);if(d.isAssetPastPlayoutLimit(y)||d.appendInPlace&&this.timelinePos===o.end){this.advanceAfterAssetEnded(d,e,i);return}i=y}const f=this.waitingItem;this.assetsBuffered(o,l)||this.setBufferingItem(o);let p=this.preloadAssets(d,i);if(this.eventItemsMatch(o,f||r)||(this.waitingItem=o,this.log(`INTERSTITIAL_STARTED ${nr(o)} ${d.appendInPlace?"append in place":""}`),this.hls.trigger(M.INTERSTITIAL_STARTED,{event:d,schedule:n.slice(0),scheduleIndex:e})),!d.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${d}`);return}if(d.assetListLoader&&(d.assetListLoader.destroy(),d.assetListLoader=void 0),!l){this.log(`Waiting for attachMedia to start Interstitial ${d}`);return}this.waitingItem=this.endedItem=null,this.playingItem=o;const m=d.assetList[i];if(!m){this.advanceAfterAssetEnded(d,e,i||0);return}if(p||(p=this.getAssetPlayer(m.identifier)),p===null||p.destroyed){const y=d.assetList.length;this.warn(`asset ${i+1}/${y} player destroyed ${d}`),p=this.createAssetPlayer(d,m,i),p.loadSource()}if(!this.eventItemsMatch(o,this.bufferingItem)&&d.appendInPlace&&this.isAssetBuffered(m))return;this.startAssetPlayer(p,i,n,e,l),this.shouldPlay&&EC(p.media)}else o?(this.resumePrimary(o,e,r),this.shouldPlay&&EC(this.hls.media)):s&&this.isInterstitial(r)&&(this.endedItem=null,this.playingItem=r,r.event.appendInPlace||this.attachPrimary(a.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,n,i){var r,s;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${nr(e)}`),!((r=this.detachedData)!=null&&r.mediaSource)){let o=this.timelinePos;(o<e.start||o>=e.end)&&(o=this.getPrimaryResumption(e,n),this.log(Xf("resumePrimary",o)),this.timelinePos=o),this.attachPrimary(o,e)}if(!i)return;const a=(s=this.schedule)==null?void 0:s.items;a&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${nr(e)}`),this.hls.trigger(M.INTERSTITIALS_PRIMARY_RESUMED,{schedule:a.slice(0),scheduleIndex:n}),this.checkBuffer())}getPrimaryResumption(e,n){const i=e.start;if(this.primaryLive){const r=this.primaryDetails;if(n===0)return this.hls.startPosition;if(r&&(i<r.fragmentStart||i>r.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(e){const n=this.getAssetPlayer(e.identifier);return n!=null&&n.hls?n.hls.bufferedToEnd:pt.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,n,i){n?this.setBufferingItem(n):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const r=this.primaryMedia;if(!r)return;const s=this.hls;s.media?this.checkBuffer():(this.transferMediaTo(s,r),i&&this.startLoadingPrimaryAt(e,i)),i||(this.log(Xf("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,i))}startLoadingPrimaryAt(e,n){var i;const r=this.hls;!r.loadingEnabled||!r.media||Math.abs((((i=r.mainForwardBufferInfo)==null?void 0:i.start)||r.media.currentTime)-e)>.5?r.startLoad(e,n):r.bufferingEnabled||r.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(M.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(M.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,n){if(n.level===-1||!this.schedule)return;const i=this.hls.levels[n.level];if(!i.details)return;const r=Bt(Bt({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=r,this.schedule.parseInterstitialDateRanges(r,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,n){const i=this.hls.audioTracks[n.id],r=this.mediaSelection;if(!r){this.altSelection=Bt(Bt({},this.altSelection),{},{audio:i});return}const s=Bt(Bt({},r),{},{audio:i});this.mediaSelection=s}onSubtitleTrackUpdated(e,n){const i=this.hls.subtitleTracks[n.id],r=this.mediaSelection;if(!r){this.altSelection=Bt(Bt({},this.altSelection),{},{subtitles:i});return}const s=Bt(Bt({},r),{},{subtitles:i});this.mediaSelection=s}onAudioTrackSwitching(e,n){const i=Dw(n);this.playerQueue.forEach(({hls:r})=>r&&(r.setAudioOption(n)||r.setAudioOption(i)))}onSubtitleTrackSwitch(e,n){const i=Dw(n);this.playerQueue.forEach(({hls:r})=>r&&(r.setSubtitleOption(n)||n.id!==-1&&r.setSubtitleOption(i)))}onBufferCodecs(e,n){const i=n.tracks;i&&(this.requiredTracks=i)}onBufferAppended(e,n){this.checkBuffer()}onBufferFlushed(e,n){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const r=this.timelinePos;this.bufferedPos=r,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const n=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&n){for(let r=0;r<n.length;r++){const s=n[r];if(s.cue.post){var i;const a=this.schedule.findEventIndex(s.identifier),o=(i=this.schedule.items)==null?void 0:i[a];this.isInterstitial(o)&&this.eventItemsMatch(o,this.bufferingItem)&&this.bufferedToItem(o,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const n=this.playingItem;if(!this.playingLastItem&&n){const i=this.findItemIndex(n);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(e,n){var i;const r=(i=this.schedule)==null?void 0:i.items;if(e&&r){const s=this.findItemIndex(e,n);return r[s]||null}return null}trimInPlace(e,n){if(this.isInterstitial(e)&&e.event.appendInPlace&&n.end-e.end>.25){e.event.assetList.forEach((s,a)=>{e.event.isAssetPastPlayoutLimit(a)&&this.clearAssetPlayer(s.identifier,null)});const i=e.end+.25,r=pt.bufferInfo(this.primaryMedia,i,0);(r.end>i||(r.nextStart||0)>i)&&(this.log(`trim buffered interstitial ${nr(e)} (was ${nr(n)})`),this.attachPrimary(i,null,!0),this.flushFrontBuffer(i))}}itemsMatch(e,n){return!!n&&(e===n||e.event&&n.event&&this.eventItemsMatch(e,n)||!e.event&&!n.event&&this.findItemIndex(e)===this.findItemIndex(n))}eventItemsMatch(e,n){var i;return!!n&&(e===n||e.event.identifier===((i=n.event)==null?void 0:i.identifier))}findItemIndex(e,n){return e&&this.schedule?this.schedule.findItemIndex(e,n):-1}updateSchedule(e=!1){var n;const i=this.mediaSelection;i&&((n=this.schedule)==null||n.updateSchedule(i,[],e))}checkBuffer(e){var n;const i=(n=this.schedule)==null?void 0:n.items;if(!i)return;const r=pt.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,i,e)}updateBufferedPos(e,n,i){const r=this.schedule,s=this.bufferingItem;if(this.bufferedPos>e||!r)return;if(n.length===1&&this.itemsMatch(n[0],s)){this.bufferedPos=e;return}const a=this.playingItem,o=this.findItemIndex(a);let l=r.findItemIndexAtTime(e);if(this.bufferedPos<e){var u;const d=this.findItemIndex(s),f=Math.min(d+1,n.length-1),p=n[f];if((l===-1&&s&&e>=s.end||(u=p.event)!=null&&u.appendInPlace&&e+.01>=p.start)&&(l=f),this.isInterstitial(s)){const m=s.event;if(f-o>1&&m.appendInPlace===!1||m.assetList.length===0&&m.assetListLoader)return}if(this.bufferedPos=e,l>d&&l>o)this.bufferedToItem(p);else{const m=this.primaryDetails;this.primaryLive&&m&&e>m.edge-m.targetduration&&p.start<m.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(p)&&this.preloadAssets(p.event,0)}}else i&&a&&!this.itemsMatch(a,s)&&(l===o?this.bufferedToItem(a):l===o+1&&this.bufferedToItem(n[l]))}assetsBuffered(e,n){return e.event.assetList.length===0?!1:!e.event.assetList.some(r=>{const s=this.getAssetPlayer(r.identifier);return!(s!=null&&s.bufferedInPlaceToEnd(n))})}setBufferingItem(e){const n=this.bufferingItem,i=this.schedule;if(!this.itemsMatch(e,n)&&i){const{items:r,events:s}=i;if(!r||!s)return n;const a=this.isInterstitial(e),o=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const l=o?o.remaining:n?n.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${nr(e)}`+(n?` (${l.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(a){const u=i.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((d,f)=>{const p=this.getAssetPlayer(d.identifier);p&&(f===u&&p.loadSource(),p.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering());this.hls.trigger(M.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:s.slice(0),schedule:r.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return n}bufferedToItem(e,n=0){const i=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,n);else if(i!==null){this.bufferingAsset=null;const r=this.detachedData;r?r.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const n=this.findItemIndex(e),i=this.getPrimaryResumption(e,n);this.startLoadingPrimaryAt(i)}bufferedToEvent(e,n){const i=e.event,r=i.assetList.length===0&&!i.assetListLoader,s=i.cue.once;if(r||!s){const a=this.preloadAssets(i,n);if(a!=null&&a.interstitial.appendInPlace){const o=this.primaryMedia;o&&this.bufferAssetPlayer(a,o)}}}preloadAssets(e,n){const i=e.assetUrl,r=e.assetList.length,s=r===0&&!e.assetListLoader,a=e.cue.once;if(s){const l=e.timelineStart;if(e.appendInPlace){var o;const p=this.playingItem;!this.isInterstitial(p)&&(p==null||(o=p.nextEvent)==null?void 0:o.identifier)===e.identifier&&this.flushFrontBuffer(l+.25)}let u,d=0;if(!this.playingItem&&this.primaryLive&&(d=this.hls.startPosition,d===-1&&(d=this.hls.liveSyncPosition||0)),d&&!(e.cue.pre||e.cue.post)){const p=d-l;p>0&&(u=Math.round(p*1e3)/1e3)}if(this.log(`Load interstitial asset ${n+1}/${i?1:r} ${e}${u?` live-start: ${d} start-offset: ${u}`:""}`),i)return this.createAsset(e,0,0,l,e.duration,i);const f=this.assetListLoader.loadAssetList(e,u);f&&(e.assetListLoader=f)}else if(!a&&r){for(let u=n;u<r;u++){const d=e.assetList[u],f=this.getAssetPlayerQueueIndex(d.identifier);(f===-1||this.playerQueue[f].destroyed)&&!d.error&&this.createAssetPlayer(e,d,u)}const l=e.assetList[n];if(l){const u=this.getAssetPlayer(l.identifier);return u&&u.loadSource(),u}}return null}flushFrontBuffer(e){const n=this.requiredTracks;if(!n)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(n).forEach(r=>{this.hls.trigger(M.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})}getAssetPlayerQueueIndex(e){const n=this.playerQueue;for(let i=0;i<n.length;i++)if(e===n[i].assetId)return i;return-1}getAssetPlayer(e){const n=this.getAssetPlayerQueueIndex(e);return this.playerQueue[n]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:n}=this;if(n){for(let i=0;i<e.length;i++)if(e[i].media===n)return e[i]}return null}createAsset(e,n,i,r,s,a){const o={parentIdentifier:e.identifier,identifier:JQ(e,a,n),duration:s,startOffset:i,timelineStart:r,uri:a};return this.createAssetPlayer(e,o,n)}createAssetPlayer(e,n,i){const r=this.hls,s=r.userConfig;let a=s.videoPreference;const o=r.loadLevelObj||r.levels[r.currentLevel];(a||o)&&(a=Vt({},a),o.videoCodec&&(a.videoCodec=o.videoCodec),o.videoRange&&(a.allowedVideoRanges=[o.videoRange]));const l=r.audioTracks[r.audioTrack],u=r.subtitleTracks[r.subtitleTrack];let d=0;if(this.primaryLive||e.appendInPlace){const w=this.timelinePos-n.timelineStart;if(w>1){const C=n.duration;C&&w<C&&(d=w)}}const f=n.identifier,p=Bt(Bt({},s),{},{maxMaxBufferLength:Math.min(180,r.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:r.sessionId,assetPlayerId:f,abrEwmaDefaultEstimate:r.bandwidthEstimate,interstitialsController:void 0,startPosition:d,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:l||s.audioPreference,subtitlePreference:u||s.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,n.timelineStart&&(p.timelineOffset=n.timelineStart));const m=p.cmcd;m!=null&&m.sessionId&&m.contentId&&(p.cmcd=Vt({},m,{contentId:_c(n.uri)})),this.getAssetPlayer(f)&&this.warn(`Duplicate date range identifier ${e} and asset ${f}`);const y=new nZ(this.HlsPlayerClass,p,e,n);this.playerQueue.push(y),e.assetList[i]=n;let b=!0;const E=w=>{if(w.live){var C;const N=new Error(`Interstitials MUST be VOD assets ${e}`),G={fatal:!0,type:it.OTHER_ERROR,details:pe.INTERSTITIAL_ASSET_ITEM_ERROR,error:N},O=((C=this.schedule)==null?void 0:C.findEventIndex(e.identifier))||-1;this.handleAssetItemError(G,e,O,i,N.message);return}const I=w.edge-w.fragmentStart,L=n.duration;(b||L===null||I>L)&&(b=!1,this.log(`Interstitial asset "${f}" duration change ${L} > ${I}`),n.duration=I,this.updateSchedule())};y.on(M.LEVEL_UPDATED,(w,{details:C})=>E(C)),y.on(M.LEVEL_PTS_UPDATED,(w,{details:C})=>E(C)),y.on(M.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const T=(w,C)=>{const I=this.getAssetPlayer(f);if(I&&C.tracks){I.off(M.BUFFER_CODECS,T),I.tracks=C.tracks;const L=this.primaryMedia;this.bufferingAsset===I.assetItem&&L&&!I.media&&this.bufferAssetPlayer(I,L)}};y.on(M.BUFFER_CODECS,T);const x=()=>{var w;const C=this.getAssetPlayer(f);if(this.log(`buffered to end of asset ${C}`),!C||!this.schedule)return;const I=this.schedule.findEventIndex(e.identifier),L=(w=this.schedule.items)==null?void 0:w[I];this.isInterstitial(L)&&this.advanceAssetBuffering(L,n)};y.on(M.BUFFERED_TO_END,x);const S=w=>()=>{if(!this.getAssetPlayer(f)||!this.schedule)return;this.shouldPlay=!0;const I=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,I,w)};return y.once(M.MEDIA_ENDED,S(i)),y.once(M.PLAYOUT_LIMIT_REACHED,S(1/0)),y.on(M.ERROR,(w,C)=>{if(!this.schedule)return;const I=this.getAssetPlayer(f);if(C.details===pe.BUFFER_STALLED_ERROR){if(I!=null&&I.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),i,`Asset player error ${C.error} ${e}`)}),y.on(M.DESTROYING,()=>{if(!this.getAssetPlayer(f)||!this.schedule)return;const C=new Error(`Asset player destroyed unexpectedly ${f}`),I={fatal:!0,type:it.OTHER_ERROR,details:pe.INTERSTITIAL_ASSET_ITEM_ERROR,error:C};this.handleAssetItemError(I,e,this.schedule.findEventIndex(e.identifier),i,C.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${wu(n)}`),this.hls.trigger(M.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:n,assetListIndex:i,event:e,player:y}),y}clearInterstitial(e,n){e.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,n)}),e.reset()}resetAssetPlayer(e){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){this.log(`reset asset player "${e}" after error`);const i=this.playerQueue[n];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(e,n){const i=this.getAssetPlayerQueueIndex(e);if(i!==-1){const r=this.playerQueue[i];this.log(`clear ${r} toSegment: ${n&&nr(n)}`),this.transferMediaFromPlayer(r,n),this.playerQueue.splice(i,1),r.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,n,i,r,s){const{interstitial:a,assetItem:o,assetId:l}=e,u=a.assetList.length,d=this.playingAsset;this.endedAsset=null,this.playingAsset=o,(!d||d.identifier!==l)&&(d&&(this.clearAssetPlayer(d.identifier,i[r]),delete d.error),this.log(`INTERSTITIAL_ASSET_STARTED ${n+1}/${u} ${wu(o)}`),this.hls.trigger(M.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:n,event:a,schedule:i.slice(0),scheduleIndex:r,player:e})),this.bufferAssetPlayer(e,s)}bufferAssetPlayer(e,n){var i,r;if(!this.schedule)return;const{interstitial:s,assetItem:a}=e,o=this.schedule.findEventIndex(s.identifier),l=(i=this.schedule.items)==null?void 0:i[o];if(!l)return;e.loadSource(),this.setBufferingItem(l),this.bufferingAsset=a;const u=this.getBufferingPlayer();if(u===e)return;const d=s.appendInPlace;if(d&&(u==null?void 0:u.interstitial.appendInPlace)===!1)return;const f=(u==null?void 0:u.tracks)||((r=this.detachedData)==null?void 0:r.tracks)||this.requiredTracks;if(d&&a!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(f&&!uL(f,e.tracks)){const p=new Error(`Asset ${wu(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(f)}')`),m={fatal:!0,type:it.OTHER_ERROR,details:pe.INTERSTITIAL_ASSET_ITEM_ERROR,error:p},y=s.findAssetIndex(a);this.handleAssetItemError(m,s,o,y,p.message);return}}this.transferMediaTo(e,n)}handleInPlaceStall(e){const n=this.schedule,i=this.primaryMedia;if(!n||!i)return;const r=i.currentTime,s=n.findAssetIndex(e,r),a=e.assetList[s];if(a){const o=this.getAssetPlayer(a.identifier);if(o){const l=o.currentTime||r-a.timelineStart,u=o.duration-l;if(this.warn(`Stalled at ${l} of ${l+u} in ${o} ${e} (media.currentTime: ${r})`),l&&(u/i.playbackRate<.5||o.bufferedInPlaceToEnd(i))&&o.hls){const d=n.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,d,s)}}}}advanceInPlace(e){const n=this.primaryMedia;n&&n.currentTime<e&&(n.currentTime=e)}handleAssetItemError(e,n,i,r,s){if(e.details===pe.BUFFER_STALLED_ERROR)return;const a=n.assetList[r]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${a&&wu(a)} ${e.error}`),!this.schedule)return;const o=(a==null?void 0:a.identifier)||"",l=this.getAssetPlayerQueueIndex(o),u=this.playerQueue[l]||null,d=this.schedule.items,f=Vt({},e,{fatal:!1,errorAction:Ou(!0),asset:a,assetListIndex:r,event:n,schedule:d,scheduleIndex:i,player:u});if(this.hls.trigger(M.INTERSTITIAL_ASSET_ERROR,f),!e.fatal)return;const p=this.playingAsset,m=this.bufferingAsset,y=new Error(s);if(a&&(this.clearAssetPlayer(o,null),a.error=y),!n.assetList.some(b=>!b.error))n.error=y;else for(let b=r;b<n.assetList.length;b++)this.resetAssetPlayer(n.assetList[b].identifier);this.updateSchedule(!0),n.error?this.primaryFallback(n):p&&p.identifier===o?this.advanceAfterAssetEnded(n,i,r):m&&m.identifier===o&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,m)}primaryFallback(e){const n=e.timelineStart,i=this.effectivePlayingItem;if(i){this.log(`Fallback to primary from event "${e.identifier}" start: ${n} pos: ${this.timelinePos} playing: ${nr(i)} error: ${e.error}`);let r=this.timelinePos;r===-1&&(r=this.hls.startPosition);const s=this.updateItem(i,r);if(this.itemsMatch(i,s)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(n,null),this.flushFrontBuffer(n)),!this.schedule)return;const a=this.schedule.findItemIndexAtTime(r);this.setSchedulePosition(a)}else this.checkStart()}onAssetListLoaded(e,n){var i,r;const s=n.event,a=s.identifier,o=n.assetListResponse.ASSETS;if(!((i=this.schedule)!=null&&i.hasEvent(a)))return;const l=s.timelineStart,u=s.duration;let d=0;o.forEach((b,E)=>{const T=parseFloat(b.DURATION);this.createAsset(s,E,d,l+d,T,b.URI),d+=T}),s.duration=d,this.log(`Loaded asset-list with duration: ${d} (was: ${u}) ${s}`);const f=this.waitingItem,p=(f==null?void 0:f.event.identifier)===a;this.updateSchedule();const m=(r=this.bufferingItem)==null?void 0:r.event;if(p){var y;const b=this.schedule.findEventIndex(a),E=(y=this.schedule.items)==null?void 0:y[b];if(E){if(!this.playingItem&&this.timelinePos>E.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==b){s.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${s}`),this.updateSchedule(!0),this.primaryFallback(s);return}this.setBufferingItem(E)}this.setSchedulePosition(b)}else if((m==null?void 0:m.identifier)===a){const b=s.assetList[0];if(b){const E=this.getAssetPlayer(b.identifier);if(m.appendInPlace){const T=this.primaryMedia;E&&T&&this.bufferAssetPlayer(E,T)}else E&&E.loadSource()}}}onError(e,n){if(this.schedule)switch(n.details){case pe.ASSET_LIST_PARSING_ERROR:case pe.ASSET_LIST_LOAD_ERROR:case pe.ASSET_LIST_LOAD_TIMEOUT:{const i=n.interstitial;i&&(this.updateSchedule(!0),this.primaryFallback(i));break}case pe.BUFFER_STALLED_ERROR:{const i=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&i.event.appendInPlace){this.handleInPlaceStall(i.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const TC=500;class aZ extends kb{constructor(e,n,i){super(e,n,i,"subtitle-stream-controller",Xe.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(M.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(M.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(M.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(M.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(M.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(M.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,n){this.stopLoad(),this.state=_e.IDLE,this.setInterval(TC),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=n?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,n){this.tracksBuffered=[],super.onMediaDetaching(e,n)}onLevelLoaded(e,n){this.mainDetails=n.details}onSubtitleFragProcessed(e,n){const{frag:i,success:r}=n;if(this.fragContextChanged(i)||(bn(i)&&(this.fragPrevious=i),this.state=_e.IDLE),!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a;const o=i.start;for(let u=0;u<s.length;u++)if(o>=s[u].start&&o<=s[u].end){a=s[u];break}const l=i.start+i.duration;a?a.end=l:(a={start:o,end:l},s.push(a)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(e,n){const{startOffset:i,endOffset:r}=n;if(i===0&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;n.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=s){a.shift();continue}else if(a[o].start<s)a[o].start=s;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(i,s,Xe.SUBTITLE)}}onError(e,n){const i=n.frag;(i==null?void 0:i.type)===Xe.SUBTITLE&&(n.details===pe.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==_e.STOPPED&&(this.state=_e.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:n}){if(this.levels&&u4(this.levels,n)){this.levels=n.map(i=>new Fc(i));return}this.tracksBuffered=[],this.levels=n.map(i=>{const r=new Fc(i);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Xe.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,n){var i;if(this.currentTrackId=n.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.state!==_e.STOPPED&&this.setInterval(TC)}onSubtitleTrackLoaded(e,n){var i;const{currentTrackId:r,levels:s}=this,{details:a,id:o}=n;if(!s){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}const l=s[o];if(o>=s.length||!l)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(a.live||(i=l.details)!=null&&i.live){if(a.deltaUpdateFailed)return;const f=this.mainDetails;if(!f){this.startFragRequested=!1;return}const p=f.fragments[0];if(!l.details)a.hasProgramDateTime&&f.hasProgramDateTime?(jh(a,f),u=a.fragmentStart):p&&(u=p.start,Xy(a,u));else{var d;u=this.alignPlaylists(a,l.details,(d=this.levelLastLoaded)==null?void 0:d.details),u===0&&p&&(u=p.start,Xy(a,u))}f&&!this.startFragRequested&&this.setStartPosition(f,u)}l.details=a,this.levelLastLoaded=l,o===r&&(this.hls.trigger(M.SUBTITLE_TRACK_UPDATED,{details:a,id:o,groupId:n.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===_e.IDLE&&(lo(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:n,payload:i}=e,r=n.decryptdata,s=this.hls;if(!this.fragContextChanged(n)&&i&&i.byteLength>0&&r!=null&&r.key&&r.iv&&Pu(r.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,Ob(r.method)).catch(o=>{throw s.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:n}),o}).then(o=>{const l=performance.now();s.trigger(M.FRAG_DECRYPTED,{frag:n,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=_e.IDLE})}}doTick(){if(!this.media){this.state=_e.IDLE;return}if(this.state===_e.IDLE){const{currentTrackId:e,levels:n}=this,i=n==null?void 0:n[e];if(!i||!n.length||!i.details||this.waitForLive(i))return;const{config:r}=this,s=this.getLoadPosition(),a=pt.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:o,len:l}=a,u=i.details,d=this.hls.maxBufferLength+u.levelTargetDuration;if(l>d)return;const f=u.fragments,p=f.length,m=u.edge;let y=null;const b=this.fragPrevious;if(o<m){const x=r.maxFragLookUpTolerance,S=o>m-x?0:x;y=lo(b,f,Math.max(f[0].start,o),S),!y&&b&&b.start<f[0].start&&(y=f[0])}else y=f[p-1];if(y=this.filterReplacedPrimary(y,i.details),!y)return;const E=y.sn-u.startSN,T=f[E-1];if(T&&T.cc===y.cc&&this.fragmentTracker.getState(T)===wn.NOT_LOADED&&(y=T),this.fragmentTracker.getState(y)===wn.NOT_LOADED){const x=this.mapToInitFragWhenRequired(y);x&&this.loadFragment(x,i,o)}}}loadFragment(e,n,i){bn(e)?super.loadFragment(e,n,i):this._loadInitSegment(e,n)}get mediaBufferTimeRanges(){return new oZ(this.tracksBuffered[this.currentTrackId]||[])}}class oZ{constructor(e){this.buffered=void 0;const n=(i,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][i]};this.buffered={get length(){return e.length},end(i){return n("end",i,e.length)},start(i){return n("start",i,e.length)}}}}const uZ={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},A4=t=>String.fromCharCode(uZ[t]||t),ir=15,ss=100,lZ={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},cZ={17:2,18:4,21:6,22:8,23:10,19:13,20:15},dZ={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},fZ={25:2,26:4,29:6,30:8,31:10,27:13,28:15},hZ=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class pZ{constructor(){this.time=null,this.verboseLevel=0}log(e,n){if(this.verboseLevel>=e){const i=typeof n=="function"?n():n;Ft.log(`${this.time} [${e}] ${i}`)}}}const Wa=function(e){const n=[];for(let i=0;i<e.length;i++)n.push(e[i].toString(16));return n};class w4{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const n=["foreground","underline","italics","background","flash"];for(let i=0;i<n.length;i++){const r=n[i];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class mZ{constructor(){this.uchar=" ",this.penState=new w4}reset(){this.uchar=" ",this.penState.reset()}setChar(e,n){this.uchar=e,this.penState.copy(n)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class gZ{constructor(e){this.chars=[],this.pos=0,this.currPenState=new w4,this.cueStartTime=null,this.logger=void 0;for(let n=0;n<ss;n++)this.chars.push(new mZ);this.logger=e}equals(e){for(let n=0;n<ss;n++)if(!this.chars[n].equals(e.chars[n]))return!1;return!0}copy(e){for(let n=0;n<ss;n++)this.chars[n].copy(e.chars[n])}isEmpty(){let e=!0;for(let n=0;n<ss;n++)if(!this.chars[n].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>ss&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=ss)}moveCursor(e){const n=this.pos+e;if(e>1)for(let i=this.pos+1;i<n+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(n)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const n=A4(e);if(this.pos>=ss){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+n+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(n,this.currPenState),this.moveCursor(1)}clearFromPos(e){let n;for(n=e;n<ss;n++)this.chars[n].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let n=!0;for(let i=0;i<ss;i++){const r=this.chars[i].uchar;r!==" "&&(n=!1),e.push(r)}return n?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class k1{constructor(e){this.rows=[],this.currRow=ir-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let n=0;n<ir;n++)this.rows.push(new gZ(e));this.logger=e}reset(){for(let e=0;e<ir;e++)this.rows[e].clear();this.currRow=ir-1}equals(e){let n=!0;for(let i=0;i<ir;i++)if(!this.rows[i].equals(e.rows[i])){n=!1;break}return n}copy(e){for(let n=0;n<ir;n++)this.rows[n].copy(e.rows[n])}isEmpty(){let e=!0;for(let n=0;n<ir;n++)if(!this.rows[n].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Wt(e));let n=e.row-1;if(this.nrRollUpRows&&n<this.nrRollUpRows-1&&(n=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==n){for(let o=0;o<ir;o++)this.rows[o].clear();const s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[s].cueStartTime,l=this.logger.time;if(o!==null&&l!==null&&o<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[n-this.nrRollUpRows+u+1].copy(a.rows[s+u])}}this.currRow=n;const i=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,a=Math.max(s-1,0);i.setCursor(e.indent),e.color=i.chars[a].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Wt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,n=this.rows.splice(e,1)[0];n.clear(),this.rows.splice(this.currRow,0,n),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const n=[];let i="",r=-1;for(let s=0;s<ir;s++){const a=this.rows[s].getTextString();a&&(r=s+1,e?n.push("Row "+r+": '"+a+"'"):n.push(a.trim()))}return n.length>0&&(e?i="["+n.join(" | ")+"]":i=n.join(`
`)),i}getTextAndFormat(){return this.rows}}class xC{constructor(e,n,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new k1(i),this.nonDisplayedMemory=new k1(i),this.lastOutputScreen=new k1(i),this.currRollUpRow=this.displayedMemory.rows[ir-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[ir-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>n+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const n={flash:!1};if(n.underline=e%2===1,n.italics=e>=46,n.italics)n.foreground="white";else{const i=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];n.foreground=r[i]}this.logger.log(2,"MIDROW: "+Wt(n)),this.writeScreen.setPen(n)}outputDataUpdate(e=!1){const n=this.logger.time;n!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=n:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,n,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:n),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class SC{constructor(e,n,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=vZ(),this.logger=void 0;const r=this.logger=new pZ;this.channels=[null,new xC(e,n,r),new xC(e+1,i,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,n){this.channels[e].setHandler(n)}addData(e,n){this.logger.time=e;for(let i=0;i<n.length;i+=2){const r=n[i]&127,s=n[i+1]&127;let a=!1,o=null;if(r===0&&s===0)continue;this.logger.log(3,()=>"["+Wa([n[i],n[i+1]])+"] -> ("+Wa([r,s])+")");const l=this.cmdHistory;if(r>=16&&r<=31){if(yZ(r,s,l)){Qf(null,null,l),this.logger.log(3,()=>"Repeated command ("+Wa([r,s])+") is dropped");continue}Qf(r,s,this.cmdHistory),a=this.parseCmd(r,s),a||(a=this.parseMidrow(r,s)),a||(a=this.parsePAC(r,s)),a||(a=this.parseBackgroundAttributes(r,s))}else Qf(null,null,l);if(!a&&(o=this.parseChars(r,s),o)){const d=this.currentChannel;d&&d>0?this.channels[d].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Wa([r,s])+" orig: "+Wa([n[i],n[i+1]]))}}parseCmd(e,n){const i=(e===20||e===28||e===21||e===29)&&n>=32&&n<=47,r=(e===23||e===31)&&n>=33&&n<=35;if(!(i||r))return!1;const s=e===20||e===21||e===23?1:2,a=this.channels[s];return e===20||e===21||e===28||e===29?n===32?a.ccRCL():n===33?a.ccBS():n===34?a.ccAOF():n===35?a.ccAON():n===36?a.ccDER():n===37?a.ccRU(2):n===38?a.ccRU(3):n===39?a.ccRU(4):n===40?a.ccFON():n===41?a.ccRDC():n===42?a.ccTR():n===43?a.ccRTD():n===44?a.ccEDM():n===45?a.ccCR():n===46?a.ccENM():n===47&&a.ccEOC():a.ccTO(n-32),this.currentChannel=s,!0}parseMidrow(e,n){let i=0;if((e===17||e===25)&&n>=32&&n<=47){if(e===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[i];return r?(r.ccMIDROW(n),this.logger.log(3,()=>"MIDROW ("+Wa([e,n])+")"),!0):!1}return!1}parsePAC(e,n){let i;const r=(e>=17&&e<=23||e>=25&&e<=31)&&n>=64&&n<=127,s=(e===16||e===24)&&n>=64&&n<=95;if(!(r||s))return!1;const a=e<=23?1:2;n>=64&&n<=95?i=a===1?lZ[e]:dZ[e]:i=a===1?cZ[e]:fZ[e];const o=this.channels[a];return o?(o.setPAC(this.interpretPAC(i,n)),this.currentChannel=a,!0):!1}interpretPAC(e,n){let i;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return n>95?i=n-96:i=n-64,r.underline=(i&1)===1,i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((i-16)/2)*4,r}parseChars(e,n){let i,r=null,s=null;if(e>=25?(i=2,s=e-8):(i=1,s=e),s>=17&&s<=19){let a;s===17?a=n+80:s===18?a=n+112:a=n+144,this.logger.log(2,()=>"Special char '"+A4(a)+"' in channel "+i),r=[a]}else e>=32&&e<=127&&(r=n===0?[e]:[e,n]);return r&&this.logger.log(3,()=>"Char codes =  "+Wa(r).join(",")),r}parseBackgroundAttributes(e,n){const i=(e===16||e===24)&&n>=32&&n<=47,r=(e===23||e===31)&&n>=45&&n<=47;if(!(i||r))return!1;let s;const a={};e===16||e===24?(s=Math.floor((n-32)/2),a.background=hZ[s],n%2===1&&(a.background=a.background+"_semi")):n===45?a.background="transparent":(a.foreground="black",n===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const n=this.channels[e];n&&n.reset()}Qf(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let n=0;n<this.channels.length;n++){const i=this.channels[n];i&&i.cueSplitAtTime(e)}}}function Qf(t,e,n){n.a=t,n.b=e}function yZ(t,e,n){return n.a===t&&n.b===e}function vZ(){return{a:null,b:null}}var Wb=(function(){if(Gh!=null&&Gh.VTTCue)return self.VTTCue;const t=["","lr","rl"],e=["start","middle","end","left","right"];function n(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const u=l.toLowerCase();return~o.indexOf(u)?u:!1}function i(o){return n(t,o)}function r(o){return n(e,o)}function s(o,...l){let u=1;for(;u<arguments.length;u++){const d=arguments[u];for(const f in d)o[f]=d[f]}return o}function a(o,l,u){const d=this,f={enumerable:!0};d.hasBeenReset=!1;let p="",m=!1,y=o,b=l,E=u,T=null,x="",S=!0,w="auto",C="start",I=50,L="middle",N=50,G="middle";Object.defineProperty(d,"id",s({},f,{get:function(){return p},set:function(O){p=""+O}})),Object.defineProperty(d,"pauseOnExit",s({},f,{get:function(){return m},set:function(O){m=!!O}})),Object.defineProperty(d,"startTime",s({},f,{get:function(){return y},set:function(O){if(typeof O!="number")throw new TypeError("Start time must be set to a number.");y=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"endTime",s({},f,{get:function(){return b},set:function(O){if(typeof O!="number")throw new TypeError("End time must be set to a number.");b=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"text",s({},f,{get:function(){return E},set:function(O){E=""+O,this.hasBeenReset=!0}})),Object.defineProperty(d,"region",s({},f,{get:function(){return T},set:function(O){T=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"vertical",s({},f,{get:function(){return x},set:function(O){const D=i(O);if(D===!1)throw new SyntaxError("An invalid or illegal string was specified.");x=D,this.hasBeenReset=!0}})),Object.defineProperty(d,"snapToLines",s({},f,{get:function(){return S},set:function(O){S=!!O,this.hasBeenReset=!0}})),Object.defineProperty(d,"line",s({},f,{get:function(){return w},set:function(O){if(typeof O!="number"&&O!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");w=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"lineAlign",s({},f,{get:function(){return C},set:function(O){const D=r(O);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");C=D,this.hasBeenReset=!0}})),Object.defineProperty(d,"position",s({},f,{get:function(){return I},set:function(O){if(O<0||O>100)throw new Error("Position must be between 0 and 100.");I=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"positionAlign",s({},f,{get:function(){return L},set:function(O){const D=r(O);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");L=D,this.hasBeenReset=!0}})),Object.defineProperty(d,"size",s({},f,{get:function(){return N},set:function(O){if(O<0||O>100)throw new Error("Size must be between 0 and 100.");N=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"align",s({},f,{get:function(){return G},set:function(O){const D=r(O);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");G=D,this.hasBeenReset=!0}})),d.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a})();class bZ{decode(e,n){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function C4(t){function e(i,r,s,a){return(i|0)*3600+(r|0)*60+(s|0)+parseFloat(a||0)}const n=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?e(n[2],n[3],0,n[4]):e(n[1],n[2],n[3],n[4]):null}class EZ{constructor(){this.values=Object.create(null)}set(e,n){!this.get(e)&&n!==""&&(this.values[e]=n)}get(e,n,i){return i?this.has(e)?this.values[e]:n[i]:this.has(e)?this.values[e]:n}has(e){return e in this.values}alt(e,n,i){for(let r=0;r<i.length;++r)if(n===i[r]){this.set(e,n);break}}integer(e,n){/^-?\d+$/.test(n)&&this.set(e,parseInt(n,10))}percent(e,n){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(n)){const i=parseFloat(n);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function R4(t,e,n,i){const r=i?t.split(i):[t];for(const s in r){if(typeof r[s]!="string")continue;const a=r[s].split(n);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const rv=new Wb(0,0,""),Zf=rv.align==="middle"?"middle":"center";function TZ(t,e,n){const i=t;function r(){const o=C4(t);if(o===null)throw new Error("Malformed timestamp: "+i);return t=t.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,l){const u=new EZ;R4(o,function(p,m){let y;switch(p){case"region":for(let b=n.length-1;b>=0;b--)if(n[b].id===m){u.set(p,n[b].region);break}break;case"vertical":u.alt(p,m,["rl","lr"]);break;case"line":y=m.split(","),u.integer(p,y[0]),u.percent(p,y[0])&&u.set("snapToLines",!1),u.alt(p,y[0],["auto"]),y.length===2&&u.alt("lineAlign",y[1],["start",Zf,"end"]);break;case"position":y=m.split(","),u.percent(p,y[0]),y.length===2&&u.alt("positionAlign",y[1],["start",Zf,"end","line-left","line-right","auto"]);break;case"size":u.percent(p,m);break;case"align":u.alt(p,m,["start",Zf,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let d=u.get("line","auto");d==="auto"&&rv.line===-1&&(d=-1),l.line=d,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",Zf);let f=u.get("position","auto");f==="auto"&&rv.position===50&&(f=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=f}function a(){t=t.replace(/^\s+/,"")}if(a(),e.startTime=r(),a(),t.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);t=t.slice(3),a(),e.endTime=r(),a(),s(t,e)}function _4(t){return t.replace(/<br(?: \/)?>/gi,`
`)}class xZ{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new bZ,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const n=this;e&&(n.buffer+=n.decoder.decode(e,{stream:!0}));function i(){let s=n.buffer,a=0;for(s=_4(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;const o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,n.buffer=s.slice(a),o}function r(s){R4(s,function(a,o){},/:/)}try{let s="";if(n.state==="INITIAL"){if(!/\r\n|\n/.test(n.buffer))return this;s=i();const o=s.match(/^()?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");n.state="HEADER"}let a=!1;for(;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(a?a=!1:s=i(),n.state){case"HEADER":/:/.test(s)?r(s):s||(n.state="ID");continue;case"NOTE":s||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){n.state="NOTE";break}if(!s)continue;if(n.cue=new Wb(0,0,""),n.state="CUE",s.indexOf("-->")===-1){n.cue.id=s;continue}case"CUE":if(!n.cue){n.state="BADCUE";continue}try{TZ(s,n.cue,n.regionList)}catch{n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":{const o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){n.oncue&&n.cue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}if(n.cue===null)continue;n.cue.text&&(n.cue.text+=`
`),n.cue.text+=s}continue;case"BADCUE":s||(n.state="ID")}}}catch{n.state==="CUETEXT"&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state=n.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(n){e.onparsingerror&&e.onparsingerror(n)}return e.onflush&&e.onflush(),this}}const SZ=/\r\n|\n\r|\n|\r/g,N1=function(e,n,i=0){return e.slice(i,i+n.length)===n},AZ=function(e){let n=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!We(n)||!We(i)||!We(r)||!We(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return n+=1e3*i,n+=60*1e3*r,n+=3600*1e3*s,n};function $b(t,e,n){return _c(t.toString())+_c(e.toString())+_c(n)}const wZ=function(e,n,i){let r=e[n],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=i};function CZ(t,e,n,i,r,s,a){const o=new xZ,l=_i(new Uint8Array(t)).trim().replace(SZ,`
`).split(`
`),u=[],d=e?OX(e.baseTime,e.timescale):0;let f="00:00.000",p=0,m=0,y,b=!0;o.oncue=function(E){const T=n[i];let x=n.ccOffset;const S=(p-d)/9e4;if(T!=null&&T.new&&(m!==void 0?x=n.ccOffset=T.start:wZ(n,i,S)),S){if(!e){y=new Error("Missing initPTS for VTT MPEGTS");return}x=S-n.presentationOffset}const w=E.endTime-E.startTime,C=Hi((E.startTime+x-m)*9e4,r*9e4)/9e4;E.startTime=Math.max(C,0),E.endTime=Math.max(C+w,0);const I=E.text.trim();E.text=decodeURIComponent(encodeURIComponent(I)),E.id||(E.id=$b(E.startTime,E.endTime,I)),E.endTime>0&&u.push(E)},o.onparsingerror=function(E){y=E},o.onflush=function(){if(y){a(y);return}s(u)},l.forEach(E=>{if(b)if(N1(E,"X-TIMESTAMP-MAP=")){b=!1,E.slice(16).split(",").forEach(T=>{N1(T,"LOCAL:")?f=T.slice(6):N1(T,"MPEGTS:")&&(p=parseInt(T.slice(7)))});try{m=AZ(f)/1e3}catch(T){y=T}return}else E===""&&(b=!1);o.parse(E+`
`)}),o.flush()}const M1="stpp.ttml.im1t",I4=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,L4=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,RZ={left:"start",center:"center",right:"end",start:"start",end:"end"};function AC(t,e,n,i){const r=Tt(new Uint8Array(t),["mdat"]);if(r.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const s=r.map(o=>_i(o)),a=DX(e.baseTime,1,e.timescale);try{s.forEach(o=>n(_Z(o,a)))}catch(o){i(o)}}function _Z(t,e){const r=new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((f,p)=>(f[p]=r.getAttribute(`ttp:${p}`)||s[p],f),{}),o=r.getAttribute("xml:space")!=="preserve",l=wC(B1(r,"styling","style")),u=wC(B1(r,"layout","region")),d=B1(r,"body","[begin]");return[].map.call(d,f=>{const p=D4(f,o);if(!p||!f.hasAttribute("begin"))return null;const m=U1(f.getAttribute("begin"),a),y=U1(f.getAttribute("dur"),a);let b=U1(f.getAttribute("end"),a);if(m===null)throw CC(f);if(b===null){if(y===null)throw CC(f);b=m+y}const E=new Wb(m-e,b-e,p);E.id=$b(E.startTime,E.endTime,E.text);const T=u[f.getAttribute("region")],x=l[f.getAttribute("style")],S=IZ(T,x,l),{textAlign:w}=S;if(w){const C=RZ[w];C&&(E.lineAlign=C),E.align=w}return Vt(E,S),E}).filter(f=>f!==null)}function B1(t,e,n){const i=t.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function wC(t){return t.reduce((e,n)=>{const i=n.getAttribute("xml:id");return i&&(e[i]=n),e},{})}function D4(t,e){return[].slice.call(t.childNodes).reduce((n,i,r)=>{var s;return i.nodeName==="br"&&r?n+`
`:(s=i.childNodes)!=null&&s.length?D4(i,e):e?n+i.textContent.trim().replace(/\s+/g," "):n+i.textContent},"")}function IZ(t,e,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=t!=null&&t.hasAttribute("style")?t.getAttribute("style"):null;return a&&n.hasOwnProperty(a)&&(r=n[a]),s.reduce((o,l)=>{const u=F1(e,i,l)||F1(t,i,l)||F1(r,i,l);return u&&(o[l]=u),o},{})}function F1(t,e,n){return t&&t.hasAttributeNS(e,n)?t.getAttributeNS(e,n):null}function CC(t){return new Error(`Could not parse ttml timestamp ${t}`)}function U1(t,e){if(!t)return null;let n=C4(t);return n===null&&(I4.test(t)?n=LZ(t,e):L4.test(t)&&(n=DZ(t,e))),n}function LZ(t,e){const n=I4.exec(t),i=(n[4]|0)+(n[5]|0)/e.subFrameRate;return(n[1]|0)*3600+(n[2]|0)*60+(n[3]|0)+i/e.frameRate}function DZ(t,e){const n=L4.exec(t),i=Number(n[1]);switch(n[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}class Jf{constructor(e,n){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=n}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,n,i){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=n,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class OZ{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=_C(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(M.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(M.FRAG_LOADING,this.onFragLoading,this),e.on(M.FRAG_LOADED,this.onFragLoaded,this),e.on(M.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(M.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(M.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(M.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(M.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(M.FRAG_LOADING,this.onFragLoading,this),e.off(M.FRAG_LOADED,this.onFragLoaded,this),e.off(M.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(M.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(M.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(M.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Jf(this,"textTrack1"),n=new Jf(this,"textTrack2"),i=new Jf(this,"textTrack3"),r=new Jf(this,"textTrack4");this.cea608Parser1=new SC(1,e,n),this.cea608Parser2=new SC(3,i,r)}addCues(e,n,i,r,s){let a=!1;for(let o=s.length;o--;){const l=s[o],u=PZ(l[0],l[1],n,i);if(u>=0&&(l[0]=Math.min(l[0],n),l[1]=Math.max(l[1],i),a=!0,u/(i-n)>.5))return}if(a||s.push([n,i]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,n,i,r)}else{const o=this.Cues.newCue(null,n,i,r);this.hls.trigger(M.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:n,id:i,initPTS:r,timescale:s,trackId:a}){const{unparsedVttFrags:o}=this;i===Xe.MAIN&&(this.initPTS[n.cc]={baseTime:r,timescale:s,trackId:a}),o.length&&(this.unparsedVttFrags=[],o.forEach(l=>{this.initPTS[l.frag.cc]?this.onFragLoaded(M.FRAG_LOADED,l):this.hls.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,n){const{media:i}=this;if(i)for(let r=0;r<i.textTracks.length;r++){const s=i.textTracks[r];if(RC(s,{name:e,lang:n,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:n,captionsTracks:i,media:r}=this,{label:s,languageCode:a}=n[e],o=this.getExistingTrack(s,a);if(o)i[e]=o,_u(i[e]),T4(i[e],r);else{const l=this.createTextTrack("captions",s,a);l&&(l[e]=!0,i[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const n=this.captionsProperties[e];if(!n)return;const i=n.label,r={_id:e,label:i,kind:"captions",default:n.media?!!n.media.default:!1,closedCaptions:n.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(M.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,n,i){const r=this.media;if(r)return r.addTextTrack(e,n,i)}onMediaAttaching(e,n){this.media=n.media,n.mediaSource||this._cleanTracks()}onMediaDetaching(e,n){const i=!!n.transferMedia;if(this.media=null,i)return;const{captionsTracks:r}=this;Object.keys(r).forEach(s=>{_u(r[s]),delete r[s]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=_C(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const n=e.textTracks;if(n)for(let i=0;i<n.length;i++)_u(n[i])}onSubtitleTracksUpdated(e,n){const i=n.subtitleTracks||[],r=i.some(s=>s.textCodec===M1);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(u4(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const a=this.media,o=a?Eh(a.textTracks):null;if(this.tracks.forEach((l,u)=>{let d;if(o){let f=null;for(let p=0;p<o.length;p++)if(o[p]&&RC(o[p],l)){f=o[p],o[p]=null;break}f&&(d=f)}if(d)_u(d);else{const f=O4(l);d=this.createTextTrack(f,l.name,l.lang),d&&(d.mode="disabled")}d&&this.textTracks.push(d)}),o!=null&&o.length){const l=o.filter(u=>u!==null).map(u=>u.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(M.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,n){this.config.enableCEA708Captions&&n.captions&&n.captions.forEach(i=>{const r=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!r)return;const s=`textTrack${r[1]}`,a=this.captionsProperties[s];a&&(a.label=i.name,i.lang&&(a.languageCode=i.lang),a.media=i)})}closedCaptionsForLevel(e){const n=this.hls.levels[e.level];return n==null?void 0:n.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,n){if(this.enabled&&n.frag.type===Xe.MAIN){var i,r;const{cea608Parser1:s,cea608Parser2:a,lastSn:o}=this,{cc:l,sn:u}=n.frag,d=(i=(r=n.part)==null?void 0:r.index)!=null?i:-1;s&&a&&(u!==o+1||u===o&&d!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),a.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=d}}onFragLoaded(e,n){const{frag:i,payload:r}=n;if(i.type===Xe.SUBTITLE)if(r.byteLength){const s=i.decryptdata,a="stats"in n;if(s==null||!s.encrypted||a){const o=this.tracks[i.level],l=this.vttCCs;l[i.cc]||(l[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),o&&o.textCodec===M1?this._parseIMSC1(i,r):this._parseVTTs(n)}}else this.hls.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,n){const i=this.hls;AC(n,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),i.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{i.logger.log(`Failed to parse IMSC1: ${r}`),i.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var n;const{frag:i,payload:r}=e,{initPTS:s,unparsedVttFrags:a}=this,o=s.length-1;if(!s[i.cc]&&o===-1){a.push(e);return}const l=this.hls,u=(n=i.initSegment)!=null&&n.data?ji(i.initSegment.data,new Uint8Array(r)).buffer:r;CZ(u,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,d=>{this._appendCues(d,i.level),l.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},d=>{const f=d.message==="Missing initPTS for VTT MPEGTS";f?a.push(e):this._fallbackToIMSC1(i,r),l.logger.log(`Failed to parse VTT cue: ${d}`),!(f&&o>i.cc)&&l.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:d})})}_fallbackToIMSC1(e,n){const i=this.tracks[e.level];i.textCodec||AC(n,this.initPTS[e.cc],()=>{i.textCodec=M1,this._parseIMSC1(e,n)},()=>{i.textCodec="wvtt"})}_appendCues(e,n){const i=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[n];if(!r||r.mode==="disabled")return;e.forEach(s=>x4(r,s))}else{const r=this.tracks[n];if(!r)return;const s=r.default?"default":"subtitles"+n;i.trigger(M.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,n){const{frag:i}=n;i.type===Xe.SUBTITLE&&this.onFragLoaded(M.FRAG_LOADED,n)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,n){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:r}=n;if(!(i.type===Xe.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let s=0;s<r.length;s++){const a=r[s].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const o=this.extractCea608Data(a);this.cea608Parser1.addData(r[s].pts,o[0]),this.cea608Parser2.addData(r[s].pts,o[1])}}}onBufferFlushing(e,{startOffset:n,endOffset:i,endOffsetSubtitles:r,type:s}){const{media:a}=this;if(!(!a||a.currentTime<i)){if(!s||s==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>iv(o[l],n,i))}if(this.config.renderTextTracksNatively&&n===0&&r!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>iv(o[l],n,r))}}}extractCea608Data(e){const n=[[],[]],i=e[0]&31;let r=2;for(let s=0;s<i;s++){const a=e[r++],o=127&e[r++],l=127&e[r++];if(o===0&&l===0)continue;if((4&a)!==0){const d=3&a;(d===0||d===1)&&(n[d].push(o),n[d].push(l))}}return n}}function O4(t){return t.characteristics&&/transcribes-spoken-dialog/gi.test(t.characteristics)&&/describes-music-and-sound/gi.test(t.characteristics)?"captions":"subtitles"}function RC(t,e){return!!t&&t.kind===O4(e)&&Jy(e,t)}function PZ(t,e,n,i){return Math.min(e,i)-Math.max(t,n)}function _C(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const kZ=/\s/,NZ={newCue(t,e,n,i){const r=[];let s,a,o,l,u;const d=self.VTTCue||self.TextTrackCue;for(let p=0;p<i.rows.length;p++)if(s=i.rows[p],o=!0,l=0,u="",!s.isEmpty()){var f;for(let b=0;b<s.chars.length;b++)kZ.test(s.chars[b].uchar)&&o?l++:(u+=s.chars[b].uchar,o=!1);s.cueStartTime=e,e===n&&(n+=1e-4),l>=16?l--:l++;const m=_4(u.trim()),y=$b(e,n,m);t!=null&&(f=t.cues)!=null&&f.getCueById(y)||(a=new d(e,n,m),a.id=y,a.line=p+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),r.push(a))}return t&&r.length&&(r.sort((p,m)=>p.line==="auto"||m.line==="auto"?0:p.line>8&&m.line>8?m.line-p.line:p.line-m.line),r.forEach(p=>x4(t,p))),r}};function MZ(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const BZ=/(\d+)-(\d+)\/(\d+)/;class IC{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||zZ,this.controller=new self.AbortController,this.stats=new Ab}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,n,i){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=FZ(e,this.controller.signal),a=e.responseType==="arraybuffer",o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=n.loadPolicy;this.context=e,this.config=n,this.callbacks=i,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),n.timeout=l&&We(l)?l:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},n.timeout),(qc(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(f=>{var p;this.response=this.loader=f;const m=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),n.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},u-(m-r.loading.start)),!f.ok){const{status:b,statusText:E}=f;throw new qZ(E||"fetch, bad network response",b,f)}r.loading.first=m,r.total=HZ(f.headers)||r.total;const y=(p=this.callbacks)==null?void 0:p.onProgress;return y&&We(n.highWaterMark)?this.loadProgressively(f,r,e,n.highWaterMark,y):a?f.arrayBuffer():e.responseType==="json"?f.json():f.text()}).then(f=>{var p,m;const y=this.response;if(!y)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const b=f[o];b&&(r.loaded=r.total=b);const E={url:y.url,data:f,code:y.status},T=(p=this.callbacks)==null?void 0:p.onProgress;T&&!We(n.highWaterMark)&&T(r,e,f,y),(m=this.callbacks)==null||m.onSuccess(E,r,e,y)}).catch(f=>{var p;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const m=f&&f.code||0,y=f?f.message:null;(p=this.callbacks)==null||p.onError({code:m,text:y},e,f?f.details:null,r)})}getCacheAge(){let e=null;if(this.response){const n=this.response.headers.get("age");e=n?parseFloat(n):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,n,i,r=0,s){const a=new qL,o=e.body.getReader(),l=()=>o.read().then(u=>{if(u.done)return a.dataLength&&s(n,i,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const d=u.value,f=d.length;return n.loaded+=f,f<r||a.dataLength?(a.push(d),a.dataLength>=r&&s(n,i,a.flush().buffer,e)):s(n,i,d.buffer,e),l()}).catch(()=>Promise.reject());return l()}}function FZ(t,e){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Vt({},t.headers))};return t.rangeEnd&&n.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1)),n}function UZ(t){const e=BZ.exec(t);if(e)return parseInt(e[2])-parseInt(e[1])+1}function HZ(t){const e=t.get("Content-Range");if(e){const i=UZ(e);if(We(i))return i}const n=t.get("Content-Length");if(n)return parseInt(n)}function zZ(t,e){return new self.Request(t.url,e)}class qZ extends Error{constructor(e,n,i){super(e),this.code=void 0,this.details=void 0,this.code=n,this.details=i}}const VZ=/^age:\s*[\d.]+\s*$/im;class P4{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Ab,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,n,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=n,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:n}=this;if(!e||!n)return;const i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return s(i,n.url)}).catch(a=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",n.url,!0),s(i,n.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,n,e)}).catch(a=>{var o;(o=this.callbacks)==null||o.onError({code:i.status,text:a.message},n,i,r)}):this.openAndSendXhr(i,n,e)}openAndSendXhr(e,n,i){e.readyState||e.open("GET",n.url,!0);const r=n.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=i.loadPolicy;if(r)for(const o in r)e.setRequestHeader(o,r[o]);n.rangeEnd&&e.setRequestHeader("Range","bytes="+n.rangeStart+"-"+(n.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=n.responseType,self.clearTimeout(this.requestTimeout),i.timeout=s&&We(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:n,stats:i}=this;if(!e||!n)return;const r=n.readyState,s=this.config;if(!i.aborted&&r>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),n.onreadystatechange=null,n.onprogress=null;const u=n.status,d=n.responseType==="text"?n.responseText:null;if(u>=200&&u<300){const y=d??n.response;if(y!=null){var a,o;i.loading.end=Math.max(self.performance.now(),i.loading.first);const b=n.responseType==="arraybuffer"?y.byteLength:y.length;i.loaded=i.total=b,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);const E=(a=this.callbacks)==null?void 0:a.onProgress;E&&E(i,e,y,n);const T={url:n.responseURL,data:y,code:u};(o=this.callbacks)==null||o.onSuccess(T,i,e,n);return}}const f=s.loadPolicy.errorRetry,p=i.retry,m={url:e.url,data:void 0,code:u};if(Vh(f,p,!1,m))this.retry(f);else{var l;Ft.error(`${u} while loading ${e.url}`),(l=this.callbacks)==null||l.onError({code:u,text:n.statusText},e,n,i)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,n=this.stats.retry;if(Vh(e,n,!0))this.retry(e);else{var i;Ft.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:n,stats:i}=this;this.retryDelay=_b(e,i.retry),i.retry++,Ft.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${n==null?void 0:n.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const n=this.stats;n.loaded=e.loaded,e.lengthComputable&&(n.total=e.total)}getCacheAge(){let e=null;if(this.loader&&VZ.test(this.loader.getAllResponseHeaders())){const n=this.loader.getResponseHeader("age");e=n?parseFloat(n):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const GZ={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},jZ=Bt(Bt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:P4,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:nK,bufferController:$X,capLevelController:Vb,errorController:oK,fpsController:YQ,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:OL,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:GZ},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},WZ()),{},{subtitleStreamController:aZ,subtitleTrackController:QQ,timelineController:OZ,audioStreamController:VX,audioTrackController:GX,emeController:ku,cmcdController:GQ,contentSteeringController:WQ,interstitialsController:sZ});function WZ(){return{cueHandler:NZ,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function $Z(t,e,n){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=sv(t),r=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(a=>{const o=`${a==="level"?"playlist":a}LoadPolicy`,l=e[o]===void 0,u=[];s.forEach(d=>{const f=`${a}Loading${d}`,p=e[f];if(p!==void 0&&l){u.push(f);const m=i[o].default;switch(e[o]={default:m},d){case"TimeOut":m.maxLoadTimeMs=p,m.maxTimeToFirstByteMs=p;break;case"MaxRetry":m.errorRetry.maxNumRetry=p,m.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":m.errorRetry.retryDelayMs=p,m.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":m.errorRetry.maxRetryDelayMs=p,m.timeoutRetry.maxRetryDelayMs=p;break}}}),u.length&&n.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${o}": ${Wt(e[o])}`)}),Bt(Bt({},i),e)}function sv(t){return t&&typeof t=="object"?Array.isArray(t)?t.map(sv):Object.keys(t).reduce((e,n)=>(e[n]=sv(t[n]),e),{}):t}function YZ(t,e){const n=t.loader;n!==IC&&n!==P4?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1):MZ()&&(t.loader=IC,t.progressive=!0,t.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const Th=2,KZ=.1,XZ=.05,QZ=100;class ZZ extends _L{constructor(e,n){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(M.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=n,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,n){this.setInterval(QZ),this.mediaSource=n.mediaSource;const i=this.media=n.media;Jn(i,"playing",this.onMediaPlaying),Jn(i,"waiting",this.onMediaWaiting),Jn(i,"ended",this.onMediaEnded)}onMediaDetaching(e,n){this.clearInterval();const{media:i}=this;i&&(ci(i,"playing",this.onMediaPlaying),ci(i,"waiting",this.onMediaWaiting),ci(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,n){this.buffered=n.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const n=this.media.currentTime;this.poll(n,this.lastCurrentTime),this.lastCurrentTime=n}poll(e,n){var i,r;const s=(i=this.hls)==null?void 0:i.config;if(!s)return;const a=this.media;if(!a)return;const{seeking:o}=a,l=this.seeking&&!o,u=!this.seeking&&o,d=a.paused&&!o||a.ended||a.playbackRate===0;if(this.seeking=o,e!==n){n&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,s.nudgeOnVideoHole&&!d&&e>n&&this.nudgeOnVideoHole(e,n)),this.waiting===0&&this.stallResolved(e);return}if(u||l){l&&this.stallResolved(e);return}if(d){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(M.MEDIA_ENDED,{stalled:!1}));return}if(!pt.getBuffered(a).length){this.nudgeRetry=0;return}const f=pt.bufferInfo(a,e,0),p=f.nextStart||0,m=this.fragmentTracker;if(o&&m&&this.hls){const I=LC(this.hls.inFlightFragments,e),L=f.len>Th,N=!p||I||p-e>Th&&!m.getPartialFragment(e);if(L||N)return;this.moved=!1}const y=(r=this.hls)==null?void 0:r.latestLevelDetails;if(!this.moved&&this.stalled!==null&&m){if(!(f.len>0)&&!p)return;const L=Math.max(p,f.start||0)-e,G=!!(y!=null&&y.live)?y.targetduration*2:Th,O=eh(e,m);if(L>0&&(L<=G||O)){a.paused||this._trySkipBufferHole(O);return}}const b=s.detectStallWithCurrentTimeMs,E=self.performance.now(),T=this.waiting;let x=this.stalled;if(x===null)if(T>0&&E-T<b)x=this.stalled=T;else{this.stalled=E;return}const S=E-x;if(!o&&(S>=b||T)&&this.hls){var w;if(((w=this.mediaSource)==null?void 0:w.readyState)==="ended"&&!(y!=null&&y.live)&&Math.abs(e-((y==null?void 0:y.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(M.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(f),!this.media||!this.hls)return}const C=pt.bufferInfo(a,e,s.maxBufferHole);this._tryFixBufferStall(C,S,e)}stallResolved(e){const n=this.stalled;if(n&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-n;this.log(`playback not stuck anymore @${e}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(M.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,n){var i;const r=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&r&&r.length>1&&e>r.end(0)){const s=pt.bufferedInfo(pt.timeRangesToArray(this.buffered.audio),e,0);if(s.len>1&&n>=s.start){const a=pt.timeRangesToArray(r),o=pt.bufferedInfo(a,n,0).bufferedIndex;if(o>-1&&o<a.length-1){const l=pt.bufferedInfo(a,e,0).bufferedIndex,u=a[o].end,d=a[o+1].start;if((l===-1||l>o)&&d-u<1&&e-u<2){const f=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${u} -> ${d} buffered index: ${l}`);this.warn(f.message),this.media.currentTime+=1e-6;let p=eh(e,this.fragmentTracker);p&&"fragment"in p?p=p.fragment:p||(p=void 0);const m=pt.bufferInfo(this.media,e,0);this.hls.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:f,reason:f.message,frag:p,buffer:m.len,bufferInfo:m})}}}}}_tryFixBufferStall(e,n,i){var r,s;const{fragmentTracker:a,media:o}=this,l=(r=this.hls)==null?void 0:r.config;if(!o||!a||!l)return;const u=(s=this.hls)==null?void 0:s.latestLevelDetails,d=eh(i,a);if((d||u!=null&&u.live&&i<u.fragmentStart)&&(this._trySkipBufferHole(d)||!this.media))return;const f=e.buffered,p=this.adjacentTraversal(e,i);(f&&f.length>1&&e.len>l.maxBufferHole||e.nextStart&&(e.nextStart-i<l.maxBufferHole||p))&&(n>l.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,n){const i=this.fragmentTracker,r=e.nextStart;if(i&&r){const s=i.getFragAtPos(n,Xe.MAIN),a=i.getFragAtPos(r,Xe.MAIN);if(s&&a)return a.sn-s.sn<2}return!1}_reportStall(e){const{hls:n,media:i,stallReported:r,stalled:s}=this;if(!r&&s!==null&&i&&n){this.stallReported=!0;const a=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${Wt(e)})`);this.warn(a.message),n.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:s}})}}_trySkipBufferHole(e){var n;const{fragmentTracker:i,media:r}=this,s=(n=this.hls)==null?void 0:n.config;if(!r||!i||!s)return 0;const a=r.currentTime,o=pt.bufferInfo(r,a,0),l=a<o.start?o.start:o.nextStart;if(l&&this.hls){const d=o.len<=s.maxBufferHole,f=o.len>0&&o.len<1&&r.readyState<3,p=l-a;if(p>0&&(d||f)){if(p>s.maxBufferHole){let y=!1;if(a===0){const b=i.getAppendedFrag(0,Xe.MAIN);b&&l<b.end&&(y=!0)}if(!y&&e){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||LC(this.hls.inFlightFragments,l))return 0;let E=!1,T=e.end;for(;T<l;){const x=eh(T,i);if(x)T+=x.duration;else{E=!0;break}}if(E)return 0}}const m=Math.max(l+XZ,a+KZ);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${m}`),this.moved=!0,r.currentTime=m,!(e!=null&&e.gap)){const y=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${m}`),b={type:it.MEDIA_ERROR,details:pe.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,buffer:o.len,bufferInfo:o};e&&("fragment"in e?b.part=e:b.frag=e),this.hls.trigger(M.ERROR,b)}return m}}return 0}_tryNudgeBuffer(e){const{hls:n,media:i,nudgeRetry:r}=this,s=n==null?void 0:n.config;if(!i||!s)return 0;const a=i.currentTime;if(this.nudgeRetry++,r<s.nudgeMaxRetry){const o=a+(r+1)*s.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${a} to ${o}`);this.warn(l.message),i.currentTime=o,n.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:e.len,bufferInfo:e})}else{const o=new Error(`Playhead still not moving while enough data buffered @${a} after ${s.nudgeMaxRetry} nudges`);this.error(o.message),n.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.BUFFER_STALLED_ERROR,error:o,fatal:!0,buffer:e.len,bufferInfo:e})}}}function LC(t,e){const n=DC(t.main);if(n&&n.start<=e)return n;const i=DC(t.audio);return i&&i.start<=e?i:null}function DC(t){if(!t)return null;switch(t.state){case _e.IDLE:case _e.STOPPED:case _e.ENDED:case _e.ERROR:return null}return t.frag}function eh(t,e){return e.getAppendedFrag(t,Xe.MAIN)||e.getPartialFragment(t)}const JZ=.25;function av(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function H1(t,e,n,i,r){let s=new t(e,n,"");try{s.value=i,r&&(s.type=r)}catch{s=new t(e,n,Wt(r?Bt({type:r},i):i))}return s}const th=(()=>{const t=av();try{t&&new t(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class eJ{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(M.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(M.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(M.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,n){var i;this.media=n.media,((i=n.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const n=(e=this.hls)==null?void 0:e.latestLevelDetails;n&&this.updateDateRangeCues(n)}onMediaDetaching(e,n){this.media=null,!n.transferMedia&&(this.id3Track&&(this.removeCues&&_u(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const n=this.getID3Track(e.textTracks);return n.mode="hidden",n}getID3Track(e){if(this.media){for(let n=0;n<e.length;n++){const i=e[n];if(i.kind==="metadata"&&i.label==="id3")return T4(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,n){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:i,enableID3MetadataCues:r}=this.hls.config;if(!i&&!r)return;const{samples:s}=n;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=av();if(a)for(let o=0;o<s.length;o++){const l=s[o].type;if(l===wi.emsg&&!i||!r)continue;const u=KL(s[o].data),d=s[o].pts;let f=d+s[o].duration;f>th&&(f=th),f-d<=0&&(f=d+JZ);for(let m=0;m<u.length;m++){const y=u[m];if(!XL(y)){this.updateId3CueEnds(d,l);const b=H1(a,d,f,y,l);b&&this.id3Track.addCue(b)}}}}updateId3CueEnds(e,n){var i;const r=(i=this.id3Track)==null?void 0:i.cues;if(r)for(let s=r.length;s--;){const a=r[s];a.type===n&&a.startTime<e&&a.endTime===th&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:n,endOffset:i,type:r}){const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let u;r==="audio"?u=d=>d.type===wi.audioId3&&l:r==="video"?u=d=>d.type===wi.emsg&&o:u=d=>d.type===wi.audioId3&&l||d.type===wi.emsg&&o,iv(s,n,i,u)}}onLevelUpdated(e,{details:n}){this.updateDateRangeCues(n,!0)}onLevelPtsUpdated(e,n){Math.abs(n.drift)>.01&&this.updateDateRangeCues(n.details)}updateDateRangeCues(e,n){if(!this.hls||!this.media)return;const{assetPlayerId:i,timelineOffset:r,enableDateRangeMetadataCues:s,interstitialsController:a}=this.hls.config;if(!s)return;const o=av();if(i&&r&&!a){const{fragmentStart:b,fragmentEnd:E}=e;let T=this.assetCue;T?(T.startTime=b,T.endTime=E):o&&(T=this.assetCue=H1(o,b,E,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),T&&(T.id=i,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(T),T.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:l}=this,{dateRanges:u}=e,d=Object.keys(u);let f=this.dateRangeCuesAppended;if(l&&n){var p;if((p=l.cues)!=null&&p.length){const b=Object.keys(f).filter(E=>!d.includes(E));for(let E=b.length;E--;){var m;const T=b[E],x=(m=f[T])==null?void 0:m.cues;delete f[T],x&&Object.keys(x).forEach(S=>{const w=x[S];if(w){w.removeEventListener("enter",this.onEventCueEnter);try{l.removeCue(w)}catch{}}})}}else f=this.dateRangeCuesAppended={}}const y=e.fragments[e.fragments.length-1];if(!(d.length===0||!We(y==null?void 0:y.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let b=0;b<d.length;b++){const E=d[b],T=u[E],x=T.startTime,S=f[E],w=(S==null?void 0:S.cues)||{};let C=(S==null?void 0:S.durationKnown)||!1,I=th;const{duration:L,endDate:N}=T;if(N&&L!==null)I=x+L,C=!0;else if(T.endOnNext&&!C){const O=d.reduce((D,V)=>{if(V!==T.id){const $=u[V];if($.class===T.class&&$.startDate>T.startDate&&(!D||T.startDate<D.startDate))return $}return D},null);O&&(I=O.startTime,C=!0)}const G=Object.keys(T.attr);for(let O=0;O<G.length;O++){const D=G[O];if(!EK(D))continue;const V=w[D];if(V)C&&!(S!=null&&S.durationKnown)?V.endTime=I:Math.abs(V.startTime-x)>.01&&(V.startTime=x,V.endTime=I);else if(o){let $=T.attr[D];TK(D)&&($=lL($));const K=H1(o,x,I,{key:D,data:$},wi.dateRange);K&&(K.id=E,this.id3Track.addCue(K),w[D]=K,a&&(D==="X-ASSET-LIST"||D==="X-ASSET-URL")&&K.addEventListener("enter",this.onEventCueEnter))}}f[E]={cues:w,dateRange:T,durationKnown:C}}}}}class tJ{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:n}=this,i=this.levelDetails;if(!n||!i)return;this.currentTime=n.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:a}=this.config;if(!s||a===1||!i.live)return;const o=this.targetLatency;if(o===null)return;const l=r-o,u=Math.min(this.maxLatency,o+i.targetduration);if(l<u&&l>.05&&this.forwardBufferLength>1){const f=Math.min(2,Math.max(1,a)),p=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,m=Math.min(f,Math.max(1,p));this.changeMediaPlaybackRate(n,m)}else n.playbackRate!==1&&n.playbackRate!==0&&this.changeMediaPlaybackRate(n,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const n=this.levelDetails;return n?e.liveMaxLatencyDurationCount*n.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:n,partHoldBack:i,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let u=o&&i||n;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:a*r);const d=r;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,d)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),n=this.targetLatency;if(e===null||n===null)return null;const i=this.levelDetails;if(i===null)return null;const r=i.edge,s=e-n-this.edgeStalled,a=r-i.totalduration,o=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(a,s),o)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const n=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-n,0)}get forwardBufferLength(){const{media:e}=this,n=this.levelDetails;if(!e||!n)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):n.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(M.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(M.ERROR,this.onError,this))}onMediaAttached(e,n){this.media=n.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:n}){n.advanced&&this.onTimeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,n){var i;n.details===pe.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,n){var i,r;e.playbackRate!==n&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(r=this.targetLatency)==null?void 0:r.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${n}`),e.playbackRate=n)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class nJ extends qb{constructor(e,n){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=n,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this),e.on(M.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this),e.off(M.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(n=>{n.loadError=0,n.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,n){this.resetLevels()}onManifestLoaded(e,n){const i=this.hls.config.preferManagedMediaSource,r=[],s={},a={};let o=!1,l=!1,u=!1;n.levels.forEach(d=>{const f=d.attrs;let{audioCodec:p,videoCodec:m}=d;p&&(d.audioCodec=p=Uh(p,i)||void 0),m&&(m=d.videoCodec=BY(m));const{width:y,height:b,unknownCodecs:E}=d,T=(E==null?void 0:E.length)||0;if(o||(o=!!(y&&b)),l||(l=!!m),u||(u=!!p),T||p&&!this.isAudioSupported(p)||m&&!this.isVideoSupported(m)){this.log(`Some or all CODECS not supported "${f.CODECS}"`);return}const{CODECS:x,"FRAME-RATE":S,"HDCP-LEVEL":w,"PATHWAY-ID":C,RESOLUTION:I,"VIDEO-RANGE":L}=f,G=`${`${C||"."}-`}${d.bitrate}-${I}-${S}-${x}-${L}-${w}`;if(s[G])if(s[G].uri!==d.url&&!d.attrs["PATHWAY-ID"]){const O=a[G]+=1;d.attrs["PATHWAY-ID"]=new Array(O+1).join(".");const D=this.createLevel(d);s[G]=D,r.push(D)}else s[G].addGroupId("audio",f.AUDIO),s[G].addGroupId("text",f.SUBTITLES);else{const O=this.createLevel(d);s[G]=O,a[G]=1,r.push(O)}}),this.filterAndSortMediaOptions(r,n,o,l,u)}createLevel(e){const n=new Fc(e),i=e.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const r=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(r.message),n.supportedResult=EL(r,[])}return n}isAudioSupported(e){return Mc(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Mc(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,n,i,r,s){var a;let o=[],l=[],u=e;const d=((a=n.stats)==null?void 0:a.parsing)||{};if((i||r)&&s&&(u=u.filter(({videoCodec:x,videoRange:S,width:w,height:C})=>(!!x||!!(w&&C))&&$Y(S))),u.length===0){Promise.resolve().then(()=>{if(this.hls){let x="no level with compatible codecs found in manifest",S=x;n.levels.length&&(S=`one or more CODECS in variant not supported: ${Wt(n.levels.map(C=>C.attrs.CODECS).filter((C,I,L)=>L.indexOf(C)===I))}`,this.warn(S),x+=` (${S})`);const w=new Error(x);this.hls.trigger(M.ERROR,{type:it.MEDIA_ERROR,details:pe.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:n.url,error:w,reason:S})}}),d.end=performance.now();return}n.audioTracks&&(o=n.audioTracks.filter(x=>!x.audioCodec||this.isAudioSupported(x.audioCodec)),OC(o)),n.subtitles&&(l=n.subtitles,OC(l));const f=u.slice(0);u.sort((x,S)=>{if(x.attrs["HDCP-LEVEL"]!==S.attrs["HDCP-LEVEL"])return(x.attrs["HDCP-LEVEL"]||"")>(S.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&x.height!==S.height)return x.height-S.height;if(x.frameRate!==S.frameRate)return x.frameRate-S.frameRate;if(x.videoRange!==S.videoRange)return Hh.indexOf(x.videoRange)-Hh.indexOf(S.videoRange);if(x.videoCodec!==S.videoCodec){const w=ww(x.videoCodec),C=ww(S.videoCodec);if(w!==C)return C-w}if(x.uri===S.uri&&x.codecSet!==S.codecSet){const w=Fh(x.codecSet),C=Fh(S.codecSet);if(w!==C)return C-w}return x.averageBitrate!==S.averageBitrate?x.averageBitrate-S.averageBitrate:0});let p=f[0];if(this.steering&&(u=this.steering.filterParsedLevels(u),u.length!==f.length)){for(let x=0;x<f.length;x++)if(f[x].pathwayId===u[0].pathwayId){p=f[x];break}}this._levels=u;for(let x=0;x<u.length;x++)if(u[x]===p){var m;this._firstLevel=x;const S=p.bitrate,w=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${u.length} level(s) found, first bitrate: ${S}`),((m=this.hls.userConfig)==null?void 0:m.abrEwmaDefaultEstimate)===void 0){const C=Math.min(S,this.hls.config.abrEwmaDefaultEstimateMax);C>w&&w===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=C)}break}const y=s&&!r,b=this.hls.config,E=!!(b.audioStreamController&&b.audioTrackController),T={levels:u,audioTracks:o,subtitleTracks:l,sessionData:n.sessionData,sessionKeys:n.sessionKeys,firstLevel:this._firstLevel,stats:n.stats,audio:s,video:r,altAudio:E&&!y&&o.some(x=>!!x.url)};d.end=performance.now(),this.hls.trigger(M.MANIFEST_PARSED,T)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const n=this._levels;if(n.length===0)return;if(e<0||e>=n.length){const d=new Error("invalid level idx"),f=e<0;if(this.hls.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.LEVEL_SWITCH_ERROR,level:e,fatal:f,error:d,reason:d.message}),f)return;e=Math.min(e,n.length-1)}const i=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,a=n[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,i===e&&r&&s===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${i}${s?" with Pathway "+s:""}`);const l={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(M.LEVEL_SWITCHING,l);const u=a.details;if(!u||u.live){const d=this.switchParams(a.uri,r==null?void 0:r.details,u);this.loadPlaylist(d)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const n=this.steering.pathways(),i=e.filter(r=>n.indexOf(r)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${n}`);return}this.steering.pathwayPriority=i}}onError(e,n){n.fatal||!n.context||n.context.type===At.LEVEL&&n.context.level===this.level&&this.checkRetry(n)}onFragBuffered(e,{frag:n}){if(n!==void 0&&n.type===Xe.MAIN){const i=n.elementaryStreams;if(!Object.keys(i).some(s=>!!i[s]))return;const r=this._levels[n.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,n){var i;const{level:r,details:s}=n,a=n.levelInfo;if(!a){var o;this.warn(`Invalid level index ${r}`),(o=n.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}if(a===this.currentLevel||n.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let l=a.details;l===n.details&&l.advanced&&(l=void 0),this.playlistLoaded(r,n,l)}else(i=n.deliveryDirectives)!=null&&i.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,n){super.loadingPlaylist(e,n);const i=this.getUrlWithDirectives(e.uri,n),r=this.currentLevelIndex,s=e.attrs["PATHWAY-ID"],a=e.details,o=a==null?void 0:a.age;this.log(`Loading level index ${r}${(n==null?void 0:n.msn)!==void 0?" at sn "+n.msn+" part "+n.part:""}${s?" Pathway "+s:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(M.LEVEL_LOADING,{url:i,level:r,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:n||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var n;if(this._levels.length===1)return;const i=this._levels.filter((s,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(s),s===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,s.details&&s.details.fragments.forEach(o=>o.level=-1)),!1));UL(i),this._levels=i,this.currentLevelIndex>-1&&(n=this.currentLevel)!=null&&n.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const r=i.length-1;this._firstLevel=Math.min(this._firstLevel,r),this._startLevel&&(this._startLevel=Math.min(this._startLevel,r)),this.hls.trigger(M.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:n}){this._levels=n}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:n,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==n&&(this._maxAutoLevel=n,this.hls.trigger(M.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:n,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function OC(t){const e={};t.forEach(n=>{const i=n.groupId||"";n.id=e[i]=e[i]||0,e[i]++})}function k4(){return self.SourceBuffer||self.WebKitSourceBuffer}function N4(){if(!ca())return!1;const e=k4();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function iJ(){if(!N4())return!1;const t=ca();return typeof(t==null?void 0:t.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>t.isTypeSupported(Bc(e,"video")))||["mp4a.40.2","fLaC"].some(e=>t.isTypeSupported(Bc(e,"audio"))))}function rJ(){var t;const e=k4();return typeof(e==null||(t=e.prototype)==null?void 0:t.changeType)=="function"}const sJ=100;class aJ extends kb{constructor(e,n,i){super(e,n,i,"stream-controller",Xe.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const r=this.media,s=r?r.currentTime:null;if(s===null||!We(s)||(this.log(`Media seeked to ${s.toFixed(3)}`),!this.getBufferedFrag(s)))return;const a=this.getFwdBufferInfoAtPos(r,s,Xe.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${s} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.LEVEL_LOADING,this.onLevelLoading,this),e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(M.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(M.BUFFER_CREATED,this.onBufferCreated,this),e.on(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(M.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(M.BUFFER_CREATED,this.onBufferCreated,this),e.off(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,n){if(this.levels){const{lastCurrentTime:i,hls:r}=this;if(this.stopLoad(),this.setInterval(sJ),this.level=-1,!this.startFragRequested){let s=r.startLevel;s===-1&&(r.config.testBandwidth&&this.levels.length>1?(s=0,this.bitrateTest=!0):s=r.firstAutoLevel),r.nextLoadLevel=s,this.level=r.loadLevel,this._hasEnoughToStart=!!n}i>0&&e===-1&&!n&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i),this.state=_e.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=n?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=_e.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case _e.WAITING_LEVEL:{const{levels:e,level:n}=this,i=e==null?void 0:e[n],r=i==null?void 0:i.details;if(r&&(!r.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(r))break;this.state=_e.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=_e.IDLE;break}break}case _e.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===_e.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:n,levels:i,media:r}=this;if(n===null||!r&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(i!=null&&i[s]))return;const a=i[s],o=this.getMainFwdBufferInfo();if(o===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const b={};this.altAudio===2&&(b.type="video"),this.hls.trigger(M.BUFFER_EOS,b),this.state=_e.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=a.details;if(!u||this.state===_e.WAITING_LEVEL||this.waitForLive(a)){this.level=s,this.state=_e.WAITING_LEVEL,this.startFragRequested=!1;return}const d=o.len,f=this.getMaxBufferLength(a.maxBitrate);if(d>=f)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:o.end;let m=this.getNextFragment(p,u);if(this.couldBacktrack&&!this.fragPrevious&&m&&bn(m)&&this.fragmentTracker.getState(m)!==wn.OK){var y;const E=((y=this.backtrackFragment)!=null?y:m).sn-u.startSN,T=u.fragments[E-1];T&&m.cc===T.cc&&(m=T,this.fragmentTracker.removeFragment(T))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,p)){if(!m.gap){const E=this.audioOnly&&!this.altAudio?jt.AUDIO:jt.VIDEO,T=(E===jt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;T&&this.afterBufferFlushed(T,E,Xe.MAIN)}m=this.getNextFragmentLoopLoading(m,u,o,Xe.MAIN,f)}m&&(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,a,p))}loadFragment(e,n,i){const r=this.fragmentTracker.getState(e);r===wn.NOT_LOADED||r===wn.PARTIAL?bn(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,n)):super.loadFragment(e,n,i):this._loadInitSegment(e,n):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Xe.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:n}=this;if(n!=null&&n.readyState){let i;const r=this.getAppendedFrag(n.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<s.targetduration*2)return}if(!n.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],u=this.fragLastKbps;u&&this.fragCurrent?i=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:i=0}else i=0;const a=this.getBufferedFrag(n.currentTime+i);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,u=o.duration,d=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case _e.KEY_LOADING:case _e.FRAG_LOADING:case _e.FRAG_LOADING_WAITING_RETRY:case _e.PARSING:case _e.PARSED:this.state=_e.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,n){super.flushMainBuffer(e,n,this.altAudio===2?"video":null)}onMediaAttached(e,n){super.onMediaAttached(e,n);const i=n.media;Jn(i,"playing",this.onMediaPlaying),Jn(i,"seeked",this.onMediaSeeked)}onMediaDetaching(e,n){const{media:i}=this;i&&(ci(i,"playing",this.onMediaPlaying),ci(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,n),!n.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,n){let i=!1,r=!1;for(let s=0;s<n.levels.length;s++){const a=n.levels[s].audioCodec;a&&(i=i||a.indexOf("mp4a.40.2")!==-1,r=r||a.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=i&&r&&!rJ(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=n.levels,this.startFragRequested=!1}onLevelLoading(e,n){const{levels:i}=this;if(!i||this.state!==_e.IDLE)return;const r=n.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=_e.WAITING_LEVEL)}onLevelLoaded(e,n){var i;const{levels:r,startFragRequested:s}=this,a=n.level,o=n.details,l=o.totalduration;if(!r){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${l}`);const u=n.levelInfo,d=this.fragCurrent;d&&(this.state===_e.FRAG_LOADING||this.state===_e.FRAG_LOADING_WAITING_RETRY)&&d.level!==n.level&&d.loader&&this.abortCurrentFrag();let f=0;if(o.live||(i=u.details)!=null&&i.live){var p;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;f=this.alignPlaylists(o,u.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(u.details=o,this.levelLastLoaded=u,s||this.setStartPosition(o,f),this.hls.trigger(M.LEVEL_UPDATED,{details:o,level:a}),this.state===_e.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=_e.IDLE}s&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}synchronizeToLiveEdge(e){const{config:n,media:i}=this;if(!i)return;const r=this.hls.liveSyncPosition,s=this.getLoadPosition(),a=e.fragmentStart,o=e.edge,l=s>=a-n.maxFragLookUpTolerance&&s<=o;if(r!==null&&i.duration>r&&(s<r||!l)){const d=n.liveMaxLatencyDuration!==void 0?n.liveMaxLatencyDuration:n.liveMaxLatencyDurationCount*e.targetduration;if((!l&&i.readyState<4||s<o-d)&&(this._hasEnoughToStart||(this.nextLoadPosition=r),i.readyState))if(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${r.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var u;const f=pt.bufferInfo(i,r,0);if(!((u=f.buffered)!=null&&u.length)){i.currentTime=r;return}if(f.start<=s){i.currentTime=r;return}const{nextStart:m}=pt.bufferedInfo(f.buffered,s,0);m&&(i.currentTime=m)}else i.currentTime=r}}_handleFragmentLoadProgress(e){var n;const i=e.frag,{part:r,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const o=a[i.level];if(!o){this.warn(`Level ${i.level} not found on progress`);return}const l=o.details;if(!l){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const u=o.videoCodec,d=l.PTSKnown||!l.live,f=(n=i.initSegment)==null?void 0:n.data,p=this._getAudioCodec(o),m=this.transmuxer=this.transmuxer||new o4(this.hls,Xe.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),y=r?r.index:-1,b=y!==-1,E=new Lb(i.level,i.sn,i.stats.chunkCount,s.byteLength,y,b),T=this.initPTS[i.cc];m.push(s,f,p,u,i,r,l.totalduration,d,E,T)}onAudioTrackSwitching(e,n){const i=this.hls,r=this.altAudio===2;if(zh(n.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(r){this.fragmentTracker.removeAllFragments(),i.once(M.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(M.AUDIO_TRACK_SWITCHED,n)}),i.trigger(M.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(M.AUDIO_TRACK_SWITCHED,n)}}onAudioTrackSwitched(e,n){const i=zh(n.url,this.hls);if(i){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=i?2:0,this.tick()}onBufferCreated(e,n){const i=n.tracks;let r,s,a=!1;for(const o in i){const l=i[o];if(l.id==="main"){if(s=o,r=l,o==="video"){const u=i[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,n){const{frag:i,part:r}=n,s=i.type===Xe.MAIN;if(s){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===_e.PARSED&&(this.state=_e.IDLE);return}const o=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),bn(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}const a=this.media;a&&(!this._hasEnoughToStart&&pt.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),s&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,n){var i;if(n.fatal){this.state=_e.ERROR;return}switch(n.details){case pe.FRAG_GAP:case pe.FRAG_PARSING_ERROR:case pe.FRAG_DECRYPT_ERROR:case pe.FRAG_LOAD_ERROR:case pe.FRAG_LOAD_TIMEOUT:case pe.KEY_LOAD_ERROR:case pe.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Xe.MAIN,n);break;case pe.LEVEL_LOAD_ERROR:case pe.LEVEL_LOAD_TIMEOUT:case pe.LEVEL_PARSING_ERROR:!n.levelRetry&&this.state===_e.WAITING_LEVEL&&((i=n.context)==null?void 0:i.type)===At.LEVEL&&(this.state=_e.IDLE);break;case pe.BUFFER_ADD_CODEC_ERROR:case pe.BUFFER_APPEND_ERROR:if(n.parent!=="main")return;this.reduceLengthAndFlushBuffer(n)&&this.resetLoadingState();break;case pe.BUFFER_FULL_ERROR:if(n.parent!=="main")return;this.reduceLengthAndFlushBuffer(n)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case pe.INTERNAL_EXCEPTION:this.recoverWorkerError(n);break}}onFragLoadEmergencyAborted(){this.state=_e.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:n}){if(n!==jt.AUDIO||!this.altAudio){const i=(n===jt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,n,Xe.MAIN),this.tick())}}onLevelsUpdated(e,n){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=n.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const n=e.currentTime;let i=this.startPosition;if(i>=0&&n<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${n}`);return}const r=this.timelineOffset;r&&i&&(i+=r);const s=this.getLevelDetails(),a=pt.getBuffered(e),o=a.length?a.start(0):0,l=o-i,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||l>0&&(l<u||this.loadingParts&&l<2*((s==null?void 0:s.partTarget)||0)))&&(this.log(`adjusting start position by ${l} to match buffer start`),i+=l,this.startPosition=i),n<i&&(this.log(`seek to target start position ${i} from current time ${n} buffer start ${o}`),e.currentTime=i)}}_getAudioCodec(e){let n=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&n&&(this.log("Swapping audio codec"),n.indexOf("mp4a.40.5")!==-1?n="mp4a.40.2":n="mp4a.40.5"),n}_loadBitrateTestFrag(e,n){e.bitrateTest=!0,this._doFragLoad(e,n).then(i=>{const{hls:r}=this,s=i==null?void 0:i.frag;if(!s||this.fragContextChanged(s))return;n.fragmentError=0,this.state=_e.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=s.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),r.trigger(M.FRAG_LOADED,i),s.bitrateTest=!1}).catch(i=>{this.state===_e.STOPPED||this.state===_e.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const n=this.playlistType,{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a){this.resetWhenMissingContext(s);return}const{frag:o,part:l,level:u}=a,{video:d,text:f,id3:p,initSegment:m}=r,{details:y}=u,b=this.altAudio?void 0:r.audio;if(this.fragContextChanged(o)){this.fragmentTracker.removeFragment(o);return}if(this.state=_e.PARSING,m){const E=m.tracks;if(E){const w=o.initSegment||o;if(this.unhandledEncryptionError(m,o))return;this._bufferInitSegment(u,E,w,s),i.trigger(M.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:n,tracks:E})}const T=m.initPTS,x=m.timescale,S=this.initPTS[o.cc];if(We(T)&&(!S||S.baseTime!==T||S.timescale!==x)){const w=m.trackId;this.initPTS[o.cc]={baseTime:T,timescale:x,trackId:w},i.trigger(M.INIT_PTS_FOUND,{frag:o,id:n,initPTS:T,timescale:x,trackId:w})}}if(d&&y){b&&d.type==="audiovideo"&&this.logMuxedErr(o);const E=y.fragments[o.sn-1-y.startSN],T=o.sn===y.startSN,x=!E||o.cc>E.cc;if(r.independent!==!1){const{startPTS:S,endPTS:w,startDTS:C,endDTS:I}=d;if(l)l.elementaryStreams[d.type]={startPTS:S,endPTS:w,startDTS:C,endDTS:I};else if(d.firstKeyFrame&&d.independent&&s.id===1&&!x&&(this.couldBacktrack=!0),d.dropped&&d.independent){const L=this.getMainFwdBufferInfo(),N=(L?L.end:this.getLoadPosition())+this.config.maxBufferHole,G=d.firstKeyFramePTS?d.firstKeyFramePTS:S;if(!T&&N<G-this.config.maxBufferHole&&!x){this.backtrack(o);return}else x&&(o.gap=!0);o.setElementaryStreamInfo(d.type,o.start,w,o.start,I,!0)}else T&&S-(y.appliedTimelineOffset||0)>Th&&(o.gap=!0);o.setElementaryStreamInfo(d.type,S,w,C,I),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(d,o,l,s,T||x)}else if(T||x)o.gap=!0;else{this.backtrack(o);return}}if(b){const{startPTS:E,endPTS:T,startDTS:x,endDTS:S}=b;l&&(l.elementaryStreams[jt.AUDIO]={startPTS:E,endPTS:T,startDTS:x,endDTS:S}),o.setElementaryStreamInfo(jt.AUDIO,E,T,x,S),this.bufferFragmentData(b,o,l,s)}if(y&&p!=null&&p.samples.length){const E={id:n,frag:o,details:y,samples:p.samples};i.trigger(M.FRAG_PARSING_METADATA,E)}if(y&&f){const E={id:n,frag:o,details:y,samples:f.samples};i.trigger(M.FRAG_PARSING_USERDATA,E)}}logMuxedErr(e){this.warn(`${bn(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,n,i,r){if(this.state!==_e.PARSING)return;this.audioOnly=!!n.audio&&!n.video,this.altAudio&&!this.audioOnly&&(delete n.audio,n.audiovideo&&this.logMuxedErr(i));const{audio:s,video:a,audiovideo:o}=n;if(s){const u=e.audioCodec;let d=ph(s.codec,u);d==="mp4a"&&(d="mp4a.40.5");const f=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){d&&(d.indexOf("mp4a.40.5")!==-1?d="mp4a.40.2":d="mp4a.40.5");const p=s.metadata;p&&"channelCount"in p&&(p.channelCount||1)!==1&&f.indexOf("firefox")===-1&&(d="mp4a.40.5")}d&&d.indexOf("mp4a.40.5")!==-1&&f.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(d="mp4a.40.2",this.log(`Android: force audio codec to ${d}`)),u&&u!==d&&this.log(`Swapping manifest audio codec "${u}" for "${d}"`),s.levelCodec=d,s.id=Xe.MAIN,this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${d||""}/${u||""}/${s.codec}]`),delete n.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=Xe.MAIN;const u=a.codec;if((u==null?void 0:u.length)===4)switch(u){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u}]${a.codec!==u?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete n.audiovideo}o&&(this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),delete n.video,delete n.audio);const l=Object.keys(n);if(l.length){if(this.hls.trigger(M.BUFFER_CODECS,n),!this.hls)return;l.forEach(u=>{const f=n[u].initSegment;f!=null&&f.byteLength&&this.hls.trigger(M.BUFFER_APPENDING,{type:u,data:f,frag:i,part:null,chunkMeta:r,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Xe.MAIN)}get maxBufferLength(){const{levels:e,level:n}=this,i=e==null?void 0:e[n];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=_e.IDLE}checkFragmentChanged(){const e=this.media;let n=null;if(e&&e.readyState>1&&e.seeking===!1){const i=e.currentTime;if(pt.isBuffered(e,i)?n=this.getAppendedFrag(i):pt.isBuffered(e,i+.1)&&(n=this.getAppendedFrag(i+.1)),n){this.backtrackFragment=null;const r=this.fragPlaying,s=n.level;(!r||n.sn!==r.sn||r.level!==s)&&(this.fragPlaying=n,this.hls.trigger(M.FRAG_CHANGED,{frag:n}),(!r||r.level!==s)&&this.hls.trigger(M.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const n=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return We(n)?this.getAppendedFrag(n):null}get currentProgramDateTime(){var e;const n=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(We(n)){const i=this.getLevelDetails(),r=this.currentFrag||(i?lo(null,i.fragments,n):null);if(r){const s=r.programDateTime;if(s!==null){const a=s+(n-r.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class oJ extends $i{constructor(e,n){super("key-loader",n),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const i in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[i].loader;if(r){var n;if(e&&e!==((n=r.context)==null?void 0:n.frag.type))return;r.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const n=this.keyIdToKeyInfo[e];(n.mediaKeySessionContext||n.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const n=this.keyIdToKeyInfo[e].loader;n&&n.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,n=pe.KEY_LOAD_ERROR,i,r,s){return new os({type:it.NETWORK_ERROR,details:n,fatal:!1,frag:e,response:s,error:i,networkDetails:r})}loadClear(e,n,i){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(n.length)for(let r=0,s=n.length;r<s;r++){const a=n[r];if(e.cc<=a.cc&&(!bn(e)||!bn(a)||e.sn<a.sn)||!i&&r==s-1)return this.emeController.selectKeySystemFormat(a).then(o=>{if(!this.emeController)return;a.setKeyFormat(o);const l=gh(o);if(l)return this.emeController.getKeySystemAccess([l])})}if(this.config.requireKeySystemAccessOnStart){const r=dc(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(n=>this.loadInternal(e,n)):this.loadInternal(e)}loadInternal(e,n){var i,r;n&&e.setKeyFormat(n);const s=e.decryptdata;if(!s){const u=new Error(n?`Expected frag.decryptdata to be defined after setting format ${n}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,pe.KEY_LOAD_ERROR,u))}const a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,pe.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));const o=z1(s);let l=this.keyIdToKeyInfo[o];if((i=l)!=null&&i.decryptdata.key)return s.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if(this.emeController&&(r=l)!=null&&r.keyLoadPromise)switch(this.emeController.getKeyStatus(l.decryptdata)){case"usable":case"usable-in-future":return l.keyLoadPromise.then(d=>{const{keyInfo:f}=d;return s.key=f.decryptdata.key,{frag:e,keyInfo:f}})}switch(this.log(`${this.keyIdToKeyInfo[o]?"Rel":"L"}oading${s.keyId?" keyId: "+li(s.keyId):""} URI: ${s.uri} from ${e.type} ${e.level}`),l=this.keyIdToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,pe.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,n){const i={frag:n,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(i);return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,i))).catch(s=>{throw e.keyLoadPromise=null,"data"in s&&(s.data.frag=n),s})}return Promise.resolve(i)}loadKeyHTTP(e,n){const i=this.config,r=i.loader,s=new r(i);return n.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:n,responseType:"arraybuffer",url:e.decryptdata.uri},u=i.keyLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(p,m,y,b)=>{const{frag:E,keyInfo:T}=y,x=z1(T.decryptdata);if(!E.decryptdata||T!==this.keyIdToKeyInfo[x])return o(this.createKeyLoadError(E,pe.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),b));T.decryptdata.key=E.decryptdata.key=new Uint8Array(p.data),E.keyLoader=null,T.loader=null,a({frag:E,keyInfo:T})},onError:(p,m,y,b)=>{this.resetLoader(m),o(this.createKeyLoadError(n,pe.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),y,Bt({url:l.url,data:void 0},p)))},onTimeout:(p,m,y)=>{this.resetLoader(m),o(this.createKeyLoadError(n,pe.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),y))},onAbort:(p,m,y)=>{this.resetLoader(m),o(this.createKeyLoadError(n,pe.INTERNAL_ABORTED,new Error("key loading aborted"),y))}};s.load(l,d,f)})}resetLoader(e){const{frag:n,keyInfo:i,url:r}=e,s=i.loader;n.keyLoader===s&&(n.keyLoader=null,i.loader=null);const a=z1(i.decryptdata)||r;delete this.keyIdToKeyInfo[a],s&&s.destroy()}}function z1(t){if(t.keyFormat!==Qn.FAIRPLAY){const e=t.keyId;if(e)return li(e)}return t.uri}function PC(t){const{type:e}=t;switch(e){case At.AUDIO_TRACK:return Xe.AUDIO;case At.SUBTITLE_TRACK:return Xe.SUBTITLE;default:return Xe.MAIN}}function q1(t,e){let n=t.url;return(n===void 0||n.indexOf("data:")===0)&&(n=e.url),n}class uJ{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.LEVEL_LOADING,this.onLevelLoading,this),e.on(M.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(M.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.LEVEL_LOADING,this.onLevelLoading,this),e.off(M.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(M.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const n=this.hls.config,i=n.pLoader,r=n.loader,s=i||r,a=new s(n);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const n=this.loaders[e];n&&n.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,n){const{url:i}=n;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:At.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,n){const{id:i,level:r,pathwayId:s,url:a,deliveryDirectives:o,levelInfo:l}=n;this.load({id:i,level:r,pathwayId:s,responseType:"text",type:At.LEVEL,url:a,deliveryDirectives:o,levelOrTrack:l})}onAudioTrackLoading(e,n){const{id:i,groupId:r,url:s,deliveryDirectives:a,track:o}=n;this.load({id:i,groupId:r,level:null,responseType:"text",type:At.AUDIO_TRACK,url:s,deliveryDirectives:a,levelOrTrack:o})}onSubtitleTrackLoading(e,n){const{id:i,groupId:r,url:s,deliveryDirectives:a,track:o}=n;this.load({id:i,groupId:r,level:null,responseType:"text",type:At.SUBTITLE_TRACK,url:s,deliveryDirectives:a,levelOrTrack:o})}onLevelsUpdated(e,n){const i=this.loaders[At.LEVEL];if(i){const r=i.context;r&&!n.levels.some(s=>s===r.levelOrTrack)&&(i.abort(),delete this.loaders[At.LEVEL])}}load(e){var n;const i=this.hls.config;let r=this.getInternalLoader(e);if(r){const u=this.hls.logger,d=r.context;if(d&&d.levelOrTrack===e.levelOrTrack&&(d.url===e.url||d.deliveryDirectives&&!e.deliveryDirectives)){d.url===e.url?u.log(`[playlist-loader]: ignore ${e.url} ongoing request`):u.log(`[playlist-loader]: ignore ${e.url} in favor of ${d.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===At.MANIFEST?s=i.manifestLoadPolicy.default:s=Vt({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),We((n=e.deliveryDirectives)==null?void 0:n.part)){let u;if(e.type===At.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===At.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===At.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const d=u.partTarget,f=u.targetduration;if(d&&f){const p=Math.max(d*3,f*.8)*1e3;s=Vt({},s,{maxTimeToFirstByteMs:Math.min(p,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,s.maxTimeToFirstByteMs)})}}}const a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(u,d,f,p)=>{const m=this.getInternalLoader(f);this.resetInternalLoader(f.type);const y=u.data;d.parsing.start=performance.now(),Cr.isMediaPlaylist(y)||f.type!==At.MANIFEST?this.handleTrackOrLevelPlaylist(u,d,f,p||null,m):this.handleMasterPlaylist(u,d,f,p)},onError:(u,d,f,p)=>{this.handleNetworkError(d,f,!1,u,p)},onTimeout:(u,d,f)=>{this.handleNetworkError(d,f,!0,void 0,u)}};r.load(e,o,l)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:n},forceStartLoad:i}=this.hls;(e||i)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${n}`),this.hls.startLoad(n))}handleMasterPlaylist(e,n,i,r){const s=this.hls,a=e.data,o=q1(e,i),l=Cr.parseMasterPlaylist(a,o);if(l.playlistParsingError){n.parsing.end=performance.now(),this.handleManifestParsingError(e,i,l.playlistParsingError,r,n);return}const{contentSteering:u,levels:d,sessionData:f,sessionKeys:p,startTimeOffset:m,variableList:y}=l;this.variableList=y,d.forEach(x=>{const{unknownCodecs:S}=x;if(S){const{preferManagedMediaSource:w}=this.hls.config;let{audioCodec:C,videoCodec:I}=x;for(let L=S.length;L--;){const N=S[L];Mc(N,"audio",w)?(x.audioCodec=C=C?`${C},${N}`:N,qu.audio[C.substring(0,4)]=2,S.splice(L,1)):Mc(N,"video",w)&&(x.videoCodec=I=I?`${I},${N}`:N,qu.video[I.substring(0,4)]=2,S.splice(L,1))}}});const{AUDIO:b=[],SUBTITLES:E,"CLOSED-CAPTIONS":T}=Cr.parseMasterPlaylistMedia(a,o,l);b.length&&!b.some(S=>!S.url)&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),b.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new sn({}),bitrate:0,url:""})),s.trigger(M.MANIFEST_LOADED,{levels:d,audioTracks:b,subtitles:E,captions:T,contentSteering:u,url:o,stats:n,networkDetails:r,sessionData:f,sessionKeys:p,startTimeOffset:m,variableList:y})}handleTrackOrLevelPlaylist(e,n,i,r,s){const a=this.hls,{id:o,level:l,type:u}=i,d=q1(e,i),f=We(l)?l:We(o)?o:0,p=PC(i),m=Cr.parseLevelPlaylist(e.data,d,f,p,0,this.variableList);if(u===At.MANIFEST){const y={attrs:new sn({}),bitrate:0,details:m,name:"",url:d};m.requestScheduled=n.loading.start+ML(m,0),a.trigger(M.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:d,stats:n,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}n.parsing.end=performance.now(),i.levelDetails=m,this.handlePlaylistLoaded(m,e,n,i,r,s)}handleManifestParsingError(e,n,i,r,s){this.hls.trigger(M.ERROR,{type:it.NETWORK_ERROR,details:pe.MANIFEST_PARSING_ERROR,fatal:n.type===At.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:n,networkDetails:r,stats:s})}handleNetworkError(e,n,i=!1,r,s){let a=`A network ${i?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===At.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===At.AUDIO_TRACK||e.type===At.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let l=pe.UNKNOWN,u=!1;const d=this.getInternalLoader(e);switch(e.type){case At.MANIFEST:l=i?pe.MANIFEST_LOAD_TIMEOUT:pe.MANIFEST_LOAD_ERROR,u=!0;break;case At.LEVEL:l=i?pe.LEVEL_LOAD_TIMEOUT:pe.LEVEL_LOAD_ERROR,u=!1;break;case At.AUDIO_TRACK:l=i?pe.AUDIO_TRACK_LOAD_TIMEOUT:pe.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case At.SUBTITLE_TRACK:l=i?pe.SUBTITLE_TRACK_LOAD_TIMEOUT:pe.SUBTITLE_LOAD_ERROR,u=!1;break}d&&this.resetInternalLoader(e.type);const f={type:it.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:d,context:e,error:o,networkDetails:n,stats:s};if(r){const p=(n==null?void 0:n.url)||e.url;f.response=Bt({url:p,data:void 0},r)}this.hls.trigger(M.ERROR,f)}handlePlaylistLoaded(e,n,i,r,s,a){const o=this.hls,{type:l,level:u,levelOrTrack:d,id:f,groupId:p,deliveryDirectives:m}=r,y=q1(n,r),b=PC(r);let E=typeof r.level=="number"&&b===Xe.MAIN?u:void 0;const T=e.playlistParsingError;if(T){if(this.hls.logger.warn(`${T} ${e.url}`),!o.config.ignorePlaylistParsingErrors){o.trigger(M.ERROR,{type:it.NETWORK_ERROR,details:pe.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:T,reason:T.message,response:n,context:r,level:E,parent:b,networkDetails:s,stats:i});return}e.playlistParsingError=null}if(!e.fragments.length){const x=e.playlistParsingError=new Error("No Segments found in Playlist");o.trigger(M.ERROR,{type:it.NETWORK_ERROR,details:pe.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:x,reason:x.message,response:n,context:r,level:E,parent:b,networkDetails:s,stats:i});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case At.MANIFEST:case At.LEVEL:if(E){if(!d)E=0;else if(d!==o.levels[E]){const x=o.levels.indexOf(d);x>-1&&(E=x)}}o.trigger(M.LEVEL_LOADED,{details:e,levelInfo:d||o.levels[0],level:E||0,id:f||0,stats:i,networkDetails:s,deliveryDirectives:m,withoutMultiVariant:l===At.MANIFEST});break;case At.AUDIO_TRACK:o.trigger(M.AUDIO_TRACK_LOADED,{details:e,track:d,id:f||0,groupId:p||"",stats:i,networkDetails:s,deliveryDirectives:m});break;case At.SUBTITLE_TRACK:o.trigger(M.SUBTITLE_TRACK_LOADED,{details:e,track:d,id:f||0,groupId:p||"",stats:i,networkDetails:s,deliveryDirectives:m});break}}}class Un{static get version(){return Hc}static isMSESupported(){return N4()}static isSupported(){return iJ()}static getMediaSource(){return ca()}static get Events(){return M}static get MetadataSchema(){return wi}static get ErrorTypes(){return it}static get ErrorDetails(){return pe}static get DefaultConfig(){return Un.defaultConfig?Un.defaultConfig:jZ}static set DefaultConfig(e){Un.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Nb,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const n=this.logger=pY(e.debug||!1,"Hls instance",e.assetPlayerId),i=this.config=$Z(Un.DefaultConfig,e,n);this.userConfig=e,i.progressive&&YZ(i,n);const{abrController:r,bufferController:s,capLevelController:a,errorController:o,fpsController:l}=i,u=new o(this),d=this.abrController=new r(this),f=new uK(this),p=i.interstitialsController,m=p?this.interstitialsController=new p(this,Un):null,y=this.bufferController=new s(this,f),b=this.capLevelController=new a(this),E=new l(this),T=new uJ(this),x=i.contentSteeringController,S=x?new x(this):null,w=this.levelController=new nJ(this,S),C=new eJ(this),I=new oJ(this.config,this.logger),L=this.streamController=new aJ(this,f,I),N=this.gapController=new ZZ(this,f);b.setStreamController(L),E.setStreamController(L);const G=[T,w,L];m&&G.splice(1,0,m),S&&G.splice(1,0,S),this.networkControllers=G;const O=[d,y,N,b,E,C,f];this.audioTrackController=this.createController(i.audioTrackController,G);const D=i.audioStreamController;D&&G.push(this.audioStreamController=new D(this,f,I)),this.subtitleTrackController=this.createController(i.subtitleTrackController,G);const V=i.subtitleStreamController;V&&G.push(this.subtititleStreamController=new V(this,f,I)),this.createController(i.timelineController,O),I.emeController=this.emeController=this.createController(i.emeController,O),this.cmcdController=this.createController(i.cmcdController,O),this.latencyController=this.createController(tJ,O),this.coreComponents=O,G.push(u);const $=u.onErrorOut;typeof $=="function"&&this.on(M.ERROR,$,u),this.on(M.MANIFEST_LOADED,T.onManifestLoaded,T)}createController(e,n){if(e){const i=new e(this);return n&&n.push(i),i}return null}on(e,n,i=this){this._emitter.on(e,n,i)}once(e,n,i=this){this._emitter.once(e,n,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,n,i=this,r){this._emitter.off(e,n,i,r)}listeners(e){return this._emitter.listeners(e)}emit(e,n,i){return this._emitter.emit(e,n,i)}trigger(e,n){if(this.config.debug)return this.emit(e,e,n);try{return this.emit(e,e,n)}catch(i){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const r=e===M.ERROR;this.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.INTERNAL_EXCEPTION,fatal:r,event:e,error:i}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(M.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(n=>n.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(n=>n.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const s=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(M.ERROR,{type:it.OTHER_ERROR,details:pe.ATTACH_MEDIA_ERROR,fatal:!0,error:s});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const n="media"in e,i=n?e.media:e,r=n?e:{media:i};this._media=i,this.trigger(M.MEDIA_ATTACHING,r)}detachMedia(){this.logger.log("detachMedia"),this.trigger(M.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(M.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const n=this.media,i=this._url,r=this._url=Sb.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${r}`),n&&i&&(i!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(n)),this.trigger(M.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,n){this.logger.log(`startLoad(${e+(n?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(e,n),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Xe.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Xe.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Xe.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,n=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),n&&this.startLoad(n))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=ZQ()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const n=!!e;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){WY(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:n}}=this;if(!e)return 0;const i=e.length;for(let r=0;r<i;r++)if(e[r].maxBitrate>=n)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:n,maxHdcpLevel:i}=this;let r;if(n===-1&&e!=null&&e.length?r=e.length-1:r=n,i)for(let s=r;s--;){const a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=i)return s}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var n;return((n=this.audioTrackController)==null?void 0:n.setAudioOption(e))||null}setSubtitleOption(e){var n;return((n=this.subtitleTrackController)==null?void 0:n.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const n=this.audioTrackController;n&&(n.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const n=this.subtitleTrackController;n&&(n.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const n=this.subtitleTrackController;n&&(n.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,n=this.allAudioTracks){const i=SL(n);return TL(e,i,navigator.mediaCapabilities)}}Un.defaultConfig=void 0;function fs(){return fs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},fs.apply(null,arguments)}function Ic(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function lJ(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function M4(...t){return e=>t.forEach(n=>lJ(n,e))}function B4(...t){return H.useCallback(M4(...t),t)}function cJ(t,e=[]){let n=[];function i(s,a){const o=H.createContext(a),l=n.length;n=[...n,a];function u(f){const{scope:p,children:m,...y}=f,b=(p==null?void 0:p[t][l])||o,E=H.useMemo(()=>y,Object.values(y));return H.createElement(b.Provider,{value:E},m)}function d(f,p){const m=(p==null?void 0:p[t][l])||o,y=H.useContext(m);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,d]}const r=()=>{const s=n.map(a=>H.createContext(a));return function(o){const l=(o==null?void 0:o[t])||s;return H.useMemo(()=>({[`__scope${t}`]:{...o,[t]:l}}),[o,l])}};return r.scopeName=t,[i,dJ(r,...e)]}function dJ(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const i=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const a=i.reduce((o,{useScope:l,scopeName:u})=>{const f=l(s)[`__scope${u}`];return{...o,...f}},{});return H.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}const fJ=globalThis!=null&&globalThis.document?H.useLayoutEffect:()=>{},hJ=Pv.useId||(()=>{});let pJ=0;function mJ(t){const[e,n]=H.useState(hJ());return fJ(()=>{n(i=>i??String(pJ++))},[t]),e?`radix-${e}`:""}const F4=H.forwardRef((t,e)=>{const{children:n,...i}=t,r=H.Children.toArray(n),s=r.find(yJ);if(s){const a=s.props.children,o=r.map(l=>l===s?H.Children.count(a)>1?H.Children.only(null):H.isValidElement(a)?a.props.children:null:l);return H.createElement(ov,fs({},i,{ref:e}),H.isValidElement(a)?H.cloneElement(a,void 0,o):null)}return H.createElement(ov,fs({},i,{ref:e}),n)});F4.displayName="Slot";const ov=H.forwardRef((t,e)=>{const{children:n,...i}=t;return H.isValidElement(n)?H.cloneElement(n,{...vJ(i,n.props),ref:e?M4(e,n.ref):n.ref}):H.Children.count(n)>1?H.Children.only(null):null});ov.displayName="SlotClone";const gJ=({children:t})=>H.createElement(H.Fragment,null,t);function yJ(t){return H.isValidElement(t)&&t.type===gJ}function vJ(t,e){const n={...e};for(const i in e){const r=t[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...o)=>{s(...o),r(...o)}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...t,...n}}const bJ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],w0=bJ.reduce((t,e)=>{const n=H.forwardRef((i,r)=>{const{asChild:s,...a}=i,o=s?F4:e;return H.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),H.createElement(o,fs({},a,{ref:r}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{}),[Yb]=cJ("Form"),U4="Form",[EJ,H4]=Yb(U4),[TJ,xJ]=Yb(U4),SJ=H.forwardRef((t,e)=>{const{__scopeForm:n,onClearServerErrors:i=()=>{},...r}=t,s=H.useRef(null),a=B4(e,s),[o,l]=H.useState({}),u=H.useCallback(O=>o[O],[o]),d=H.useCallback((O,D)=>l(V=>{var $;return{...V,[O]:{...($=V[O])!==null&&$!==void 0?$:{},...D}}}),[]),f=H.useCallback(O=>{l(D=>({...D,[O]:void 0})),x(D=>({...D,[O]:{}}))},[]),[p,m]=H.useState({}),y=H.useCallback(O=>{var D;return(D=p[O])!==null&&D!==void 0?D:[]},[p]),b=H.useCallback((O,D)=>{m(V=>{var $;return{...V,[O]:[...($=V[O])!==null&&$!==void 0?$:[],D]}})},[]),E=H.useCallback((O,D)=>{m(V=>{var $;return{...V,[O]:(($=V[O])!==null&&$!==void 0?$:[]).filter(J=>J.id!==D)}})},[]),[T,x]=H.useState({}),S=H.useCallback(O=>{var D;return(D=T[O])!==null&&D!==void 0?D:{}},[T]),w=H.useCallback((O,D)=>{x(V=>{var $;return{...V,[O]:{...($=V[O])!==null&&$!==void 0?$:{},...D}}})},[]),[C,I]=H.useState({}),L=H.useCallback((O,D)=>{I(V=>{const $=new Set(V[O]).add(D);return{...V,[O]:$}})},[]),N=H.useCallback((O,D)=>{I(V=>{const $=new Set(V[O]);return $.delete(D),{...V,[O]:$}})},[]),G=H.useCallback(O=>{var D;return Array.from((D=C[O])!==null&&D!==void 0?D:[]).join(" ")||void 0},[C]);return H.createElement(EJ,{scope:n,getFieldValidity:u,onFieldValidityChange:d,getFieldCustomMatcherEntries:y,onFieldCustomMatcherEntryAdd:b,onFieldCustomMatcherEntryRemove:E,getFieldCustomErrors:S,onFieldCustomErrorsChange:w,onFieldValiditionClear:f},H.createElement(TJ,{scope:n,onFieldMessageIdAdd:L,onFieldMessageIdRemove:N,getFieldDescription:G},H.createElement(w0.form,fs({},r,{ref:a,onInvalid:Ic(t.onInvalid,O=>{const D=q4(O.currentTarget);D===O.target&&D.focus(),O.preventDefault()}),onSubmit:Ic(t.onSubmit,i,{checkForDefaultPrevented:!1}),onReset:Ic(t.onReset,i)}))))}),z4="FormField",[AJ,wJ]=Yb(z4),CJ=H.forwardRef((t,e)=>{const{__scopeForm:n,name:i,serverInvalid:r=!1,...s}=t,o=H4(z4,n).getFieldValidity(i),l=mJ();return H.createElement(AJ,{scope:n,id:l,name:i,serverInvalid:r},H.createElement(w0.div,fs({"data-valid":V4(o,r),"data-invalid":G4(o,r)},s,{ref:e})))}),V1="FormControl",RJ=H.forwardRef((t,e)=>{const{__scopeForm:n,...i}=t,r=H4(V1,n),s=wJ(V1,n),a=xJ(V1,n),o=H.useRef(null),l=B4(e,o),u=i.name||s.name,d=i.id||s.id,f=r.getFieldCustomMatcherEntries(u),{onFieldValidityChange:p,onFieldCustomErrorsChange:m,onFieldValiditionClear:y}=r,b=H.useCallback(async x=>{if(NJ(x.validity)){const V=G1(x.validity);p(u,V);return}const S=x.form?new FormData(x.form):new FormData,w=[x.value,S],C=[],I=[];f.forEach(V=>{OJ(V,w)?I.push(V):PJ(V)&&C.push(V)});const L=C.map(({id:V,match:$})=>[V,$(...w)]),N=Object.fromEntries(L),G=Object.values(N).some(Boolean),O=G;x.setCustomValidity(O?kC:"");const D=G1(x.validity);if(p(u,D),m(u,N),!G&&I.length>0){const V=I.map(({id:ne,match:oe})=>oe(...w).then(P=>[ne,P])),$=await Promise.all(V),J=Object.fromEntries($),j=Object.values(J).some(Boolean);x.setCustomValidity(j?kC:"");const te=G1(x.validity);p(u,te),m(u,J)}},[f,u,m,p]);H.useEffect(()=>{const x=o.current;if(x){const S=()=>b(x);return x.addEventListener("change",S),()=>x.removeEventListener("change",S)}},[b]);const E=H.useCallback(()=>{const x=o.current;x&&(x.setCustomValidity(""),y(u))},[u,y]);H.useEffect(()=>{var x;const S=(x=o.current)===null||x===void 0?void 0:x.form;if(S)return S.addEventListener("reset",E),()=>S.removeEventListener("reset",E)},[E]),H.useEffect(()=>{const x=o.current,S=x==null?void 0:x.closest("form");if(S&&s.serverInvalid){const w=q4(S);w===x&&w.focus()}},[s.serverInvalid]);const T=r.getFieldValidity(u);return H.createElement(w0.input,fs({"data-valid":V4(T,s.serverInvalid),"data-invalid":G4(T,s.serverInvalid),"aria-invalid":s.serverInvalid?!0:void 0,"aria-describedby":a.getFieldDescription(u),title:""},i,{ref:l,id:d,name:u,onInvalid:Ic(t.onInvalid,x=>{const S=x.currentTarget;b(S)}),onChange:Ic(t.onChange,x=>{E()})}))}),kC="This value is not valid",_J=H.forwardRef((t,e)=>{const{__scopeForm:n,...i}=t;return H.createElement(w0.button,fs({type:"submit"},i,{ref:e}))});function G1(t){const e={};for(const n in t)e[n]=t[n];return e}function IJ(t){return t instanceof HTMLElement}function LJ(t){return"validity"in t}function DJ(t){return LJ(t)&&(t.validity.valid===!1||t.getAttribute("aria-invalid")==="true")}function q4(t){const e=t.elements,[n]=Array.from(e).filter(IJ).filter(DJ);return n}function OJ(t,e){return t.match.constructor.name==="AsyncFunction"||kJ(t.match,e)}function PJ(t){return t.match.constructor.name==="Function"}function kJ(t,e){return t(...e)instanceof Promise}function NJ(t){let e=!1;for(const n in t){const i=n;if(i!=="valid"&&i!=="customError"&&t[i]){e=!0;break}}return e}function V4(t,e){if((t==null?void 0:t.valid)===!0&&!e)return!0}function G4(t,e){if((t==null?void 0:t.valid)===!1||e)return!0}const MJ=SJ,BJ=CJ,FJ=RJ,UJ=_J;function HJ(t,e=globalThis==null?void 0:globalThis.document){const n=ua(t);H.useEffect(()=>{const i=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",i,{capture:!0}),()=>e.removeEventListener("keydown",i,{capture:!0})},[n,e])}var zJ="DismissableLayer",uv="dismissableLayer.update",qJ="dismissableLayer.pointerDownOutside",VJ="dismissableLayer.focusOutside",NC,j4=H.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Kb=H.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:r,onFocusOutside:s,onInteractOutside:a,onDismiss:o,...l}=t,u=H.useContext(j4),[d,f]=H.useState(null),p=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=H.useState({}),y=Yt(e,L=>f(L)),b=Array.from(u.layers),[E]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),T=b.indexOf(E),x=d?b.indexOf(d):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,w=x>=T,C=WJ(L=>{const N=L.target,G=[...u.branches].some(O=>O.contains(N));!w||G||(r==null||r(L),a==null||a(L),L.defaultPrevented||o==null||o())},p),I=$J(L=>{const N=L.target;[...u.branches].some(O=>O.contains(N))||(s==null||s(L),a==null||a(L),L.defaultPrevented||o==null||o())},p);return HJ(L=>{x===u.layers.size-1&&(i==null||i(L),!L.defaultPrevented&&o&&(L.preventDefault(),o()))},p),H.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(NC=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),MC(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=NC)}},[d,p,n,u]),H.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),MC())},[d,u]),H.useEffect(()=>{const L=()=>m({});return document.addEventListener(uv,L),()=>document.removeEventListener(uv,L)},[]),Ce.jsx(Ct.div,{...l,ref:y,style:{pointerEvents:S?w?"auto":"none":void 0,...t.style},onFocusCapture:xt(t.onFocusCapture,I.onFocusCapture),onBlurCapture:xt(t.onBlurCapture,I.onBlurCapture),onPointerDownCapture:xt(t.onPointerDownCapture,C.onPointerDownCapture)})});Kb.displayName=zJ;var GJ="DismissableLayerBranch",jJ=H.forwardRef((t,e)=>{const n=H.useContext(j4),i=H.useRef(null),r=Yt(e,i);return H.useEffect(()=>{const s=i.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),Ce.jsx(Ct.div,{...t,ref:r})});jJ.displayName=GJ;function WJ(t,e=globalThis==null?void 0:globalThis.document){const n=ua(t),i=H.useRef(!1),r=H.useRef(()=>{});return H.useEffect(()=>{const s=o=>{if(o.target&&!i.current){let l=function(){W4(qJ,n,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);i.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",s),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>i.current=!0}}function $J(t,e=globalThis==null?void 0:globalThis.document){const n=ua(t),i=H.useRef(!1);return H.useEffect(()=>{const r=s=>{s.target&&!i.current&&W4(VJ,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function MC(){const t=new CustomEvent(uv);document.dispatchEvent(t)}function W4(t,e,n,{discrete:i}){const r=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?J9(r,s):r.dispatchEvent(s)}var j1=0;function $4(){H.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??BC()),document.body.insertAdjacentElement("beforeend",t[1]??BC()),j1++,()=>{j1===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),j1--}},[])}function BC(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var W1="focusScope.autoFocusOnMount",$1="focusScope.autoFocusOnUnmount",FC={bubbles:!1,cancelable:!0},YJ="FocusScope",Xb=H.forwardRef((t,e)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...a}=t,[o,l]=H.useState(null),u=ua(r),d=ua(s),f=H.useRef(null),p=Yt(e,b=>l(b)),m=H.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;H.useEffect(()=>{if(i){let b=function(S){if(m.paused||!o)return;const w=S.target;o.contains(w)?f.current=w:ea(f.current,{select:!0})},E=function(S){if(m.paused||!o)return;const w=S.relatedTarget;w!==null&&(o.contains(w)||ea(f.current,{select:!0}))},T=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&ea(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",E);const x=new MutationObserver(T);return o&&x.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",E),x.disconnect()}}},[i,o,m.paused]),H.useEffect(()=>{if(o){HC.add(m);const b=document.activeElement;if(!o.contains(b)){const T=new CustomEvent(W1,FC);o.addEventListener(W1,u),o.dispatchEvent(T),T.defaultPrevented||(KJ(eee(Y4(o)),{select:!0}),document.activeElement===b&&ea(o))}return()=>{o.removeEventListener(W1,u),setTimeout(()=>{const T=new CustomEvent($1,FC);o.addEventListener($1,d),o.dispatchEvent(T),T.defaultPrevented||ea(b??document.body,{select:!0}),o.removeEventListener($1,d),HC.remove(m)},0)}}},[o,u,d,m]);const y=H.useCallback(b=>{if(!n&&!i||m.paused)return;const E=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,T=document.activeElement;if(E&&T){const x=b.currentTarget,[S,w]=XJ(x);S&&w?!b.shiftKey&&T===w?(b.preventDefault(),n&&ea(S,{select:!0})):b.shiftKey&&T===S&&(b.preventDefault(),n&&ea(w,{select:!0})):T===x&&b.preventDefault()}},[n,i,m.paused]);return Ce.jsx(Ct.div,{tabIndex:-1,...a,ref:p,onKeyDown:y})});Xb.displayName=YJ;function KJ(t,{select:e=!1}={}){const n=document.activeElement;for(const i of t)if(ea(i,{select:e}),document.activeElement!==n)return}function XJ(t){const e=Y4(t),n=UC(e,t),i=UC(e.reverse(),t);return[n,i]}function Y4(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function UC(t,e){for(const n of t)if(!QJ(n,{upTo:e}))return n}function QJ(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function ZJ(t){return t instanceof HTMLInputElement&&"select"in t}function ea(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&ZJ(t)&&e&&t.select()}}var HC=JJ();function JJ(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=zC(t,e),t.unshift(e)},remove(e){var n;t=zC(t,e),(n=t[0])==null||n.resume()}}}function zC(t,e){const n=[...t],i=n.indexOf(e);return i!==-1&&n.splice(i,1),n}function eee(t){return t.filter(e=>e.tagName!=="A")}const tee=["top","right","bottom","left"],fa=Math.min,Ci=Math.max,Yh=Math.round,nh=Math.floor,_r=t=>({x:t,y:t}),nee={left:"right",right:"left",bottom:"top",top:"bottom"},iee={start:"end",end:"start"};function lv(t,e,n){return Ci(t,fa(e,n))}function hs(t,e){return typeof t=="function"?t(e):t}function ps(t){return t.split("-")[0]}function Ju(t){return t.split("-")[1]}function Qb(t){return t==="x"?"y":"x"}function Zb(t){return t==="y"?"height":"width"}const ree=new Set(["top","bottom"]);function Rr(t){return ree.has(ps(t))?"y":"x"}function Jb(t){return Qb(Rr(t))}function see(t,e,n){n===void 0&&(n=!1);const i=Ju(t),r=Jb(t),s=Zb(r);let a=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=Kh(a)),[a,Kh(a)]}function aee(t){const e=Kh(t);return[cv(t),e,cv(e)]}function cv(t){return t.replace(/start|end/g,e=>iee[e])}const qC=["left","right"],VC=["right","left"],oee=["top","bottom"],uee=["bottom","top"];function lee(t,e,n){switch(t){case"top":case"bottom":return n?e?VC:qC:e?qC:VC;case"left":case"right":return e?oee:uee;default:return[]}}function cee(t,e,n,i){const r=Ju(t);let s=lee(ps(t),n==="start",i);return r&&(s=s.map(a=>a+"-"+r),e&&(s=s.concat(s.map(cv)))),s}function Kh(t){return t.replace(/left|right|bottom|top/g,e=>nee[e])}function dee(t){return{top:0,right:0,bottom:0,left:0,...t}}function K4(t){return typeof t!="number"?dee(t):{top:t,right:t,bottom:t,left:t}}function Xh(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function GC(t,e,n){let{reference:i,floating:r}=t;const s=Rr(e),a=Jb(e),o=Zb(a),l=ps(e),u=s==="y",d=i.x+i.width/2-r.width/2,f=i.y+i.height/2-r.height/2,p=i[o]/2-r[o]/2;let m;switch(l){case"top":m={x:d,y:i.y-r.height};break;case"bottom":m={x:d,y:i.y+i.height};break;case"right":m={x:i.x+i.width,y:f};break;case"left":m={x:i.x-r.width,y:f};break;default:m={x:i.x,y:i.y}}switch(Ju(e)){case"start":m[a]-=p*(n&&u?-1:1);break;case"end":m[a]+=p*(n&&u?-1:1);break}return m}const fee=async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let u=await a.getElementRects({reference:t,floating:e,strategy:r}),{x:d,y:f}=GC(u,i,l),p=i,m={},y=0;for(let b=0;b<o.length;b++){const{name:E,fn:T}=o[b],{x,y:S,data:w,reset:C}=await T({x:d,y:f,initialPlacement:i,placement:p,strategy:r,middlewareData:m,rects:u,platform:a,elements:{reference:t,floating:e}});d=x??d,f=S??f,m={...m,[E]:{...m[E],...w}},C&&y<=50&&(y++,typeof C=="object"&&(C.placement&&(p=C.placement),C.rects&&(u=C.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:r}):C.rects),{x:d,y:f}=GC(u,p,l)),b=-1)}return{x:d,y:f,placement:p,strategy:r,middlewareData:m}};async function Gc(t,e){var n;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:a,elements:o,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:f="floating",altBoundary:p=!1,padding:m=0}=hs(e,t),y=K4(m),E=o[p?f==="floating"?"reference":"floating":f],T=Xh(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(E)))==null||n?E:E.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:d,strategy:l})),x=f==="floating"?{x:i,y:r,width:a.floating.width,height:a.floating.height}:a.reference,S=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),w=await(s.isElement==null?void 0:s.isElement(S))?await(s.getScale==null?void 0:s.getScale(S))||{x:1,y:1}:{x:1,y:1},C=Xh(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:x,offsetParent:S,strategy:l}):x);return{top:(T.top-C.top+y.top)/w.y,bottom:(C.bottom-T.bottom+y.bottom)/w.y,left:(T.left-C.left+y.left)/w.x,right:(C.right-T.right+y.right)/w.x}}const hee=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:s,platform:a,elements:o,middlewareData:l}=e,{element:u,padding:d=0}=hs(t,e)||{};if(u==null)return{};const f=K4(d),p={x:n,y:i},m=Jb(r),y=Zb(m),b=await a.getDimensions(u),E=m==="y",T=E?"top":"left",x=E?"bottom":"right",S=E?"clientHeight":"clientWidth",w=s.reference[y]+s.reference[m]-p[m]-s.floating[y],C=p[m]-s.reference[m],I=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let L=I?I[S]:0;(!L||!await(a.isElement==null?void 0:a.isElement(I)))&&(L=o.floating[S]||s.floating[y]);const N=w/2-C/2,G=L/2-b[y]/2-1,O=fa(f[T],G),D=fa(f[x],G),V=O,$=L-b[y]-D,J=L/2-b[y]/2+N,K=lv(V,J,$),j=!l.arrow&&Ju(r)!=null&&J!==K&&s.reference[y]/2-(J<V?O:D)-b[y]/2<0,te=j?J<V?J-V:J-$:0;return{[m]:p[m]+te,data:{[m]:K,centerOffset:J-K-te,...j&&{alignmentOffset:te}},reset:j}}}),pee=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:u}=e,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...E}=hs(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const T=ps(r),x=Rr(o),S=ps(o)===o,w=await(l.isRTL==null?void 0:l.isRTL(u.floating)),C=p||(S||!b?[Kh(o)]:aee(o)),I=y!=="none";!p&&I&&C.push(...cee(o,b,y,w));const L=[o,...C],N=await Gc(e,E),G=[];let O=((i=s.flip)==null?void 0:i.overflows)||[];if(d&&G.push(N[T]),f){const J=see(r,a,w);G.push(N[J[0]],N[J[1]])}if(O=[...O,{placement:r,overflows:G}],!G.every(J=>J<=0)){var D,V;const J=(((D=s.flip)==null?void 0:D.index)||0)+1,K=L[J];if(K&&(!(f==="alignment"?x!==Rr(K):!1)||O.every(ne=>Rr(ne.placement)===x?ne.overflows[0]>0:!0)))return{data:{index:J,overflows:O},reset:{placement:K}};let j=(V=O.filter(te=>te.overflows[0]<=0).sort((te,ne)=>te.overflows[1]-ne.overflows[1])[0])==null?void 0:V.placement;if(!j)switch(m){case"bestFit":{var $;const te=($=O.filter(ne=>{if(I){const oe=Rr(ne.placement);return oe===x||oe==="y"}return!0}).map(ne=>[ne.placement,ne.overflows.filter(oe=>oe>0).reduce((oe,P)=>oe+P,0)]).sort((ne,oe)=>ne[1]-oe[1])[0])==null?void 0:$[0];te&&(j=te);break}case"initialPlacement":j=o;break}if(r!==j)return{reset:{placement:j}}}return{}}}};function jC(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function WC(t){return tee.some(e=>t[e]>=0)}const mee=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...r}=hs(t,e);switch(i){case"referenceHidden":{const s=await Gc(e,{...r,elementContext:"reference"}),a=jC(s,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:WC(a)}}}case"escaped":{const s=await Gc(e,{...r,altBoundary:!0}),a=jC(s,n.floating);return{data:{escapedOffsets:a,escaped:WC(a)}}}default:return{}}}}},X4=new Set(["left","top"]);async function gee(t,e){const{placement:n,platform:i,elements:r}=t,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),a=ps(n),o=Ju(n),l=Rr(n)==="y",u=X4.has(a)?-1:1,d=s&&l?-1:1,f=hs(e,t);let{mainAxis:p,crossAxis:m,alignmentAxis:y}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof y=="number"&&(m=o==="end"?y*-1:y),l?{x:m*d,y:p*u}:{x:p*u,y:m*d}}const yee=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:a,middlewareData:o}=e,l=await gee(e,t);return a===((n=o.offset)==null?void 0:n.placement)&&(i=o.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:a}}}}},vee=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:E=>{let{x:T,y:x}=E;return{x:T,y:x}}},...l}=hs(t,e),u={x:n,y:i},d=await Gc(e,l),f=Rr(ps(r)),p=Qb(f);let m=u[p],y=u[f];if(s){const E=p==="y"?"top":"left",T=p==="y"?"bottom":"right",x=m+d[E],S=m-d[T];m=lv(x,m,S)}if(a){const E=f==="y"?"top":"left",T=f==="y"?"bottom":"right",x=y+d[E],S=y-d[T];y=lv(x,y,S)}const b=o.fn({...e,[p]:m,[f]:y});return{...b,data:{x:b.x-n,y:b.y-i,enabled:{[p]:s,[f]:a}}}}}},bee=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:r,rects:s,middlewareData:a}=e,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=hs(t,e),d={x:n,y:i},f=Rr(r),p=Qb(f);let m=d[p],y=d[f];const b=hs(o,e),E=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const S=p==="y"?"height":"width",w=s.reference[p]-s.floating[S]+E.mainAxis,C=s.reference[p]+s.reference[S]-E.mainAxis;m<w?m=w:m>C&&(m=C)}if(u){var T,x;const S=p==="y"?"width":"height",w=X4.has(ps(r)),C=s.reference[f]-s.floating[S]+(w&&((T=a.offset)==null?void 0:T[f])||0)+(w?0:E.crossAxis),I=s.reference[f]+s.reference[S]+(w?0:((x=a.offset)==null?void 0:x[f])||0)-(w?E.crossAxis:0);y<C?y=C:y>I&&(y=I)}return{[p]:m,[f]:y}}}},Eee=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,i;const{placement:r,rects:s,platform:a,elements:o}=e,{apply:l=()=>{},...u}=hs(t,e),d=await Gc(e,u),f=ps(r),p=Ju(r),m=Rr(r)==="y",{width:y,height:b}=s.floating;let E,T;f==="top"||f==="bottom"?(E=f,T=p===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(T=f,E=p==="end"?"top":"bottom");const x=b-d.top-d.bottom,S=y-d.left-d.right,w=fa(b-d[E],x),C=fa(y-d[T],S),I=!e.middlewareData.shift;let L=w,N=C;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(N=S),(i=e.middlewareData.shift)!=null&&i.enabled.y&&(L=x),I&&!p){const O=Ci(d.left,0),D=Ci(d.right,0),V=Ci(d.top,0),$=Ci(d.bottom,0);m?N=y-2*(O!==0||D!==0?O+D:Ci(d.left,d.right)):L=b-2*(V!==0||$!==0?V+$:Ci(d.top,d.bottom))}await l({...e,availableWidth:N,availableHeight:L});const G=await a.getDimensions(o.floating);return y!==G.width||b!==G.height?{reset:{rects:!0}}:{}}}};function C0(){return typeof window<"u"}function el(t){return Q4(t)?(t.nodeName||"").toLowerCase():"#document"}function Ii(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Nr(t){var e;return(e=(Q4(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Q4(t){return C0()?t instanceof Node||t instanceof Ii(t).Node:!1}function ur(t){return C0()?t instanceof Element||t instanceof Ii(t).Element:!1}function Dr(t){return C0()?t instanceof HTMLElement||t instanceof Ii(t).HTMLElement:!1}function $C(t){return!C0()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ii(t).ShadowRoot}const Tee=new Set(["inline","contents"]);function sd(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=lr(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!Tee.has(r)}const xee=new Set(["table","td","th"]);function See(t){return xee.has(el(t))}const Aee=[":popover-open",":modal"];function R0(t){return Aee.some(e=>{try{return t.matches(e)}catch{return!1}})}const wee=["transform","translate","scale","rotate","perspective"],Cee=["transform","translate","scale","rotate","perspective","filter"],Ree=["paint","layout","strict","content"];function eE(t){const e=tE(),n=ur(t)?lr(t):t;return wee.some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||Cee.some(i=>(n.willChange||"").includes(i))||Ree.some(i=>(n.contain||"").includes(i))}function _ee(t){let e=ha(t);for(;Dr(e)&&!Gu(e);){if(eE(e))return e;if(R0(e))return null;e=ha(e)}return null}function tE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Iee=new Set(["html","body","#document"]);function Gu(t){return Iee.has(el(t))}function lr(t){return Ii(t).getComputedStyle(t)}function _0(t){return ur(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ha(t){if(el(t)==="html")return t;const e=t.assignedSlot||t.parentNode||$C(t)&&t.host||Nr(t);return $C(e)?e.host:e}function Z4(t){const e=ha(t);return Gu(e)?t.ownerDocument?t.ownerDocument.body:t.body:Dr(e)&&sd(e)?e:Z4(e)}function jc(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=Z4(t),s=r===((i=t.ownerDocument)==null?void 0:i.body),a=Ii(r);if(s){const o=dv(a);return e.concat(a,a.visualViewport||[],sd(r)?r:[],o&&n?jc(o):[])}return e.concat(r,jc(r,[],n))}function dv(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function J4(t){const e=lr(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Dr(t),s=r?t.offsetWidth:n,a=r?t.offsetHeight:i,o=Yh(n)!==s||Yh(i)!==a;return o&&(n=s,i=a),{width:n,height:i,$:o}}function nE(t){return ur(t)?t:t.contextElement}function Mu(t){const e=nE(t);if(!Dr(e))return _r(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=J4(e);let a=(s?Yh(n.width):n.width)/i,o=(s?Yh(n.height):n.height)/r;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Lee=_r(0);function eD(t){const e=Ii(t);return!tE()||!e.visualViewport?Lee:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Dee(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ii(t)?!1:e}function co(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=nE(t);let a=_r(1);e&&(i?ur(i)&&(a=Mu(i)):a=Mu(t));const o=Dee(s,n,i)?eD(s):_r(0);let l=(r.left+o.x)/a.x,u=(r.top+o.y)/a.y,d=r.width/a.x,f=r.height/a.y;if(s){const p=Ii(s),m=i&&ur(i)?Ii(i):i;let y=p,b=dv(y);for(;b&&i&&m!==y;){const E=Mu(b),T=b.getBoundingClientRect(),x=lr(b),S=T.left+(b.clientLeft+parseFloat(x.paddingLeft))*E.x,w=T.top+(b.clientTop+parseFloat(x.paddingTop))*E.y;l*=E.x,u*=E.y,d*=E.x,f*=E.y,l+=S,u+=w,y=Ii(b),b=dv(y)}}return Xh({width:d,height:f,x:l,y:u})}function I0(t,e){const n=_0(t).scrollLeft;return e?e.left+n:co(Nr(t)).left+n}function tD(t,e){const n=t.getBoundingClientRect(),i=n.left+e.scrollLeft-I0(t,n),r=n.top+e.scrollTop;return{x:i,y:r}}function Oee(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const s=r==="fixed",a=Nr(i),o=e?R0(e.floating):!1;if(i===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},u=_r(1);const d=_r(0),f=Dr(i);if((f||!f&&!s)&&((el(i)!=="body"||sd(a))&&(l=_0(i)),Dr(i))){const m=co(i);u=Mu(i),d.x=m.x+i.clientLeft,d.y=m.y+i.clientTop}const p=a&&!f&&!s?tD(a,l):_r(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+d.x+p.x,y:n.y*u.y-l.scrollTop*u.y+d.y+p.y}}function Pee(t){return Array.from(t.getClientRects())}function kee(t){const e=Nr(t),n=_0(t),i=t.ownerDocument.body,r=Ci(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=Ci(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let a=-n.scrollLeft+I0(t);const o=-n.scrollTop;return lr(i).direction==="rtl"&&(a+=Ci(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:a,y:o}}const YC=25;function Nee(t,e){const n=Ii(t),i=Nr(t),r=n.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(r){s=r.width,a=r.height;const d=tE();(!d||d&&e==="fixed")&&(o=r.offsetLeft,l=r.offsetTop)}const u=I0(i);if(u<=0){const d=i.ownerDocument,f=d.body,p=getComputedStyle(f),m=d.compatMode==="CSS1Compat"&&parseFloat(p.marginLeft)+parseFloat(p.marginRight)||0,y=Math.abs(i.clientWidth-f.clientWidth-m);y<=YC&&(s-=y)}else u<=YC&&(s+=u);return{width:s,height:a,x:o,y:l}}const Mee=new Set(["absolute","fixed"]);function Bee(t,e){const n=co(t,!0,e==="fixed"),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=Dr(t)?Mu(t):_r(1),a=t.clientWidth*s.x,o=t.clientHeight*s.y,l=r*s.x,u=i*s.y;return{width:a,height:o,x:l,y:u}}function KC(t,e,n){let i;if(e==="viewport")i=Nee(t,n);else if(e==="document")i=kee(Nr(t));else if(ur(e))i=Bee(e,n);else{const r=eD(t);i={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return Xh(i)}function nD(t,e){const n=ha(t);return n===e||!ur(n)||Gu(n)?!1:lr(n).position==="fixed"||nD(n,e)}function Fee(t,e){const n=e.get(t);if(n)return n;let i=jc(t,[],!1).filter(o=>ur(o)&&el(o)!=="body"),r=null;const s=lr(t).position==="fixed";let a=s?ha(t):t;for(;ur(a)&&!Gu(a);){const o=lr(a),l=eE(a);!l&&o.position==="fixed"&&(r=null),(s?!l&&!r:!l&&o.position==="static"&&!!r&&Mee.has(r.position)||sd(a)&&!l&&nD(t,a))?i=i.filter(d=>d!==a):r=o,a=ha(a)}return e.set(t,i),i}function Uee(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const a=[...n==="clippingAncestors"?R0(e)?[]:Fee(e,this._c):[].concat(n),i],o=a[0],l=a.reduce((u,d)=>{const f=KC(e,d,r);return u.top=Ci(f.top,u.top),u.right=fa(f.right,u.right),u.bottom=fa(f.bottom,u.bottom),u.left=Ci(f.left,u.left),u},KC(e,o,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Hee(t){const{width:e,height:n}=J4(t);return{width:e,height:n}}function zee(t,e,n){const i=Dr(e),r=Nr(e),s=n==="fixed",a=co(t,!0,s,e);let o={scrollLeft:0,scrollTop:0};const l=_r(0);function u(){l.x=I0(r)}if(i||!i&&!s)if((el(e)!=="body"||sd(r))&&(o=_0(e)),i){const m=co(e,!0,s,e);l.x=m.x+e.clientLeft,l.y=m.y+e.clientTop}else r&&u();s&&!i&&r&&u();const d=r&&!i&&!s?tD(r,o):_r(0),f=a.left+o.scrollLeft-l.x-d.x,p=a.top+o.scrollTop-l.y-d.y;return{x:f,y:p,width:a.width,height:a.height}}function Y1(t){return lr(t).position==="static"}function XC(t,e){if(!Dr(t)||lr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Nr(t)===n&&(n=n.ownerDocument.body),n}function iD(t,e){const n=Ii(t);if(R0(t))return n;if(!Dr(t)){let r=ha(t);for(;r&&!Gu(r);){if(ur(r)&&!Y1(r))return r;r=ha(r)}return n}let i=XC(t,e);for(;i&&See(i)&&Y1(i);)i=XC(i,e);return i&&Gu(i)&&Y1(i)&&!eE(i)?n:i||_ee(t)||n}const qee=async function(t){const e=this.getOffsetParent||iD,n=this.getDimensions,i=await n(t.floating);return{reference:zee(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Vee(t){return lr(t).direction==="rtl"}const Gee={convertOffsetParentRelativeRectToViewportRelativeRect:Oee,getDocumentElement:Nr,getClippingRect:Uee,getOffsetParent:iD,getElementRects:qee,getClientRects:Pee,getDimensions:Hee,getScale:Mu,isElement:ur,isRTL:Vee};function rD(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function jee(t,e){let n=null,i;const r=Nr(t);function s(){var o;clearTimeout(i),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const u=t.getBoundingClientRect(),{left:d,top:f,width:p,height:m}=u;if(o||e(),!p||!m)return;const y=nh(f),b=nh(r.clientWidth-(d+p)),E=nh(r.clientHeight-(f+m)),T=nh(d),S={rootMargin:-y+"px "+-b+"px "+-E+"px "+-T+"px",threshold:Ci(0,fa(1,l))||1};let w=!0;function C(I){const L=I[0].intersectionRatio;if(L!==l){if(!w)return a();L?a(!1,L):i=setTimeout(()=>{a(!1,1e-7)},1e3)}L===1&&!rD(u,t.getBoundingClientRect())&&a(),w=!1}try{n=new IntersectionObserver(C,{...S,root:r.ownerDocument})}catch{n=new IntersectionObserver(C,S)}n.observe(t)}return a(!0),s}function Wee(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,u=nE(t),d=r||s?[...u?jc(u):[],...jc(e)]:[];d.forEach(T=>{r&&T.addEventListener("scroll",n,{passive:!0}),s&&T.addEventListener("resize",n)});const f=u&&o?jee(u,n):null;let p=-1,m=null;a&&(m=new ResizeObserver(T=>{let[x]=T;x&&x.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(e)})),n()}),u&&!l&&m.observe(u),m.observe(e));let y,b=l?co(t):null;l&&E();function E(){const T=co(t);b&&!rD(b,T)&&n(),b=T,y=requestAnimationFrame(E)}return n(),()=>{var T;d.forEach(x=>{r&&x.removeEventListener("scroll",n),s&&x.removeEventListener("resize",n)}),f==null||f(),(T=m)==null||T.disconnect(),m=null,l&&cancelAnimationFrame(y)}}const $ee=yee,Yee=vee,Kee=pee,Xee=Eee,Qee=mee,QC=hee,Zee=bee,Jee=(t,e,n)=>{const i=new Map,r={platform:Gee,...n},s={...r.platform,_c:i};return fee(t,e,{...r,platform:s})};var ete=typeof document<"u",tte=function(){},xh=ete?H.useLayoutEffect:tte;function Qh(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,i,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;i--!==0;)if(!Qh(t[i],e[i]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!(s==="_owner"&&t.$$typeof)&&!Qh(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function sD(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function ZC(t,e){const n=sD(t);return Math.round(e*n)/n}function K1(t){const e=H.useRef(t);return xh(()=>{e.current=t}),e}function nte(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:u}=t,[d,f]=H.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[p,m]=H.useState(i);Qh(p,i)||m(i);const[y,b]=H.useState(null),[E,T]=H.useState(null),x=H.useCallback(ne=>{ne!==I.current&&(I.current=ne,b(ne))},[]),S=H.useCallback(ne=>{ne!==L.current&&(L.current=ne,T(ne))},[]),w=s||y,C=a||E,I=H.useRef(null),L=H.useRef(null),N=H.useRef(d),G=l!=null,O=K1(l),D=K1(r),V=K1(u),$=H.useCallback(()=>{if(!I.current||!L.current)return;const ne={placement:e,strategy:n,middleware:p};D.current&&(ne.platform=D.current),Jee(I.current,L.current,ne).then(oe=>{const P={...oe,isPositioned:V.current!==!1};J.current&&!Qh(N.current,P)&&(N.current=P,$c.flushSync(()=>{f(P)}))})},[p,e,n,D,V]);xh(()=>{u===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,f(ne=>({...ne,isPositioned:!1})))},[u]);const J=H.useRef(!1);xh(()=>(J.current=!0,()=>{J.current=!1}),[]),xh(()=>{if(w&&(I.current=w),C&&(L.current=C),w&&C){if(O.current)return O.current(w,C,$);$()}},[w,C,$,O,G]);const K=H.useMemo(()=>({reference:I,floating:L,setReference:x,setFloating:S}),[x,S]),j=H.useMemo(()=>({reference:w,floating:C}),[w,C]),te=H.useMemo(()=>{const ne={position:n,left:0,top:0};if(!j.floating)return ne;const oe=ZC(j.floating,d.x),P=ZC(j.floating,d.y);return o?{...ne,transform:"translate("+oe+"px, "+P+"px)",...sD(j.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:oe,top:P}},[n,o,j.floating,d.x,d.y]);return H.useMemo(()=>({...d,update:$,refs:K,elements:j,floatingStyles:te}),[d,$,K,j,te])}const ite=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:i,padding:r}=typeof t=="function"?t(n):t;return i&&e(i)?i.current!=null?QC({element:i.current,padding:r}).fn(n):{}:i?QC({element:i,padding:r}).fn(n):{}}}},rte=(t,e)=>({...$ee(t),options:[t,e]}),ste=(t,e)=>({...Yee(t),options:[t,e]}),ate=(t,e)=>({...Zee(t),options:[t,e]}),ote=(t,e)=>({...Kee(t),options:[t,e]}),ute=(t,e)=>({...Xee(t),options:[t,e]}),lte=(t,e)=>({...Qee(t),options:[t,e]}),cte=(t,e)=>({...ite(t),options:[t,e]});var dte="Arrow",aD=H.forwardRef((t,e)=>{const{children:n,width:i=10,height:r=5,...s}=t;return Ce.jsx(Ct.svg,{...s,ref:e,width:i,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:Ce.jsx("polygon",{points:"0,0 30,0 15,10"})})});aD.displayName=dte;var fte=aD,iE="Popper",[oD,L0]=Pr(iE),[hte,uD]=oD(iE),lD=t=>{const{__scopePopper:e,children:n}=t,[i,r]=H.useState(null);return Ce.jsx(hte,{scope:e,anchor:i,onAnchorChange:r,children:n})};lD.displayName=iE;var cD="PopperAnchor",dD=H.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:i,...r}=t,s=uD(cD,n),a=H.useRef(null),o=Yt(e,a),l=H.useRef(null);return H.useEffect(()=>{const u=l.current;l.current=(i==null?void 0:i.current)||a.current,u!==l.current&&s.onAnchorChange(l.current)}),i?null:Ce.jsx(Ct.div,{...r,ref:o})});dD.displayName=cD;var rE="PopperContent",[pte,mte]=oD(rE),fD=H.forwardRef((t,e)=>{var Me,Fe,$e,Ye,fe,Ie;const{__scopePopper:n,side:i="bottom",sideOffset:r=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:f="partial",hideWhenDetached:p=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=t,E=uD(rE,n),[T,x]=H.useState(null),S=Yt(e,Le=>x(Le)),[w,C]=H.useState(null),I=hb(w),L=(I==null?void 0:I.width)??0,N=(I==null?void 0:I.height)??0,G=i+(s!=="center"?"-"+s:""),O=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},D=Array.isArray(u)?u:[u],V=D.length>0,$={padding:O,boundary:D.filter(yte),altBoundary:V},{refs:J,floatingStyles:K,placement:j,isPositioned:te,middlewareData:ne}=nte({strategy:"fixed",placement:G,whileElementsMounted:(...Le)=>Wee(...Le,{animationFrame:m==="always"}),elements:{reference:E.anchor},middleware:[rte({mainAxis:r+N,alignmentAxis:a}),l&&ste({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?ate():void 0,...$}),l&&ote({...$}),ute({...$,apply:({elements:Le,rects:Ke,availableWidth:Lt,availableHeight:Qe})=>{const{width:k,height:X}=Ke.reference,ue=Le.floating.style;ue.setProperty("--radix-popper-available-width",`${Lt}px`),ue.setProperty("--radix-popper-available-height",`${Qe}px`),ue.setProperty("--radix-popper-anchor-width",`${k}px`),ue.setProperty("--radix-popper-anchor-height",`${X}px`)}}),w&&cte({element:w,padding:o}),vte({arrowWidth:L,arrowHeight:N}),p&&lte({strategy:"referenceHidden",...$})]}),[oe,P]=mD(j),ie=ua(y);Hn(()=>{te&&(ie==null||ie())},[te,ie]);const le=(Me=ne.arrow)==null?void 0:Me.x,q=(Fe=ne.arrow)==null?void 0:Fe.y,ye=(($e=ne.arrow)==null?void 0:$e.centerOffset)!==0,[Pe,we]=H.useState();return Hn(()=>{T&&we(window.getComputedStyle(T).zIndex)},[T]),Ce.jsx("div",{ref:J.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:te?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Pe,"--radix-popper-transform-origin":[(Ye=ne.transformOrigin)==null?void 0:Ye.x,(fe=ne.transformOrigin)==null?void 0:fe.y].join(" "),...((Ie=ne.hide)==null?void 0:Ie.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:Ce.jsx(pte,{scope:n,placedSide:oe,onArrowChange:C,arrowX:le,arrowY:q,shouldHideArrow:ye,children:Ce.jsx(Ct.div,{"data-side":oe,"data-align":P,...b,ref:S,style:{...b.style,animation:te?void 0:"none"}})})})});fD.displayName=rE;var hD="PopperArrow",gte={top:"bottom",right:"left",bottom:"top",left:"right"},pD=H.forwardRef(function(e,n){const{__scopePopper:i,...r}=e,s=mte(hD,i),a=gte[s.placedSide];return Ce.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:Ce.jsx(fte,{...r,ref:n,style:{...r.style,display:"block"}})})});pD.displayName=hD;function yte(t){return t!==null}var vte=t=>({name:"transformOrigin",options:t,fn(e){var E,T,x;const{placement:n,rects:i,middlewareData:r}=e,a=((E=r.arrow)==null?void 0:E.centerOffset)!==0,o=a?0:t.arrowWidth,l=a?0:t.arrowHeight,[u,d]=mD(n),f={start:"0%",center:"50%",end:"100%"}[d],p=(((T=r.arrow)==null?void 0:T.x)??0)+o/2,m=(((x=r.arrow)==null?void 0:x.y)??0)+l/2;let y="",b="";return u==="bottom"?(y=a?f:`${p}px`,b=`${-l}px`):u==="top"?(y=a?f:`${p}px`,b=`${i.floating.height+l}px`):u==="right"?(y=`${-l}px`,b=a?f:`${m}px`):u==="left"&&(y=`${i.floating.width+l}px`,b=a?f:`${m}px`),{data:{x:y,y:b}}}});function mD(t){const[e,n="center"]=t.split("-");return[e,n]}var gD=lD,sE=dD,yD=fD,vD=pD,bte="Portal",bD=H.forwardRef((t,e)=>{var o;const{container:n,...i}=t,[r,s]=H.useState(!1);Hn(()=>s(!0),[]);const a=n||r&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?W9.createPortal(Ce.jsx(Ct.div,{...i,ref:e}),a):null});bD.displayName=bte;var Ete=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},vu=new WeakMap,ih=new WeakMap,rh={},X1=0,ED=function(t){return t&&(t.host||ED(t.parentNode))},Tte=function(t,e){return e.map(function(n){if(t.contains(n))return n;var i=ED(n);return i&&t.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},xte=function(t,e,n,i){var r=Tte(e,Array.isArray(t)?t:[t]);rh[n]||(rh[n]=new WeakMap);var s=rh[n],a=[],o=new Set,l=new Set(r),u=function(f){!f||o.has(f)||(o.add(f),u(f.parentNode))};r.forEach(u);var d=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(p){if(o.has(p))d(p);else try{var m=p.getAttribute(i),y=m!==null&&m!=="false",b=(vu.get(p)||0)+1,E=(s.get(p)||0)+1;vu.set(p,b),s.set(p,E),a.push(p),b===1&&y&&ih.set(p,!0),E===1&&p.setAttribute(n,"true"),y||p.setAttribute(i,"true")}catch(T){console.error("aria-hidden: cannot operate on ",p,T)}})};return d(e),o.clear(),X1++,function(){a.forEach(function(f){var p=vu.get(f)-1,m=s.get(f)-1;vu.set(f,p),s.set(f,m),p||(ih.has(f)||f.removeAttribute(i),ih.delete(f)),m||f.removeAttribute(n)}),X1--,X1||(vu=new WeakMap,vu=new WeakMap,ih=new WeakMap,rh={})}},TD=function(t,e,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(t)?t:[t]),r=Ete(t);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live], script"))),xte(i,r,n,"aria-hidden")):function(){return null}},Sr=function(){return Sr=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Sr.apply(this,arguments)};function xD(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function Ste(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var Sh="right-scroll-bar-position",Ah="width-before-scroll-bar",Ate="with-scroll-bars-hidden",wte="--removed-body-scroll-bar-size";function Q1(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Cte(t,e){var n=H.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(i){var r=n.value;r!==i&&(n.value=i,n.callback(i,r))}}}})[0];return n.callback=e,n.facade}var Rte=typeof window<"u"?H.useLayoutEffect:H.useEffect,JC=new WeakMap;function _te(t,e){var n=Cte(null,function(i){return t.forEach(function(r){return Q1(r,i)})});return Rte(function(){var i=JC.get(n);if(i){var r=new Set(i),s=new Set(t),a=n.current;r.forEach(function(o){s.has(o)||Q1(o,null)}),s.forEach(function(o){r.has(o)||Q1(o,a)})}JC.set(n,t)},[t]),n}function Ite(t){return t}function Lte(t,e){e===void 0&&(e=Ite);var n=[],i=!1,r={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var a=e(s,i);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(i=!0;n.length;){var a=n;n=[],a.forEach(s)}n={push:function(o){return s(o)},filter:function(){return n}}},assignMedium:function(s){i=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(s),a=n}var l=function(){var d=a;a=[],d.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(d){a.push(d),u()},filter:function(d){return a=a.filter(d),n}}}};return r}function Dte(t){t===void 0&&(t={});var e=Lte(null);return e.options=Sr({async:!0,ssr:!1},t),e}var SD=function(t){var e=t.sideCar,n=xD(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=e.read();if(!i)throw new Error("Sidecar medium not found");return H.createElement(i,Sr({},n))};SD.isSideCarExport=!0;function Ote(t,e){return t.useMedium(e),SD}var AD=Dte(),Z1=function(){},D0=H.forwardRef(function(t,e){var n=H.useRef(null),i=H.useState({onScrollCapture:Z1,onWheelCapture:Z1,onTouchMoveCapture:Z1}),r=i[0],s=i[1],a=t.forwardProps,o=t.children,l=t.className,u=t.removeScrollBar,d=t.enabled,f=t.shards,p=t.sideCar,m=t.noRelative,y=t.noIsolation,b=t.inert,E=t.allowPinchZoom,T=t.as,x=T===void 0?"div":T,S=t.gapMode,w=xD(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=p,I=_te([n,e]),L=Sr(Sr({},w),r);return H.createElement(H.Fragment,null,d&&H.createElement(C,{sideCar:AD,removeScrollBar:u,shards:f,noRelative:m,noIsolation:y,inert:b,setCallbacks:s,allowPinchZoom:!!E,lockRef:n,gapMode:S}),a?H.cloneElement(H.Children.only(o),Sr(Sr({},L),{ref:I})):H.createElement(x,Sr({},L,{className:l,ref:I}),o))});D0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};D0.classNames={fullWidth:Ah,zeroRight:Sh};var Pte=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function kte(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Pte();return e&&t.setAttribute("nonce",e),t}function Nte(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Mte(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Bte=function(){var t=0,e=null;return{add:function(n){t==0&&(e=kte())&&(Nte(e,n),Mte(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Fte=function(){var t=Bte();return function(e,n){H.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},wD=function(){var t=Fte(),e=function(n){var i=n.styles,r=n.dynamic;return t(i,r),null};return e},Ute={left:0,top:0,right:0,gap:0},J1=function(t){return parseInt(t||"",10)||0},Hte=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],i=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[J1(n),J1(i),J1(r)]},zte=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Ute;var e=Hte(t),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,i-n+e[2]-e[0])}},qte=wD(),Bu="data-scroll-locked",Vte=function(t,e,n,i){var r=t.left,s=t.top,a=t.right,o=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Ate,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(o,"px ").concat(i,`;
  }
  body[`).concat(Bu,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Sh,` {
    right: `).concat(o,"px ").concat(i,`;
  }
  
  .`).concat(Ah,` {
    margin-right: `).concat(o,"px ").concat(i,`;
  }
  
  .`).concat(Sh," .").concat(Sh,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(Ah," .").concat(Ah,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Bu,`] {
    `).concat(wte,": ").concat(o,`px;
  }
`)},eR=function(){var t=parseInt(document.body.getAttribute(Bu)||"0",10);return isFinite(t)?t:0},Gte=function(){H.useEffect(function(){return document.body.setAttribute(Bu,(eR()+1).toString()),function(){var t=eR()-1;t<=0?document.body.removeAttribute(Bu):document.body.setAttribute(Bu,t.toString())}},[])},jte=function(t){var e=t.noRelative,n=t.noImportant,i=t.gapMode,r=i===void 0?"margin":i;Gte();var s=H.useMemo(function(){return zte(r)},[r]);return H.createElement(qte,{styles:Vte(s,!e,r,n?"":"!important")})},fv=!1;if(typeof window<"u")try{var sh=Object.defineProperty({},"passive",{get:function(){return fv=!0,!0}});window.addEventListener("test",sh,sh),window.removeEventListener("test",sh,sh)}catch{fv=!1}var bu=fv?{passive:!1}:!1,Wte=function(t){return t.tagName==="TEXTAREA"},CD=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Wte(t)&&n[e]==="visible")},$te=function(t){return CD(t,"overflowY")},Yte=function(t){return CD(t,"overflowX")},tR=function(t,e){var n=e.ownerDocument,i=e;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var r=RD(t,i);if(r){var s=_D(t,i),a=s[1],o=s[2];if(a>o)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},Kte=function(t){var e=t.scrollTop,n=t.scrollHeight,i=t.clientHeight;return[e,n,i]},Xte=function(t){var e=t.scrollLeft,n=t.scrollWidth,i=t.clientWidth;return[e,n,i]},RD=function(t,e){return t==="v"?$te(e):Yte(e)},_D=function(t,e){return t==="v"?Kte(e):Xte(e)},Qte=function(t,e){return t==="h"&&e==="rtl"?-1:1},Zte=function(t,e,n,i,r){var s=Qte(t,window.getComputedStyle(e).direction),a=s*i,o=n.target,l=e.contains(o),u=!1,d=a>0,f=0,p=0;do{if(!o)break;var m=_D(t,o),y=m[0],b=m[1],E=m[2],T=b-E-s*y;(y||T)&&RD(t,o)&&(f+=T,p+=y);var x=o.parentNode;o=x&&x.nodeType===Node.DOCUMENT_FRAGMENT_NODE?x.host:x}while(!l&&o!==document.body||l&&(e.contains(o)||e===o));return(d&&Math.abs(f)<1||!d&&Math.abs(p)<1)&&(u=!0),u},ah=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},nR=function(t){return[t.deltaX,t.deltaY]},iR=function(t){return t&&"current"in t?t.current:t},Jte=function(t,e){return t[0]===e[0]&&t[1]===e[1]},ene=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},tne=0,Eu=[];function nne(t){var e=H.useRef([]),n=H.useRef([0,0]),i=H.useRef(),r=H.useState(tne++)[0],s=H.useState(wD)[0],a=H.useRef(t);H.useEffect(function(){a.current=t},[t]),H.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var b=Ste([t.lockRef.current],(t.shards||[]).map(iR),!0).filter(Boolean);return b.forEach(function(E){return E.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),b.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var o=H.useCallback(function(b,E){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var T=ah(b),x=n.current,S="deltaX"in b?b.deltaX:x[0]-T[0],w="deltaY"in b?b.deltaY:x[1]-T[1],C,I=b.target,L=Math.abs(S)>Math.abs(w)?"h":"v";if("touches"in b&&L==="h"&&I.type==="range")return!1;var N=tR(L,I);if(!N)return!0;if(N?C=L:(C=L==="v"?"h":"v",N=tR(L,I)),!N)return!1;if(!i.current&&"changedTouches"in b&&(S||w)&&(i.current=C),!C)return!0;var G=i.current||C;return Zte(G,E,b,G==="h"?S:w)},[]),l=H.useCallback(function(b){var E=b;if(!(!Eu.length||Eu[Eu.length-1]!==s)){var T="deltaY"in E?nR(E):ah(E),x=e.current.filter(function(C){return C.name===E.type&&(C.target===E.target||E.target===C.shadowParent)&&Jte(C.delta,T)})[0];if(x&&x.should){E.cancelable&&E.preventDefault();return}if(!x){var S=(a.current.shards||[]).map(iR).filter(Boolean).filter(function(C){return C.contains(E.target)}),w=S.length>0?o(E,S[0]):!a.current.noIsolation;w&&E.cancelable&&E.preventDefault()}}},[]),u=H.useCallback(function(b,E,T,x){var S={name:b,delta:E,target:T,should:x,shadowParent:ine(T)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(w){return w!==S})},1)},[]),d=H.useCallback(function(b){n.current=ah(b),i.current=void 0},[]),f=H.useCallback(function(b){u(b.type,nR(b),b.target,o(b,t.lockRef.current))},[]),p=H.useCallback(function(b){u(b.type,ah(b),b.target,o(b,t.lockRef.current))},[]);H.useEffect(function(){return Eu.push(s),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",l,bu),document.addEventListener("touchmove",l,bu),document.addEventListener("touchstart",d,bu),function(){Eu=Eu.filter(function(b){return b!==s}),document.removeEventListener("wheel",l,bu),document.removeEventListener("touchmove",l,bu),document.removeEventListener("touchstart",d,bu)}},[]);var m=t.removeScrollBar,y=t.inert;return H.createElement(H.Fragment,null,y?H.createElement(s,{styles:ene(r)}):null,m?H.createElement(jte,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function ine(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const rne=Ote(AD,nne);var aE=H.forwardRef(function(t,e){return H.createElement(D0,Sr({},t,{ref:e,sideCar:rne}))});aE.classNames=D0.classNames;var O0="Popover",[ID]=Pr(O0,[L0]),ad=L0(),[sne,bo]=ID(O0),LD=t=>{const{__scopePopover:e,children:n,open:i,defaultOpen:r,onOpenChange:s,modal:a=!1}=t,o=ad(e),l=H.useRef(null),[u,d]=H.useState(!1),[f,p]=oa({prop:i,defaultProp:r??!1,onChange:s,caller:O0});return Ce.jsx(gD,{...o,children:Ce.jsx(sne,{scope:e,contentId:po(),triggerRef:l,open:f,onOpenChange:p,onOpenToggle:H.useCallback(()=>p(m=>!m),[p]),hasCustomAnchor:u,onCustomAnchorAdd:H.useCallback(()=>d(!0),[]),onCustomAnchorRemove:H.useCallback(()=>d(!1),[]),modal:a,children:n})})};LD.displayName=O0;var DD="PopoverAnchor",ane=H.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=bo(DD,n),s=ad(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=r;return H.useEffect(()=>(a(),()=>o()),[a,o]),Ce.jsx(sE,{...s,...i,ref:e})});ane.displayName=DD;var OD="PopoverTrigger",PD=H.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=bo(OD,n),s=ad(n),a=Yt(e,r.triggerRef),o=Ce.jsx(Ct.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":UD(r.open),...i,ref:a,onClick:xt(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?o:Ce.jsx(sE,{asChild:!0,...s,children:o})});PD.displayName=OD;var one="PopoverPortal",[Tle,une]=ID(one,{forceMount:void 0}),ju="PopoverContent",kD=H.forwardRef((t,e)=>{const n=une(ju,t.__scopePopover),{forceMount:i=n.forceMount,...r}=t,s=bo(ju,t.__scopePopover);return Ce.jsx(Yc,{present:i||s.open,children:s.modal?Ce.jsx(cne,{...r,ref:e}):Ce.jsx(dne,{...r,ref:e})})});kD.displayName=ju;var lne=Oc("PopoverContent.RemoveScroll"),cne=H.forwardRef((t,e)=>{const n=bo(ju,t.__scopePopover),i=H.useRef(null),r=Yt(e,i),s=H.useRef(!1);return H.useEffect(()=>{const a=i.current;if(a)return TD(a)},[]),Ce.jsx(aE,{as:lne,allowPinchZoom:!0,children:Ce.jsx(ND,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xt(t.onCloseAutoFocus,a=>{var o;a.preventDefault(),s.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:xt(t.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,u=o.button===2||l;s.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:xt(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),dne=H.forwardRef((t,e)=>{const n=bo(ju,t.__scopePopover),i=H.useRef(!1),r=H.useRef(!1);return Ce.jsx(ND,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=t.onCloseAutoFocus)==null||a.call(t,s),s.defaultPrevented||(i.current||(o=n.triggerRef.current)==null||o.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var l,u;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const a=s.target;((u=n.triggerRef.current)==null?void 0:u.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),ND=H.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:d,...f}=t,p=bo(ju,n),m=ad(n);return $4(),Ce.jsx(Xb,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:Ce.jsx(Kb,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:d,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1),children:Ce.jsx(yD,{"data-state":UD(p.open),role:"dialog",id:p.contentId,...m,...f,ref:e,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),MD="PopoverClose",BD=H.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=bo(MD,n);return Ce.jsx(Ct.button,{type:"button",...i,ref:e,onClick:xt(t.onClick,()=>r.onOpenChange(!1))})});BD.displayName=MD;var fne="PopoverArrow",FD=H.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=ad(n);return Ce.jsx(vD,{...r,...i,ref:e})});FD.displayName=fne;function UD(t){return t?"open":"closed"}var hne=LD,pne=PD,mne=kD,gne=BD,yne=FD;function rR(t,[e,n]){return Math.min(n,Math.max(e,t))}var HD=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),vne="VisuallyHidden",bne=H.forwardRef((t,e)=>Ce.jsx(Ct.span,{...t,ref:e,style:{...HD,...t.style}}));bne.displayName=vne;var Ene=[" ","Enter","ArrowUp","ArrowDown"],Tne=[" ","Enter"],fo="Select",[P0,k0,xne]=T_(fo),[tl]=Pr(fo,[xne,L0]),N0=L0(),[Sne,va]=tl(fo),[Ane,wne]=tl(fo),zD=t=>{const{__scopeSelect:e,children:n,open:i,defaultOpen:r,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:u,name:d,autoComplete:f,disabled:p,required:m,form:y}=t,b=N0(e),[E,T]=H.useState(null),[x,S]=H.useState(null),[w,C]=H.useState(!1),I=n0(u),[L,N]=oa({prop:i,defaultProp:r??!1,onChange:s,caller:fo}),[G,O]=oa({prop:a,defaultProp:o,onChange:l,caller:fo}),D=H.useRef(null),V=E?y||!!E.closest("form"):!0,[$,J]=H.useState(new Set),K=Array.from($).map(j=>j.props.value).join(";");return Ce.jsx(gD,{...b,children:Ce.jsxs(Sne,{required:m,scope:e,trigger:E,onTriggerChange:T,valueNode:x,onValueNodeChange:S,valueNodeHasChildren:w,onValueNodeHasChildrenChange:C,contentId:po(),value:G,onValueChange:O,open:L,onOpenChange:N,dir:I,triggerPointerDownPosRef:D,disabled:p,children:[Ce.jsx(P0.Provider,{scope:e,children:Ce.jsx(Ane,{scope:t.__scopeSelect,onNativeOptionAdd:H.useCallback(j=>{J(te=>new Set(te).add(j))},[]),onNativeOptionRemove:H.useCallback(j=>{J(te=>{const ne=new Set(te);return ne.delete(j),ne})},[]),children:n})}),V?Ce.jsxs(dO,{"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:f,value:G,onChange:j=>O(j.target.value),disabled:p,form:y,children:[G===void 0?Ce.jsx("option",{value:""}):null,Array.from($)]},K):null]})})};zD.displayName=fo;var qD="SelectTrigger",VD=H.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:i=!1,...r}=t,s=N0(n),a=va(qD,n),o=a.disabled||i,l=Yt(e,a.onTriggerChange),u=k0(n),d=H.useRef("touch"),[f,p,m]=hO(b=>{const E=u().filter(S=>!S.disabled),T=E.find(S=>S.value===a.value),x=pO(E,b,T);x!==void 0&&a.onValueChange(x.value)}),y=b=>{o||(a.onOpenChange(!0),m()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return Ce.jsx(sE,{asChild:!0,...s,children:Ce.jsx(Ct.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":fO(a.value)?"":void 0,...r,ref:l,onClick:xt(r.onClick,b=>{b.currentTarget.focus(),d.current!=="mouse"&&y(b)}),onPointerDown:xt(r.onPointerDown,b=>{d.current=b.pointerType;const E=b.target;E.hasPointerCapture(b.pointerId)&&E.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:xt(r.onKeyDown,b=>{const E=f.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&p(b.key),!(E&&b.key===" ")&&Ene.includes(b.key)&&(y(),b.preventDefault())})})})});VD.displayName=qD;var GD="SelectValue",jD=H.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,children:s,placeholder:a="",...o}=t,l=va(GD,n),{onValueNodeHasChildrenChange:u}=l,d=s!==void 0,f=Yt(e,l.onValueNodeChange);return Hn(()=>{u(d)},[u,d]),Ce.jsx(Ct.span,{...o,ref:f,style:{pointerEvents:"none"},children:fO(l.value)?Ce.jsx(Ce.Fragment,{children:a}):s})});jD.displayName=GD;var Cne="SelectIcon",WD=H.forwardRef((t,e)=>{const{__scopeSelect:n,children:i,...r}=t;return Ce.jsx(Ct.span,{"aria-hidden":!0,...r,ref:e,children:i||""})});WD.displayName=Cne;var Rne="SelectPortal",$D=t=>Ce.jsx(bD,{asChild:!0,...t});$D.displayName=Rne;var ho="SelectContent",YD=H.forwardRef((t,e)=>{const n=va(ho,t.__scopeSelect),[i,r]=H.useState();if(Hn(()=>{r(new DocumentFragment)},[]),!n.open){const s=i;return s?$c.createPortal(Ce.jsx(KD,{scope:t.__scopeSelect,children:Ce.jsx(P0.Slot,{scope:t.__scopeSelect,children:Ce.jsx("div",{children:t.children})})}),s):null}return Ce.jsx(XD,{...t,ref:e})});YD.displayName=ho;var rr=10,[KD,ba]=tl(ho),_ne="SelectContentImpl",Ine=Oc("SelectContent.RemoveScroll"),XD=H.forwardRef((t,e)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:u,alignOffset:d,arrowPadding:f,collisionBoundary:p,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:E,...T}=t,x=va(ho,n),[S,w]=H.useState(null),[C,I]=H.useState(null),L=Yt(e,Me=>w(Me)),[N,G]=H.useState(null),[O,D]=H.useState(null),V=k0(n),[$,J]=H.useState(!1),K=H.useRef(!1);H.useEffect(()=>{if(S)return TD(S)},[S]),$4();const j=H.useCallback(Me=>{const[Fe,...$e]=V().map(Ie=>Ie.ref.current),[Ye]=$e.slice(-1),fe=document.activeElement;for(const Ie of Me)if(Ie===fe||(Ie==null||Ie.scrollIntoView({block:"nearest"}),Ie===Fe&&C&&(C.scrollTop=0),Ie===Ye&&C&&(C.scrollTop=C.scrollHeight),Ie==null||Ie.focus(),document.activeElement!==fe))return},[V,C]),te=H.useCallback(()=>j([N,S]),[j,N,S]);H.useEffect(()=>{$&&te()},[$,te]);const{onOpenChange:ne,triggerPointerDownPosRef:oe}=x;H.useEffect(()=>{if(S){let Me={x:0,y:0};const Fe=Ye=>{var fe,Ie;Me={x:Math.abs(Math.round(Ye.pageX)-(((fe=oe.current)==null?void 0:fe.x)??0)),y:Math.abs(Math.round(Ye.pageY)-(((Ie=oe.current)==null?void 0:Ie.y)??0))}},$e=Ye=>{Me.x<=10&&Me.y<=10?Ye.preventDefault():S.contains(Ye.target)||ne(!1),document.removeEventListener("pointermove",Fe),oe.current=null};return oe.current!==null&&(document.addEventListener("pointermove",Fe),document.addEventListener("pointerup",$e,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Fe),document.removeEventListener("pointerup",$e,{capture:!0})}}},[S,ne,oe]),H.useEffect(()=>{const Me=()=>ne(!1);return window.addEventListener("blur",Me),window.addEventListener("resize",Me),()=>{window.removeEventListener("blur",Me),window.removeEventListener("resize",Me)}},[ne]);const[P,ie]=hO(Me=>{const Fe=V().filter(fe=>!fe.disabled),$e=Fe.find(fe=>fe.ref.current===document.activeElement),Ye=pO(Fe,Me,$e);Ye&&setTimeout(()=>Ye.ref.current.focus())}),le=H.useCallback((Me,Fe,$e)=>{const Ye=!K.current&&!$e;(x.value!==void 0&&x.value===Fe||Ye)&&(G(Me),Ye&&(K.current=!0))},[x.value]),q=H.useCallback(()=>S==null?void 0:S.focus(),[S]),ye=H.useCallback((Me,Fe,$e)=>{const Ye=!K.current&&!$e;(x.value!==void 0&&x.value===Fe||Ye)&&D(Me)},[x.value]),Pe=i==="popper"?hv:QD,we=Pe===hv?{side:o,sideOffset:l,align:u,alignOffset:d,arrowPadding:f,collisionBoundary:p,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:E}:{};return Ce.jsx(KD,{scope:n,content:S,viewport:C,onViewportChange:I,itemRefCallback:le,selectedItem:N,onItemLeave:q,itemTextRefCallback:ye,focusSelectedItem:te,selectedItemText:O,position:i,isPositioned:$,searchRef:P,children:Ce.jsx(aE,{as:Ine,allowPinchZoom:!0,children:Ce.jsx(Xb,{asChild:!0,trapped:x.open,onMountAutoFocus:Me=>{Me.preventDefault()},onUnmountAutoFocus:xt(r,Me=>{var Fe;(Fe=x.trigger)==null||Fe.focus({preventScroll:!0}),Me.preventDefault()}),children:Ce.jsx(Kb,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:Me=>Me.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:Ce.jsx(Pe,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:Me=>Me.preventDefault(),...T,...we,onPlaced:()=>J(!0),ref:L,style:{display:"flex",flexDirection:"column",outline:"none",...T.style},onKeyDown:xt(T.onKeyDown,Me=>{const Fe=Me.ctrlKey||Me.altKey||Me.metaKey;if(Me.key==="Tab"&&Me.preventDefault(),!Fe&&Me.key.length===1&&ie(Me.key),["ArrowUp","ArrowDown","Home","End"].includes(Me.key)){let Ye=V().filter(fe=>!fe.disabled).map(fe=>fe.ref.current);if(["ArrowUp","End"].includes(Me.key)&&(Ye=Ye.slice().reverse()),["ArrowUp","ArrowDown"].includes(Me.key)){const fe=Me.target,Ie=Ye.indexOf(fe);Ye=Ye.slice(Ie+1)}setTimeout(()=>j(Ye)),Me.preventDefault()}})})})})})})});XD.displayName=_ne;var Lne="SelectItemAlignedPosition",QD=H.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:i,...r}=t,s=va(ho,n),a=ba(ho,n),[o,l]=H.useState(null),[u,d]=H.useState(null),f=Yt(e,L=>d(L)),p=k0(n),m=H.useRef(!1),y=H.useRef(!0),{viewport:b,selectedItem:E,selectedItemText:T,focusSelectedItem:x}=a,S=H.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&u&&b&&E&&T){const L=s.trigger.getBoundingClientRect(),N=u.getBoundingClientRect(),G=s.valueNode.getBoundingClientRect(),O=T.getBoundingClientRect();if(s.dir!=="rtl"){const fe=O.left-N.left,Ie=G.left-fe,Le=L.left-Ie,Ke=L.width+Le,Lt=Math.max(Ke,N.width),Qe=window.innerWidth-rr,k=rR(Ie,[rr,Math.max(rr,Qe-Lt)]);o.style.minWidth=Ke+"px",o.style.left=k+"px"}else{const fe=N.right-O.right,Ie=window.innerWidth-G.right-fe,Le=window.innerWidth-L.right-Ie,Ke=L.width+Le,Lt=Math.max(Ke,N.width),Qe=window.innerWidth-rr,k=rR(Ie,[rr,Math.max(rr,Qe-Lt)]);o.style.minWidth=Ke+"px",o.style.right=k+"px"}const D=p(),V=window.innerHeight-rr*2,$=b.scrollHeight,J=window.getComputedStyle(u),K=parseInt(J.borderTopWidth,10),j=parseInt(J.paddingTop,10),te=parseInt(J.borderBottomWidth,10),ne=parseInt(J.paddingBottom,10),oe=K+j+$+ne+te,P=Math.min(E.offsetHeight*5,oe),ie=window.getComputedStyle(b),le=parseInt(ie.paddingTop,10),q=parseInt(ie.paddingBottom,10),ye=L.top+L.height/2-rr,Pe=V-ye,we=E.offsetHeight/2,Me=E.offsetTop+we,Fe=K+j+Me,$e=oe-Fe;if(Fe<=ye){const fe=D.length>0&&E===D[D.length-1].ref.current;o.style.bottom="0px";const Ie=u.clientHeight-b.offsetTop-b.offsetHeight,Le=Math.max(Pe,we+(fe?q:0)+Ie+te),Ke=Fe+Le;o.style.height=Ke+"px"}else{const fe=D.length>0&&E===D[0].ref.current;o.style.top="0px";const Le=Math.max(ye,K+b.offsetTop+(fe?le:0)+we)+$e;o.style.height=Le+"px",b.scrollTop=Fe-ye+b.offsetTop}o.style.margin=`${rr}px 0`,o.style.minHeight=P+"px",o.style.maxHeight=V+"px",i==null||i(),requestAnimationFrame(()=>m.current=!0)}},[p,s.trigger,s.valueNode,o,u,b,E,T,s.dir,i]);Hn(()=>S(),[S]);const[w,C]=H.useState();Hn(()=>{u&&C(window.getComputedStyle(u).zIndex)},[u]);const I=H.useCallback(L=>{L&&y.current===!0&&(S(),x==null||x(),y.current=!1)},[S,x]);return Ce.jsx(One,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:I,children:Ce.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:Ce.jsx(Ct.div,{...r,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});QD.displayName=Lne;var Dne="SelectPopperPosition",hv=H.forwardRef((t,e)=>{const{__scopeSelect:n,align:i="start",collisionPadding:r=rr,...s}=t,a=N0(n);return Ce.jsx(yD,{...a,...s,ref:e,align:i,collisionPadding:r,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});hv.displayName=Dne;var[One,oE]=tl(ho,{}),pv="SelectViewport",ZD=H.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:i,...r}=t,s=ba(pv,n),a=oE(pv,n),o=Yt(e,s.onViewportChange),l=H.useRef(0);return Ce.jsxs(Ce.Fragment,{children:[Ce.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),Ce.jsx(P0.Slot,{scope:n,children:Ce.jsx(Ct.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:xt(r.onScroll,u=>{const d=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:p}=a;if(p!=null&&p.current&&f){const m=Math.abs(l.current-d.scrollTop);if(m>0){const y=window.innerHeight-rr*2,b=parseFloat(f.style.minHeight),E=parseFloat(f.style.height),T=Math.max(b,E);if(T<y){const x=T+m,S=Math.min(y,x),w=x-S;f.style.height=S+"px",f.style.bottom==="0px"&&(d.scrollTop=w>0?w:0,f.style.justifyContent="flex-end")}}}l.current=d.scrollTop})})})]})});ZD.displayName=pv;var JD="SelectGroup",[Pne,kne]=tl(JD),eO=H.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=po();return Ce.jsx(Pne,{scope:n,id:r,children:Ce.jsx(Ct.div,{role:"group","aria-labelledby":r,...i,ref:e})})});eO.displayName=JD;var tO="SelectLabel",nO=H.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=kne(tO,n);return Ce.jsx(Ct.div,{id:r.id,...i,ref:e})});nO.displayName=tO;var Zh="SelectItem",[Nne,iO]=tl(Zh),rO=H.forwardRef((t,e)=>{const{__scopeSelect:n,value:i,disabled:r=!1,textValue:s,...a}=t,o=va(Zh,n),l=ba(Zh,n),u=o.value===i,[d,f]=H.useState(s??""),[p,m]=H.useState(!1),y=Yt(e,x=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,x,i,r)}),b=po(),E=H.useRef("touch"),T=()=>{r||(o.onValueChange(i),o.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return Ce.jsx(Nne,{scope:n,value:i,disabled:r,textId:b,isSelected:u,onItemTextChange:H.useCallback(x=>{f(S=>S||((x==null?void 0:x.textContent)??"").trim())},[]),children:Ce.jsx(P0.ItemSlot,{scope:n,value:i,disabled:r,textValue:d,children:Ce.jsx(Ct.div,{role:"option","aria-labelledby":b,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...a,ref:y,onFocus:xt(a.onFocus,()=>m(!0)),onBlur:xt(a.onBlur,()=>m(!1)),onClick:xt(a.onClick,()=>{E.current!=="mouse"&&T()}),onPointerUp:xt(a.onPointerUp,()=>{E.current==="mouse"&&T()}),onPointerDown:xt(a.onPointerDown,x=>{E.current=x.pointerType}),onPointerMove:xt(a.onPointerMove,x=>{var S;E.current=x.pointerType,r?(S=l.onItemLeave)==null||S.call(l):E.current==="mouse"&&x.currentTarget.focus({preventScroll:!0})}),onPointerLeave:xt(a.onPointerLeave,x=>{var S;x.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:xt(a.onKeyDown,x=>{var w;((w=l.searchRef)==null?void 0:w.current)!==""&&x.key===" "||(Tne.includes(x.key)&&T(),x.key===" "&&x.preventDefault())})})})})});rO.displayName=Zh;var fc="SelectItemText",sO=H.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,...s}=t,a=va(fc,n),o=ba(fc,n),l=iO(fc,n),u=wne(fc,n),[d,f]=H.useState(null),p=Yt(e,T=>f(T),l.onItemTextChange,T=>{var x;return(x=o.itemTextRefCallback)==null?void 0:x.call(o,T,l.value,l.disabled)}),m=d==null?void 0:d.textContent,y=H.useMemo(()=>Ce.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:b,onNativeOptionRemove:E}=u;return Hn(()=>(b(y),()=>E(y)),[b,E,y]),Ce.jsxs(Ce.Fragment,{children:[Ce.jsx(Ct.span,{id:l.textId,...s,ref:p}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?$c.createPortal(s.children,a.valueNode):null]})});sO.displayName=fc;var aO="SelectItemIndicator",oO=H.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return iO(aO,n).isSelected?Ce.jsx(Ct.span,{"aria-hidden":!0,...i,ref:e}):null});oO.displayName=aO;var mv="SelectScrollUpButton",uO=H.forwardRef((t,e)=>{const n=ba(mv,t.__scopeSelect),i=oE(mv,t.__scopeSelect),[r,s]=H.useState(!1),a=Yt(e,i.onScrollButtonChange);return Hn(()=>{if(n.viewport&&n.isPositioned){let o=function(){const u=l.scrollTop>0;s(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),r?Ce.jsx(cO,{...t,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});uO.displayName=mv;var gv="SelectScrollDownButton",lO=H.forwardRef((t,e)=>{const n=ba(gv,t.__scopeSelect),i=oE(gv,t.__scopeSelect),[r,s]=H.useState(!1),a=Yt(e,i.onScrollButtonChange);return Hn(()=>{if(n.viewport&&n.isPositioned){let o=function(){const u=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<u;s(d)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),r?Ce.jsx(cO,{...t,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});lO.displayName=gv;var cO=H.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:i,...r}=t,s=ba("SelectScrollButton",n),a=H.useRef(null),o=k0(n),l=H.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return H.useEffect(()=>()=>l(),[l]),Hn(()=>{var d;const u=o().find(f=>f.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[o]),Ce.jsx(Ct.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:xt(r.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(i,50))}),onPointerMove:xt(r.onPointerMove,()=>{var u;(u=s.onItemLeave)==null||u.call(s),a.current===null&&(a.current=window.setInterval(i,50))}),onPointerLeave:xt(r.onPointerLeave,()=>{l()})})}),Mne="SelectSeparator",Bne=H.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return Ce.jsx(Ct.div,{"aria-hidden":!0,...i,ref:e})});Bne.displayName=Mne;var yv="SelectArrow",Fne=H.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=N0(n),s=va(yv,n),a=ba(yv,n);return s.open&&a.position==="popper"?Ce.jsx(vD,{...r,...i,ref:e}):null});Fne.displayName=yv;var Une="SelectBubbleInput",dO=H.forwardRef(({__scopeSelect:t,value:e,...n},i)=>{const r=H.useRef(null),s=Yt(i,r),a=pb(e);return H.useEffect(()=>{const o=r.current;if(!o)return;const l=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==e&&d){const f=new Event("change",{bubbles:!0});d.call(o,e),o.dispatchEvent(f)}},[a,e]),Ce.jsx(Ct.select,{...n,style:{...HD,...n.style},ref:s,defaultValue:e})});dO.displayName=Une;function fO(t){return t===""||t===void 0}function hO(t){const e=ua(t),n=H.useRef(""),i=H.useRef(0),r=H.useCallback(a=>{const o=n.current+a;e(o),(function l(u){n.current=u,window.clearTimeout(i.current),u!==""&&(i.current=window.setTimeout(()=>l(""),1e3))})(o)},[e]),s=H.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return H.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,r,s]}function pO(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let a=Hne(t,Math.max(s,0));r.length===1&&(a=a.filter(u=>u!==n));const l=a.find(u=>u.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function Hne(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var zne=zD,qne=VD,Vne=YD,Gne=nO,jne=rO,wh={exports:{}},Wne=wh.exports,sR;function $ne(){return sR||(sR=1,(function(t){//! openseadragon 4.1.1
//! Built on 2024-04-01
//! Git commit: v4.1.1-0-f90d9814
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function e(n){return new e.Viewer(n)}(function(n){n.version={versionStr:"4.1.1",major:parseInt("4",10),minor:parseInt("1",10),revision:parseInt("1",10)};var i={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object AsyncFunction]":"function","[object Promise]":"promise","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},r=Object.prototype.toString,s=Object.prototype.hasOwnProperty;n.isFunction=function(a){return n.type(a)==="function"},n.isArray=Array.isArray||function(a){return n.type(a)==="array"},n.isWindow=function(a){return a&&typeof a=="object"&&"setInterval"in a},n.type=function(a){return a==null?String(a):i[r.call(a)]||"object"},n.isPlainObject=function(a){if(!a||e.type(a)!=="object"||a.nodeType||n.isWindow(a)||a.constructor&&!s.call(a,"constructor")&&!s.call(a.constructor.prototype,"isPrototypeOf"))return!1;var o;for(var l in a)o=l;return o===void 0||s.call(a,o)},n.isEmptyObject=function(a){for(var o in a)return!1;return!0},n.freezeObject=function(a){return Object.freeze?n.freezeObject=Object.freeze:n.freezeObject=function(o){return o},n.freezeObject(a)},n.supportsCanvas=(function(){var a=document.createElement("canvas");return!!(n.isFunction(a.getContext)&&a.getContext("2d"))})(),n.isCanvasTainted=function(a){var o=!1;try{a.getContext("2d").getImageData(0,0,1,1)}catch{o=!0}return o},n.supportsAddEventListener=(function(){return!!(document.documentElement.addEventListener&&document.addEventListener)})(),n.supportsRemoveEventListener=(function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)})(),n.supportsEventListenerOptions=(function(){var a=0;if(n.supportsAddEventListener)try{var o={get capture(){return a++,!1},get once(){return a++,!1},get passive(){return a++,!1}};window.addEventListener("test",null,o),window.removeEventListener("test",null,o)}catch{a=0}return a>=3})(),n.getCurrentPixelDensityRatio=function(){if(n.supportsCanvas){var a=document.createElement("canvas").getContext("2d"),o=window.devicePixelRatio||1,l=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;return Math.max(o,1)/l}else return 1},n.pixelDensityRatio=n.getCurrentPixelDensityRatio()})(e),(function(n){n.extend=function(){var l,u,d,f,p,m,y=arguments[0]||{},b=arguments.length,E=!1,T=1;for(typeof y=="boolean"&&(E=y,y=arguments[1]||{},T=2),typeof y!="object"&&!e.isFunction(y)&&(y={}),b===T&&(y=this,--T);T<b;T++)if(l=arguments[T],l!==null||l!==void 0)for(u in l){var x=Object.getOwnPropertyDescriptor(l,u);if(x!==void 0){if(x.get||x.set){Object.defineProperty(y,u,x);continue}f=x.value}else{n.console.warn('Could not copy inherited property "'+u+'".');continue}y!==f&&(E&&f&&(e.isPlainObject(f)||(p=e.isArray(f)))?(d=y[u],p?(p=!1,m=d&&e.isArray(d)?d:[]):m=d&&e.isPlainObject(d)?d:{},y[u]=e.extend(E,m,f)):f!==void 0&&(y[u]=f))}return y};var i=function(){if(typeof navigator!="object")return!1;var l=navigator.userAgent;return typeof l!="string"?!1:l.indexOf("iPhone")!==-1||l.indexOf("iPad")!==-1||l.indexOf("iPod")!==-1};n.extend(n,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!1,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerDblClickDrag:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:i(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorElement:null,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,tileRetryMax:0,tileRetryDelay:2500,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},SIGNAL:"----seadragon----",delegate:function(l,u){return function(){var d=arguments;return d===void 0&&(d=[]),u.apply(l,d)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(l){return n._viewers.get(this.getElement(l))},getElement:function(l){return typeof l=="string"&&(l=document.getElementById(l)),l},getElementPosition:function(l){var u=new n.Point,d,f;for(l=n.getElement(l),d=n.getElementStyle(l).position==="fixed",f=o(l,d);f;)u.x+=l.offsetLeft,u.y+=l.offsetTop,d&&(u=u.plus(n.getPageScroll())),l=f,d=n.getElementStyle(l).position==="fixed",f=o(l,d);return u},getElementOffset:function(l){l=n.getElement(l);var u=l&&l.ownerDocument,d,f,p={top:0,left:0};return u?(d=u.documentElement,typeof l.getBoundingClientRect<"u"&&(p=l.getBoundingClientRect()),f=u===u.window?u:u.nodeType===9?u.defaultView||u.parentWindow:!1,new n.Point(p.left+(f.pageXOffset||d.scrollLeft)-(d.clientLeft||0),p.top+(f.pageYOffset||d.scrollTop)-(d.clientTop||0))):new n.Point},getElementSize:function(l){return l=n.getElement(l),new n.Point(l.clientWidth,l.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(l){return l=n.getElement(l),l.currentStyle}:function(l){return l=n.getElement(l),window.getComputedStyle(l,"")},getCssPropertyWithVendorPrefix:function(l){var u={};return n.getCssPropertyWithVendorPrefix=function(d){if(u[d]!==void 0)return u[d];var f=document.createElement("div").style,p=null;if(f[d]!==void 0)p=d;else for(var m=["Webkit","Moz","MS","O","webkit","moz","ms","o"],y=n.capitalizeFirstLetter(d),b=0;b<m.length;b++){var E=m[b]+y;if(f[E]!==void 0){p=E;break}}return u[d]=p,p},n.getCssPropertyWithVendorPrefix(l)},capitalizeFirstLetter:function(l){return l.charAt(0).toUpperCase()+l.slice(1)},positiveModulo:function(l,u){var d=l%u;return d<0&&(d+=u),d},pointInElement:function(l,u){l=n.getElement(l);var d=n.getElementOffset(l),f=n.getElementSize(l);return u.x>=d.x&&u.x<d.x+f.x&&u.y<d.y+f.y&&u.y>=d.y},getMousePosition:function(l){if(typeof l.pageX=="number")n.getMousePosition=function(u){var d=new n.Point;return d.x=u.pageX,d.y=u.pageY,d};else if(typeof l.clientX=="number")n.getMousePosition=function(u){var d=new n.Point;return d.x=u.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d.y=u.clientY+document.body.scrollTop+document.documentElement.scrollTop,d};else throw new Error("Unknown event mouse position, no known technique.");return n.getMousePosition(l)},getPageScroll:function(){var l=document.documentElement||{},u=document.body||{};if(typeof window.pageXOffset=="number")n.getPageScroll=function(){return new n.Point(window.pageXOffset,window.pageYOffset)};else if(u.scrollLeft||u.scrollTop)n.getPageScroll=function(){return new n.Point(document.body.scrollLeft,document.body.scrollTop)};else if(l.scrollLeft||l.scrollTop)n.getPageScroll=function(){return new n.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new n.Point(0,0);return n.getPageScroll()},setPageScroll:function(l){if(typeof window.scrollTo<"u")n.setPageScroll=function(f){window.scrollTo(f.x,f.y)};else{var u=n.getPageScroll();if(u.x===l.x&&u.y===l.y)return;document.body.scrollLeft=l.x,document.body.scrollTop=l.y;var d=n.getPageScroll();if(d.x!==u.x&&d.y!==u.y){n.setPageScroll=function(f){document.body.scrollLeft=f.x,document.body.scrollTop=f.y};return}if(document.documentElement.scrollLeft=l.x,document.documentElement.scrollTop=l.y,d=n.getPageScroll(),d.x!==u.x&&d.y!==u.y){n.setPageScroll=function(f){document.documentElement.scrollLeft=f.x,document.documentElement.scrollTop=f.y};return}n.setPageScroll=function(f){}}n.setPageScroll(l)},getWindowSize:function(){var l=document.documentElement||{},u=document.body||{};if(typeof window.innerWidth=="number")n.getWindowSize=function(){return new n.Point(window.innerWidth,window.innerHeight)};else if(l.clientWidth||l.clientHeight)n.getWindowSize=function(){return new n.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(u.clientWidth||u.clientHeight)n.getWindowSize=function(){return new n.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return n.getWindowSize()},makeCenteredNode:function(l){l=n.getElement(l);var u=[n.makeNeutralElement("div"),n.makeNeutralElement("div"),n.makeNeutralElement("div")];return n.extend(u[0].style,{display:"table",height:"100%",width:"100%"}),n.extend(u[1].style,{display:"table-row"}),n.extend(u[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),u[0].appendChild(u[1]),u[1].appendChild(u[2]),u[2].appendChild(l),u[0]},makeNeutralElement:function(l){var u=document.createElement(l),d=u.style;return d.background="transparent none",d.border="none",d.margin="0px",d.padding="0px",d.position="static",u},now:function(){return Date.now?n.now=Date.now:n.now=function(){return new Date().getTime()},n.now()},makeTransparentImage:function(l){var u=n.makeNeutralElement("img");return u.src=l,u},setElementOpacity:function(l,u,d){var f,p;l=n.getElement(l),d&&!n.Browser.alpha&&(u=Math.round(u)),n.Browser.opacity?l.style.opacity=u<1?u:"":u<1?(f=Math.round(100*u),p="alpha(opacity="+f+")",l.style.filter=p):l.style.filter=""},setElementTouchActionNone:function(l){l=n.getElement(l),typeof l.style.touchAction<"u"?l.style.touchAction="none":typeof l.style.msTouchAction<"u"&&(l.style.msTouchAction="none")},setElementPointerEvents:function(l,u){l=n.getElement(l),typeof l.style<"u"&&typeof l.style.pointerEvents<"u"&&(l.style.pointerEvents=u)},setElementPointerEventsNone:function(l){n.setElementPointerEvents(l,"none")},addClass:function(l,u){l=n.getElement(l),l.className?(" "+l.className+" ").indexOf(" "+u+" ")===-1&&(l.className+=" "+u):l.className=u},indexOf:function(l,u,d){return Array.prototype.indexOf?this.indexOf=function(f,p,m){return f.indexOf(p,m)}:this.indexOf=function(f,p,m){var y,b=m||0,E;if(!f)throw new TypeError;if(E=f.length,E===0||b>=E)return-1;for(b<0&&(b=E-Math.abs(b)),y=b;y<E;y++)if(f[y]===p)return y;return-1},this.indexOf(l,u,d)},removeClass:function(l,u){var d,f=[],p;for(l=n.getElement(l),d=l.className.split(/\s+/),p=0;p<d.length;p++)d[p]&&d[p]!==u&&f.push(d[p]);l.className=f.join(" ")},normalizeEventListenerOptions:function(l){var u;return typeof l<"u"?typeof l=="boolean"?u=n.supportsEventListenerOptions?{capture:l}:l:u=n.supportsEventListenerOptions?l:typeof l.capture<"u"?l.capture:!1:u=n.supportsEventListenerOptions?{capture:!1}:!1,u},addEvent:(function(){if(n.supportsAddEventListener)return function(l,u,d,f){f=n.normalizeEventListenerOptions(f),l=n.getElement(l),l.addEventListener(u,d,f)};if(document.documentElement.attachEvent&&document.attachEvent)return function(l,u,d){l=n.getElement(l),l.attachEvent("on"+u,d)};throw new Error("No known event model.")})(),removeEvent:(function(){if(n.supportsRemoveEventListener)return function(l,u,d,f){f=n.normalizeEventListenerOptions(f),l=n.getElement(l),l.removeEventListener(u,d,f)};if(document.documentElement.detachEvent&&document.detachEvent)return function(l,u,d){l=n.getElement(l),l.detachEvent("on"+u,d)};throw new Error("No known event model.")})(),cancelEvent:function(l){l.preventDefault()},eventIsCanceled:function(l){return l.defaultPrevented},stopEvent:function(l){l.stopPropagation()},createCallback:function(l,u){var d=[],f;for(f=2;f<arguments.length;f++)d.push(arguments[f]);return function(){var p=d.concat([]),m;for(m=0;m<arguments.length;m++)p.push(arguments[m]);return u.apply(l,p)}},getUrlParameter:function(l){var u=a[l];return u||null},getUrlProtocol:function(l){var u=l.match(/^([a-z]+:)\/\//i);return u===null?window.location.protocol:u[1].toLowerCase()},createAjaxRequest:function(l){var u;try{u=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{u=!1}if(u)window.XMLHttpRequest?n.createAjaxRequest=function(d){return d?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:n.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)n.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return n.createAjaxRequest(l)},makeAjaxRequest:function(l,u,d){var f,p,m,y;n.isPlainObject(l)&&(u=l.success,d=l.error,f=l.withCredentials,p=l.headers,m=l.responseType||null,y=l.postData||null,l=l.url);var b=n.getUrlProtocol(l),E=n.createAjaxRequest(b==="file:");if(!n.isFunction(u))throw new Error("makeAjaxRequest requires a success callback");E.onreadystatechange=function(){E.readyState===4&&(E.onreadystatechange=function(){},E.status>=200&&E.status<300||E.status===0&&b!=="http:"&&b!=="https:"?u(E):n.isFunction(d)?d(E):n.console.error("AJAX request returned %d: %s",E.status,l))};var T=y?"POST":"GET";try{if(E.open(T,l,!0),m&&(E.responseType=m),p)for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&p[x]&&E.setRequestHeader(x,p[x]);f&&(E.withCredentials=!0),E.send(y)}catch(S){n.console.error("%s while making AJAX request: %s",S.name,S.message),E.onreadystatechange=function(){},n.isFunction(d)&&d(E,S)}return E},jsonp:function(l){var u,d=l.url,f=document.head||document.getElementsByTagName("head")[0]||document.documentElement,p=l.callbackName||"openseadragon"+n.now(),m=window[p],y="$1"+p+"$2",b=l.param||"callback",E=l.callback;d=d.replace(/(=)\?(&|$)|\?\?/i,y),d+=(/\?/.test(d)?"&":"?")+b+"="+p,window[p]=function(T){if(m)window[p]=m;else try{delete window[p]}catch{}E&&n.isFunction(E)&&E(T)},u=document.createElement("script"),(l.async!==void 0||l.async!==!1)&&(u.async="async"),l.scriptCharset&&(u.charset=l.scriptCharset),u.src=d,u.onload=u.onreadystatechange=function(T,x){(x||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,f&&u.parentNode&&f.removeChild(u),u=void 0)},f.insertBefore(u,f.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(l){if(window.DOMParser)n.parseXml=function(u){var d=null,f;return f=new DOMParser,d=f.parseFromString(u,"text/xml"),d};else if(window.ActiveXObject)n.parseXml=function(u){var d=null;return d=new ActiveXObject("Microsoft.XMLDOM"),d.async=!1,d.loadXML(u),d};else throw new Error("Browser doesn't support XML DOM.");return n.parseXml(l)},parseJSON:function(l){return n.parseJSON=window.JSON.parse,n.parseJSON(l)},imageFormatSupported:function(l){return l=l||"",!!s[l.toLowerCase()]},setImageFormatsSupported:function(l){n.extend(s,l)}});var r=function(l){};n.console=window.console||{log:r,debug:r,info:r,warn:r,error:r,assert:r},n.Browser={vendor:n.BROWSERS.UNKNOWN,version:0,alpha:!0};var s={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},a={};(function(){var l=navigator.appVersion,u=navigator.userAgent,d;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(n.Browser.vendor=n.BROWSERS.IE,n.Browser.version=parseFloat(u.substring(u.indexOf("MSIE")+5,u.indexOf(";",u.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(u.indexOf("Edge")>=0?(n.Browser.vendor=n.BROWSERS.EDGE,n.Browser.version=parseFloat(u.substring(u.indexOf("Edge")+5))):u.indexOf("Edg")>=0?(n.Browser.vendor=n.BROWSERS.CHROMEEDGE,n.Browser.version=parseFloat(u.substring(u.indexOf("Edg")+4))):u.indexOf("Firefox")>=0?(n.Browser.vendor=n.BROWSERS.FIREFOX,n.Browser.version=parseFloat(u.substring(u.indexOf("Firefox")+8))):u.indexOf("Safari")>=0?(n.Browser.vendor=u.indexOf("Chrome")>=0?n.BROWSERS.CHROME:n.BROWSERS.SAFARI,n.Browser.version=parseFloat(u.substring(u.substring(0,u.indexOf("Safari")).lastIndexOf("/")+1,u.indexOf("Safari")))):(d=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),d.exec(u)!==null&&(n.Browser.vendor=n.BROWSERS.IE,n.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":n.Browser.vendor=n.BROWSERS.OPERA,n.Browser.version=parseFloat(l);break}var f=window.location.search.substring(1),p=f.split("&"),m,y,b;for(b=0;b<p.length;b++)if(m=p[b],y=m.indexOf("="),y>0){var E=m.substring(0,y),T=m.substring(y+1);try{a[E]=decodeURIComponent(T)}catch{n.console.error("Ignoring malformed URL parameter: %s=%s",E,T)}}n.Browser.alpha=!(n.Browser.vendor===n.BROWSERS.CHROME&&n.Browser.version<2),n.Browser.opacity=!0,n.Browser.vendor===n.BROWSERS.IE&&n.Browser.version<11&&n.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon")})(),(function(l){var u=l.requestAnimationFrame||l.mozRequestAnimationFrame||l.webkitRequestAnimationFrame||l.msRequestAnimationFrame,d=l.cancelAnimationFrame||l.mozCancelAnimationFrame||l.webkitCancelAnimationFrame||l.msCancelAnimationFrame;if(u&&d)n.requestAnimationFrame=function(){return u.apply(l,arguments)},n.cancelAnimationFrame=function(){return d.apply(l,arguments)};else{var f=[],p=[],m=0,y;n.requestAnimationFrame=function(b){return f.push([++m,b]),y||(y=setInterval(function(){if(f.length){var E=n.now(),T=p;for(p=f,f=T;p.length;)p.shift()[1](E)}else clearInterval(y),y=void 0},1e3/50)),m},n.cancelAnimationFrame=function(b){var E,T;for(E=0,T=f.length;E<T;E+=1)if(f[E][0]===b){f.splice(E,1);return}for(E=0,T=p.length;E<T;E+=1)if(p[E][0]===b){p.splice(E,1);return}}}})(window);function o(l,u){return u&&l!==document.body?document.body:l.offsetParent}})(e),(function(n,i){t.exports?t.exports=i():n.OpenSeadragon=i()})(Wne,function(){return e}),(function(n){var i={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.fullscreenElement},i.requestFullScreen=function(r){return r.requestFullscreen()},i.exitFullScreen=function(){document.exitFullscreen()},i.fullScreenEventName="fullscreenchange",i.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.msFullscreenElement},i.requestFullScreen=function(r){return r.msRequestFullscreen()},i.exitFullScreen=function(){document.msExitFullscreen()},i.fullScreenEventName="MSFullscreenChange",i.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.webkitFullscreenElement},i.requestFullScreen=function(r){return r.webkitRequestFullscreen()},i.exitFullScreen=function(){document.webkitExitFullscreen()},i.fullScreenEventName="webkitfullscreenchange",i.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},i.requestFullScreen=function(r){return r.webkitRequestFullScreen()},i.exitFullScreen=function(){document.webkitCancelFullScreen()},i.fullScreenEventName="webkitfullscreenchange",i.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.mozFullScreenElement},i.requestFullScreen=function(r){return r.mozRequestFullScreen()},i.exitFullScreen=function(){document.mozCancelFullScreen()},i.fullScreenEventName="mozfullscreenchange",i.fullScreenErrorEventName="mozfullscreenerror"),i.isFullScreen=function(){return i.getFullScreenElement()!==null},i.cancelFullScreen=function(){n.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),i.exitFullScreen()},n.extend(n,i)})(e),(function(n){n.EventSource=function(){this.events={}},n.EventSource.prototype={addOnceHandler:function(i,r,s,a,o){var l=this;a=a||1;var u=0,d=function(f){return u++,u===a&&l.removeHandler(i,d),r(f)};this.addHandler(i,d,s,o)},addHandler:function(i,r,s,a){var o=this.events[i];if(o||(this.events[i]=o=[]),r&&n.isFunction(r)){var l=o.length,u={handler:r,userData:s||null,priority:a||0};for(o[l]=u;l>0&&o[l-1].priority<o[l].priority;)o[l]=o[l-1],o[l-1]=u,l--}},removeHandler:function(i,r){var s=this.events[i],a=[],o;if(s&&n.isArray(s)){for(o=0;o<s.length;o++)s[o].handler!==r&&a.push(s[o]);this.events[i]=a}},numberOfHandlers:function(i){var r=this.events[i];return r?r.length:0},removeAllHandlers:function(i){if(i)this.events[i]=[];else for(var r in this.events)this.events[r]=[]},getHandler:function(i){var r=this.events[i];return!r||!r.length?null:(r=r.length===1?[r[0]]:Array.apply(null,r),function(s,a){var o,l=r.length;for(o=0;o<l;o++)r[o]&&(a.eventSource=s,a.userData=r[o].userData,r[o].handler(a))})},raiseEvent:function(i,r){var s=this.getHandler(i);if(s)return s(this,r||{})}}})(e),(function(n){var i={};n.MouseTracker=function(B){var F=arguments;n.isPlainObject(B)||(B={element:F[0],clickTimeThreshold:F[1],clickDistThreshold:F[2]}),this.hash=Math.random(),this.element=n.getElement(B.element),this.clickTimeThreshold=B.clickTimeThreshold||n.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=B.clickDistThreshold||n.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=B.dblClickTimeThreshold||n.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=B.dblClickDistThreshold||n.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=B.userData||null,this.stopDelay=B.stopDelay||50,this.preProcessEventHandler=B.preProcessEventHandler||null,this.contextMenuHandler=B.contextMenuHandler||null,this.enterHandler=B.enterHandler||null,this.leaveHandler=B.leaveHandler||null,this.exitHandler=B.exitHandler||null,this.overHandler=B.overHandler||null,this.outHandler=B.outHandler||null,this.pressHandler=B.pressHandler||null,this.nonPrimaryPressHandler=B.nonPrimaryPressHandler||null,this.releaseHandler=B.releaseHandler||null,this.nonPrimaryReleaseHandler=B.nonPrimaryReleaseHandler||null,this.moveHandler=B.moveHandler||null,this.scrollHandler=B.scrollHandler||null,this.clickHandler=B.clickHandler||null,this.dblClickHandler=B.dblClickHandler||null,this.dragHandler=B.dragHandler||null,this.dragEndHandler=B.dragEndHandler||null,this.pinchHandler=B.pinchHandler||null,this.stopHandler=B.stopHandler||null,this.keyDownHandler=B.keyDownHandler||null,this.keyUpHandler=B.keyUpHandler||null,this.keyHandler=B.keyHandler||null,this.focusHandler=B.focusHandler||null,this.blurHandler=B.blurHandler||null;var Y=this;i[this.hash]={click:function(Z){S(Y,Z)},dblclick:function(Z){w(Y,Z)},keydown:function(Z){C(Y,Z)},keyup:function(Z){I(Y,Z)},keypress:function(Z){L(Y,Z)},focus:function(Z){N(Y,Z)},blur:function(Z){G(Y,Z)},contextmenu:function(Z){O(Y,Z)},wheel:function(Z){D(Y,Z)},mousewheel:function(Z){V(Y,Z)},DOMMouseScroll:function(Z){V(Y,Z)},MozMousePixelScroll:function(Z){V(Y,Z)},losecapture:function(Z){J(Y,Z)},mouseenter:function(Z){q(Y,Z)},mouseleave:function(Z){ye(Y,Z)},mouseover:function(Z){Pe(Y,Z)},mouseout:function(Z){we(Y,Z)},mousedown:function(Z){Me(Y,Z)},mouseup:function(Z){Fe(Y,Z)},mousemove:function(Z){fe(Y,Z)},touchstart:function(Z){K(Y,Z)},touchend:function(Z){j(Y,Z)},touchmove:function(Z){te(Y,Z)},touchcancel:function(Z){ne(Y,Z)},gesturestart:function(Z){oe(Y,Z)},gesturechange:function(Z){P(Y,Z)},gotpointercapture:function(Z){ie(Y,Z)},lostpointercapture:function(Z){le(Y,Z)},pointerenter:function(Z){q(Y,Z)},pointerleave:function(Z){ye(Y,Z)},pointerover:function(Z){Pe(Y,Z)},pointerout:function(Z){we(Y,Z)},pointerdown:function(Z){Me(Y,Z)},pointerup:function(Z){Fe(Y,Z)},pointermove:function(Z){fe(Y,Z)},pointercancel:function(Z){Ke(Y,Z)},pointerupcaptured:function(Z){$e(Y,Z)},pointermovecaptured:function(Z){Ie(Y,Z)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,n.MouseTracker.havePointerEvents&&n.setElementPointerEvents(this.element,"auto"),this.exitHandler&&n.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),B.startDisabled||this.setTracking(!0)},n.MouseTracker.prototype={destroy:function(){l(this),this.element=null,i[this.hash]=null,delete i[this.hash]},isTracking:function(){return i[this.hash].tracking},setTracking:function(B){return B?o(this):l(this),this},getActivePointersListByType:function(B){var F=i[this.hash],Y,Z=F.activePointersLists.length,xe;for(Y=0;Y<Z;Y++)if(F.activePointersLists[Y].type===B)return F.activePointersLists[Y];return xe=new n.MouseTracker.GesturePointList(B),F.activePointersLists.push(xe),xe},getActivePointerCount:function(){var B=i[this.hash],F,Y=B.activePointersLists.length,Z=0;for(F=0;F<Y;F++)Z+=B.activePointersLists[F].getLength();return Z},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var r=(function(){try{return window.self!==window.top}catch{return!0}})();function s(B){try{return B.addEventListener&&B.removeEventListener}catch{return!1}}n.MouseTracker.gesturePointVelocityTracker=(function(){var B=[],F=0,Y=0,Z=function(lt,tt){return lt.hash.toString()+tt.type+tt.id.toString()},xe=function(){var lt,tt=B.length,Zt,cn,Fr=n.now(),To,xs,od;for(To=Fr-Y,Y=Fr,lt=0;lt<tt;lt++)Zt=B[lt],cn=Zt.gPoint,cn.direction=Math.atan2(cn.currentPos.y-Zt.lastPos.y,cn.currentPos.x-Zt.lastPos.x),xs=Zt.lastPos.distanceTo(cn.currentPos),Zt.lastPos=cn.currentPos,od=1e3*xs/(To+1),cn.speed=.75*od+.25*cn.speed},Be=function(lt,tt){var Zt=Z(lt,tt);B.push({guid:Zt,gPoint:tt,lastPos:tt.currentPos}),B.length===1&&(Y=n.now(),F=window.setInterval(xe,50))},Ze=function(lt,tt){var Zt=Z(lt,tt),cn,Fr=B.length;for(cn=0;cn<Fr;cn++)if(B[cn].guid===Zt){B.splice(cn,1),Fr--,Fr===0&&window.clearInterval(F);break}};return{addPoint:Be,removePoint:Ze}})(),n.MouseTracker.captureElement=document,n.MouseTracker.wheelEventName=n.Browser.vendor===n.BROWSERS.IE&&n.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",n.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",n.MouseTracker.wheelEventName],n.MouseTracker.wheelEventName==="DOMMouseScroll"&&n.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(n.MouseTracker.havePointerEvents=!0,n.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),n.MouseTracker.havePointerCapture=(function(){var B=document.createElement("div");return n.isFunction(B.setPointerCapture)&&n.isFunction(B.releasePointerCapture)})(),n.MouseTracker.havePointerCapture&&n.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(n.MouseTracker.havePointerEvents=!1,n.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),n.MouseTracker.mousePointerId="legacy-mouse",n.MouseTracker.havePointerCapture=(function(){var B=document.createElement("div");return n.isFunction(B.setCapture)&&n.isFunction(B.releaseCapture)})(),n.MouseTracker.havePointerCapture&&n.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&n.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&n.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),n.MouseTracker.GesturePointList=function(B){this._gPoints=[],this.type=B,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},n.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(B){return this._gPoints.push(B)},removeById:function(B){var F,Y=this._gPoints.length;for(F=0;F<Y;F++)if(this._gPoints[F].id===B){this._gPoints.splice(F,1);break}return this._gPoints.length},getByIndex:function(B){return B<this._gPoints.length?this._gPoints[B]:null},getById:function(B){var F,Y=this._gPoints.length;for(F=0;F<Y;F++)if(this._gPoints[F].id===B)return this._gPoints[F];return null},getPrimary:function(B){var F,Y=this._gPoints.length;for(F=0;F<Y;F++)if(this._gPoints[F].isPrimary)return this._gPoints[F];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(n.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function a(B){var F=i[B.hash],Y,Z,xe,Be,Ze,lt=F.activePointersLists.length;for(Y=0;Y<lt;Y++)if(xe=F.activePointersLists[Y],xe.getLength()>0){for(Ze=[],Be=xe.asArray(),Z=0;Z<Be.length;Z++)Ze.push(Be[Z]);for(Z=0;Z<Ze.length;Z++)Qe(B,xe,Ze[Z])}for(Y=0;Y<lt;Y++)F.activePointersLists.pop();F.sentDragEvent=!1}function o(B){var F=i[B.hash],Y,Z;if(!F.tracking){for(Z=0;Z<n.MouseTracker.subscribeEvents.length;Z++)Y=n.MouseTracker.subscribeEvents[Z],n.addEvent(B.element,Y,F[Y],Y===n.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);a(B),F.tracking=!0}}function l(B){var F=i[B.hash],Y,Z;if(F.tracking){for(Z=0;Z<n.MouseTracker.subscribeEvents.length;Z++)Y=n.MouseTracker.subscribeEvents[Z],n.removeEvent(B.element,Y,F[Y],!1);a(B),F.tracking=!1}}function u(B,F){var Y=i[B.hash];if(F==="pointerevent")return{upName:"pointerup",upHandler:Y.pointerupcaptured,moveName:"pointermove",moveHandler:Y.pointermovecaptured};if(F==="mouse")return{upName:"pointerup",upHandler:Y.pointerupcaptured,moveName:"pointermove",moveHandler:Y.pointermovecaptured};if(F==="touch")return{upName:"touchend",upHandler:Y.touchendcaptured,moveName:"touchmove",moveHandler:Y.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function d(B,F){var Y;if(n.MouseTracker.havePointerCapture)if(n.MouseTracker.havePointerEvents)try{B.element.setPointerCapture(F.id)}catch{n.console.warn("setPointerCapture() called on invalid pointer ID");return}else B.element.setCapture(!0);else Y=u(B,n.MouseTracker.havePointerEvents?"pointerevent":F.type),r&&s(window.top)&&n.addEvent(window.top,Y.upName,Y.upHandler,!0),n.addEvent(n.MouseTracker.captureElement,Y.upName,Y.upHandler,!0),n.addEvent(n.MouseTracker.captureElement,Y.moveName,Y.moveHandler,!0);ue(B,F,!0)}function f(B,F){var Y,Z,xe;if(n.MouseTracker.havePointerCapture)if(n.MouseTracker.havePointerEvents){if(Z=B.getActivePointersListByType(F.type),xe=Z.getById(F.id),!xe||!xe.captured)return;try{B.element.releasePointerCapture(F.id)}catch{}}else B.element.releaseCapture();else Y=u(B,n.MouseTracker.havePointerEvents?"pointerevent":F.type),r&&s(window.top)&&n.removeEvent(window.top,Y.upName,Y.upHandler,!0),n.removeEvent(n.MouseTracker.captureElement,Y.moveName,Y.moveHandler,!0),n.removeEvent(n.MouseTracker.captureElement,Y.upName,Y.upHandler,!0);ue(B,F,!1)}function p(B){return n.MouseTracker.havePointerEvents?B.pointerId:n.MouseTracker.mousePointerId}function m(B){return n.MouseTracker.havePointerEvents?B.pointerType||(n.Browser.vendor===n.BROWSERS.IE?"mouse":""):"mouse"}function y(B){return n.MouseTracker.havePointerEvents?B.isPrimary:!0}function b(B){return n.getMousePosition(B)}function E(B,F){return T(b(B),F)}function T(B,F){var Y=n.getElementOffset(F);return B.minus(Y)}function x(B,F){return new n.Point((B.x+F.x)/2,(B.y+F.y)/2)}function S(B,F){var Y={originalEvent:F,eventType:"click",pointerType:"mouse",isEmulated:!1};X(B,Y),Y.preventDefault&&!Y.defaultPrevented&&n.cancelEvent(F),Y.stopPropagation&&n.stopEvent(F)}function w(B,F){var Y={originalEvent:F,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};X(B,Y),Y.preventDefault&&!Y.defaultPrevented&&n.cancelEvent(F),Y.stopPropagation&&n.stopEvent(F)}function C(B,F){var Y=null,Z={originalEvent:F,eventType:"keydown",pointerType:"",isEmulated:!1};X(B,Z),B.keyDownHandler&&!Z.preventGesture&&!Z.defaultPrevented&&(Y={eventSource:B,keyCode:F.keyCode?F.keyCode:F.charCode,ctrl:F.ctrlKey,shift:F.shiftKey,alt:F.altKey,meta:F.metaKey,originalEvent:F,preventDefault:Z.preventDefault||Z.defaultPrevented,userData:B.userData},B.keyDownHandler(Y)),(Y&&Y.preventDefault||Z.preventDefault&&!Z.defaultPrevented)&&n.cancelEvent(F),Z.stopPropagation&&n.stopEvent(F)}function I(B,F){var Y=null,Z={originalEvent:F,eventType:"keyup",pointerType:"",isEmulated:!1};X(B,Z),B.keyUpHandler&&!Z.preventGesture&&!Z.defaultPrevented&&(Y={eventSource:B,keyCode:F.keyCode?F.keyCode:F.charCode,ctrl:F.ctrlKey,shift:F.shiftKey,alt:F.altKey,meta:F.metaKey,originalEvent:F,preventDefault:Z.preventDefault||Z.defaultPrevented,userData:B.userData},B.keyUpHandler(Y)),(Y&&Y.preventDefault||Z.preventDefault&&!Z.defaultPrevented)&&n.cancelEvent(F),Z.stopPropagation&&n.stopEvent(F)}function L(B,F){var Y=null,Z={originalEvent:F,eventType:"keypress",pointerType:"",isEmulated:!1};X(B,Z),B.keyHandler&&!Z.preventGesture&&!Z.defaultPrevented&&(Y={eventSource:B,keyCode:F.keyCode?F.keyCode:F.charCode,ctrl:F.ctrlKey,shift:F.shiftKey,alt:F.altKey,meta:F.metaKey,originalEvent:F,preventDefault:Z.preventDefault||Z.defaultPrevented,userData:B.userData},B.keyHandler(Y)),(Y&&Y.preventDefault||Z.preventDefault&&!Z.defaultPrevented)&&n.cancelEvent(F),Z.stopPropagation&&n.stopEvent(F)}function N(B,F){var Y={originalEvent:F,eventType:"focus",pointerType:"",isEmulated:!1};X(B,Y),B.focusHandler&&!Y.preventGesture&&B.focusHandler({eventSource:B,originalEvent:F,userData:B.userData})}function G(B,F){var Y={originalEvent:F,eventType:"blur",pointerType:"",isEmulated:!1};X(B,Y),B.blurHandler&&!Y.preventGesture&&B.blurHandler({eventSource:B,originalEvent:F,userData:B.userData})}function O(B,F){var Y=null,Z={originalEvent:F,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};X(B,Z),B.contextMenuHandler&&!Z.preventGesture&&!Z.defaultPrevented&&(Y={eventSource:B,position:T(b(F),B.element),originalEvent:Z.originalEvent,preventDefault:Z.preventDefault||Z.defaultPrevented,userData:B.userData},B.contextMenuHandler(Y)),(Y&&Y.preventDefault||Z.preventDefault&&!Z.defaultPrevented)&&n.cancelEvent(F),Z.stopPropagation&&n.stopEvent(F)}function D(B,F){$(B,F,F)}function V(B,F){var Y={target:F.target||F.srcElement,type:"wheel",shiftKey:F.shiftKey||!1,clientX:F.clientX,clientY:F.clientY,pageX:F.pageX?F.pageX:F.clientX,pageY:F.pageY?F.pageY:F.clientY,deltaMode:F.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};n.MouseTracker.wheelEventName==="mousewheel"?Y.deltaY=-F.wheelDelta/n.DEFAULT_SETTINGS.pixelsPerWheelLine:Y.deltaY=F.detail,$(B,Y,F)}function $(B,F,Y){var Z=0,xe,Be=null;Z=F.deltaY<0?1:-1,xe={originalEvent:F,eventType:"wheel",pointerType:"mouse",isEmulated:F!==Y},X(B,xe),B.scrollHandler&&!xe.preventGesture&&!xe.defaultPrevented&&(Be={eventSource:B,pointerType:"mouse",position:E(F,B.element),scroll:Z,shift:F.shiftKey,isTouchEvent:!1,originalEvent:Y,preventDefault:xe.preventDefault||xe.defaultPrevented,userData:B.userData},B.scrollHandler(Be)),xe.stopPropagation&&n.stopEvent(Y),(Be&&Be.preventDefault||xe.preventDefault&&!xe.defaultPrevented)&&n.cancelEvent(Y)}function J(B,F){var Y={id:n.MouseTracker.mousePointerId,type:"mouse"},Z={originalEvent:F,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};X(B,Z),F.target===B.element&&ue(B,Y,!1),Z.stopPropagation&&n.stopEvent(F)}function K(B,F){var Y,Z,xe=F.changedTouches.length,Be,Ze=B.getActivePointersListByType("touch");Y=n.now(),Ze.getLength()>F.touches.length-xe&&n.console.warn("Tracked touch contact count doesn't match event.touches.length");var lt={originalEvent:F,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(X(B,lt),Z=0;Z<xe;Z++)Be={id:F.changedTouches[Z].identifier,type:"touch",isPrimary:Ze.getLength()===0,currentPos:b(F.changedTouches[Z]),currentTime:Y},Se(B,lt,Be),dt(B,lt,Be,0),ue(B,Be,!0);lt.preventDefault&&!lt.defaultPrevented&&n.cancelEvent(F),lt.stopPropagation&&n.stopEvent(F)}function j(B,F){var Y,Z,xe=F.changedTouches.length,Be;Y=n.now();var Ze={originalEvent:F,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(X(B,Ze),Z=0;Z<xe;Z++)Be={id:F.changedTouches[Z].identifier,type:"touch",currentPos:b(F.changedTouches[Z]),currentTime:Y},mt(B,Ze,Be,0),ue(B,Be,!1),Oe(B,Ze,Be);Ze.preventDefault&&!Ze.defaultPrevented&&n.cancelEvent(F),Ze.stopPropagation&&n.stopEvent(F)}function te(B,F){var Y,Z,xe=F.changedTouches.length,Be;Y=n.now();var Ze={originalEvent:F,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(X(B,Ze),Z=0;Z<xe;Z++)Be={id:F.changedTouches[Z].identifier,type:"touch",currentPos:b(F.changedTouches[Z]),currentTime:Y},he(B,Ze,Be);Ze.preventDefault&&!Ze.defaultPrevented&&n.cancelEvent(F),Ze.stopPropagation&&n.stopEvent(F)}function ne(B,F){var Y=F.changedTouches.length,Z,xe,Be={originalEvent:F,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(X(B,Be),Z=0;Z<Y;Z++)xe={id:F.changedTouches[Z].identifier,type:"touch"},Te(B,Be,xe);Be.stopPropagation&&n.stopEvent(F)}function oe(B,F){return n.eventIsCanceled(F)||F.preventDefault(),!1}function P(B,F){return n.eventIsCanceled(F)||F.preventDefault(),!1}function ie(B,F){var Y={originalEvent:F,eventType:"gotpointercapture",pointerType:m(F),isEmulated:!1};X(B,Y),F.target===B.element&&ue(B,{id:F.pointerId,type:m(F)},!0),Y.stopPropagation&&n.stopEvent(F)}function le(B,F){var Y={originalEvent:F,eventType:"lostpointercapture",pointerType:m(F),isEmulated:!1};X(B,Y),F.target===B.element&&ue(B,{id:F.pointerId,type:m(F)},!1),Y.stopPropagation&&n.stopEvent(F)}function q(B,F){var Y={id:p(F),type:m(F),isPrimary:y(F),currentPos:b(F),currentTime:n.now()},Z={originalEvent:F,eventType:"pointerenter",pointerType:Y.type,isEmulated:!1};X(B,Z),Se(B,Z,Y)}function ye(B,F){var Y={id:p(F),type:m(F),isPrimary:y(F),currentPos:b(F),currentTime:n.now()},Z={originalEvent:F,eventType:"pointerleave",pointerType:Y.type,isEmulated:!1};X(B,Z),Oe(B,Z,Y)}function Pe(B,F){var Y={id:p(F),type:m(F),isPrimary:y(F),currentPos:b(F),currentTime:n.now()},Z={originalEvent:F,eventType:"pointerover",pointerType:Y.type,isEmulated:!1};X(B,Z),ze(B,Z,Y),Z.preventDefault&&!Z.defaultPrevented&&n.cancelEvent(F),Z.stopPropagation&&n.stopEvent(F)}function we(B,F){var Y={id:p(F),type:m(F),isPrimary:y(F),currentPos:b(F),currentTime:n.now()},Z={originalEvent:F,eventType:"pointerout",pointerType:Y.type,isEmulated:!1};X(B,Z),Ne(B,Z,Y),Z.preventDefault&&!Z.defaultPrevented&&n.cancelEvent(F),Z.stopPropagation&&n.stopEvent(F)}function Me(B,F){var Y={id:p(F),type:m(F),isPrimary:y(F),currentPos:b(F),currentTime:n.now()},Z=n.MouseTracker.havePointerEvents&&Y.type==="touch"&&n.Browser.vendor!==n.BROWSERS.IE,xe={originalEvent:F,eventType:"pointerdown",pointerType:Y.type,isEmulated:!1};X(B,xe),dt(B,xe,Y,F.button),xe.preventDefault&&!xe.defaultPrevented&&n.cancelEvent(F),xe.stopPropagation&&n.stopEvent(F),xe.shouldCapture&&(Z?ue(B,Y,!0):d(B,Y))}function Fe(B,F){Ye(B,F)}function $e(B,F){var Y=B.getActivePointersListByType(m(F));Y.getById(F.pointerId)&&Ye(B,F),n.stopEvent(F)}function Ye(B,F){var Y;Y={id:p(F),type:m(F),isPrimary:y(F),currentPos:b(F),currentTime:n.now()};var Z={originalEvent:F,eventType:"pointerup",pointerType:Y.type,isEmulated:!1};X(B,Z),mt(B,Z,Y,F.button),Z.preventDefault&&!Z.defaultPrevented&&n.cancelEvent(F),Z.stopPropagation&&n.stopEvent(F),Z.shouldReleaseCapture&&(F.target===B.element?f(B,Y):ue(B,Y,!1))}function fe(B,F){Le(B,F)}function Ie(B,F){var Y=B.getActivePointersListByType(m(F));Y.getById(F.pointerId)&&Le(B,F),n.stopEvent(F)}function Le(B,F){var Y={id:p(F),type:m(F),isPrimary:y(F),currentPos:b(F),currentTime:n.now()},Z={originalEvent:F,eventType:"pointermove",pointerType:Y.type,isEmulated:!1};X(B,Z),he(B,Z,Y),Z.preventDefault&&!Z.defaultPrevented&&n.cancelEvent(F),Z.stopPropagation&&n.stopEvent(F)}function Ke(B,F){var Y={id:F.pointerId,type:m(F)},Z={originalEvent:F,eventType:"pointercancel",pointerType:Y.type,isEmulated:!1};X(B,Z),Te(B,Z,Y),Z.stopPropagation&&n.stopEvent(F)}function Lt(B,F){return F.speed=0,F.direction=0,F.contactPos=F.currentPos,F.contactTime=F.currentTime,F.lastPos=F.currentPos,F.lastTime=F.currentTime,B.add(F)}function Qe(B,F,Y){var Z,xe=F.getById(Y.id);return xe?(xe.captured&&(n.console.warn("stopTrackingPointer() called on captured pointer"),f(B,xe)),F.removeContact(),Z=F.removeById(Y.id)):Z=F.getLength(),Z}function k(B,F){switch(F.eventType){case"pointermove":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!B.hasGestureHandlers,F.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!1,F.stopPropagation=!1;break;case"pointerdown":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!B.hasGestureHandlers,F.stopPropagation=!1;break;case"pointerup":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!B.hasGestureHandlers,F.stopPropagation=!1;break;case"wheel":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!B.hasScrollHandler,F.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":F.isStoppable=!0,F.isCancelable=!1,F.preventDefault=!1,F.preventGesture=!1,F.stopPropagation=!1;break;case"click":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!!B.clickHandler,F.preventGesture=!1,F.stopPropagation=!1;break;case"dblclick":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!!B.dblClickHandler,F.preventGesture=!1,F.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:F.isStoppable=!1,F.isCancelable=!1,F.preventDefault=!1,F.preventGesture=!1,F.stopPropagation=!1;break}}function X(B,F){F.eventSource=B,F.eventPhase=F.originalEvent&&typeof F.originalEvent.eventPhase<"u"?F.originalEvent.eventPhase:0,F.defaultPrevented=n.eventIsCanceled(F.originalEvent),F.shouldCapture=!1,F.shouldReleaseCapture=!1,F.userData=B.userData,k(B,F),B.preProcessEventHandler&&B.preProcessEventHandler(F)}function ue(B,F,Y){var Z=B.getActivePointersListByType(F.type),xe=Z.getById(F.id);xe?Y&&!xe.captured?(xe.captured=!0,Z.captureCount++):!Y&&xe.captured&&(xe.captured=!1,Z.captureCount--,Z.captureCount<0&&(Z.captureCount=0,n.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):n.console.warn("updatePointerCaptured() called on untracked pointer")}function Se(B,F,Y){var Z=B.getActivePointersListByType(Y.type),xe;xe=Z.getById(Y.id),xe?(xe.insideElement=!0,xe.lastPos=xe.currentPos,xe.lastTime=xe.currentTime,xe.currentPos=Y.currentPos,xe.currentTime=Y.currentTime,Y=xe):(Y.captured=!1,Y.insideElementPressed=!1,Y.insideElement=!0,Lt(Z,Y)),B.enterHandler&&B.enterHandler({eventSource:B,pointerType:Y.type,position:T(Y.currentPos,B.element),buttons:Z.buttons,pointers:B.getActivePointerCount(),insideElementPressed:Y.insideElementPressed,buttonDownAny:Z.buttons!==0,isTouchEvent:Y.type==="touch",originalEvent:F.originalEvent,userData:B.userData})}function Oe(B,F,Y){var Z=B.getActivePointersListByType(Y.type),xe,Be;xe=Z.getById(Y.id),xe?(xe.captured?(xe.insideElement=!1,xe.lastPos=xe.currentPos,xe.lastTime=xe.currentTime,xe.currentPos=Y.currentPos,xe.currentTime=Y.currentTime):Qe(B,Z,xe),Y=xe):(Y.captured=!1,Y.insideElementPressed=!1),(B.leaveHandler||B.exitHandler)&&(Be={eventSource:B,pointerType:Y.type,position:Y.currentPos&&T(Y.currentPos,B.element),buttons:Z.buttons,pointers:B.getActivePointerCount(),insideElementPressed:Y.insideElementPressed,buttonDownAny:Z.buttons!==0,isTouchEvent:Y.type==="touch",originalEvent:F.originalEvent,userData:B.userData},B.leaveHandler&&B.leaveHandler(Be),B.exitHandler&&B.exitHandler(Be))}function ze(B,F,Y){var Z,xe;Z=B.getActivePointersListByType(Y.type),xe=Z.getById(Y.id),xe?Y=xe:(Y.captured=!1,Y.insideElementPressed=!1),B.overHandler&&B.overHandler({eventSource:B,pointerType:Y.type,position:T(Y.currentPos,B.element),buttons:Z.buttons,pointers:B.getActivePointerCount(),insideElementPressed:Y.insideElementPressed,buttonDownAny:Z.buttons!==0,isTouchEvent:Y.type==="touch",originalEvent:F.originalEvent,userData:B.userData})}function Ne(B,F,Y){var Z,xe;Z=B.getActivePointersListByType(Y.type),xe=Z.getById(Y.id),xe?Y=xe:(Y.captured=!1,Y.insideElementPressed=!1),B.outHandler&&B.outHandler({eventSource:B,pointerType:Y.type,position:Y.currentPos&&T(Y.currentPos,B.element),buttons:Z.buttons,pointers:B.getActivePointerCount(),insideElementPressed:Y.insideElementPressed,buttonDownAny:Z.buttons!==0,isTouchEvent:Y.type==="touch",originalEvent:F.originalEvent,userData:B.userData})}function dt(B,F,Y,Z){var xe=i[B.hash],Be=B.getActivePointersListByType(Y.type),Ze;if(typeof F.originalEvent.buttons<"u"?Be.buttons=F.originalEvent.buttons:Z===0?Be.buttons|=1:Z===1?Be.buttons|=4:Z===2?Be.buttons|=2:Z===3?Be.buttons|=8:Z===4?Be.buttons|=16:Z===5&&(Be.buttons|=32),Z!==0){F.shouldCapture=!1,F.shouldReleaseCapture=!1,B.nonPrimaryPressHandler&&!F.preventGesture&&!F.defaultPrevented&&(F.preventDefault=!0,B.nonPrimaryPressHandler({eventSource:B,pointerType:Y.type,position:T(Y.currentPos,B.element),button:Z,buttons:Be.buttons,isTouchEvent:Y.type==="touch",originalEvent:F.originalEvent,userData:B.userData}));return}Ze=Be.getById(Y.id),Ze?(Ze.insideElementPressed=!0,Ze.insideElement=!0,Ze.originalTarget=F.originalEvent.target,Ze.contactPos=Y.currentPos,Ze.contactTime=Y.currentTime,Ze.lastPos=Ze.currentPos,Ze.lastTime=Ze.currentTime,Ze.currentPos=Y.currentPos,Ze.currentTime=Y.currentTime,Y=Ze):(Y.captured=!1,Y.insideElementPressed=!0,Y.insideElement=!0,Y.originalTarget=F.originalEvent.target,Lt(Be,Y)),Be.addContact(),!F.preventGesture&&!F.defaultPrevented?(F.shouldCapture=!0,F.shouldReleaseCapture=!1,F.preventDefault=!0,(B.dragHandler||B.dragEndHandler||B.pinchHandler)&&n.MouseTracker.gesturePointVelocityTracker.addPoint(B,Y),Be.contacts===1?B.pressHandler&&!F.preventGesture&&B.pressHandler({eventSource:B,pointerType:Y.type,position:T(Y.contactPos,B.element),buttons:Be.buttons,isTouchEvent:Y.type==="touch",originalEvent:F.originalEvent,userData:B.userData}):Be.contacts===2&&B.pinchHandler&&Y.type==="touch"&&(xe.pinchGPoints=Be.asArray(),xe.lastPinchDist=xe.currentPinchDist=xe.pinchGPoints[0].currentPos.distanceTo(xe.pinchGPoints[1].currentPos),xe.lastPinchCenter=xe.currentPinchCenter=x(xe.pinchGPoints[0].currentPos,xe.pinchGPoints[1].currentPos))):(F.shouldCapture=!1,F.shouldReleaseCapture=!1)}function mt(B,F,Y,Z){var xe=i[B.hash],Be=B.getActivePointersListByType(Y.type),Ze,lt,tt,Zt=!1,cn;if(typeof F.originalEvent.buttons<"u"?Be.buttons=F.originalEvent.buttons:Z===0?Be.buttons^=-2:Z===1?Be.buttons^=-5:Z===2?Be.buttons^=-3:Z===3?Be.buttons^=-9:Z===4?Be.buttons^=-17:Z===5&&(Be.buttons^=-33),F.shouldCapture=!1,Z!==0){F.shouldReleaseCapture=!1,B.nonPrimaryReleaseHandler&&!F.preventGesture&&!F.defaultPrevented&&(F.preventDefault=!0,B.nonPrimaryReleaseHandler({eventSource:B,pointerType:Y.type,position:T(Y.currentPos,B.element),button:Z,buttons:Be.buttons,isTouchEvent:Y.type==="touch",originalEvent:F.originalEvent,userData:B.userData}));return}tt=Be.getById(Y.id),tt?(Be.removeContact(),tt.captured&&(Zt=!0),tt.lastPos=tt.currentPos,tt.lastTime=tt.currentTime,tt.currentPos=Y.currentPos,tt.currentTime=Y.currentTime,tt.insideElement||Qe(B,Be,tt),Ze=tt.currentPos,lt=tt.currentTime):(Y.captured=!1,Y.insideElementPressed=!1,Y.insideElement=!0,Lt(Be,Y),tt=Y),!F.preventGesture&&!F.defaultPrevented&&(Zt?(F.shouldReleaseCapture=!0,F.preventDefault=!0,(B.dragHandler||B.dragEndHandler||B.pinchHandler)&&n.MouseTracker.gesturePointVelocityTracker.removePoint(B,tt),Be.contacts===0?(B.releaseHandler&&Ze&&B.releaseHandler({eventSource:B,pointerType:tt.type,position:T(Ze,B.element),buttons:Be.buttons,insideElementPressed:tt.insideElementPressed,insideElementReleased:tt.insideElement,isTouchEvent:tt.type==="touch",originalEvent:F.originalEvent,userData:B.userData}),B.dragEndHandler&&xe.sentDragEvent&&B.dragEndHandler({eventSource:B,pointerType:tt.type,position:T(tt.currentPos,B.element),speed:tt.speed,direction:tt.direction,shift:F.originalEvent.shiftKey,isTouchEvent:tt.type==="touch",originalEvent:F.originalEvent,userData:B.userData}),xe.sentDragEvent=!1,(B.clickHandler||B.dblClickHandler)&&tt.insideElement&&(cn=lt-tt.contactTime<=B.clickTimeThreshold&&tt.contactPos.distanceTo(Ze)<=B.clickDistThreshold,B.clickHandler&&B.clickHandler({eventSource:B,pointerType:tt.type,position:T(tt.currentPos,B.element),quick:cn,shift:F.originalEvent.shiftKey,isTouchEvent:tt.type==="touch",originalEvent:F.originalEvent,originalTarget:tt.originalTarget,userData:B.userData}),B.dblClickHandler&&cn&&(Be.clicks++,Be.clicks===1?(xe.lastClickPos=Ze,xe.dblClickTimeOut=setTimeout(function(){Be.clicks=0},B.dblClickTimeThreshold)):Be.clicks===2&&(clearTimeout(xe.dblClickTimeOut),Be.clicks=0,xe.lastClickPos.distanceTo(Ze)<=B.dblClickDistThreshold&&B.dblClickHandler({eventSource:B,pointerType:tt.type,position:T(tt.currentPos,B.element),shift:F.originalEvent.shiftKey,isTouchEvent:tt.type==="touch",originalEvent:F.originalEvent,userData:B.userData}),xe.lastClickPos=null)))):Be.contacts===2&&B.pinchHandler&&tt.type==="touch"&&(xe.pinchGPoints=Be.asArray(),xe.lastPinchDist=xe.currentPinchDist=xe.pinchGPoints[0].currentPos.distanceTo(xe.pinchGPoints[1].currentPos),xe.lastPinchCenter=xe.currentPinchCenter=x(xe.pinchGPoints[0].currentPos,xe.pinchGPoints[1].currentPos))):(F.shouldReleaseCapture=!1,B.releaseHandler&&Ze&&(B.releaseHandler({eventSource:B,pointerType:tt.type,position:T(Ze,B.element),buttons:Be.buttons,insideElementPressed:tt.insideElementPressed,insideElementReleased:tt.insideElement,isTouchEvent:tt.type==="touch",originalEvent:F.originalEvent,userData:B.userData}),F.preventDefault=!0)))}function he(B,F,Y){var Z=i[B.hash],xe=B.getActivePointersListByType(Y.type),Be,Ze,lt;if(typeof F.originalEvent.buttons<"u"&&(xe.buttons=F.originalEvent.buttons),Be=xe.getById(Y.id),Be)Be.lastPos=Be.currentPos,Be.lastTime=Be.currentTime,Be.currentPos=Y.currentPos,Be.currentTime=Y.currentTime;else return;F.shouldCapture=!1,F.shouldReleaseCapture=!1,B.stopHandler&&Y.type==="mouse"&&(clearTimeout(B.stopTimeOut),B.stopTimeOut=setTimeout(function(){je(B,F.originalEvent,Y.type)},B.stopDelay)),xe.contacts===0?B.moveHandler&&B.moveHandler({eventSource:B,pointerType:Y.type,position:T(Y.currentPos,B.element),buttons:xe.buttons,isTouchEvent:Y.type==="touch",originalEvent:F.originalEvent,userData:B.userData}):xe.contacts===1?(B.moveHandler&&(Be=xe.asArray()[0],B.moveHandler({eventSource:B,pointerType:Be.type,position:T(Be.currentPos,B.element),buttons:xe.buttons,isTouchEvent:Be.type==="touch",originalEvent:F.originalEvent,userData:B.userData})),B.dragHandler&&!F.preventGesture&&!F.defaultPrevented&&(Be=xe.asArray()[0],lt=Be.currentPos.minus(Be.lastPos),B.dragHandler({eventSource:B,pointerType:Be.type,position:T(Be.currentPos,B.element),buttons:xe.buttons,delta:lt,speed:Be.speed,direction:Be.direction,shift:F.originalEvent.shiftKey,isTouchEvent:Be.type==="touch",originalEvent:F.originalEvent,userData:B.userData}),F.preventDefault=!0,Z.sentDragEvent=!0)):xe.contacts===2&&(B.moveHandler&&(Ze=xe.asArray(),B.moveHandler({eventSource:B,pointerType:Ze[0].type,position:T(x(Ze[0].currentPos,Ze[1].currentPos),B.element),buttons:xe.buttons,isTouchEvent:Ze[0].type==="touch",originalEvent:F.originalEvent,userData:B.userData})),B.pinchHandler&&Y.type==="touch"&&!F.preventGesture&&!F.defaultPrevented&&(lt=Z.pinchGPoints[0].currentPos.distanceTo(Z.pinchGPoints[1].currentPos),lt!==Z.currentPinchDist&&(Z.lastPinchDist=Z.currentPinchDist,Z.currentPinchDist=lt,Z.lastPinchCenter=Z.currentPinchCenter,Z.currentPinchCenter=x(Z.pinchGPoints[0].currentPos,Z.pinchGPoints[1].currentPos),B.pinchHandler({eventSource:B,pointerType:"touch",gesturePoints:Z.pinchGPoints,lastCenter:T(Z.lastPinchCenter,B.element),center:T(Z.currentPinchCenter,B.element),lastDistance:Z.lastPinchDist,distance:Z.currentPinchDist,shift:F.originalEvent.shiftKey,originalEvent:F.originalEvent,userData:B.userData}),F.preventDefault=!0)))}function Te(B,F,Y){var Z=B.getActivePointersListByType(Y.type),xe;xe=Z.getById(Y.id),xe&&Qe(B,Z,xe)}function je(B,F,Y){B.stopHandler&&B.stopHandler({eventSource:B,pointerType:Y,position:E(F,B.element),buttons:B.getActivePointersListByType(Y).buttons,isTouchEvent:Y==="touch",originalEvent:F,userData:B.userData})}})(e),(function(n){n.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},n.Control=function(i,r,s){var a=i.parentNode;typeof r=="number"&&(n.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),r={anchor:r}),r.attachToViewer=typeof r.attachToViewer>"u"?!0:r.attachToViewer,this.autoFade=typeof r.autoFade>"u"?!0:r.autoFade,this.element=i,this.anchor=r.anchor,this.container=s,this.anchor===n.ControlAnchor.ABSOLUTE?(this.wrapper=n.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof r.top=="number"?r.top+"px":r.top,this.wrapper.style.left=typeof r.left=="number"?r.left+"px":r.left,this.wrapper.style.height=typeof r.height=="number"?r.height+"px":r.height,this.wrapper.style.width=typeof r.width=="number"?r.width+"px":r.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=n.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===n.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),r.attachToViewer?this.anchor===n.ControlAnchor.TOP_RIGHT||this.anchor===n.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):a.appendChild(this.wrapper)},n.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==n.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(i){this.wrapper.style.display=i?this.anchor===n.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(i){this.element[n.SIGNAL]&&n.Browser.vendor===n.BROWSERS.IE?n.setElementOpacity(this.element,i,!0):n.setElementOpacity(this.wrapper,i,!0)}}})(e),(function(n){n.ControlDock=function(r){var s=["topleft","topright","bottomright","bottomleft"],a,o;for(n.extend(!0,this,{id:"controldock-"+n.now()+"-"+Math.floor(Math.random()*1e6),container:n.makeNeutralElement("div"),controls:[]},r),this.container.onsubmit=function(){return!1},this.element&&(this.element=n.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),o=0;o<s.length;o++)a=s[o],this.controls[a]=n.makeNeutralElement("div"),this.controls[a].style.position="absolute",a.match("left")&&(this.controls[a].style.left="0px"),a.match("right")&&(this.controls[a].style.right="0px"),a.match("top")&&(this.controls[a].style.top="0px"),a.match("bottom")&&(this.controls[a].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},n.ControlDock.prototype={addControl:function(r,s){r=n.getElement(r);var a=null;if(!(i(this,r)>=0)){switch(s.anchor){case n.ControlAnchor.TOP_RIGHT:a=this.controls.topright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingTop="0px";break;case n.ControlAnchor.BOTTOM_RIGHT:a=this.controls.bottomright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingBottom="0px";break;case n.ControlAnchor.BOTTOM_LEFT:a=this.controls.bottomleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingBottom="0px";break;case n.ControlAnchor.TOP_LEFT:a=this.controls.topleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingTop="0px";break;case n.ControlAnchor.ABSOLUTE:a=this.container,r.style.margin="0px",r.style.padding="0px";break;default:case n.ControlAnchor.NONE:a=this.container,r.style.margin="0px",r.style.padding="0px";break}this.controls.push(new n.Control(r,s,a)),r.style.display="inline-block"}},removeControl:function(r){r=n.getElement(r);var s=i(this,r);return s>=0&&(this.controls[s].destroy(),this.controls.splice(s,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var r;for(r=this.controls.length-1;r>=0;r--)if(this.controls[r].isVisible())return!0;return!1},setControlsEnabled:function(r){var s;for(s=this.controls.length-1;s>=0;s--)this.controls[s].setVisible(r);return this}};function i(r,s){var a=r.controls,o;for(o=a.length-1;o>=0;o--)if(a[o].element===s)return o;return-1}})(e),(function(n){n.Placement=n.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})})(e),(function(n){var i={},r=1;n.Viewer=function(k){var X=arguments,ue=this,Se;if(n.isPlainObject(k)||(k={id:X[0],xmlPath:X.length>1?X[1]:void 0,prefixUrl:X.length>2?X[2]:void 0,controls:X.length>3?X[3]:void 0,overlays:X.length>4?X[4]:void 0}),k.config&&(n.extend(!0,k,k.config),delete k.config),n.extend(!0,this,{id:k.id,hash:k.hash||r++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttonGroup:null,profiler:null},n.DEFAULT_SETTINGS,k),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof i[this.hash]<"u"&&n.console.warn("Hash "+this.hash+" has already been used."),i[this.hash]={fsBoundsDelta:new n.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,needsResize:!1,forceResize:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null,lastClickTime:null,draggingToZoom:!1},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=n.now(),n.EventSource.call(this),this.addHandler("open-failed",function(Oe){var ze=n.getString("Errors.OpenFailed",Oe.eventSource,Oe.message);ue._showMessage(ze)}),n.ControlDock.call(this,k),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=n.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",(function(Oe){Oe.width="100%",Oe.height="100%",Oe.overflow="hidden",Oe.position="absolute",Oe.top="0px",Oe.left="0px"})(this.canvas.style),n.setElementTouchActionNone(this.canvas),k.tabIndex!==""&&(this.canvas.tabIndex=k.tabIndex===void 0?0:k.tabIndex),this.container.className="openseadragon-container",(function(Oe){Oe.width="100%",Oe.height="100%",Oe.position="relative",Oe.overflow="hidden",Oe.left="0px",Oe.top="0px",Oe.textAlign="left"})(this.container.style),n.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new n.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:n.delegate(this,E),keyDownHandler:n.delegate(this,T),keyHandler:n.delegate(this,x),clickHandler:n.delegate(this,S),dblClickHandler:n.delegate(this,w),dragHandler:n.delegate(this,C),dragEndHandler:n.delegate(this,I),enterHandler:n.delegate(this,L),leaveHandler:n.delegate(this,N),pressHandler:n.delegate(this,G),releaseHandler:n.delegate(this,O),nonPrimaryPressHandler:n.delegate(this,D),nonPrimaryReleaseHandler:n.delegate(this,V),scrollHandler:n.delegate(this,j),pinchHandler:n.delegate(this,$),focusHandler:n.delegate(this,J),blurHandler:n.delegate(this,K)}),this.outerTracker=new n.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:n.delegate(this,te),leaveHandler:n.delegate(this,ne)}),this.toolbar&&(this.toolbar=new n.ControlDock({element:this.toolbar})),this.bindStandardControls(),i[this.hash].prevContainerSize=s(this.container),window.ResizeObserver?(this._autoResizePolling=!1,this._resizeObserver=new ResizeObserver(function(){i[ue.hash].needsResize=!0}),this._resizeObserver.observe(this.container,{})):this._autoResizePolling=!0,this.world=new n.World({viewer:this}),this.world.addHandler("add-item",function(Oe){ue.source=ue.world.getItemAt(0).source,i[ue.hash].forceRedraw=!0,ue._updateRequestId||(ue._updateRequestId=u(ue,oe))}),this.world.addHandler("remove-item",function(Oe){ue.world.getItemCount()?ue.source=ue.world.getItemAt(0).source:ue.source=null,i[ue.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(Oe){ue.viewport&&ue.viewport._setContentBounds(ue.world.getHomeBounds(),ue.world.getContentFactor())}),this.world.addHandler("item-index-change",function(Oe){ue.source=ue.world.getItemAt(0).source}),this.viewport=new n.Viewport({containerSize:i[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new n.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:k.timeout,tileRetryMax:this.tileRetryMax,tileRetryDelay:this.tileRetryDelay}),this.tileCache=new n.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new n.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=n.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(Se=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(Se,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(Se=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(Se,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new n.Navigator({element:this.navigatorElement,id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy,animationTime:this.animationTime})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),Se=0;Se<this.customControls.length;Se++)this.addControl(this.customControls[Se].id,{anchor:this.customControls[Se].anchor});n.requestAnimationFrame(function(){f(ue)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),n._viewers.set(this.element,this)},n.extend(n.Viewer.prototype,n.EventSource.prototype,n.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(k){return n.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(k)},openTileSource:function(k){return n.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(k)},get buttons(){return n.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(k,X){var ue=this;if(this.close(),!k)return this;if(this.sequenceMode&&n.isArray(k))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof X<"u"&&!isNaN(X)&&(this.initialPage=X),this.tileSources=k,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(n.isArray(k)||(k=[k]),!k.length)return this;this._opening=!0;for(var Se=k.length,Oe=0,ze=0,Ne,dt=function(){if(Oe+ze===Se)if(Oe){(ue._firstOpen||!ue.preserveViewport)&&(ue.viewport.goHome(!0),ue.viewport.update()),ue._firstOpen=!1;var Te=k[0];if(Te.tileSource&&(Te=Te.tileSource),ue.overlays&&!ue.preserveOverlays)for(var je=0;je<ue.overlays.length;je++)ue.currentOverlays[je]=o(ue,ue.overlays[je]);ue._drawOverlays(),ue._opening=!1,ue.raiseEvent("open",{source:Te})}else ue._opening=!1,ue.raiseEvent("open-failed",Ne)},mt=function(Te){(!n.isPlainObject(Te)||!Te.tileSource)&&(Te={tileSource:Te}),Te.index!==void 0&&(n.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete Te.index),Te.collectionImmediately===void 0&&(Te.collectionImmediately=!0);var je=Te.success;Te.success=function(F){if(Oe++,Te.tileSource.overlays)for(var Y=0;Y<Te.tileSource.overlays.length;Y++)ue.addOverlay(Te.tileSource.overlays[Y]);je&&je(F),dt()};var B=Te.error;Te.error=function(F){ze++,Ne||(Ne=F),B&&B(F),dt()},ue.addTiledImage(Te)},he=0;he<k.length;he++)mt(k[he]);return this},close:function(){return i[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),i[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(i[this.hash]){if(this.raiseEvent("before-destroy"),this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this._resizeObserver&&this._resizeObserver.disconnect(),this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(n.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),i[this.navigator.hash]=null,delete i[this.navigator.hash],this.navigator=null),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),i[this.hash]=null,delete i[this.hash],this.canvas=null,this.container=null,n._viewers.delete(this.element),this.element=null,this.raiseEvent("destroy"),this.removeAllHandlers()}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(k){return this.innerTracker.setTracking(k),this.outerTracker.setTracking(k),this.raiseEvent("mouse-enabled",{enabled:k}),this},areControlsEnabled:function(){var k=this.controls.length,X;for(X=0;X<this.controls.length;X++)k=k&&this.controls[X].isVisible();return k},setControlsEnabled:function(k){return k?m(this):f(this),this.raiseEvent("controls-enabled",{enabled:k}),this},setDebugMode:function(k){for(var X=0;X<this.world.getItemCount();X++)this.world.getItemAt(X).debugMode=k;this.debugMode=k,this.forceRedraw()},setAjaxHeaders:function(k,X){if(k===null&&(k={}),!n.isPlainObject(k)){console.error("[Viewer.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}if(X===void 0&&(X=!0),this.ajaxHeaders=k,X){for(var ue=0;ue<this.world.getItemCount();ue++)this.world.getItemAt(ue)._updateAjaxHeaders(!0);if(this.navigator&&this.navigator.setAjaxHeaders(this.ajaxHeaders,!0),this.referenceStrip&&this.referenceStrip.miniViewers)for(var Se in this.referenceStrip.miniViewers)this.referenceStrip.miniViewers[Se].setAjaxHeaders(this.ajaxHeaders,!0)}},addButton:function(k){this.buttonGroup.addButton(k)},isFullPage:function(){return i[this.hash].fullPage},setFullPage:function(k){var X=document.body,ue=X.style,Se=document.documentElement.style,Oe=this,ze,Ne;if(k===this.isFullPage())return this;var dt={fullPage:k,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",dt),dt.preventDefaultAction)return this;if(k){for(this.elementSize=n.getElementSize(this.element),this.pageScroll=n.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=ue.margin,this.docMargin=Se.margin,ue.margin="0",Se.margin="0",this.bodyPadding=ue.padding,this.docPadding=Se.padding,ue.padding="0",Se.padding="0",this.bodyWidth=ue.width,this.docWidth=Se.width,ue.width="100%",Se.width="100%",this.bodyHeight=ue.height,this.docHeight=Se.height,ue.height="100%",Se.height="100%",this.bodyDisplay=ue.display,ue.display="block",this.previousBody=[],i[this.hash].prevElementParent=this.element.parentNode,i[this.hash].prevNextSibling=this.element.nextSibling,i[this.hash].prevElementWidth=this.element.style.width,i[this.hash].prevElementHeight=this.element.style.height,ze=X.childNodes.length,Ne=0;Ne<ze;Ne++)this.previousBody.push(X.childNodes[0]),X.removeChild(X.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,X.appendChild(this.toolbar.element),n.addClass(this.toolbar.element,"fullpage")),n.addClass(this.element,"fullpage"),X.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=n.getElementSize(this.element).y-n.getElementSize(this.toolbar.element).y+"px"),i[this.hash].fullPage=!0,n.delegate(this,te)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,ue.margin=this.bodyMargin,Se.margin=this.docMargin,ue.padding=this.bodyPadding,Se.padding=this.docPadding,ue.width=this.bodyWidth,Se.width=this.docWidth,ue.height=this.bodyHeight,Se.height=this.docHeight,ue.display=this.bodyDisplay,X.removeChild(this.element),ze=this.previousBody.length,Ne=0;Ne<ze;Ne++)X.appendChild(this.previousBody.shift());n.removeClass(this.element,"fullpage"),i[this.hash].prevElementParent.insertBefore(this.element,i[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(X.removeChild(this.toolbar.element),n.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=i[this.hash].prevElementWidth,this.element.style.height=i[this.hash].prevElementHeight;var mt=0,he=function(){n.setPageScroll(Oe.pageScroll);var Te=n.getPageScroll();mt++,mt<10&&(Te.x!==Oe.pageScroll.x||Te.y!==Oe.pageScroll.y)&&n.requestAnimationFrame(he)};n.requestAnimationFrame(he),i[this.hash].fullPage=!1,n.delegate(this,ne)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:k}),this},setFullScreen:function(k){var X=this;if(!n.supportsFullScreen)return this.setFullPage(k);if(n.isFullScreen()===k)return this;var ue={fullScreen:k,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",ue),ue.preventDefaultAction)return this;if(k){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var Se=function(){var Oe=n.isFullScreen();Oe||(n.removeEvent(document,n.fullScreenEventName,Se),n.removeEvent(document,n.fullScreenErrorEventName,Se),X.setFullPage(!1),X.isFullPage()&&(X.element.style.width=X.fullPageStyleWidth,X.element.style.height=X.fullPageStyleHeight)),X.navigator&&X.viewport&&setTimeout(function(){X.navigator.update(X.viewport)}),X.raiseEvent("full-screen",{fullScreen:Oe})};n.addEvent(document,n.fullScreenEventName,Se),n.addEvent(document,n.fullScreenErrorEventName,Se),n.requestFullScreen(document.body)}else n.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},isFullScreen:function(){return n.isFullScreen()&&this.isFullPage()},setVisible:function(k){return this.container.style.visibility=k?"":"hidden",this.raiseEvent("visible",{visible:k}),this},addTiledImage:function(k){n.console.assert(k,"[Viewer.addTiledImage] options is required"),n.console.assert(k.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),n.console.assert(!k.replace||k.index>-1&&k.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var X=this;k.replace&&(k.replaceItem=X.world.getItemAt(k.index)),this._hideMessage(),k.placeholderFillStyle===void 0&&(k.placeholderFillStyle=this.placeholderFillStyle),k.opacity===void 0&&(k.opacity=this.opacity),k.preload===void 0&&(k.preload=this.preload),k.compositeOperation===void 0&&(k.compositeOperation=this.compositeOperation),k.crossOriginPolicy===void 0&&(k.crossOriginPolicy=k.tileSource.crossOriginPolicy!==void 0?k.tileSource.crossOriginPolicy:this.crossOriginPolicy),k.ajaxWithCredentials===void 0&&(k.ajaxWithCredentials=this.ajaxWithCredentials),k.loadTilesWithAjax===void 0&&(k.loadTilesWithAjax=this.loadTilesWithAjax),n.isPlainObject(k.ajaxHeaders)||(k.ajaxHeaders={});var ue={options:k};function Se(Ne){for(var dt=0;dt<X._loadQueue.length;dt++)if(X._loadQueue[dt]===ue){X._loadQueue.splice(dt,1);break}X._loadQueue.length===0&&Oe(ue),X.raiseEvent("add-item-failed",Ne),k.error&&k.error(Ne)}function Oe(Ne){X.collectionMode&&(X.world.arrange({immediately:Ne.options.collectionImmediately,rows:X.collectionRows,columns:X.collectionColumns,layout:X.collectionLayout,tileSize:X.collectionTileSize,tileMargin:X.collectionTileMargin}),X.world.setAutoRefigureSizes(!0))}if(n.isArray(k.tileSource)){setTimeout(function(){Se({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:k.tileSource,options:k})});return}this._loadQueue.push(ue);function ze(){for(var Ne,dt,mt;X._loadQueue.length&&(Ne=X._loadQueue[0],!!Ne.tileSource);){if(X._loadQueue.splice(0,1),Ne.options.replace){var he=X.world.getIndexOfItem(Ne.options.replaceItem);he!==-1&&(Ne.options.index=he),X.world.removeItem(Ne.options.replaceItem)}dt=new n.TiledImage({viewer:X,source:Ne.tileSource,viewport:X.viewport,drawer:X.drawer,tileCache:X.tileCache,imageLoader:X.imageLoader,x:Ne.options.x,y:Ne.options.y,width:Ne.options.width,height:Ne.options.height,fitBounds:Ne.options.fitBounds,fitBoundsPlacement:Ne.options.fitBoundsPlacement,clip:Ne.options.clip,placeholderFillStyle:Ne.options.placeholderFillStyle,opacity:Ne.options.opacity,preload:Ne.options.preload,degrees:Ne.options.degrees,flipped:Ne.options.flipped,compositeOperation:Ne.options.compositeOperation,springStiffness:X.springStiffness,animationTime:X.animationTime,minZoomImageRatio:X.minZoomImageRatio,wrapHorizontal:X.wrapHorizontal,wrapVertical:X.wrapVertical,immediateRender:X.immediateRender,blendTime:X.blendTime,alwaysBlend:X.alwaysBlend,minPixelRatio:X.minPixelRatio,smoothTileEdgesMinZoom:X.smoothTileEdgesMinZoom,iOSDevice:X.iOSDevice,crossOriginPolicy:Ne.options.crossOriginPolicy,ajaxWithCredentials:Ne.options.ajaxWithCredentials,loadTilesWithAjax:Ne.options.loadTilesWithAjax,ajaxHeaders:Ne.options.ajaxHeaders,debugMode:X.debugMode,subPixelRoundingForTransparency:X.subPixelRoundingForTransparency}),X.collectionMode&&X.world.setAutoRefigureSizes(!1),X.navigator&&(mt=n.extend({},Ne.options,{replace:!1,originalTiledImage:dt,tileSource:Ne.tileSource}),X.navigator.addTiledImage(mt)),X.world.addItem(dt,{index:Ne.options.index}),X._loadQueue.length===0&&Oe(Ne),X.world.getItemCount()===1&&!X.preserveViewport&&X.viewport.goHome(!0),Ne.options.success&&Ne.options.success({item:dt})}}a(this,k.tileSource,k,function(Ne){ue.tileSource=Ne,ze()},function(Ne){Ne.options=k,Se(Ne),ze()})},addSimpleImage:function(k){n.console.assert(k,"[Viewer.addSimpleImage] options is required"),n.console.assert(k.url,"[Viewer.addSimpleImage] options.url is required");var X=n.extend({},k,{tileSource:{type:"image",url:k.url}});delete X.url,this.addTiledImage(X)},addLayer:function(k){var X=this;n.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var ue=n.extend({},k,{success:function(Se){X.raiseEvent("add-layer",{options:k,drawer:Se.item})},error:function(Se){X.raiseEvent("add-layer-failed",Se)}});return this.addTiledImage(ue),this},getLayerAtLevel:function(k){return n.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(k)},getLevelOfLayer:function(k){return n.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(k)},getLayersCount:function(){return n.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(k,X){return n.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(k,X)},removeLayer:function(k){return n.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(k)},forceRedraw:function(){return i[this.hash].forceRedraw=!0,this},forceResize:function(){i[this.hash].needsResize=!0,i[this.hash].forceResize=!0},bindSequenceControls:function(){var k=n.delegate(this,y),X=n.delegate(this,b),ue=n.delegate(this,this.goToNextPage),Se=n.delegate(this,this.goToPreviousPage),Oe=this.navImages,ze=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(ze=!1),this.previousButton=new n.Button({element:this.previousButton?n.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.PreviousPage"),srcRest:q(this.prefixUrl,Oe.previous.REST),srcGroup:q(this.prefixUrl,Oe.previous.GROUP),srcHover:q(this.prefixUrl,Oe.previous.HOVER),srcDown:q(this.prefixUrl,Oe.previous.DOWN),onRelease:Se,onFocus:k,onBlur:X}),this.nextButton=new n.Button({element:this.nextButton?n.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.NextPage"),srcRest:q(this.prefixUrl,Oe.next.REST),srcGroup:q(this.prefixUrl,Oe.next.GROUP),srcHover:q(this.prefixUrl,Oe.next.HOVER),srcDown:q(this.prefixUrl,Oe.next.DOWN),onRelease:ue,onFocus:k,onBlur:X}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),ze&&(this.paging=new n.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:n.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||n.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var k=n.delegate(this,ye),X=n.delegate(this,we),ue=n.delegate(this,$e),Se=n.delegate(this,Pe),Oe=n.delegate(this,Ye),ze=n.delegate(this,Ie),Ne=n.delegate(this,Le),dt=n.delegate(this,Ke),mt=n.delegate(this,Lt),he=n.delegate(this,Qe),Te=n.delegate(this,y),je=n.delegate(this,b),B=this.navImages,F=[],Y=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(Y=!1),this.showZoomControl&&(F.push(this.zoomInButton=new n.Button({element:this.zoomInButton?n.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.ZoomIn"),srcRest:q(this.prefixUrl,B.zoomIn.REST),srcGroup:q(this.prefixUrl,B.zoomIn.GROUP),srcHover:q(this.prefixUrl,B.zoomIn.HOVER),srcDown:q(this.prefixUrl,B.zoomIn.DOWN),onPress:k,onRelease:X,onClick:ue,onEnter:k,onExit:X,onFocus:Te,onBlur:je})),F.push(this.zoomOutButton=new n.Button({element:this.zoomOutButton?n.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.ZoomOut"),srcRest:q(this.prefixUrl,B.zoomOut.REST),srcGroup:q(this.prefixUrl,B.zoomOut.GROUP),srcHover:q(this.prefixUrl,B.zoomOut.HOVER),srcDown:q(this.prefixUrl,B.zoomOut.DOWN),onPress:Se,onRelease:X,onClick:Oe,onEnter:Se,onExit:X,onFocus:Te,onBlur:je}))),this.showHomeControl&&F.push(this.homeButton=new n.Button({element:this.homeButton?n.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.Home"),srcRest:q(this.prefixUrl,B.home.REST),srcGroup:q(this.prefixUrl,B.home.GROUP),srcHover:q(this.prefixUrl,B.home.HOVER),srcDown:q(this.prefixUrl,B.home.DOWN),onRelease:ze,onFocus:Te,onBlur:je})),this.showFullPageControl&&F.push(this.fullPageButton=new n.Button({element:this.fullPageButton?n.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.FullPage"),srcRest:q(this.prefixUrl,B.fullpage.REST),srcGroup:q(this.prefixUrl,B.fullpage.GROUP),srcHover:q(this.prefixUrl,B.fullpage.HOVER),srcDown:q(this.prefixUrl,B.fullpage.DOWN),onRelease:Ne,onFocus:Te,onBlur:je})),this.showRotationControl&&(F.push(this.rotateLeftButton=new n.Button({element:this.rotateLeftButton?n.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.RotateLeft"),srcRest:q(this.prefixUrl,B.rotateleft.REST),srcGroup:q(this.prefixUrl,B.rotateleft.GROUP),srcHover:q(this.prefixUrl,B.rotateleft.HOVER),srcDown:q(this.prefixUrl,B.rotateleft.DOWN),onRelease:dt,onFocus:Te,onBlur:je})),F.push(this.rotateRightButton=new n.Button({element:this.rotateRightButton?n.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.RotateRight"),srcRest:q(this.prefixUrl,B.rotateright.REST),srcGroup:q(this.prefixUrl,B.rotateright.GROUP),srcHover:q(this.prefixUrl,B.rotateright.HOVER),srcDown:q(this.prefixUrl,B.rotateright.DOWN),onRelease:mt,onFocus:Te,onBlur:je}))),this.showFlipControl&&F.push(this.flipButton=new n.Button({element:this.flipButton?n.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:n.getString("Tooltips.Flip"),srcRest:q(this.prefixUrl,B.flip.REST),srcGroup:q(this.prefixUrl,B.flip.GROUP),srcHover:q(this.prefixUrl,B.flip.HOVER),srcDown:q(this.prefixUrl,B.flip.DOWN),onRelease:he,onFocus:Te,onBlur:je})),Y?(this.buttonGroup=new n.ButtonGroup({buttons:F,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",n.delegate(this,fe)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||n.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||n.ControlAnchor.TOP_LEFT})):this.customButtons=F),this},currentPage:function(){return this._sequenceIndex},goToPage:function(k){return this.tileSources&&k>=0&&k<this.tileSources.length&&(this._sequenceIndex=k,this._updateSequenceButtons(k),this.open(this.tileSources[k]),this.referenceStrip&&this.referenceStrip.setFocus(k),this.raiseEvent("page",{page:k})),this},addOverlay:function(k,X,ue,Se){var Oe;if(n.isPlainObject(k)?Oe=k:Oe={element:k,location:X,placement:ue,onDraw:Se},k=n.getElement(Oe.element),l(this.currentOverlays,k)>=0)return this;var ze=o(this,Oe);return this.currentOverlays.push(ze),ze.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:k,location:Oe.location,placement:Oe.placement}),this},updateOverlay:function(k,X,ue){var Se;return k=n.getElement(k),Se=l(this.currentOverlays,k),Se>=0&&(this.currentOverlays[Se].update(X,ue),i[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:k,location:X,placement:ue})),this},removeOverlay:function(k){var X;return k=n.getElement(k),X=l(this.currentOverlays,k),X>=0&&(this.currentOverlays[X].destroy(),this.currentOverlays.splice(X,1),i[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:k})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return i[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(k){var X;return k=n.getElement(k),X=l(this.currentOverlays,k),X>=0?this.currentOverlays[X]:null},_updateSequenceButtons:function(k){this.nextButton&&(!this.tileSources||this.tileSources.length-1===k?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(k>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(k){this._hideMessage();var X=n.makeNeutralElement("div");X.appendChild(document.createTextNode(k)),this.messageDiv=n.makeCenteredNode(X),n.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var k=this.messageDiv;k&&(k.parentNode.removeChild(k),delete this.messageDiv)},gestureSettingsByDeviceType:function(k){switch(k){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var k,X=this.currentOverlays.length;for(k=0;k<X;k++)this.currentOverlays[k].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new n.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else n.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),n.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){n.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var k=n.pixelDensityRatio,X=n.getCurrentPixelDensityRatio();k!==X&&(n.pixelDensityRatio=X,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var k=this._sequenceIndex-1;this.navPrevNextWrap&&k<0&&(k+=this.tileSources.length),this.goToPage(k)},goToNextPage:function(){var k=this._sequenceIndex+1;this.navPrevNextWrap&&k>=this.tileSources.length&&(k=0),this.goToPage(k)},isAnimating:function(){return i[this.hash].animating}});function s(k){return k=n.getElement(k),new n.Point(k.clientWidth===0?1:k.clientWidth,k.clientHeight===0?1:k.clientHeight)}function a(k,X,ue,Se,Oe){var ze=k;if(n.type(X)==="string"){if(X.match(/^\s*<.*>\s*$/))X=n.parseXml(X);else if(X.match(/^\s*[{[].*[}\]]\s*$/))try{var Ne=n.parseJSON(X);X=Ne}catch{}}function dt(mt,he){mt.ready?Se(mt):(mt.addHandler("ready",function(){Se(mt)}),mt.addHandler("open-failed",function(Te){Oe({message:Te.message,source:he})}))}setTimeout(function(){if(n.type(X)==="string")X=new n.TileSource({url:X,crossOriginPolicy:ue.crossOriginPolicy!==void 0?ue.crossOriginPolicy:k.crossOriginPolicy,ajaxWithCredentials:k.ajaxWithCredentials,ajaxHeaders:ue.ajaxHeaders?ue.ajaxHeaders:k.ajaxHeaders,splitHashDataForPost:k.splitHashDataForPost,useCanvas:k.useCanvas,success:function(je){Se(je.tileSource)}}),X.addHandler("open-failed",function(je){Oe(je)});else if(n.isPlainObject(X)||X.nodeType)if(X.crossOriginPolicy===void 0&&(ue.crossOriginPolicy!==void 0||k.crossOriginPolicy!==void 0)&&(X.crossOriginPolicy=ue.crossOriginPolicy!==void 0?ue.crossOriginPolicy:k.crossOriginPolicy),X.ajaxWithCredentials===void 0&&(X.ajaxWithCredentials=k.ajaxWithCredentials),X.useCanvas===void 0&&(X.useCanvas=k.useCanvas),n.isFunction(X.getTileUrl)){var mt=new n.TileSource(X);mt.getTileUrl=X.getTileUrl,Se(mt)}else{var he=n.TileSource.determineType(ze,X);if(!he){Oe({message:"Unable to load TileSource",source:X});return}var Te=he.prototype.configure.apply(ze,[X]);dt(new he(Te),X)}else dt(X,X)})}function o(k,X){if(X instanceof n.Overlay)return X;var ue=null;if(X.element)ue=n.getElement(X.element);else{var Se=X.id?X.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);ue=n.getElement(X.id),ue||(ue=document.createElement("a"),ue.href="#/overlay/"+Se),ue.id=Se,n.addClass(ue,X.className?X.className:"openseadragon-overlay")}var Oe=X.location,ze=X.width,Ne=X.height;if(!Oe){var dt=X.x,mt=X.y;if(X.px!==void 0){var he=k.viewport.imageToViewportRectangle(new n.Rect(X.px,X.py,ze||0,Ne||0));dt=he.x,mt=he.y,ze=ze!==void 0?he.width:void 0,Ne=Ne!==void 0?he.height:void 0}Oe=new n.Point(dt,mt)}var Te=X.placement;return Te&&n.type(Te)==="string"&&(Te=n.Placement[X.placement.toUpperCase()]),new n.Overlay({element:ue,location:Oe,placement:Te,onDraw:X.onDraw,checkResize:X.checkResize,width:ze,height:Ne,rotationMode:X.rotationMode})}function l(k,X){var ue;for(ue=k.length-1;ue>=0;ue--)if(k[ue].element===X)return ue;return-1}function u(k,X){return n.requestAnimationFrame(function(){X(k)})}function d(k){n.requestAnimationFrame(function(){p(k)})}function f(k){k.autoHideControls&&(k.controlsShouldFade=!0,k.controlsFadeBeginTime=n.now()+k.controlsFadeDelay,window.setTimeout(function(){d(k)},k.controlsFadeDelay))}function p(k){var X,ue,Se,Oe;if(k.controlsShouldFade){for(X=n.now(),ue=X-k.controlsFadeBeginTime,Se=1-ue/k.controlsFadeLength,Se=Math.min(1,Se),Se=Math.max(0,Se),Oe=k.controls.length-1;Oe>=0;Oe--)k.controls[Oe].autoFade&&k.controls[Oe].setOpacity(Se);Se>0&&d(k)}}function m(k){var X;for(k.controlsShouldFade=!1,X=k.controls.length-1;X>=0;X--)k.controls[X].setOpacity(1)}function y(){m(this)}function b(){f(this)}function E(k){var X={tracker:k.eventSource,position:k.position,originalEvent:k.originalEvent,preventDefault:k.preventDefault};this.raiseEvent("canvas-contextmenu",X),k.preventDefault=X.preventDefault}function T(k){var X={originalEvent:k.originalEvent,preventDefaultAction:!1,preventVerticalPan:k.preventVerticalPan||!this.panVertical,preventHorizontalPan:k.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",X),!X.preventDefaultAction&&!k.ctrl&&!k.alt&&!k.meta)switch(k.keyCode){case 38:X.preventVerticalPan||(k.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new n.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),k.preventDefault=!0;break;case 40:X.preventVerticalPan||(k.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new n.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),k.preventDefault=!0;break;case 37:X.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new n.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),k.preventDefault=!0;break;case 39:X.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new n.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),k.preventDefault=!0;break;case 187:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),k.preventDefault=!0;break;case 189:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),k.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),k.preventDefault=!0;break;case 87:X.preventVerticalPan||(k.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new n.Point(0,-40))),this.viewport.applyConstraints()),k.preventDefault=!0;break;case 83:X.preventVerticalPan||(k.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new n.Point(0,40))),this.viewport.applyConstraints()),k.preventDefault=!0;break;case 65:X.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new n.Point(-40,0))),this.viewport.applyConstraints()),k.preventDefault=!0;break;case 68:X.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new n.Point(40,0))),this.viewport.applyConstraints()),k.preventDefault=!0;break;case 82:k.shift?this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement),this.viewport.applyConstraints(),k.preventDefault=!0;break;case 70:this.viewport.toggleFlip(),k.preventDefault=!0;break;case 74:this.goToPreviousPage();break;case 75:this.goToNextPage();break;default:k.preventDefault=!1;break}else k.preventDefault=!1}function x(k){var X={originalEvent:k.originalEvent};this.raiseEvent("canvas-key-press",X)}function S(k){var X,ue=document.activeElement===this.canvas;ue||this.canvas.focus(),this.viewport.flipped&&(k.position.x=this.viewport.getContainerSize().x-k.position.x);var Se={tracker:k.eventSource,position:k.position,quick:k.quick,shift:k.shift,originalEvent:k.originalEvent,originalTarget:k.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",Se),!Se.preventDefaultAction&&this.viewport&&k.quick&&(X=this.gestureSettingsByDeviceType(k.pointerType),X.clickToZoom===!0&&(this.viewport.zoomBy(k.shift?1/this.zoomPerClick:this.zoomPerClick,X.zoomToRefPoint?this.viewport.pointFromPixel(k.position,!0):null),this.viewport.applyConstraints()),X.dblClickDragToZoom&&(i[this.hash].draggingToZoom===!0?(i[this.hash].lastClickTime=null,i[this.hash].draggingToZoom=!1):i[this.hash].lastClickTime=n.now()))}function w(k){var X,ue={tracker:k.eventSource,position:k.position,shift:k.shift,originalEvent:k.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",ue),!ue.preventDefaultAction&&this.viewport&&(X=this.gestureSettingsByDeviceType(k.pointerType),X.dblClickToZoom&&(this.viewport.zoomBy(k.shift?1/this.zoomPerClick:this.zoomPerClick,X.zoomToRefPoint?this.viewport.pointFromPixel(k.position,!0):null),this.viewport.applyConstraints()))}function C(k){var X,ue={tracker:k.eventSource,pointerType:k.pointerType,position:k.position,delta:k.delta,speed:k.speed,direction:k.direction,shift:k.shift,originalEvent:k.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",ue),X=this.gestureSettingsByDeviceType(k.pointerType),!ue.preventDefaultAction&&this.viewport){if(X.dblClickDragToZoom&&i[this.hash].draggingToZoom){var Se=Math.pow(this.zoomPerDblClickDrag,k.delta.y/50);this.viewport.zoomBy(Se)}else if(X.dragToPan&&!i[this.hash].draggingToZoom){if(this.panHorizontal||(k.delta.x=0),this.panVertical||(k.delta.y=0),this.viewport.flipped&&(k.delta.x=-k.delta.x),this.constrainDuringPan){var Oe=this.viewport.deltaPointsFromPixels(k.delta.negate());this.viewport.centerSpringX.target.value+=Oe.x,this.viewport.centerSpringY.target.value+=Oe.y;var ze=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=Oe.x,this.viewport.centerSpringY.target.value-=Oe.y,ze.xConstrained&&(k.delta.x=0),ze.yConstrained&&(k.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(k.delta.negate()),X.flickEnabled&&!this.constrainDuringPan)}}}function I(k){var X,ue={tracker:k.eventSource,pointerType:k.pointerType,position:k.position,speed:k.speed,direction:k.direction,shift:k.shift,originalEvent:k.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",ue),X=this.gestureSettingsByDeviceType(k.pointerType),!ue.preventDefaultAction&&this.viewport){if(!i[this.hash].draggingToZoom&&X.flickEnabled&&k.speed>=X.flickMinSpeed){var Se=0;this.panHorizontal&&(Se=X.flickMomentum*k.speed*Math.cos(k.direction));var Oe=0;this.panVertical&&(Oe=X.flickMomentum*k.speed*Math.sin(k.direction));var ze=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),Ne=this.viewport.pointFromPixel(new n.Point(ze.x-Se,ze.y-Oe));this.viewport.panTo(Ne,!1)}this.viewport.applyConstraints()}X.dblClickDragToZoom&&i[this.hash].draggingToZoom===!0&&(i[this.hash].draggingToZoom=!1)}function L(k){this.raiseEvent("canvas-enter",{tracker:k.eventSource,pointerType:k.pointerType,position:k.position,buttons:k.buttons,pointers:k.pointers,insideElementPressed:k.insideElementPressed,buttonDownAny:k.buttonDownAny,originalEvent:k.originalEvent})}function N(k){this.raiseEvent("canvas-exit",{tracker:k.eventSource,pointerType:k.pointerType,position:k.position,buttons:k.buttons,pointers:k.pointers,insideElementPressed:k.insideElementPressed,buttonDownAny:k.buttonDownAny,originalEvent:k.originalEvent})}function G(k){var X;if(this.raiseEvent("canvas-press",{tracker:k.eventSource,pointerType:k.pointerType,position:k.position,insideElementPressed:k.insideElementPressed,insideElementReleased:k.insideElementReleased,originalEvent:k.originalEvent}),X=this.gestureSettingsByDeviceType(k.pointerType),X.dblClickDragToZoom){var ue=i[this.hash].lastClickTime,Se=n.now();if(ue===null)return;Se-ue<this.dblClickTimeThreshold&&(i[this.hash].draggingToZoom=!0),i[this.hash].lastClickTime=null}}function O(k){this.raiseEvent("canvas-release",{tracker:k.eventSource,pointerType:k.pointerType,position:k.position,insideElementPressed:k.insideElementPressed,insideElementReleased:k.insideElementReleased,originalEvent:k.originalEvent})}function D(k){this.raiseEvent("canvas-nonprimary-press",{tracker:k.eventSource,position:k.position,pointerType:k.pointerType,button:k.button,buttons:k.buttons,originalEvent:k.originalEvent})}function V(k){this.raiseEvent("canvas-nonprimary-release",{tracker:k.eventSource,position:k.position,pointerType:k.pointerType,button:k.button,buttons:k.buttons,originalEvent:k.originalEvent})}function $(k){var X,ue,Se,Oe,ze={tracker:k.eventSource,pointerType:k.pointerType,gesturePoints:k.gesturePoints,lastCenter:k.lastCenter,center:k.center,lastDistance:k.lastDistance,distance:k.distance,shift:k.shift,originalEvent:k.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",ze),this.viewport&&(X=this.gestureSettingsByDeviceType(k.pointerType),X.pinchToZoom&&(!ze.preventDefaultPanAction||!ze.preventDefaultZoomAction)&&(ue=this.viewport.pointFromPixel(k.center,!0),X.zoomToRefPoint&&!ze.preventDefaultPanAction&&(Se=this.viewport.pointFromPixel(k.lastCenter,!0),Oe=Se.minus(ue),this.panHorizontal||(Oe.x=0),this.panVertical||(Oe.y=0),this.viewport.panBy(Oe,!0)),ze.preventDefaultZoomAction||this.viewport.zoomBy(k.distance/k.lastDistance,ue,!0),this.viewport.applyConstraints()),X.pinchRotate&&!ze.preventDefaultRotateAction)){var Ne=Math.atan2(k.gesturePoints[0].currentPos.y-k.gesturePoints[1].currentPos.y,k.gesturePoints[0].currentPos.x-k.gesturePoints[1].currentPos.x),dt=Math.atan2(k.gesturePoints[0].lastPos.y-k.gesturePoints[1].lastPos.y,k.gesturePoints[0].lastPos.x-k.gesturePoints[1].lastPos.x);ue=this.viewport.pointFromPixel(k.center,!0),this.viewport.rotateTo(this.viewport.getRotation(!0)+(Ne-dt)*(180/Math.PI),ue,!0)}}function J(k){this.raiseEvent("canvas-focus",{tracker:k.eventSource,originalEvent:k.originalEvent})}function K(k){this.raiseEvent("canvas-blur",{tracker:k.eventSource,originalEvent:k.originalEvent})}function j(k){var X,ue,Se,Oe,ze;Oe=n.now(),ze=Oe-this._lastScrollTime,ze>this.minScrollDeltaTime?(this._lastScrollTime=Oe,X={tracker:k.eventSource,position:k.position,scroll:k.scroll,shift:k.shift,originalEvent:k.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",X),!X.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(k.position.x=this.viewport.getContainerSize().x-k.position.x),ue=this.gestureSettingsByDeviceType(k.pointerType),ue.scrollToZoom&&(Se=Math.pow(this.zoomPerScroll,k.scroll),this.viewport.zoomBy(Se,ue.zoomToRefPoint?this.viewport.pointFromPixel(k.position,!0):null),this.viewport.applyConstraints())),k.preventDefault=X.preventDefault):k.preventDefault=!0}function te(k){i[this.hash].mouseInside=!0,m(this),this.raiseEvent("container-enter",{tracker:k.eventSource,pointerType:k.pointerType,position:k.position,buttons:k.buttons,pointers:k.pointers,insideElementPressed:k.insideElementPressed,buttonDownAny:k.buttonDownAny,originalEvent:k.originalEvent})}function ne(k){k.pointers<1&&(i[this.hash].mouseInside=!1,i[this.hash].animating||f(this)),this.raiseEvent("container-exit",{tracker:k.eventSource,pointerType:k.pointerType,position:k.position,buttons:k.buttons,pointers:k.pointers,insideElementPressed:k.insideElementPressed,buttonDownAny:k.buttonDownAny,originalEvent:k.originalEvent})}function oe(k){ie(k),k.isOpen()?k._updateRequestId=u(k,oe):k._updateRequestId=!1}function P(k,X){var ue=k.viewport,Se=ue.getZoom(),Oe=ue.getCenter();ue.resize(X,k.preserveImageSizeOnResize),ue.panTo(Oe,!0);var ze;if(k.preserveImageSizeOnResize)ze=i[k.hash].prevContainerSize.x/X.x;else{var Ne=new n.Point(0,0),dt=new n.Point(i[k.hash].prevContainerSize.x,i[k.hash].prevContainerSize.y).distanceTo(Ne),mt=new n.Point(X.x,X.y).distanceTo(Ne);ze=mt/dt*i[k.hash].prevContainerSize.x/X.x}ue.zoomTo(Se*ze,null,!0),i[k.hash].prevContainerSize=X,i[k.hash].forceRedraw=!0,i[k.hash].needsResize=!1,i[k.hash].forceResize=!1}function ie(k){if(!(k._opening||!i[k.hash])){if(k.autoResize||i[k.hash].forceResize){var X;if(k._autoResizePolling){X=s(k.container);var ue=i[k.hash].prevContainerSize;X.equals(ue)||(i[k.hash].needsResize=!0)}i[k.hash].needsResize&&P(k,X||s(k.container))}var Se=k.viewport.update(),Oe=k.world.update()||Se;Se&&k.raiseEvent("viewport-change"),k.referenceStrip&&(Oe=k.referenceStrip.update(k.viewport)||Oe);var ze=i[k.hash].animating;!ze&&Oe&&(k.raiseEvent("animation-start"),m(k));var Ne=ze&&!Oe;Ne&&(i[k.hash].animating=!1),(Oe||Ne||i[k.hash].forceRedraw||k.world.needsDraw())&&(le(k),k._drawOverlays(),k.navigator&&k.navigator.update(k.viewport),i[k.hash].forceRedraw=!1,Oe&&k.raiseEvent("animation")),Ne&&(k.raiseEvent("animation-finish"),i[k.hash].mouseInside||f(k)),i[k.hash].animating=Oe}}function le(k){k.imageLoader.clear(),k.drawer.clear(),k.world.draw(),k.raiseEvent("update-viewport",{})}function q(k,X){return k?k+X:X}function ye(){i[this.hash].lastZoomTime=n.now(),i[this.hash].zoomFactor=this.zoomPerSecond,i[this.hash].zooming=!0,Me(this)}function Pe(){i[this.hash].lastZoomTime=n.now(),i[this.hash].zoomFactor=1/this.zoomPerSecond,i[this.hash].zooming=!0,Me(this)}function we(){i[this.hash].zooming=!1}function Me(k){n.requestAnimationFrame(n.delegate(k,Fe))}function Fe(){var k,X,ue;i[this.hash].zooming&&this.viewport&&(k=n.now(),X=k-i[this.hash].lastZoomTime,ue=Math.pow(i[this.hash].zoomFactor,X/1e3),this.viewport.zoomBy(ue),this.viewport.applyConstraints(),i[this.hash].lastZoomTime=k,Me(this))}function $e(){this.viewport&&(i[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function Ye(){this.viewport&&(i[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function fe(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function Ie(){this.viewport&&this.viewport.goHome()}function Le(){this.isFullPage()&&!n.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function Ke(){if(this.viewport){var k=this.viewport.getRotation();this.viewport.flipped?k+=this.rotationIncrement:k-=this.rotationIncrement,this.viewport.setRotation(k)}}function Lt(){if(this.viewport){var k=this.viewport.getRotation();this.viewport.flipped?k-=this.rotationIncrement:k+=this.rotationIncrement,this.viewport.setRotation(k)}}function Qe(){this.viewport.toggleFlip()}})(e),(function(n){n.Navigator=function(u){var d=u.viewer,f=this,p,m;u.element||u.id?(u.element?(u.id&&n.console.warn("Given option.id for Navigator was ignored since option.element was provided and is being used instead."),u.element.id?u.id=u.element.id:u.id="navigator-"+n.now(),this.element=u.element):this.element=document.getElementById(u.id),u.controlOptions={anchor:n.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(u.id="navigator-"+n.now(),this.element=n.makeNeutralElement("div"),u.controlOptions={anchor:n.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:u.autoFade},u.position&&(u.position==="BOTTOM_RIGHT"?u.controlOptions.anchor=n.ControlAnchor.BOTTOM_RIGHT:u.position==="BOTTOM_LEFT"?u.controlOptions.anchor=n.ControlAnchor.BOTTOM_LEFT:u.position==="TOP_RIGHT"?u.controlOptions.anchor=n.ControlAnchor.TOP_RIGHT:u.position==="TOP_LEFT"?u.controlOptions.anchor=n.ControlAnchor.TOP_LEFT:u.position==="ABSOLUTE"&&(u.controlOptions.anchor=n.ControlAnchor.ABSOLUTE,u.controlOptions.top=u.top,u.controlOptions.left=u.left,u.controlOptions.height=u.height,u.controlOptions.width=u.width))),this.element.id=u.id,this.element.className+=" navigator",u=n.extend(!0,{sizeRatio:n.DEFAULT_SETTINGS.navigatorSizeRatio},u,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:u.animationTime,autoResize:!1,minZoomImageRatio:1,background:u.background,opacity:u.opacity,borderColor:u.borderColor,displayRegionColor:u.displayRegionColor}),u.minPixelRatio=this.minPixelRatio=d.minPixelRatio,n.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new n.Point(1,1),this.totalBorderWidths=new n.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),u.controlOptions.anchor!==n.ControlAnchor.NONE&&(function(E,T){E.margin="0px",E.border=T+"px solid "+u.borderColor,E.padding="0px",E.background=u.background,E.opacity=u.opacity,E.overflow="hidden"})(this.element.style,this.borderWidth),this.displayRegion=n.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",(function(E,T){E.position="relative",E.top="0px",E.left="0px",E.fontSize="0px",E.overflow="hidden",E.border=T+"px solid "+u.displayRegionColor,E.margin="0px",E.padding="0px",E.background="transparent",E.float="left",E.cssFloat="left",E.styleFloat="left",E.zIndex=999999999,E.cursor="default",E.boxSizing="content-box"})(this.displayRegion.style,this.borderWidth),n.setElementPointerEventsNone(this.displayRegion),n.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=n.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",n.setElementPointerEventsNone(this.displayRegionContainer),n.setElementTouchActionNone(this.displayRegionContainer),d.addControl(this.element,u.controlOptions),this._resizeWithViewer=u.controlOptions.anchor!==n.ControlAnchor.ABSOLUTE&&u.controlOptions.anchor!==n.ControlAnchor.NONE,u.width&&u.height?(this.setWidth(u.width),this.setHeight(u.height)):this._resizeWithViewer&&(p=n.getElementSize(d.element),this.element.style.height=Math.round(p.y*u.sizeRatio)+"px",this.element.style.width=Math.round(p.x*u.sizeRatio)+"px",this.oldViewerSize=p,m=n.getElementSize(this.element),this.elementArea=m.x*m.y),this.oldContainerSize=new n.Point(0,0),n.Viewer.apply(this,[u]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function y(E,T){o(f.displayRegionContainer,E),o(f.displayRegion,-E),f.viewport.setRotation(E,T)}if(u.navigatorRotate){var b=u.viewer.viewport?u.viewer.viewport.getRotation():u.viewer.degrees||0;y(b,!0),u.viewer.addHandler("rotate",function(E){y(E.degrees,E.immediately)})}this.innerTracker.destroy(),this.innerTracker=new n.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:n.delegate(this,r),clickHandler:n.delegate(this,i),releaseHandler:n.delegate(this,s),scrollHandler:n.delegate(this,a),preProcessEventHandler:function(E){E.eventType==="wheel"&&(E.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",n.setElementPointerEventsNone(this.canvas),n.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){f.viewport&&f.viewport.goHome(!0)}),d.world.addHandler("item-index-change",function(E){window.setTimeout(function(){var T=f.world.getItemAt(E.previousIndex);f.world.setItemIndex(T,E.newIndex)},1)}),d.world.addHandler("remove-item",function(E){var T=E.item,x=f._getMatchingItem(T);x&&f.world.removeItem(x)}),this.update(d.viewport)},n.extend(n.Navigator.prototype,n.EventSource.prototype,n.Viewer.prototype,{updateSize:function(){if(this.viewport){var u=new n.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);u.equals(this.oldContainerSize)||(this.viewport.resize(u,!0),this.viewport.goHome(!0),this.oldContainerSize=u,this.drawer.clear(),this.world.draw())}},setWidth:function(u){this.width=u,this.element.style.width=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1,this.updateSize()},setHeight:function(u){this.height=u,this.element.style.height=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1,this.updateSize()},setFlip:function(u){return this.viewport.setFlip(u),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(u){l(this.displayRegion,u),l(this.canvas,u),l(this.element,u)},update:function(u){var d,f,p,m,y,b;if(d=n.getElementSize(this.viewer.element),this._resizeWithViewer&&d.x&&d.y&&!d.equals(this.oldViewerSize)&&(this.oldViewerSize=d,this.maintainSizeRatio||!this.elementArea?(f=d.x*this.sizeRatio,p=d.y*this.sizeRatio):(f=Math.sqrt(this.elementArea*(d.x/d.y)),p=this.elementArea/f),this.element.style.width=Math.round(f)+"px",this.element.style.height=Math.round(p)+"px",this.elementArea||(this.elementArea=f*p),this.updateSize()),u&&this.viewport){if(m=u.getBoundsNoRotate(!0),y=this.viewport.pixelFromPointNoRotate(m.getTopLeft(),!1),b=this.viewport.pixelFromPointNoRotate(m.getBottomRight(),!1).minus(this.totalBorderWidths),!this.navigatorRotate){var E=u.getRotation(!0);o(this.displayRegion,-E)}var T=this.displayRegion.style;T.display=this.world.getItemCount()?"block":"none",T.top=y.y.toFixed(2)+"px",T.left=y.x.toFixed(2)+"px";var x=b.x-y.x,S=b.y-y.y;T.width=Math.round(Math.max(x,0))+"px",T.height=Math.round(Math.max(S,0))+"px"}},addTiledImage:function(u){var d=this,f=u.originalTiledImage;delete u.original;var p=n.extend({},u,{success:function(m){var y=m.item;y._originalForNavigator=f,d._matchBounds(y,f,!0),d._matchOpacity(y,f),d._matchCompositeOperation(y,f);function b(){d._matchBounds(y,f)}function E(){d._matchOpacity(y,f)}function T(){d._matchCompositeOperation(y,f)}f.addHandler("bounds-change",b),f.addHandler("clip-change",b),f.addHandler("opacity-change",E),f.addHandler("composite-operation-change",T)}});return n.Viewer.prototype.addTiledImage.apply(this,[p])},destroy:function(){return n.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(u){for(var d=this.world.getItemCount(),f,p=0;p<d;p++)if(f=this.world.getItemAt(p),f._originalForNavigator===u)return f;return null},_matchBounds:function(u,d,f){var p=d.getBoundsNoRotate();u.setPosition(p.getTopLeft(),f),u.setWidth(p.width,f),u.setRotation(d.getRotation(),f),u.setClip(d.getClip()),u.setFlip(d.getFlip())},_matchOpacity:function(u,d){u.setOpacity(d.opacity)},_matchCompositeOperation:function(u,d){u.setCompositeOperation(d.compositeOperation)}});function i(u){var d={tracker:u.eventSource,position:u.position,quick:u.quick,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",d),!d.preventDefaultAction&&u.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(u.position.x=this.viewport.getContainerSize().x-u.position.x);var f=this.viewport.pointFromPixel(u.position);this.panVertical?this.panHorizontal||(f.x=this.viewer.viewport.getCenter(!0).x):f.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(f),this.viewer.viewport.applyConstraints()}}function r(u){var d={tracker:u.eventSource,position:u.position,delta:u.delta,speed:u.speed,direction:u.direction,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",d),!d.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(u.delta.x=0),this.panVertical||(u.delta.y=0),this.viewer.viewport.flipped&&(u.delta.x=-u.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(u.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function s(u){u.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function a(u){var d={tracker:u.eventSource,position:u.position,scroll:u.scroll,shift:u.shift,originalEvent:u.originalEvent,preventDefault:u.preventDefault};this.viewer.raiseEvent("navigator-scroll",d),u.preventDefault=d.preventDefault}function o(u,d){l(u,"rotate("+d+"deg)")}function l(u,d){u.style.webkitTransform=d,u.style.mozTransform=d,u.style.msTransform=d,u.style.oTransform=d,u.style.transform=d}})(e),(function(n){var i={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};n.extend(n,{getString:function(r){var s=r.split("."),a=null,o=arguments,l=i,u;for(u=0;u<s.length-1;u++)l=l[s[u]]||{};return a=l[s[u]],typeof a!="string"&&(n.console.error("Untranslated source string:",r),a=""),a.replace(/\{\d+\}/g,function(d){var f=parseInt(d.match(/\d+/),10)+1;return f<o.length?o[f]:""})},setString:function(r,s){var a=r.split("."),o=i,l;for(l=0;l<a.length-1;l++)o[a[l]]||(o[a[l]]={}),o=o[a[l]];o[a[l]]=s}})})(e),(function(n){n.Point=function(i,r){this.x=typeof i=="number"?i:0,this.y=typeof r=="number"?r:0},n.Point.prototype={clone:function(){return new n.Point(this.x,this.y)},plus:function(i){return new n.Point(this.x+i.x,this.y+i.y)},minus:function(i){return new n.Point(this.x-i.x,this.y-i.y)},times:function(i){return new n.Point(this.x*i,this.y*i)},divide:function(i){return new n.Point(this.x/i,this.y/i)},negate:function(){return new n.Point(-this.x,-this.y)},distanceTo:function(i){return Math.sqrt(Math.pow(this.x-i.x,2)+Math.pow(this.y-i.y,2))},squaredDistanceTo:function(i){return Math.pow(this.x-i.x,2)+Math.pow(this.y-i.y,2)},apply:function(i){return new n.Point(i(this.x),i(this.y))},equals:function(i){return i instanceof n.Point&&this.x===i.x&&this.y===i.y},rotate:function(i,r){r=r||new n.Point(0,0);var s,a;if(i%90===0){var o=n.positiveModulo(i,360);switch(o){case 0:s=1,a=0;break;case 90:s=0,a=1;break;case 180:s=-1,a=0;break;case 270:s=0,a=-1;break}}else{var l=i*Math.PI/180;s=Math.cos(l),a=Math.sin(l)}var u=s*(this.x-r.x)-a*(this.y-r.y)+r.x,d=a*(this.x-r.x)+s*(this.y-r.y)+r.y;return new n.Point(u,d)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}})(e),(function(n){n.TileSource=function(r,s,a,o,l,u){var d=this,f=arguments,p,m;if(n.isPlainObject(r)?p=r:p={width:f[0],height:f[1],tileSize:f[2],tileOverlap:f[3],minLevel:f[4],maxLevel:f[5]},n.EventSource.call(this),n.extend(!0,this,p),!this.success){for(m=0;m<arguments.length;m++)if(n.isFunction(arguments[m])){this.success=arguments[m];break}}this.success&&this.addHandler("ready",function(y){d.success(y)}),n.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new n.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=p.width&&p.height?p.width/p.height:1,this.dimensions=new n.Point(p.width,p.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=p.tileOverlap?p.tileOverlap:0,this.minLevel=p.minLevel?p.minLevel:0,this.maxLevel=p.maxLevel!==void 0&&p.maxLevel!==null?p.maxLevel:p.width&&p.height?Math.ceil(Math.log(Math.max(p.width,p.height))/Math.log(2)):0,this.success&&n.isFunction(this.success)&&this.success(this))},n.TileSource.prototype={getTileSize:function(r){return n.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(r){return this._tileWidth?this._tileWidth:this.getTileSize(r)},getTileHeight:function(r){return this._tileHeight?this._tileHeight:this.getTileSize(r)},setMaxLevel:function(r){this.maxLevel=r,this._memoizeLevelScale()},getLevelScale:function(r){return this._memoizeLevelScale(),this.getLevelScale(r)},_memoizeLevelScale:function(){var r={},s;for(s=0;s<=this.maxLevel;s++)r[s]=1/Math.pow(2,this.maxLevel-s);this.getLevelScale=function(a){return r[a]}},getNumTiles:function(r){var s=this.getLevelScale(r),a=Math.ceil(s*this.dimensions.x/this.getTileWidth(r)),o=Math.ceil(s*this.dimensions.y/this.getTileHeight(r));return new n.Point(a,o)},getPixelRatio:function(r){var s=this.dimensions.times(this.getLevelScale(r)),a=1/s.x*n.pixelDensityRatio,o=1/s.y*n.pixelDensityRatio;return new n.Point(a,o)},getClosestLevel:function(){var r,s;for(r=this.minLevel+1;r<=this.maxLevel&&(s=this.getNumTiles(r),!(s.x>1||s.y>1));r++);return r-1},getTileAtPoint:function(r,s){var a=s.x>=0&&s.x<=1&&s.y>=0&&s.y<=1/this.aspectRatio;n.console.assert(a,"[TileSource.getTileAtPoint] must be called with a valid point.");var o=this.dimensions.x*this.getLevelScale(r),l=s.x*o,u=s.y*o,d=Math.floor(l/this.getTileWidth(r)),f=Math.floor(u/this.getTileHeight(r));s.x>=1&&(d=this.getNumTiles(r).x-1);var p=1e-15;return s.y>=1/this.aspectRatio-p&&(f=this.getNumTiles(r).y-1),new n.Point(d,f)},getTileBounds:function(r,s,a,o){var l=this.dimensions.times(this.getLevelScale(r)),u=this.getTileWidth(r),d=this.getTileHeight(r),f=s===0?0:u*s-this.tileOverlap,p=a===0?0:d*a-this.tileOverlap,m=u+(s===0?1:2)*this.tileOverlap,y=d+(a===0?1:2)*this.tileOverlap,b=1/l.x;return m=Math.min(m,l.x-f),y=Math.min(y,l.y-p),o?new n.Rect(0,0,m,y):new n.Rect(f*b,p*b,m*b,y*b)},getImageInfo:function(r){var s=this,a,o,l,u,d,f,p;r&&(d=r.split("/"),f=d[d.length-1],p=f.lastIndexOf("."),p>-1&&(d[d.length-1]=f.slice(0,p)));var m=null;if(this.splitHashDataForPost){var y=r.indexOf("#");y!==-1&&(m=r.substring(y+1),r=r.substr(0,y))}o=function(b){typeof b=="string"&&(b=n.parseXml(b));var E=n.TileSource.determineType(s,b,r);if(!E){s.raiseEvent("open-failed",{message:"Unable to load TileSource",source:r});return}u=E.prototype.configure.apply(s,[b,r,m]),u.ajaxWithCredentials===void 0&&(u.ajaxWithCredentials=s.ajaxWithCredentials),l=new E(u),s.ready=!0,s.raiseEvent("ready",{tileSource:l})},r.match(/\.js$/)?(a=r.split("/").pop().replace(".js",""),n.jsonp({url:r,async:!1,callbackName:a,callback:o})):n.makeAjaxRequest({url:r,postData:m,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(b){var E=i(b);o(E)},error:function(b,E){var T;try{T="HTTP "+b.status+" attempting to load TileSource: "+r}catch{var x;typeof E>"u"||!E.toString?x="Unknown error":x=E.toString(),T=x+" attempting to load TileSource: "+r}n.console.error(T),s.raiseEvent("open-failed",{message:T,source:r,postData:m})}})},supports:function(r,s){return!1},configure:function(r,s,a){throw new Error("Method not implemented.")},getTileUrl:function(r,s,a){throw new Error("Method not implemented.")},getTilePostData:function(r,s,a){return null},getTileAjaxHeaders:function(r,s,a){return{}},getTileHashKey:function(r,s,a,o,l,u){function d(f){return l?f+"+"+JSON.stringify(l):f}return d(typeof o!="string"?r+"/"+s+"_"+a:o)},tileExists:function(r,s,a){var o=this.getNumTiles(r);return r>=this.minLevel&&r<=this.maxLevel&&s>=0&&a>=0&&s<o.x&&a<o.y},hasTransparency:function(r,s,a,o){return!!r||s.match(".png")},downloadTileStart:function(r){var s=r.userData,a=new Image;s.image=a,s.request=null;var o=function(l){if(!a){r.finish(null,s.request,"Image load failed: undefined Image instance.");return}a.onload=a.onerror=a.onabort=null,r.finish(l?null:a,s.request,l)};a.onload=function(){o()},a.onabort=a.onerror=function(){o("Image load aborted.")},r.loadWithAjax?s.request=n.makeAjaxRequest({url:r.src,withCredentials:r.ajaxWithCredentials,headers:r.ajaxHeaders,responseType:"arraybuffer",postData:r.postData,success:function(l){var u;try{u=new window.Blob([l.response])}catch(p){var d=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(p.name==="TypeError"&&d){var f=new d;f.append(l.response),u=f.getBlob()}}u.size===0?o("Empty image response."):a.src=(window.URL||window.webkitURL).createObjectURL(u)},error:function(l){o("Image load aborted - XHR error")}}):(r.crossOriginPolicy!==!1&&(a.crossOrigin=r.crossOriginPolicy),a.src=r.src)},downloadTileAbort:function(r){r.userData.request&&r.userData.request.abort();var s=r.userData.image;r.userData.image&&(s.onload=s.onerror=s.onabort=null)},createTileCache:function(r,s,a){r._data=s},destroyTileCache:function(r){r._data=null,r._renderedContext=null},getTileCacheData:function(r){return r._data},getTileCacheDataAsImage:function(r){return r._data},getTileCacheDataAsContext2D:function(r){if(!r._renderedContext){var s=document.createElement("canvas");s.width=r._data.width,s.height=r._data.height,r._renderedContext=s.getContext("2d"),r._renderedContext.drawImage(r._data,0,0),r._data=null}return r._renderedContext}},n.extend(!0,n.TileSource.prototype,n.EventSource.prototype);function i(r){var s=r.responseText,a=r.status,o,l;if(r){if(r.status!==200&&r.status!==0)throw a=r.status,o=a===404?"Not Found":r.statusText,new Error(n.getString("Errors.Status",a,o))}else throw new Error(n.getString("Errors.Security"));if(s.match(/^\s*<.*/))try{l=r.responseXML&&r.responseXML.documentElement?r.responseXML:n.parseXml(s)}catch{l=r.responseText}else if(s.match(/\s*[{[].*/))try{l=n.parseJSON(s)}catch{l=s}else l=s;return l}n.TileSource.determineType=function(r,s,a){var o;for(o in e)if(o.match(/.+TileSource$/)&&n.isFunction(e[o])&&n.isFunction(e[o].prototype.supports)&&e[o].prototype.supports.call(r,s,a))return e[o];return n.console.error("No TileSource was able to open %s %s",a,s),null}})(e),(function(n){n.DziTileSource=function(s,a,o,l,u,d,f,p,m){var y,b,E,T;if(n.isPlainObject(s)?T=s:T={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=T.tilesUrl,this.fileFormat=T.fileFormat,this.displayRects=T.displayRects,this.displayRects)for(y=this.displayRects.length-1;y>=0;y--)for(b=this.displayRects[y],E=b.minLevel;E<=b.maxLevel;E++)this._levelRects[E]||(this._levelRects[E]=[]),this._levelRects[E].push(b);n.TileSource.apply(this,[T])},n.extend(n.DziTileSource.prototype,n.TileSource.prototype,{supports:function(s,a){var o;return s.Image?o=s.Image.xmlns:s.documentElement&&(s.documentElement.localName==="Image"||s.documentElement.tagName==="Image")&&(o=s.documentElement.namespaceURI),o=(o||"").toLowerCase(),o.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||o.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(s,a,o){var l;return n.isPlainObject(s)?l=r(this,s):l=i(this,s),a&&!l.tilesUrl&&(l.tilesUrl=a.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),a.search(/\.(dzi|xml|js)\?/)!==-1?l.queryParams=a.match(/\?.*/):l.queryParams=""),l},getTileUrl:function(s,a,o){return[this.tilesUrl,s,"/",a,"_",o,".",this.fileFormat,this.queryParams].join("")},tileExists:function(s,a,o){var l=this._levelRects[s],u,d,f,p,m,y,b;if(this.minLevel&&s<this.minLevel||this.maxLevel&&s>this.maxLevel)return!1;if(!l||!l.length)return!0;for(b=l.length-1;b>=0;b--)if(u=l[b],!(s<u.minLevel||s>u.maxLevel)&&(d=this.getLevelScale(s),f=u.x*d,p=u.y*d,m=f+u.width*d,y=p+u.height*d,f=Math.floor(f/this._tileWidth),p=Math.floor(p/this._tileWidth),m=Math.ceil(m/this._tileWidth),y=Math.ceil(y/this._tileWidth),f<=a&&a<m&&p<=o&&o<y))return!0;return!1}});function i(s,a){if(!a||!a.documentElement)throw new Error(n.getString("Errors.Xml"));var o=a.documentElement,l=o.localName||o.tagName,u=a.documentElement.namespaceURI,d=null,f=[],p,m,y,b,E;if(l==="Image")try{if(b=o.getElementsByTagName("Size")[0],b===void 0&&(b=o.getElementsByTagNameNS(u,"Size")[0]),d={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:o.getAttribute("Url"),Format:o.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(o.getAttribute("Overlap"),10),TileSize:parseInt(o.getAttribute("TileSize"),10),Size:{Height:parseInt(b.getAttribute("Height"),10),Width:parseInt(b.getAttribute("Width"),10)}}},!n.imageFormatSupported(d.Image.Format))throw new Error(n.getString("Errors.ImageFormat",d.Image.Format.toUpperCase()));for(p=o.getElementsByTagName("DisplayRect"),p===void 0&&(p=o.getElementsByTagNameNS(u,"DisplayRect")[0]),E=0;E<p.length;E++)m=p[E],y=m.getElementsByTagName("Rect")[0],y===void 0&&(y=m.getElementsByTagNameNS(u,"Rect")[0]),f.push({Rect:{X:parseInt(y.getAttribute("X"),10),Y:parseInt(y.getAttribute("Y"),10),Width:parseInt(y.getAttribute("Width"),10),Height:parseInt(y.getAttribute("Height"),10),MinLevel:parseInt(m.getAttribute("MinLevel"),10),MaxLevel:parseInt(m.getAttribute("MaxLevel"),10)}});return f.length&&(d.Image.DisplayRect=f),r(s,d)}catch(S){throw S instanceof Error?S:new Error(n.getString("Errors.Dzi"))}else{if(l==="Collection")throw new Error(n.getString("Errors.Dzc"));if(l==="Error"){var T=o.getElementsByTagName("Message")[0],x=T.firstChild.nodeValue;throw new Error(x)}}throw new Error(n.getString("Errors.Dzi"))}function r(s,a){var o=a.Image,l=o.Url,u=o.Format,d=o.Size,f=o.DisplayRect||[],p=parseInt(d.Width,10),m=parseInt(d.Height,10),y=parseInt(o.TileSize,10),b=parseInt(o.Overlap,10),E=[],T,x;for(x=0;x<f.length;x++)T=f[x].Rect,E.push(new n.DisplayRect(parseInt(T.X,10),parseInt(T.Y,10),parseInt(T.Width,10),parseInt(T.Height,10),parseInt(T.MinLevel,10),parseInt(T.MaxLevel,10)));return n.extend(!0,{width:p,height:m,tileSize:y,tileOverlap:b,minLevel:null,maxLevel:null,tilesUrl:l,fileFormat:u,displayRects:E},a)}})(e),(function(n){n.IIIFTileSource=function(o){if(n.extend(!0,this,o),this._id=this["@id"]||this.id||this.identifier||null,!(this.height&&this.width&&this._id))throw new Error("IIIF required parameters (width, height, or id) not provided.");if(o.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=o.version,this.tile_width&&this.tile_height)o.tileWidth=this.tile_width,o.tileHeight=this.tile_height;else if(this.tile_width)o.tileSize=this.tile_width;else if(this.tile_height)o.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)o.tileWidth=this.tiles[0].width,o.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var l=0;l<this.tiles.length;l++)for(var u=0;u<this.tiles[l].scaleFactors.length;u++){var d=this.tiles[l].scaleFactors[u];this.scale_factors.push(d),o.tileSizePerScaleFactor[d]={width:this.tiles[l].width,height:this.tiles[l].height||this.tiles[l].width}}}else if(i(o)){for(var f=Math.min(this.height,this.width),p=[256,512,1024],m=[],y=0;y<p.length;y++)p[y]<=f&&m.push(p[y]);m.length>0?o.tileSize=Math.max.apply(null,m):o.tileSize=f}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,o.levels=r(this),n.extend(!0,o,{width:o.levels[o.levels.length-1].width,height:o.levels[o.levels.length-1].height,tileSize:Math.max(o.height,o.width),tileOverlap:0,minLevel:0,maxLevel:o.levels.length-1}),this.levels=o.levels):n.console.error("Nothing in the info.json to construct image pyramids from");if(!o.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)o.maxLevel=Number(Math.round(Math.log(Math.max(this.width,this.height),2)));else{var b=Math.max.apply(null,this.scale_factors);o.maxLevel=Math.round(Math.log(b)*Math.LOG2E)}if(this.sizes){var E=this.sizes.length;(E===o.maxLevel||E===o.maxLevel+1)&&(this.levelSizes=this.sizes.slice().sort(function(T,x){return T.width-x.width}),E===o.maxLevel&&this.levelSizes.push({width:this.width,height:this.height}))}n.TileSource.apply(this,[o])},n.extend(n.IIIFTileSource.prototype,n.TileSource.prototype,{supports:function(o,l){return o.protocol&&o.protocol==="http://iiif.io/api/image"||o["@context"]&&(o["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||o["@context"]==="http://iiif.io/api/image/1/context.json")||o.profile&&o.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||o.identifier&&o.width&&o.height?!0:!!(o.documentElement&&o.documentElement.tagName==="info"&&o.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(o,l,u){if(n.isPlainObject(o)){if(!o["@context"])o["@context"]="http://iiif.io/api/image/1.0/context.json",o["@id"]=l.replace("/info.json",""),o.version=1;else{var f=o["@context"];if(Array.isArray(f)){for(var p=0;p<f.length;p++)if(typeof f[p]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(f[p])||f[p]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){f=f[p];break}}switch(f){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":o.version=1;break;case"http://iiif.io/api/image/2/context.json":o.version=2;break;case"http://iiif.io/api/image/3/context.json":o.version=3;break;default:n.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(o.preferredFormats){for(var m=0;m<o.preferredFormats.length;m++)if(e.imageFormatSupported(o.preferredFormats[m])){o.tileFormat=o.preferredFormats[m];break}}return o}else{var d=s(o);return d["@context"]="http://iiif.io/api/image/1.0/context.json",d["@id"]=l.replace("/info.xml",""),d.version=1,d}},getTileWidth:function(o){if(this.emulateLegacyImagePyramid)return n.TileSource.prototype.getTileWidth.call(this,o);var l=Math.pow(2,this.maxLevel-o);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[l]?this.tileSizePerScaleFactor[l].width:this._tileWidth},getTileHeight:function(o){if(this.emulateLegacyImagePyramid)return n.TileSource.prototype.getTileHeight.call(this,o);var l=Math.pow(2,this.maxLevel-o);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[l]?this.tileSizePerScaleFactor[l].height:this._tileHeight},getLevelScale:function(o){if(this.emulateLegacyImagePyramid){var l=NaN;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(l=this.levels[o].width/this.levels[this.maxLevel].width),l}return n.TileSource.prototype.getLevelScale.call(this,o)},getNumTiles:function(o){if(this.emulateLegacyImagePyramid){var l=this.getLevelScale(o);return l?new n.Point(1,1):new n.Point(0,0)}if(this.levelSizes){var u=this.levelSizes[o],d=Math.ceil(u.width/this.getTileWidth(o)),f=Math.ceil(u.height/this.getTileHeight(o));return new n.Point(d,f)}else return n.TileSource.prototype.getNumTiles.call(this,o)},getTileAtPoint:function(o,l){if(this.emulateLegacyImagePyramid)return new n.Point(0,0);if(this.levelSizes){var u=l.x>=0&&l.x<=1&&l.y>=0&&l.y<=1/this.aspectRatio;n.console.assert(u,"[TileSource.getTileAtPoint] must be called with a valid point.");var d=this.levelSizes[o].width,f=l.x*d,p=l.y*d,m=Math.floor(f/this.getTileWidth(o)),y=Math.floor(p/this.getTileHeight(o));l.x>=1&&(m=this.getNumTiles(o).x-1);var b=1e-15;return l.y>=1/this.aspectRatio-b&&(y=this.getNumTiles(o).y-1),new n.Point(m,y)}return n.TileSource.prototype.getTileAtPoint.call(this,o,l)},getTileUrl:function(o,l,u){if(this.emulateLegacyImagePyramid){var d=null;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(d=this.levels[o].url),d}var f="0",p=Math.pow(.5,this.maxLevel-o),m,y,b,E,T,x,S,w,C,I,L,N,G,O,D,V;return this.levelSizes?(m=this.levelSizes[o].width,y=this.levelSizes[o].height):(m=Math.ceil(this.width*p),y=Math.ceil(this.height*p)),b=this.getTileWidth(o),E=this.getTileHeight(o),T=Math.round(b/p),x=Math.round(E/p),this.version===1?D="native."+this.tileFormat:D="default."+this.tileFormat,m<b&&y<E?(this.version===2&&m===this.width?N="full":this.version===3&&m===this.width&&y===this.height?N="max":this.version===3?N=m+","+y:N=m+",",S="full"):(w=l*T,C=u*x,I=Math.min(T,this.width-w),L=Math.min(x,this.height-C),l===0&&u===0&&I===this.width&&L===this.height?S="full":S=[w,C,I,L].join(","),G=Math.min(b,m-l*b),O=Math.min(E,y-u*E),this.version===2&&G===this.width?N="full":this.version===3&&G===this.width&&O===this.height?N="max":this.version===3?N=G+","+O:N=G+","),V=[this._id,S,N,f,D].join("/"),V},__testonly__:{canBeTiled:i,constructLevels:r}});function i(o){var l=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],u=Array.isArray(o.profile)?o.profile[0]:o.profile,d=l.indexOf(u)!==-1,f=!1;return o.version===2&&o.profile.length>1&&o.profile[1].supports&&(f=o.profile[1].supports.indexOf("sizeByW")!==-1),o.version===3&&o.extraFeatures&&(f=o.extraFeatures.indexOf("sizeByWh")!==-1),!d||f}function r(o){for(var l=[],u=0;u<o.sizes.length;u++)l.push({url:o._id+"/full/"+o.sizes[u].width+","+(o.version===3?o.sizes[u].height:"")+"/0/default."+o.tileFormat,width:o.sizes[u].width,height:o.sizes[u].height});return l.sort(function(d,f){return d.width-f.width})}function s(o){if(!o||!o.documentElement)throw new Error(n.getString("Errors.Xml"));var l=o.documentElement,u=l.tagName,d=null;if(u==="info")try{return d={},a(l,d),d}catch(f){throw f instanceof Error?f:new Error(n.getString("Errors.IIIF"))}throw new Error(n.getString("Errors.IIIF"))}function a(o,l,u){var d,f;if(o.nodeType===3&&u)f=o.nodeValue.trim(),f.match(/^\d*$/)&&(f=Number(f)),l[u]?(n.isArray(l[u])||(l[u]=[l[u]]),l[u].push(f)):l[u]=f;else if(o.nodeType===1)for(d=0;d<o.childNodes.length;d++)a(o.childNodes[d],l,o.nodeName)}})(e),(function(n){n.OsmTileSource=function(i,r,s,a,o){var l;n.isPlainObject(i)?l=i:l={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!l.width||!l.height)&&(l.width=65572864,l.height=65572864),l.tileSize||(l.tileSize=256,l.tileOverlap=0),l.tilesUrl||(l.tilesUrl="http://tile.openstreetmap.org/"),l.minLevel=8,n.TileSource.apply(this,[l])},n.extend(n.OsmTileSource.prototype,n.TileSource.prototype,{supports:function(i,r){return i.type&&i.type==="openstreetmaps"},configure:function(i,r,s){return i},getTileUrl:function(i,r,s){return this.tilesUrl+(i-8)+"/"+r+"/"+s+".png"}})})(e),(function(n){n.TmsTileSource=function(i,r,s,a,o){var l;n.isPlainObject(i)?l=i:l={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var u=Math.ceil(l.width/256)*256,d=Math.ceil(l.height/256)*256,f;u>d?f=u/256:f=d/256,l.maxLevel=Math.ceil(Math.log(f)/Math.log(2))-1,l.tileSize=256,l.width=u,l.height=d,n.TileSource.apply(this,[l])},n.extend(n.TmsTileSource.prototype,n.TileSource.prototype,{supports:function(i,r){return i.type&&i.type==="tiledmapservice"},configure:function(i,r,s){return i},getTileUrl:function(i,r,s){var a=this.getNumTiles(i).y-1;return this.tilesUrl+i+"/"+r+"/"+(a-s)+".png"}})})(e),(function(n){n.ZoomifyTileSource=function(i){typeof i.tileSize>"u"&&(i.tileSize=256),typeof i.fileFormat>"u"&&(i.fileFormat="jpg",this.fileFormat=i.fileFormat);var r={x:i.width,y:i.height};for(i.imageSizes=[{x:i.width,y:i.height}],i.gridSize=[this._getGridSize(i.width,i.height,i.tileSize)];parseInt(r.x,10)>i.tileSize||parseInt(r.y,10)>i.tileSize;)r.x=Math.floor(r.x/2),r.y=Math.floor(r.y/2),i.imageSizes.push({x:r.x,y:r.y}),i.gridSize.push(this._getGridSize(r.x,r.y,i.tileSize));i.imageSizes.reverse(),i.gridSize.reverse(),i.minLevel=0,i.maxLevel=i.gridSize.length-1,e.TileSource.apply(this,[i])},n.extend(n.ZoomifyTileSource.prototype,n.TileSource.prototype,{_getGridSize:function(i,r,s){return{x:Math.ceil(i/s),y:Math.ceil(r/s)}},_calculateAbsoluteTileNumber:function(i,r,s){for(var a=0,o={},l=0;l<i;l++)o=this.gridSize[l],a+=o.x*o.y;return o=this.gridSize[i],a+=o.x*s+r,a},supports:function(i,r){return i.type&&i.type==="zoomifytileservice"},configure:function(i,r,s){return i},getTileUrl:function(i,r,s){var a=0,o=this._calculateAbsoluteTileNumber(i,r,s);return a=Math.floor(o/256),this.tilesUrl+"TileGroup"+a+"/"+i+"-"+r+"-"+s+"."+this.fileFormat}})})(e),(function(n){n.LegacyTileSource=function(a){var o,l,u;n.isArray(a)&&(o={type:"legacy-image-pyramid",levels:a}),o.levels=i(o.levels),o.levels.length>0?(l=o.levels[o.levels.length-1].width,u=o.levels[o.levels.length-1].height):(l=0,u=0,n.console.error("No supported image formats found")),n.extend(!0,o,{width:l,height:u,tileSize:Math.max(u,l),tileOverlap:0,minLevel:0,maxLevel:o.levels.length>0?o.levels.length-1:0}),n.TileSource.apply(this,[o]),this.levels=o.levels},n.extend(n.LegacyTileSource.prototype,n.TileSource.prototype,{supports:function(a,o){return a.type&&a.type==="legacy-image-pyramid"||a.documentElement&&a.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(a,o,l){var u;return n.isPlainObject(a)?u=s(this,a):u=r(this,a),u},getLevelScale:function(a){var o=NaN;return this.levels.length>0&&a>=this.minLevel&&a<=this.maxLevel&&(o=this.levels[a].width/this.levels[this.maxLevel].width),o},getNumTiles:function(a){var o=this.getLevelScale(a);return o?new n.Point(1,1):new n.Point(0,0)},getTileUrl:function(a,o,l){var u=null;return this.levels.length>0&&a>=this.minLevel&&a<=this.maxLevel&&(u=this.levels[a].url),u}});function i(a){var o=[],l,u;for(u=0;u<a.length;u++)l=a[u],l.height&&l.width&&l.url?o.push({url:l.url,width:Number(l.width),height:Number(l.height)}):n.console.error("Unsupported image format: %s",l.url?l.url:"<no URL>");return o.sort(function(d,f){return d.height-f.height})}function r(a,o){if(!o||!o.documentElement)throw new Error(n.getString("Errors.Xml"));var l=o.documentElement,u=l.tagName,d=null,f=[],p,m;if(u==="image")try{for(d={type:l.getAttribute("type"),levels:[]},f=l.getElementsByTagName("level"),m=0;m<f.length;m++)p=f[m],d.levels.push({url:p.getAttribute("url"),width:parseInt(p.getAttribute("width"),10),height:parseInt(p.getAttribute("height"),10)});return s(a,d)}catch(y){throw y instanceof Error?y:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(u==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(u==="error")throw new Error("Error: "+o)}throw new Error("Unknown element "+u)}function s(a,o){return o.levels}})(e),(function(n){n.ImageTileSource=function(i){i=n.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},i),n.TileSource.apply(this,[i])},n.extend(n.ImageTileSource.prototype,n.TileSource.prototype,{supports:function(i,r){return i.type&&i.type==="image"},configure:function(i,r,s){return i},getImageInfo:function(i){var r=this._image=new Image,s=this;this.crossOriginPolicy&&(r.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(r.useCredentials=this.ajaxWithCredentials),n.addEvent(r,"load",function(){s.width=r.naturalWidth,s.height=r.naturalHeight,s.aspectRatio=s.width/s.height,s.dimensions=new n.Point(s.width,s.height),s._tileWidth=s.width,s._tileHeight=s.height,s.tileOverlap=0,s.minLevel=0,s.levels=s._buildLevels(),s.maxLevel=s.levels.length-1,s.ready=!0,s.raiseEvent("ready",{tileSource:s})}),n.addEvent(r,"error",function(){s.raiseEvent("open-failed",{message:"Error loading image at "+i,source:i})}),r.src=i},getLevelScale:function(i){var r=NaN;return i>=this.minLevel&&i<=this.maxLevel&&(r=this.levels[i].width/this.levels[this.maxLevel].width),r},getNumTiles:function(i){var r=this.getLevelScale(i);return r?new n.Point(1,1):new n.Point(0,0)},getTileUrl:function(i,r,s){var a=null;return i>=this.minLevel&&i<=this.maxLevel&&(a=this.levels[i].url),a},getContext2D:function(i,r,s){var a=null;return i>=this.minLevel&&i<=this.maxLevel&&(a=this.levels[i].context2D),a},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var i=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!n.supportsCanvas||!this.useCanvas)return delete this._image,i;var r=this._image.naturalWidth,s=this._image.naturalHeight,a=document.createElement("canvas"),o=a.getContext("2d");if(a.width=r,a.height=s,o.drawImage(this._image,0,0,r,s),i[0].context2D=o,delete this._image,n.isCanvasTainted(a))return i;for(;r>=2&&s>=2;){r=Math.floor(r/2),s=Math.floor(s/2);var l=document.createElement("canvas"),u=l.getContext("2d");l.width=r,l.height=s,u.drawImage(a,0,0,r,s),i.splice(0,0,{context2D:u,width:r,height:s}),a=l,o=u}return i},_freeupCanvasMemory:function(){for(var i=0;i<this.levels.length;i++)this.levels[i].context2D&&(this.levels[i].context2D.canvas.height=0,this.levels[i].context2D.canvas.width=0)}})})(e),(function(n){n.TileSourceCollection=function(i,r,s,a){n.console.error("TileSourceCollection is deprecated; use World instead")}})(e),(function(n){n.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},n.Button=function(u){var d=this;n.EventSource.call(this),n.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:n.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:n.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},u),this.element=u.element||n.makeNeutralElement("div"),u.element||(this.imgRest=n.makeTransparentImage(this.srcRest),this.imgGroup=n.makeTransparentImage(this.srcGroup),this.imgHover=n.makeTransparentImage(this.srcHover),this.imgDown=n.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,n.setElementPointerEventsNone(this.imgRest),n.setElementPointerEventsNone(this.imgGroup),n.setElementPointerEventsNone(this.imgHover),n.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",n.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",n.Browser.vendor===n.BROWSERS.FIREFOX&&n.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=n.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new n.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(f){f.insideElementPressed?(o(d,n.ButtonState.DOWN),d.raiseEvent("enter",{originalEvent:f.originalEvent})):f.buttonDownAny||o(d,n.ButtonState.HOVER)},focusHandler:function(f){d.tracker.enterHandler(f),d.raiseEvent("focus",{originalEvent:f.originalEvent})},leaveHandler:function(f){l(d,n.ButtonState.GROUP),f.insideElementPressed&&d.raiseEvent("exit",{originalEvent:f.originalEvent})},blurHandler:function(f){d.tracker.leaveHandler(f),d.raiseEvent("blur",{originalEvent:f.originalEvent})},pressHandler:function(f){o(d,n.ButtonState.DOWN),d.raiseEvent("press",{originalEvent:f.originalEvent})},releaseHandler:function(f){f.insideElementPressed&&f.insideElementReleased?(l(d,n.ButtonState.HOVER),d.raiseEvent("release",{originalEvent:f.originalEvent})):f.insideElementPressed?l(d,n.ButtonState.GROUP):o(d,n.ButtonState.HOVER)},clickHandler:function(f){f.quick&&d.raiseEvent("click",{originalEvent:f.originalEvent})},keyHandler:function(f){f.keyCode===13?(d.raiseEvent("click",{originalEvent:f.originalEvent}),d.raiseEvent("release",{originalEvent:f.originalEvent}),f.preventDefault=!0):f.preventDefault=!1}}),l(this,n.ButtonState.REST)},n.extend(n.Button.prototype,n.EventSource.prototype,{notifyGroupEnter:function(){o(this,n.ButtonState.GROUP)},notifyGroupExit:function(){l(this,n.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,this.tracker.setTracking(!1),n.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,this.tracker.setTracking(!0),n.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function i(u){n.requestAnimationFrame(function(){r(u)})}function r(u){var d,f,p;u.shouldFade&&(d=n.now(),f=d-u.fadeBeginTime,p=1-f/u.fadeLength,p=Math.min(1,p),p=Math.max(0,p),u.imgGroup&&n.setElementOpacity(u.imgGroup,p,!0),p>0&&i(u))}function s(u){u.shouldFade=!0,u.fadeBeginTime=n.now()+u.fadeDelay,window.setTimeout(function(){i(u)},u.fadeDelay)}function a(u){u.shouldFade=!1,u.imgGroup&&n.setElementOpacity(u.imgGroup,1,!0)}function o(u,d){u.element.disabled||(d>=n.ButtonState.GROUP&&u.currentState===n.ButtonState.REST&&(a(u),u.currentState=n.ButtonState.GROUP),d>=n.ButtonState.HOVER&&u.currentState===n.ButtonState.GROUP&&(u.imgHover&&(u.imgHover.style.visibility=""),u.currentState=n.ButtonState.HOVER),d>=n.ButtonState.DOWN&&u.currentState===n.ButtonState.HOVER&&(u.imgDown&&(u.imgDown.style.visibility=""),u.currentState=n.ButtonState.DOWN))}function l(u,d){u.element.disabled||(d<=n.ButtonState.HOVER&&u.currentState===n.ButtonState.DOWN&&(u.imgDown&&(u.imgDown.style.visibility="hidden"),u.currentState=n.ButtonState.HOVER),d<=n.ButtonState.GROUP&&u.currentState===n.ButtonState.HOVER&&(u.imgHover&&(u.imgHover.style.visibility="hidden"),u.currentState=n.ButtonState.GROUP),d<=n.ButtonState.REST&&u.currentState===n.ButtonState.GROUP&&(s(u),u.currentState=n.ButtonState.REST))}})(e),(function(n){n.ButtonGroup=function(i){n.extend(!0,this,{buttons:[],clickTimeThreshold:n.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:n.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},i);var r=this.buttons.concat([]),s=this,a;if(this.element=i.element||n.makeNeutralElement("div"),!i.group)for(this.element.style.display="inline-block",a=0;a<r.length;a++)this.element.appendChild(r[a].element);n.setElementTouchActionNone(this.element),this.tracker=new n.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(o){var l;for(l=0;l<s.buttons.length;l++)s.buttons[l].notifyGroupEnter()},leaveHandler:function(o){var l;if(!o.insideElementPressed)for(l=0;l<s.buttons.length;l++)s.buttons[l].notifyGroupExit()}})},n.ButtonGroup.prototype={addButton:function(i){this.buttons.push(i),this.element.appendChild(i.element)},emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var i=this.buttons.pop();this.element.removeChild(i.element),i.destroy()}this.tracker.destroy(),this.element=null}}})(e),(function(n){n.Rect=function(i,r,s,a,o){this.x=typeof i=="number"?i:0,this.y=typeof r=="number"?r:0,this.width=typeof s=="number"?s:0,this.height=typeof a=="number"?a:0,this.degrees=typeof o=="number"?o:0,this.degrees=n.positiveModulo(this.degrees,360);var l,u;this.degrees>=270?(l=this.getTopRight(),this.x=l.x,this.y=l.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=270):this.degrees>=180?(l=this.getBottomRight(),this.x=l.x,this.y=l.y,this.degrees-=180):this.degrees>=90&&(l=this.getBottomLeft(),this.x=l.x,this.y=l.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=90)},n.Rect.fromSummits=function(i,r,s){var a=i.distanceTo(r),o=i.distanceTo(s),l=r.minus(i),u=Math.atan(l.y/l.x);return l.x<0?u+=Math.PI:l.y<0&&(u+=2*Math.PI),new n.Rect(i.x,i.y,a,o,u/Math.PI*180)},n.Rect.prototype={clone:function(){return new n.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new n.Point(this.x,this.y)},getBottomRight:function(){return new n.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new n.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new n.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new n.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new n.Point(this.width,this.height)},equals:function(i){return i instanceof n.Rect&&this.x===i.x&&this.y===i.y&&this.width===i.width&&this.height===i.height&&this.degrees===i.degrees},times:function(i){return new n.Rect(this.x*i,this.y*i,this.width*i,this.height*i,this.degrees)},translate:function(i){return new n.Rect(this.x+i.x,this.y+i.y,this.width,this.height,this.degrees)},union:function(i){var r=this.getBoundingBox(),s=i.getBoundingBox(),a=Math.min(r.x,s.x),o=Math.min(r.y,s.y),l=Math.max(r.x+r.width,s.x+s.width),u=Math.max(r.y+r.height,s.y+s.height);return new n.Rect(a,o,l-a,u-o)},intersection:function(i){var r=1e-10,s=[],a=this.getTopLeft();i.containsPoint(a,r)&&s.push(a);var o=this.getTopRight();i.containsPoint(o,r)&&s.push(o);var l=this.getBottomLeft();i.containsPoint(l,r)&&s.push(l);var u=this.getBottomRight();i.containsPoint(u,r)&&s.push(u);var d=i.getTopLeft();this.containsPoint(d,r)&&s.push(d);var f=i.getTopRight();this.containsPoint(f,r)&&s.push(f);var p=i.getBottomLeft();this.containsPoint(p,r)&&s.push(p);var m=i.getBottomRight();this.containsPoint(m,r)&&s.push(m);for(var y=this._getSegments(),b=i._getSegments(),E=0;E<y.length;E++)for(var T=y[E],x=0;x<b.length;x++){var S=b[x],w=C(T[0],T[1],S[0],S[1]);w&&s.push(w)}function C(V,$,J,K){var j=$.minus(V),te=K.minus(J),ne=-te.x*j.y+j.x*te.y;if(ne===0)return null;var oe=(j.x*(V.y-J.y)-j.y*(V.x-J.x))/ne,P=(te.x*(V.y-J.y)-te.y*(V.x-J.x))/ne;return-r<=oe&&oe<=1-r&&-r<=P&&P<=1-r?new n.Point(V.x+P*j.x,V.y+P*j.y):null}if(s.length===0)return null;for(var I=s[0].x,L=s[0].x,N=s[0].y,G=s[0].y,O=1;O<s.length;O++){var D=s[O];D.x<I&&(I=D.x),D.x>L&&(L=D.x),D.y<N&&(N=D.y),D.y>G&&(G=D.y)}return new n.Rect(I,N,L-I,G-N)},_getSegments:function(){var i=this.getTopLeft(),r=this.getTopRight(),s=this.getBottomLeft(),a=this.getBottomRight();return[[i,r],[r,a],[a,s],[s,i]]},rotate:function(i,r){if(i=n.positiveModulo(i,360),i===0)return this.clone();r=r||this.getCenter();var s=this.getTopLeft().rotate(i,r),a=this.getTopRight().rotate(i,r),o=a.minus(s);o=o.apply(function(u){var d=1e-15;return Math.abs(u)<d?0:u});var l=Math.atan(o.y/o.x);return o.x<0?l+=Math.PI:o.y<0&&(l+=2*Math.PI),new n.Rect(s.x,s.y,this.width,this.height,l/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var i=this.getTopLeft(),r=this.getTopRight(),s=this.getBottomLeft(),a=this.getBottomRight(),o=Math.min(i.x,r.x,s.x,a.x),l=Math.max(i.x,r.x,s.x,a.x),u=Math.min(i.y,r.y,s.y,a.y),d=Math.max(i.y,r.y,s.y,a.y);return new n.Rect(o,u,l-o,d-u)},getIntegerBoundingBox:function(){var i=this.getBoundingBox(),r=Math.floor(i.x),s=Math.floor(i.y),a=Math.ceil(i.width+i.x-r),o=Math.ceil(i.height+i.y-s);return new n.Rect(r,s,a,o)},containsPoint:function(i,r){r=r||0;var s=this.getTopLeft(),a=this.getTopRight(),o=this.getBottomLeft(),l=a.minus(s),u=o.minus(s);return(i.x-s.x)*l.x+(i.y-s.y)*l.y>=-r&&(i.x-a.x)*l.x+(i.y-a.y)*l.y<=r&&(i.x-s.x)*u.x+(i.y-s.y)*u.y>=-r&&(i.x-o.x)*u.x+(i.y-o.y)*u.y<=r},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}})(e),(function(n){var i={};n.ReferenceStrip=function(p){var m=this,y=p.viewer,b=n.getElementSize(y.element),E,T,x;for(p.id||(p.id="referencestrip-"+n.now(),this.element=n.makeNeutralElement("div"),this.element.id=p.id,this.element.className="referencestrip"),p=n.extend(!0,{sizeRatio:n.DEFAULT_SETTINGS.referenceStripSizeRatio,position:n.DEFAULT_SETTINGS.referenceStripPosition,scroll:n.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:n.DEFAULT_SETTINGS.clickTimeThreshold},p,{element:this.element}),n.extend(this,p),i[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,T=this.element.style,T.marginTop="0px",T.marginRight="0px",T.marginBottom="0px",T.marginLeft="0px",T.left="0px",T.bottom="0px",T.border="0px",T.background="#000",T.position="relative",n.setElementTouchActionNone(this.element),n.setElementOpacity(this.element,.8),this.viewer=y,this.tracker=new n.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:n.delegate(this,r),dragHandler:n.delegate(this,s),scrollHandler:n.delegate(this,a),enterHandler:n.delegate(this,l),leaveHandler:n.delegate(this,u),keyDownHandler:n.delegate(this,d),keyHandler:n.delegate(this,f),preProcessEventHandler:function(S){S.eventType==="wheel"&&(S.preventDefault=!0)}}),p.width&&p.height?(this.element.style.width=p.width+"px",this.element.style.height=p.height+"px",y.addControl(this.element,{anchor:n.ControlAnchor.BOTTOM_LEFT})):p.scroll==="horizontal"?(this.element.style.width=b.x*p.sizeRatio*y.tileSources.length+12*y.tileSources.length+"px",this.element.style.height=b.y*p.sizeRatio+"px",y.addControl(this.element,{anchor:n.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=b.y*p.sizeRatio*y.tileSources.length+12*y.tileSources.length+"px",this.element.style.width=b.x*p.sizeRatio+"px",y.addControl(this.element,{anchor:n.ControlAnchor.TOP_LEFT})),this.panelWidth=b.x*this.sizeRatio+8,this.panelHeight=b.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},x=0;x<y.tileSources.length;x++)E=n.makeNeutralElement("div"),E.id=this.element.id+"-"+x,E.style.width=m.panelWidth+"px",E.style.height=m.panelHeight+"px",E.style.display="inline",E.style.float="left",E.style.cssFloat="left",E.style.styleFloat="left",E.style.padding="2px",n.setElementTouchActionNone(E),n.setElementPointerEventsNone(E),this.element.appendChild(E),E.activePanel=!1,this.panels.push(E);o(this,this.scroll==="vertical"?b.y:b.x,0),this.setFocus(0)},n.ReferenceStrip.prototype={setFocus:function(p){var m=this.element.querySelector("#"+this.element.id+"-"+p),y=n.getElementSize(this.viewer.canvas),b=Number(this.element.style.width.replace("px","")),E=Number(this.element.style.height.replace("px","")),T=-Number(this.element.style.marginLeft.replace("px","")),x=-Number(this.element.style.marginTop.replace("px","")),S;this.currentSelected!==m&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=m,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(S=Number(p)*(this.panelWidth+3),S>T+y.x-this.panelWidth?(S=Math.min(S,b-y.x),this.element.style.marginLeft=-S+"px",o(this,y.x,-S)):S<T&&(S=Math.max(0,S-y.x/2),this.element.style.marginLeft=-S+"px",o(this,y.x,-S))):(S=Number(p)*(this.panelHeight+3),S>x+y.y-this.panelHeight?(S=Math.min(S,E-y.y),this.element.style.marginTop=-S+"px",o(this,y.y,-S)):S<x&&(S=Math.max(0,S-y.y/2),this.element.style.marginTop=-S+"px",o(this,y.y,-S))),this.currentPage=p,l.call(this,{eventSource:this.tracker}))},update:function(){return!!i[this.id].animating},destroy:function(){if(this.miniViewers)for(var p in this.miniViewers)this.miniViewers[p].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function r(p){if(p.quick){var m;this.scroll==="horizontal"?m=Math.floor(p.position.x/(this.panelWidth+4)):m=Math.floor(p.position.y/this.panelHeight),this.viewer.goToPage(m)}this.element.focus()}function s(p){if(this.dragging=!0,this.element){var m=Number(this.element.style.marginLeft.replace("px","")),y=Number(this.element.style.marginTop.replace("px","")),b=Number(this.element.style.width.replace("px","")),E=Number(this.element.style.height.replace("px","")),T=n.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-p.delta.x>0?m>-(b-T.x)&&(this.element.style.marginLeft=m+p.delta.x*2+"px",o(this,T.x,m+p.delta.x*2)):-p.delta.x<0&&m<0&&(this.element.style.marginLeft=m+p.delta.x*2+"px",o(this,T.x,m+p.delta.x*2)):-p.delta.y>0?y>-(E-T.y)&&(this.element.style.marginTop=y+p.delta.y*2+"px",o(this,T.y,y+p.delta.y*2)):-p.delta.y<0&&y<0&&(this.element.style.marginTop=y+p.delta.y*2+"px",o(this,T.y,y+p.delta.y*2))}}function a(p){if(this.element){var m=Number(this.element.style.marginLeft.replace("px","")),y=Number(this.element.style.marginTop.replace("px","")),b=Number(this.element.style.width.replace("px","")),E=Number(this.element.style.height.replace("px","")),T=n.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?p.scroll>0?m>-(b-T.x)&&(this.element.style.marginLeft=m-p.scroll*60+"px",o(this,T.x,m-p.scroll*60)):p.scroll<0&&m<0&&(this.element.style.marginLeft=m-p.scroll*60+"px",o(this,T.x,m-p.scroll*60)):p.scroll<0?y>T.y-E&&(this.element.style.marginTop=y+p.scroll*60+"px",o(this,T.y,y+p.scroll*60)):p.scroll>0&&y<0&&(this.element.style.marginTop=y+p.scroll*60+"px",o(this,T.y,y+p.scroll*60)),p.preventDefault=!0}}function o(p,m,y){var b,E,T,x,S,w;for(p.scroll==="horizontal"?b=p.panelWidth:b=p.panelHeight,E=Math.ceil(m/b)+5,T=Math.ceil((Math.abs(y)+m)/b)+1,E=T-E,E=E<0?0:E,S=E;S<T&&S<p.panels.length;S++)if(w=p.panels[S],!w.activePanel){var C,I=p.viewer.tileSources[S];I.referenceStripThumbnailUrl?C={type:"image",url:I.referenceStripThumbnailUrl}:C=I,x=new n.Viewer({id:w.id,tileSources:[C],element:w,navigatorSizeRatio:p.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:p.viewer.loadTilesWithAjax,ajaxHeaders:p.viewer.ajaxHeaders,useCanvas:p.useCanvas}),n.setElementPointerEventsNone(x.canvas),n.setElementPointerEventsNone(x.container),x.innerTracker.setTracking(!1),x.outerTracker.setTracking(!1),p.miniViewers[w.id]=x,w.activePanel=!0}}function l(p){var m=p.eventSource.element;this.scroll==="horizontal"?m.style.marginBottom="0px":m.style.marginLeft="0px"}function u(p){var m=p.eventSource.element;this.scroll==="horizontal"?m.style.marginBottom="-"+n.getElementSize(m).y/2+"px":m.style.marginLeft="-"+n.getElementSize(m).x/2+"px"}function d(p){if(!p.ctrl&&!p.alt&&!p.meta)switch(p.keyCode){case 38:a.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),p.preventDefault=!0;break;case 40:a.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),p.preventDefault=!0;break;case 37:a.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),p.preventDefault=!0;break;case 39:a.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),p.preventDefault=!0;break;default:p.preventDefault=!1;break}else p.preventDefault=!1}function f(p){if(!p.ctrl&&!p.alt&&!p.meta)switch(p.keyCode){case 61:a.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),p.preventDefault=!0;break;case 45:a.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),p.preventDefault=!0;break;case 48:case 119:case 87:a.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),p.preventDefault=!0;break;case 115:case 83:a.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),p.preventDefault=!0;break;case 97:a.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),p.preventDefault=!0;break;case 100:a.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),p.preventDefault=!0;break;default:p.preventDefault=!1;break}else p.preventDefault=!1}})(e),(function(n){n.DisplayRect=function(i,r,s,a,o,l){n.Rect.apply(this,[i,r,s,a]),this.minLevel=o,this.maxLevel=l},n.extend(n.DisplayRect.prototype,n.Rect.prototype)})(e),(function(n){n.Spring=function(r){var s=arguments;typeof r!="object"&&(r={initial:s.length&&typeof s[0]=="number"?s[0]:void 0,springStiffness:s.length>1?s[1].springStiffness:5,animationTime:s.length>1?s[1].animationTime:1.5}),n.console.assert(typeof r.springStiffness=="number"&&r.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),n.console.assert(typeof r.animationTime=="number"&&r.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),r.exponential&&(this._exponential=!0,delete r.exponential),n.extend(!0,this,r),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:n.now()},n.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},n.Spring.prototype={resetTo:function(r){n.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=r,this.start.time=this.target.time=this.current.time=n.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(r){n.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=r,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(r){this.start.value+=r,this.target.value+=r,this._exponential&&(n.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(r){this._exponential=r,this._exponential&&(n.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=n.now();var r,s;this._exponential?(r=this.start._logValue,s=this.target._logValue):(r=this.start.value,s=this.target.value);var a=this.current.time>=this.target.time?s:r+(s-r)*i(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),o=this.current.value;return this._exponential?this.current.value=Math.exp(a):this.current.value=a,o!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function i(r,s){return(1-Math.exp(r*-s))/(1-Math.exp(-r))}})(e),(function(n){n.ImageJob=function(r){n.extend(!0,this,{timeout:n.DEFAULT_SETTINGS.timeout,jobId:null,tries:0},r),this.data=null,this.userData={},this.errorMsg=null},n.ImageJob.prototype={start:function(){this.tries++;var r=this,s=this.abort;this.jobId=window.setTimeout(function(){r.finish(null,null,"Image load exceeded timeout ("+r.timeout+" ms)")},this.timeout),this.abort=function(){r.source.downloadTileAbort(r),typeof s=="function"&&s()},this.source.downloadTileStart(this)},finish:function(r,s,a){this.data=r,this.request=s,this.errorMsg=a,this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},n.ImageLoader=function(r){n.extend(!0,this,{jobLimit:n.DEFAULT_SETTINGS.imageLoaderLimit,timeout:n.DEFAULT_SETTINGS.timeout,jobQueue:[],failedTiles:[],jobsInProgress:0},r)},n.ImageLoader.prototype={addJob:function(r){if(!r.source){n.console.error("ImageLoader.prototype.addJob() requires [options.source]. TileSource since new API defines how images are fetched. Creating a dummy TileSource.");var s=n.TileSource.prototype;r.source={downloadTileStart:s.downloadTileStart,downloadTileAbort:s.downloadTileAbort}}var a=this,o=function(d){i(a,d,r.callback)},l={src:r.src,tile:r.tile||{},source:r.source,loadWithAjax:r.loadWithAjax,ajaxHeaders:r.loadWithAjax?r.ajaxHeaders:null,crossOriginPolicy:r.crossOriginPolicy,ajaxWithCredentials:r.ajaxWithCredentials,postData:r.postData,callback:o,abort:r.abort,timeout:this.timeout},u=new n.ImageJob(l);!this.jobLimit||this.jobsInProgress<this.jobLimit?(u.start(),this.jobsInProgress++):this.jobQueue.push(u)},clear:function(){for(var r=0;r<this.jobQueue.length;r++){var s=this.jobQueue[r];typeof s.abort=="function"&&s.abort()}this.jobQueue=[]}};function i(r,s,a){s.errorMsg!==""&&(s.data===null||s.data===void 0)&&s.tries<1+r.tileRetryMax&&r.failedTiles.push(s);var o;r.jobsInProgress--,(!r.jobLimit||r.jobsInProgress<r.jobLimit)&&r.jobQueue.length>0&&(o=r.jobQueue.shift(),o.start(),r.jobsInProgress++),r.tileRetryMax>0&&r.jobQueue.length===0&&(!r.jobLimit||r.jobsInProgress<r.jobLimit)&&r.failedTiles.length>0&&(o=r.failedTiles.shift(),setTimeout(function(){o.start()},r.tileRetryDelay),r.jobsInProgress++),a(s.data,s.errorMsg,s.request)}})(e),(function(n){n.Tile=function(i,r,s,a,o,l,u,d,f,p,m,y){this.level=i,this.x=r,this.y=s,this.bounds=a,this.sourceBounds=p,this.exists=o,this._url=l,this.postData=m,this.context2D=u,this.loadWithAjax=d,this.ajaxHeaders=f,y===void 0&&(n.console.warn("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),y=n.TileSource.prototype.getTileHashKey(i,r,s,l,f,m)),this.cacheKey=y,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.hasTransparency=!1,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},n.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return console.warn("Tile.prototype._hasTransparencyChannel() has been deprecated and will be removed in the future. Use TileSource.prototype.hasTransparency() instead."),!!this.context2D||this.getUrl().match(".png")},drawHTML:function(i){if(!this.cacheImageRecord){n.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){n.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}if(!this.element){var r=this.getImage();if(!r)return;this.element=n.makeNeutralElement("div"),this.imgElement=r.cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"}this.element.parentNode!==i&&i.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),n.setElementOpacity(this.element,this.opacity)},get image(){return n.console.error("[Tile.image] property has been deprecated. Use [Tile.prototype.getImage] instead."),this.getImage()},get url(){return n.console.error("[Tile.url] property has been deprecated. Use [Tile.prototype.getUrl] instead."),this.getUrl()},getImage:function(){return this.cacheImageRecord.getImage()},getUrl:function(){return typeof this._url=="function"?this._url():this._url},getCanvasContext:function(){return this.context2D||this.cacheImageRecord.getRenderedContext()},drawCanvas:function(i,r,s,a,o,l){var u=this.position.times(n.pixelDensityRatio),d=this.size.times(n.pixelDensityRatio),f;if(!this.context2D&&!this.cacheImageRecord){n.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(f=this.getCanvasContext(),!this.loaded||!f){n.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}i.save(),i.globalAlpha=this.opacity,typeof s=="number"&&s!==1&&(u=u.times(s),d=d.times(s)),a instanceof n.Point&&(u=u.plus(a)),i.globalAlpha===1&&this.hasTransparency&&(o&&(u.x=Math.round(u.x),u.y=Math.round(u.y),d.x=Math.round(d.x),d.y=Math.round(d.y)),i.clearRect(u.x,u.y,d.x,d.y)),r({context:i,tile:this,rendered:f});var p,m;this.sourceBounds?(p=Math.min(this.sourceBounds.width,f.canvas.width),m=Math.min(this.sourceBounds.height,f.canvas.height)):(p=f.canvas.width,m=f.canvas.height),i.translate(u.x+d.x/2,0),this.flipped&&i.scale(-1,1),i.drawImage(f.canvas,0,0,p,m,-d.x/2,u.y,d.x,d.y),i.restore()},getScaleForEdgeSmoothing:function(){var i;if(this.cacheImageRecord)i=this.cacheImageRecord.getRenderedContext();else if(this.context2D)i=this.context2D;else return n.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return i.canvas.width/(this.size.x*n.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(i,r,s){var a=Math.max(1,Math.ceil((s.x-r.x)/2)),o=Math.max(1,Math.ceil((s.y-r.y)/2));return new n.Point(a,o).minus(this.position.times(n.pixelDensityRatio).times(i||1).apply(function(l){return l%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}})(e),(function(n){n.OverlayPlacement=n.Placement,n.OverlayRotationMode=n.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),n.Overlay=function(i,r,s){var a;n.isPlainObject(i)?a=i:a={element:i,location:r,placement:s},this.element=a.element,this.style=a.element.style,this._init(a)},n.Overlay.prototype={_init:function(i){this.location=i.location,this.placement=i.placement===void 0?n.Placement.TOP_LEFT:i.placement,this.onDraw=i.onDraw,this.checkResize=i.checkResize===void 0?!0:i.checkResize,this.width=i.width===void 0?null:i.width,this.height=i.height===void 0?null:i.height,this.rotationMode=i.rotationMode||n.OverlayRotationMode.EXACT,this.location instanceof n.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=n.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new n.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(i,r){var s=n.Placement.properties[this.placement];s&&(s.isHorizontallyCentered?i.x-=r.x/2:s.isRight&&(i.x-=r.x),s.isVerticallyCentered?i.y-=r.y/2:s.isBottom&&(i.y-=r.y))},destroy:function(){var i=this.element,r=this.style;i.parentNode&&(i.parentNode.removeChild(i),i.prevElementParent&&(r.display="none",document.body.appendChild(i))),this.onDraw=null,r.top="",r.left="",r.position="",this.width!==null&&(r.width=""),this.height!==null&&(r.height="");var s=n.getCssPropertyWithVendorPrefix("transformOrigin"),a=n.getCssPropertyWithVendorPrefix("transform");s&&a&&(r[s]="",r[a]="")},drawHTML:function(i,r){var s=this.element;s.parentNode!==i&&(s.prevElementParent=s.parentNode,s.prevNextSibling=s.nextSibling,i.appendChild(s),this.style.position="absolute",this.size=n.getElementSize(s));var a=this._getOverlayPositionAndSize(r),o=a.position,l=this.size=a.size,u=a.rotate;if(this.onDraw)this.onDraw(o,l,this.element);else{var d=this.style;d.left=o.x+"px",d.top=o.y+"px",this.width!==null&&(d.width=l.x+"px"),this.height!==null&&(d.height=l.y+"px");var f=n.getCssPropertyWithVendorPrefix("transformOrigin"),p=n.getCssPropertyWithVendorPrefix("transform");f&&p&&(u?(d[f]=this._getTransformOrigin(),d[p]="rotate("+u+"deg)"):(d[f]="",d[p]="")),d.display="block"}},_getOverlayPositionAndSize:function(i){var r=i.pixelFromPoint(this.location,!0),s=this._getSizeInPixels(i);this.adjust(r,s);var a=0;if(i.getRotation(!0)&&this.rotationMode!==n.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===n.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var o=new n.Rect(r.x,r.y,s.x,s.y),l=this._getBoundingBox(o,i.getRotation(!0));r=l.getTopLeft(),s=l.getSize()}else a=i.getRotation(!0);return{position:r,size:s,rotate:a}},_getSizeInPixels:function(i){var r=this.size.x,s=this.size.y;if(this.width!==null||this.height!==null){var a=i.deltaPixelsFromPointsNoRotate(new n.Point(this.width||0,this.height||0),!0);this.width!==null&&(r=a.x),this.height!==null&&(s=a.y)}if(this.checkResize&&(this.width===null||this.height===null)){var o=this.size=n.getElementSize(this.element);this.width===null&&(r=o.x),this.height===null&&(s=o.y)}return new n.Point(r,s)},_getBoundingBox:function(i,r){var s=this._getPlacementPoint(i);return i.rotate(r,s).getBoundingBox()},_getPlacementPoint:function(i){var r=new n.Point(i.x,i.y),s=n.Placement.properties[this.placement];return s&&(s.isHorizontallyCentered?r.x+=i.width/2:s.isRight&&(r.x+=i.width),s.isVerticallyCentered?r.y+=i.height/2:s.isBottom&&(r.y+=i.height)),r},_getTransformOrigin:function(){var i="",r=n.Placement.properties[this.placement];return r&&(r.isLeft?i="left":r.isRight&&(i="right"),r.isTop?i+=" top":r.isBottom&&(i+=" bottom")),i},update:function(i,r){var s=n.isPlainObject(i)?i:{location:i,placement:r};this._init({location:s.location||this.location,placement:s.placement!==void 0?s.placement:this.placement,onDraw:s.onDraw||this.onDraw,checkResize:s.checkResize||this.checkResize,width:s.width!==void 0?s.width:this.width,height:s.height!==void 0?s.height:this.height,rotationMode:s.rotationMode||this.rotationMode})},getBounds:function(i){n.console.assert(i,"A viewport must now be passed to Overlay.getBounds.");var r=this.width,s=this.height;if(r===null||s===null){var a=i.deltaPointsFromPixelsNoRotate(this.size,!0);r===null&&(r=a.x),s===null&&(s=a.y)}var o=this.location.clone();return this.adjust(o,new n.Point(r,s)),this._adjustBoundsForRotation(i,new n.Rect(o.x,o.y,r,s))},_adjustBoundsForRotation:function(i,r){if(!i||i.getRotation(!0)===0||this.rotationMode===n.OverlayRotationMode.EXACT)return r;if(this.rotationMode===n.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return r;var s=this._getOverlayPositionAndSize(i);return i.viewerElementToViewportRectangle(new n.Rect(s.position.x,s.position.y,s.size.x,s.size.y))}return r.rotate(-i.getRotation(!0),this._getPlacementPoint(r))}}})(e),(function(n){n.Drawer=function(i){n.console.assert(i.viewer,"[Drawer] options.viewer is required");var r=arguments;if(n.isPlainObject(i)||(i={source:r[0],viewport:r[1],element:r[2]}),n.console.assert(i.viewport,"[Drawer] options.viewport is required"),n.console.assert(i.element,"[Drawer] options.element is required"),i.source&&n.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=i.viewer,this.viewport=i.viewport,this.debugGridColor=typeof i.debugGridColor=="string"?[i.debugGridColor]:i.debugGridColor||n.DEFAULT_SETTINGS.debugGridColor,i.opacity&&n.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=n.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=n.getElement(i.element),this.canvas=n.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var s=this._calculateCanvasSize();this.canvas.width=s.x,this.canvas.height=s.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",n.setElementOpacity(this.canvas,this.opacity,!0),n.setElementPointerEventsNone(this.canvas),n.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},n.Drawer.prototype={addOverlay:function(i,r,s,a){return n.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(i,r,s,a),this},updateOverlay:function(i,r,s){return n.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(i,r,s),this},removeOverlay:function(i){return n.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(i),this},clearOverlays:function(){return n.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(i){var r=this.viewport.pixelFromPointNoRotate(i,!0);return new n.Point(r.x*n.pixelDensityRatio,r.y*n.pixelDensityRatio)},clipWithPolygons:function(i,r){if(this.useCanvas){var s=this._getContext(r);s.beginPath(),i.forEach(function(a){a.forEach(function(o,l){s[l===0?"moveTo":"lineTo"](o.x,o.y)})}),s.clip()}},setOpacity:function(i){n.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var r=this.viewer.world,s=0;s<r.getItemCount();s++)r.getItemAt(s).setOpacity(i);return this},getOpacity:function(){n.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var i=this.viewer.world,r=0,s=0;s<i.getItemCount();s++){var a=i.getItemAt(s).getOpacity();a>r&&(r=a)}return r},needsUpdate:function(){return n.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return n.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return n.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return n.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var i=this._calculateCanvasSize();if((this.canvas.width!==i.x||this.canvas.height!==i.y)&&(this.canvas.width=i.x,this.canvas.height=i.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var r=this._calculateSketchCanvasSize();this.sketchCanvas.width=r.x,this.sketchCanvas.height=r.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(i,r){if(this.useCanvas){var s=this._getContext(i);if(r)s.clearRect(r.x,r.y,r.width,r.height);else{var a=s.canvas;s.clearRect(0,0,a.width,a.height)}}},viewportToDrawerRectangle:function(i){var r=this.viewport.pixelFromPointNoRotate(i.getTopLeft(),!0),s=this.viewport.deltaPixelsFromPointsNoRotate(i.getSize(),!0);return new n.Rect(r.x*n.pixelDensityRatio,r.y*n.pixelDensityRatio,s.x*n.pixelDensityRatio,s.y*n.pixelDensityRatio)},drawTile:function(i,r,s,a,o,l,u){if(n.console.assert(i,"[Drawer.drawTile] tile is required"),n.console.assert(r,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var d=this._getContext(s);a=a||1,i.drawCanvas(d,r,a,o,l,u)}else i.drawHTML(this.canvas)},_getContext:function(i){var r=this.context;if(i){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var s=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=s.x,this.sketchCanvas.height=s.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var a=this;this.viewer.addHandler("rotate",function o(){if(a.viewport.getRotation()!==0){a.viewer.removeHandler("rotate",o);var l=a._calculateSketchCanvasSize();a.sketchCanvas.width=l.x,a.sketchCanvas.height=l.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}r=this.sketchContext}return r},saveContext:function(i){this.useCanvas&&this._getContext(i).save()},restoreContext:function(i){this.useCanvas&&this._getContext(i).restore()},setClip:function(i,r){if(this.useCanvas){var s=this._getContext(r);s.beginPath(),s.rect(i.x,i.y,i.width,i.height),s.clip()}},drawRectangle:function(i,r,s){if(this.useCanvas){var a=this._getContext(s);a.save(),a.fillStyle=r,a.fillRect(i.x,i.y,i.width,i.height),a.restore()}},blendSketch:function(i,r,s,a){var o=i;if(n.isPlainObject(o)||(o={opacity:i,scale:r,translate:s,compositeOperation:a}),!(!this.useCanvas||!this.sketchCanvas)){i=o.opacity,a=o.compositeOperation;var l=o.bounds;if(this.context.save(),this.context.globalAlpha=i,a&&(this.context.globalCompositeOperation=a),l)l.x<0&&(l.width+=l.x,l.x=0),l.x+l.width>this.canvas.width&&(l.width=this.canvas.width-l.x),l.y<0&&(l.height+=l.y,l.y=0),l.y+l.height>this.canvas.height&&(l.height=this.canvas.height-l.y),this.context.drawImage(this.sketchCanvas,l.x,l.y,l.width,l.height,l.x,l.y,l.width,l.height);else{r=o.scale||1,s=o.translate;var u=s instanceof n.Point?s:new n.Point(0,0),d=0,f=0;if(s){var p=this.sketchCanvas.width-this.canvas.width,m=this.sketchCanvas.height-this.canvas.height;d=Math.round(p/2),f=Math.round(m/2)}this.context.drawImage(this.sketchCanvas,u.x-d*r,u.y-f*r,(this.canvas.width+2*d)*r,(this.canvas.height+2*f)*r,-d,-f,this.canvas.width+2*d,this.canvas.height+2*f)}this.context.restore()}},drawDebugInfo:function(i,r,s,a){if(this.useCanvas){var o=this.viewer.world.getIndexOfItem(a)%this.debugGridColor.length,l=this.context;l.save(),l.lineWidth=2*n.pixelDensityRatio,l.font="small-caps bold "+13*n.pixelDensityRatio+"px arial",l.strokeStyle=this.debugGridColor[o],l.fillStyle=this.debugGridColor[o],this.viewport.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:this.viewport.getRotation(!0)}),a.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:a.getRotation(!0),point:a.viewport.pixelFromPointNoRotate(a._getRotationPoint(!0),!0)}),a.viewport.getRotation(!0)%360===0&&a.getRotation(!0)%360===0&&a._drawer.viewer.viewport.getFlip()&&a._drawer._flip(),l.strokeRect(i.position.x*n.pixelDensityRatio,i.position.y*n.pixelDensityRatio,i.size.x*n.pixelDensityRatio,i.size.y*n.pixelDensityRatio);var u=(i.position.x+i.size.x/2)*n.pixelDensityRatio,d=(i.position.y+i.size.y/2)*n.pixelDensityRatio;l.translate(u,d),l.rotate(Math.PI/180*-this.viewport.getRotation(!0)),l.translate(-u,-d),i.x===0&&i.y===0&&(l.fillText("Zoom: "+this.viewport.getZoom(),i.position.x*n.pixelDensityRatio,(i.position.y-30)*n.pixelDensityRatio),l.fillText("Pan: "+this.viewport.getBounds().toString(),i.position.x*n.pixelDensityRatio,(i.position.y-20)*n.pixelDensityRatio)),l.fillText("Level: "+i.level,(i.position.x+10)*n.pixelDensityRatio,(i.position.y+20)*n.pixelDensityRatio),l.fillText("Column: "+i.x,(i.position.x+10)*n.pixelDensityRatio,(i.position.y+30)*n.pixelDensityRatio),l.fillText("Row: "+i.y,(i.position.x+10)*n.pixelDensityRatio,(i.position.y+40)*n.pixelDensityRatio),l.fillText("Order: "+s+" of "+r,(i.position.x+10)*n.pixelDensityRatio,(i.position.y+50)*n.pixelDensityRatio),l.fillText("Size: "+i.size.toString(),(i.position.x+10)*n.pixelDensityRatio,(i.position.y+60)*n.pixelDensityRatio),l.fillText("Position: "+i.position.toString(),(i.position.x+10)*n.pixelDensityRatio,(i.position.y+70)*n.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),a.getRotation(!0)%360!==0&&this._restoreRotationChanges(),a.viewport.getRotation(!0)%360===0&&a.getRotation(!0)%360===0&&a._drawer.viewer.viewport.getFlip()&&a._drawer._flip(),l.restore()}},debugRect:function(i){if(this.useCanvas){var r=this.context;r.save(),r.lineWidth=2*n.pixelDensityRatio,r.strokeStyle=this.debugGridColor[0],r.fillStyle=this.debugGridColor[0],r.strokeRect(i.x*n.pixelDensityRatio,i.y*n.pixelDensityRatio,i.width*n.pixelDensityRatio,i.height*n.pixelDensityRatio),r.restore()}},setImageSmoothingEnabled:function(i){this.useCanvas&&(this._imageSmoothingEnabled=i,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(i){i.msImageSmoothingEnabled=this._imageSmoothingEnabled,i.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(i){var r=this._getContext(i).canvas;return new n.Point(r.width,r.height)},getCanvasCenter:function(){return new n.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(i){var r=i.point?i.point.times(n.pixelDensityRatio):this.getCanvasCenter(),s=this._getContext(i.useSketch);s.save(),s.translate(r.x,r.y),this.viewer.viewport.flipped?(s.rotate(Math.PI/180*-i.degrees),s.scale(-1,1)):s.rotate(Math.PI/180*i.degrees),s.translate(-r.x,-r.y)},_flip:function(i){i=i||{};var r=i.point?i.point.times(n.pixelDensityRatio):this.getCanvasCenter(),s=this._getContext(i.useSketch);s.translate(r.x,0),s.scale(-1,1),s.translate(-r.x,0)},_restoreRotationChanges:function(i){var r=this._getContext(i);r.restore()},_calculateCanvasSize:function(){var i=n.pixelDensityRatio,r=this.viewport.getContainerSize();return{x:Math.round(r.x*i),y:Math.round(r.y*i)}},_calculateSketchCanvasSize:function(){var i=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return i;var r=Math.ceil(Math.sqrt(i.x*i.x+i.y*i.y));return{x:r,y:r}}}})(e),(function(n){n.Viewport=function(i){var r=arguments;r.length&&r[0]instanceof n.Point&&(i={containerSize:r[0],contentSize:r[1],config:r[2]}),i.config&&(n.extend(!0,i,i.config),delete i.config),this._margins=n.extend({left:0,top:0,right:0,bottom:0},i.margins||{}),delete i.margins,i.initialDegrees=i.degrees,delete i.degrees,n.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,rotationPivot:null,viewer:null,springStiffness:n.DEFAULT_SETTINGS.springStiffness,animationTime:n.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:n.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:n.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:n.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:n.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:n.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:n.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:n.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:n.DEFAULT_SETTINGS.maxZoomLevel,initialDegrees:n.DEFAULT_SETTINGS.degrees,flipped:n.DEFAULT_SETTINGS.flipped,homeFillsViewer:n.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:n.DEFAULT_SETTINGS.silenceMultiImageWarnings},i),this._updateContainerInnerSize(),this.centerSpringX=new n.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new n.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new n.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.degreesSpring=new n.Spring({initial:i.initialDegrees,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,this._setContentBounds(new n.Rect(0,0,1,1),1),this.goHome(!0),this.update()},n.Viewport.prototype={get degrees(){return n.console.warn("Accessing [Viewport.degrees] is deprecated. Use viewport.getRotation instead."),this.getRotation()},set degrees(i){n.console.warn("Setting [Viewport.degrees] is deprecated. Use viewport.rotateTo, viewport.rotateBy, or viewport.setRotation instead."),this.rotateTo(i)},resetContentSize:function(i){return n.console.assert(i,"[Viewport.resetContentSize] contentSize is required"),n.console.assert(i instanceof n.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),n.console.assert(i.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),n.console.assert(i.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new n.Rect(0,0,1,i.y/i.x),i.x),this},setHomeBounds:function(i,r){n.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(i,r)},_setContentBounds:function(i,r){n.console.assert(i,"[Viewport._setContentBounds] bounds is required"),n.console.assert(i instanceof n.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),n.console.assert(i.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),n.console.assert(i.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=i.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(r),this._contentBounds=i.rotate(this.getRotation()).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(r),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:r,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var i=this._contentAspectRatio/this.getAspectRatio(),r;return this.homeFillsViewer?r=i>=1?i:1:r=i>=1?1:i,r/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var i=this._contentBounds.getCenter(),r=1/this.getHomeZoom(),s=r/this.getAspectRatio();return new n.Rect(i.x-r/2,i.y-s/2,r,s)},goHome:function(i){return this.viewer&&this.viewer.raiseEvent("home",{immediately:i}),this.fitBounds(this.getHomeBounds(),i)},getMinZoom:function(){var i=this.getHomeZoom(),r=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*i;return r},getMaxZoom:function(){var i=this.maxZoomLevel;return i||(i=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,i/=this._contentBounds.width),Math.max(i,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new n.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return n.extend({},this._margins)},setMargins:function(i){n.console.assert(n.type(i)==="object","[Viewport.setMargins] margins must be an object"),this._margins=n.extend({left:0,top:0,right:0,bottom:0},i),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(i){return this.getBoundsNoRotate(i).rotate(-this.getRotation(i))},getBoundsNoRotate:function(i){var r=this.getCenter(i),s=1/this.getZoom(i),a=s/this.getAspectRatio();return new n.Rect(r.x-s/2,r.y-a/2,s,a)},getBoundsWithMargins:function(i){return this.getBoundsNoRotateWithMargins(i).rotate(-this.getRotation(i),this.getCenter(i))},getBoundsNoRotateWithMargins:function(i){var r=this.getBoundsNoRotate(i),s=this._containerInnerSize.x*this.getZoom(i);return r.x-=this._margins.left/s,r.y-=this._margins.top/s,r.width+=(this._margins.left+this._margins.right)/s,r.height+=(this._margins.top+this._margins.bottom)/s,r},getCenter:function(i){var r=new n.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),s=new n.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),a,o,l,u,d,f,p,m;return i?r:this.zoomPoint?(a=this.pixelFromPoint(this.zoomPoint,!0),o=this.getZoom(),l=1/o,u=l/this.getAspectRatio(),d=new n.Rect(r.x-l/2,r.y-u/2,l,u),f=this._pixelFromPoint(this.zoomPoint,d),p=f.minus(a).rotate(-this.getRotation(!0)),m=p.divide(this._containerInnerSize.x*o),s.plus(m)):s},getZoom:function(i){return i?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(i){return Math.max(Math.min(i,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(i){var r=this.viewportToViewerElementRectangle(i).getBoundingBox(),s=this.viewportToViewerElementRectangle(this._contentBoundsNoRotate).getBoundingBox(),a=!1,o=!1;if(!this.wrapHorizontal){var l=r.x+r.width,u=s.x+s.width,d,f,p;r.width>s.width?d=this.visibilityRatio*s.width:d=this.visibilityRatio*r.width,f=s.x-l+d,p=u-r.x-d,d>s.width?(r.x+=(f+p)/2,a=!0):p<0?(r.x+=p,a=!0):f>0&&(r.x+=f,a=!0)}if(!this.wrapVertical){var m=r.y+r.height,y=s.y+s.height,b,E,T;r.height>s.height?b=this.visibilityRatio*s.height:b=this.visibilityRatio*r.height,E=s.y-m+b,T=y-r.y-b,b>s.height?(r.y+=(E+T)/2,o=!0):T<0?(r.y+=T,o=!0):E>0&&(r.y+=E,o=!0)}var x=a||o,S=x?this.viewerElementToViewportRectangle(r):i.clone();return S.xConstrained=a,S.yConstrained=o,S.constraintApplied=x,S},_raiseConstraintsEvent:function(i){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:i})},applyConstraints:function(i){var r=this.getZoom(),s=this._applyZoomConstraints(r);r!==s&&this.zoomTo(s,this.zoomPoint,i);var a=this.getConstrainedBounds(!1);return a.constraintApplied&&(this.fitBounds(a,i),this._raiseConstraintsEvent(i)),this},ensureVisible:function(i){return this.applyConstraints(i)},_fitBounds:function(i,r){r=r||{};var s=r.immediately||!1,a=r.constraints||!1,o=this.getAspectRatio(),l=i.getCenter(),u=new n.Rect(i.x,i.y,i.width,i.height,i.degrees+this.getRotation()).getBoundingBox();u.getAspectRatio()>=o?u.height=u.width/o:u.width=u.height*o,u.x=l.x-u.width/2,u.y=l.y-u.height/2;var d=1/u.width;if(s)return this.panTo(l,!0),this.zoomTo(d,null,!0),a&&this.applyConstraints(!0),this;var f=this.getCenter(!0),p=this.getZoom(!0);this.panTo(f,!0),this.zoomTo(p,null,!0);var m=this.getBounds(),y=this.getZoom();if(y===0||Math.abs(d/y-1)<1e-8)return this.zoomTo(d,null,!0),this.panTo(l,s),a&&this.applyConstraints(!1),this;if(a){this.panTo(l,!1),d=this._applyZoomConstraints(d),this.zoomTo(d,null,!1);var b=this.getConstrainedBounds();this.panTo(f,!0),this.zoomTo(p,null,!0),this.fitBounds(b)}else{var E=u.rotate(-this.getRotation()),T=E.getTopLeft().times(d).minus(m.getTopLeft().times(y)).divide(d-y);this.zoomTo(d,T,s)}return this},fitBounds:function(i,r){return this._fitBounds(i,{immediately:r,constraints:!1})},fitBoundsWithConstraints:function(i,r){return this._fitBounds(i,{immediately:r,constraints:!0})},fitVertically:function(i){var r=new n.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(r,i)},fitHorizontally:function(i){var r=new n.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(r,i)},getConstrainedBounds:function(i){var r,s;return r=this.getBounds(i),s=this._applyBoundaryConstraints(r),s},panBy:function(i,r){var s=new n.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(s.plus(i),r)},panTo:function(i,r){return r?(this.centerSpringX.resetTo(i.x),this.centerSpringY.resetTo(i.y)):(this.centerSpringX.springTo(i.x),this.centerSpringY.springTo(i.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:i,immediately:r}),this},zoomBy:function(i,r,s){return this.zoomTo(this.zoomSpring.target.value*i,r,s)},zoomTo:function(i,r,s){var a=this;return this.zoomPoint=r instanceof n.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,s?this._adjustCenterSpringsForZoomPoint(function(){a.zoomSpring.resetTo(i)}):this.zoomSpring.springTo(i),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:i,refPoint:r,immediately:s}),this},setRotation:function(i,r){return this.rotateTo(i,null,r)},getRotation:function(i){return i?this.degreesSpring.current.value:this.degreesSpring.target.value},setRotationWithPivot:function(i,r,s){return this.rotateTo(i,r,s)},rotateTo:function(i,r,s){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(this.degreesSpring.target.value===i&&this.degreesSpring.isAtTargetValue())return this;if(this.rotationPivot=r instanceof n.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,s)if(this.rotationPivot){var a=i-this._oldDegrees;if(!a)return this.rotationPivot=null,this;this._rotateAboutPivot(i)}else this.degreesSpring.resetTo(i);else{var o=n.positiveModulo(this.degreesSpring.current.value,360),l=n.positiveModulo(i,360),u=l-o;u>180?l-=360:u<-180&&(l+=360);var d=o-l;this.degreesSpring.resetTo(i+d),this.degreesSpring.springTo(i)}return this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:i,immediately:!!s,pivot:this.rotationPivot||this.getCenter()}),this},rotateBy:function(i,r,s){return this.rotateTo(this.degreesSpring.target.value+i,r,s)},resize:function(i,r){var s=this.getBoundsNoRotate(),a=s,o;this.containerSize.x=i.x,this.containerSize.y=i.y,this._updateContainerInnerSize(),r&&(o=i.x/this.containerSize.x,a.width=s.width*o,a.height=a.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:i,maintain:r});var l=this.fitBounds(a,!0);return this.viewer&&this.viewer.raiseEvent("after-resize",{newContainerSize:i,maintain:r}),l},_updateContainerInnerSize:function(){this._containerInnerSize=new n.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var i=this;this._adjustCenterSpringsForZoomPoint(function(){i.zoomSpring.update()}),this.degreesSpring.isAtTargetValue()&&(this.rotationPivot=null),this.centerSpringX.update(),this.centerSpringY.update(),this.rotationPivot?this._rotateAboutPivot(!0):this.degreesSpring.update();var r=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom||this.degreesSpring.current.value!==this._oldDegrees;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,r},_rotateAboutPivot:function(i){var r=i===!0,s=this.rotationPivot.minus(this.getCenter());this.centerSpringX.shiftBy(s.x),this.centerSpringY.shiftBy(s.y),r?this.degreesSpring.update():this.degreesSpring.resetTo(i);var a=this.degreesSpring.current.value-this._oldDegrees,o=s.rotate(a*-1).times(-1);this.centerSpringX.shiftBy(o.x),this.centerSpringY.shiftBy(o.y)},_adjustCenterSpringsForZoomPoint:function(i){if(this.zoomPoint){var r=this.pixelFromPoint(this.zoomPoint,!0);i();var s=this.pixelFromPoint(this.zoomPoint,!0),a=s.minus(r),o=this.deltaPointsFromPixels(a,!0);this.centerSpringX.shiftBy(o.x),this.centerSpringY.shiftBy(o.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else i()},deltaPixelsFromPointsNoRotate:function(i,r){return i.times(this._containerInnerSize.x*this.getZoom(r))},deltaPixelsFromPoints:function(i,r){return this.deltaPixelsFromPointsNoRotate(i.rotate(this.getRotation(r)),r)},deltaPointsFromPixelsNoRotate:function(i,r){return i.divide(this._containerInnerSize.x*this.getZoom(r))},deltaPointsFromPixels:function(i,r){return this.deltaPointsFromPixelsNoRotate(i,r).rotate(-this.getRotation(r))},pixelFromPointNoRotate:function(i,r){return this._pixelFromPointNoRotate(i,this.getBoundsNoRotate(r))},pixelFromPoint:function(i,r){return this._pixelFromPoint(i,this.getBoundsNoRotate(r))},_pixelFromPointNoRotate:function(i,r){return i.minus(r.getTopLeft()).times(this._containerInnerSize.x/r.width).plus(new n.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(i,r){return this._pixelFromPointNoRotate(i.rotate(this.getRotation(!0),this.getCenter(!0)),r)},pointFromPixelNoRotate:function(i,r){var s=this.getBoundsNoRotate(r);return i.minus(new n.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/s.width).plus(s.getTopLeft())},pointFromPixel:function(i,r){return this.pointFromPixelNoRotate(i,r).rotate(-this.getRotation(r),this.getCenter(r))},_viewportToImageDelta:function(i,r){var s=this._contentBoundsNoRotate.width;return new n.Point(i*this._contentSizeNoRotate.x/s,r*this._contentSizeNoRotate.x/s)},viewportToImageCoordinates:function(i,r){if(i instanceof n.Point)return this.viewportToImageCoordinates(i.x,i.y);if(this.viewer){var s=this.viewer.world.getItemCount();if(s>1)this.silenceMultiImageWarnings||n.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(s===1){var a=this.viewer.world.getItemAt(0);return a.viewportToImageCoordinates(i,r,!0)}}return this._viewportToImageDelta(i-this._contentBoundsNoRotate.x,r-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(i,r){var s=this._contentBoundsNoRotate.width;return new n.Point(i/this._contentSizeNoRotate.x*s,r/this._contentSizeNoRotate.x*s)},imageToViewportCoordinates:function(i,r){if(i instanceof n.Point)return this.imageToViewportCoordinates(i.x,i.y);if(this.viewer){var s=this.viewer.world.getItemCount();if(s>1)this.silenceMultiImageWarnings||n.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(s===1){var a=this.viewer.world.getItemAt(0);return a.imageToViewportCoordinates(i,r,!0)}}var o=this._imageToViewportDelta(i,r);return o.x+=this._contentBoundsNoRotate.x,o.y+=this._contentBoundsNoRotate.y,o},imageToViewportRectangle:function(i,r,s,a){var o=i;if(o instanceof n.Rect||(o=new n.Rect(i,r,s,a)),this.viewer){var l=this.viewer.world.getItemCount();if(l>1)this.silenceMultiImageWarnings||n.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(l===1){var u=this.viewer.world.getItemAt(0);return u.imageToViewportRectangle(i,r,s,a,!0)}}var d=this.imageToViewportCoordinates(o.x,o.y),f=this._imageToViewportDelta(o.width,o.height);return new n.Rect(d.x,d.y,f.x,f.y,o.degrees)},viewportToImageRectangle:function(i,r,s,a){var o=i;if(o instanceof n.Rect||(o=new n.Rect(i,r,s,a)),this.viewer){var l=this.viewer.world.getItemCount();if(l>1)this.silenceMultiImageWarnings||n.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(l===1){var u=this.viewer.world.getItemAt(0);return u.viewportToImageRectangle(i,r,s,a,!0)}}var d=this.viewportToImageCoordinates(o.x,o.y),f=this._viewportToImageDelta(o.width,o.height);return new n.Rect(d.x,d.y,f.x,f.y,o.degrees)},viewerElementToImageCoordinates:function(i){var r=this.pointFromPixel(i,!0);return this.viewportToImageCoordinates(r)},imageToViewerElementCoordinates:function(i){var r=this.imageToViewportCoordinates(i);return this.pixelFromPoint(r,!0)},windowToImageCoordinates:function(i){n.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var r=i.minus(n.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(r)},imageToWindowCoordinates:function(i){n.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var r=this.imageToViewerElementCoordinates(i);return r.plus(n.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(i){return this.pointFromPixel(i,!0)},viewportToViewerElementCoordinates:function(i){return this.pixelFromPoint(i,!0)},viewerElementToViewportRectangle:function(i){return n.Rect.fromSummits(this.pointFromPixel(i.getTopLeft(),!0),this.pointFromPixel(i.getTopRight(),!0),this.pointFromPixel(i.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(i){return n.Rect.fromSummits(this.pixelFromPoint(i.getTopLeft(),!0),this.pixelFromPoint(i.getTopRight(),!0),this.pixelFromPoint(i.getBottomLeft(),!0))},windowToViewportCoordinates:function(i){n.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var r=i.minus(n.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(r)},viewportToWindowCoordinates:function(i){n.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var r=this.viewportToViewerElementCoordinates(i);return r.plus(n.getElementPosition(this.viewer.element))},viewportToImageZoom:function(i){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)this.silenceMultiImageWarnings||n.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(r===1){var s=this.viewer.world.getItemAt(0);return s.viewportToImageZoom(i)}}var a=this._contentSizeNoRotate.x,o=this._containerInnerSize.x,l=this._contentBoundsNoRotate.width,u=o/a*l;return i*u},imageToViewportZoom:function(i){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)this.silenceMultiImageWarnings||n.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(r===1){var s=this.viewer.world.getItemAt(0);return s.imageToViewportZoom(i)}}var a=this._contentSizeNoRotate.x,o=this._containerInnerSize.x,l=this._contentBoundsNoRotate.width,u=a/o/l;return i*u},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(i){return this.flipped===i?this:(this.flipped=i,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:i}),this)}}})(e),(function(n){n.TiledImage=function(o){var l=this;n.console.assert(o.tileCache,"[TiledImage] options.tileCache is required"),n.console.assert(o.drawer,"[TiledImage] options.drawer is required"),n.console.assert(o.viewer,"[TiledImage] options.viewer is required"),n.console.assert(o.imageLoader,"[TiledImage] options.imageLoader is required"),n.console.assert(o.source,"[TiledImage] options.source is required"),n.console.assert(!o.clip||o.clip instanceof n.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),n.EventSource.call(this),this._tileCache=o.tileCache,delete o.tileCache,this._drawer=o.drawer,delete o.drawer,this._imageLoader=o.imageLoader,delete o.imageLoader,o.clip instanceof n.Rect&&(this._clip=o.clip.clone()),delete o.clip;var u=o.x||0;delete o.x;var d=o.y||0;delete o.y,this.normHeight=o.source.dimensions.y/o.source.dimensions.x,this.contentAspectX=o.source.dimensions.x/o.source.dimensions.y;var f=1;o.width?(f=o.width,delete o.width,o.height&&(n.console.error("specifying both width and height to a tiledImage is not supported"),delete o.height)):o.height&&(f=o.height/this.normHeight,delete o.height);var p=o.fitBounds;delete o.fitBounds;var m=o.fitBoundsPlacement||e.Placement.CENTER;delete o.fitBoundsPlacement;var y=o.degrees||0;delete o.degrees;var b=o.ajaxHeaders;delete o.ajaxHeaders,n.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:n.DEFAULT_SETTINGS.springStiffness,animationTime:n.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:n.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:n.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:n.DEFAULT_SETTINGS.wrapVertical,immediateRender:n.DEFAULT_SETTINGS.immediateRender,blendTime:n.DEFAULT_SETTINGS.blendTime,alwaysBlend:n.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:n.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:n.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:n.DEFAULT_SETTINGS.iOSDevice,debugMode:n.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:n.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:n.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:n.DEFAULT_SETTINGS.placeholderFillStyle,opacity:n.DEFAULT_SETTINGS.opacity,preload:n.DEFAULT_SETTINGS.preload,compositeOperation:n.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:n.DEFAULT_SETTINGS.subPixelRoundingForTransparency},o),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new n.Spring({initial:u,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new n.Spring({initial:d,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new n.Spring({initial:f,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new n.Spring({initial:y,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),p&&this.fitBounds(p,m,!0),this._drawingHandler=function(E){l.viewer.raiseEvent("tile-drawing",n.extend({tiledImage:l},E))},this._ownAjaxHeaders={},this.setAjaxHeaders(b,!1)},n.extend(n.TiledImage.prototype,n.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(o){o!==this._fullyLoaded&&(this._fullyLoaded=o,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=n.now(),this._needsDraw=!0},update:function(){var o=this._xSpring.update(),l=this._ySpring.update(),u=this._scaleSpring.update(),d=this._degreesSpring.update();return o||l||u||d?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(o){return this.getBoundsNoRotate(o).rotate(this.getRotation(o),this._getRotationPoint(o))},getBoundsNoRotate:function(o){return o?new n.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new n.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return n.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(o){var l=this.getBoundsNoRotate(o);if(this._clip){var u=o?this._worldWidthCurrent:this._worldWidthTarget,d=u/this.source.dimensions.x,f=this._clip.times(d);l=new n.Rect(l.x+f.x,l.y+f.y,f.width,f.height)}return l.rotate(this.getRotation(o),this._getRotationPoint(o))},getTileBounds:function(o,l,u){var d=this.source.getNumTiles(o),f=(d.x+l%d.x)%d.x,p=(d.y+u%d.y)%d.y,m=this.source.getTileBounds(o,f,p);return this.getFlip()&&(m.x=1-m.x-m.width),m.x+=(l-f)/d.x,m.y+=this._worldHeightCurrent/this._worldWidthCurrent*((u-p)/d.y),m},getContentSize:function(){return new n.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var o=this.imageToWindowCoordinates(new n.Point(0,0)),l=this.imageToWindowCoordinates(this.getContentSize());return new n.Point(l.x-o.x,l.y-o.y)},_viewportToImageDelta:function(o,l,u){var d=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new n.Point(o*(this.source.dimensions.x/d),l*(this.source.dimensions.y*this.contentAspectX/d))},viewportToImageCoordinates:function(o,l,u){var d;return o instanceof n.Point?(u=l,d=o):d=new n.Point(o,l),d=d.rotate(-this.getRotation(u),this._getRotationPoint(u)),u?this._viewportToImageDelta(d.x-this._xSpring.current.value,d.y-this._ySpring.current.value):this._viewportToImageDelta(d.x-this._xSpring.target.value,d.y-this._ySpring.target.value)},_imageToViewportDelta:function(o,l,u){var d=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new n.Point(o/this.source.dimensions.x*d,l/this.source.dimensions.y/this.contentAspectX*d)},imageToViewportCoordinates:function(o,l,u){o instanceof n.Point&&(u=l,l=o.y,o=o.x);var d=this._imageToViewportDelta(o,l);return u?(d.x+=this._xSpring.current.value,d.y+=this._ySpring.current.value):(d.x+=this._xSpring.target.value,d.y+=this._ySpring.target.value),d.rotate(this.getRotation(u),this._getRotationPoint(u))},imageToViewportRectangle:function(o,l,u,d,f){var p=o;p instanceof n.Rect?f=l:p=new n.Rect(o,l,u,d);var m=this.imageToViewportCoordinates(p.getTopLeft(),f),y=this._imageToViewportDelta(p.width,p.height,f);return new n.Rect(m.x,m.y,y.x,y.y,p.degrees+this.getRotation(f))},viewportToImageRectangle:function(o,l,u,d,f){var p=o;o instanceof n.Rect?f=l:p=new n.Rect(o,l,u,d);var m=this.viewportToImageCoordinates(p.getTopLeft(),f),y=this._viewportToImageDelta(p.width,p.height,f);return new n.Rect(m.x,m.y,y.x,y.y,p.degrees-this.getRotation(f))},viewerElementToImageCoordinates:function(o){var l=this.viewport.pointFromPixel(o,!0);return this.viewportToImageCoordinates(l)},imageToViewerElementCoordinates:function(o){var l=this.imageToViewportCoordinates(o);return this.viewport.pixelFromPoint(l,!0)},windowToImageCoordinates:function(o){var l=o.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(l)},imageToWindowCoordinates:function(o){var l=this.imageToViewerElementCoordinates(o);return l.plus(e.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(o){var l=this._scaleSpring.current.value;return o=o.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new n.Rect((o.x-this._xSpring.current.value)/l,(o.y-this._ySpring.current.value)/l,o.width/l,o.height/l,o.degrees)},viewportToImageZoom:function(o){var l=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return l*o},imageToViewportZoom:function(o){var l=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return o/l},setPosition:function(o,l){var u=this._xSpring.target.value===o.x&&this._ySpring.target.value===o.y;if(l){if(u&&this._xSpring.current.value===o.x&&this._ySpring.current.value===o.y)return;this._xSpring.resetTo(o.x),this._ySpring.resetTo(o.y),this._needsDraw=!0}else{if(u)return;this._xSpring.springTo(o.x),this._ySpring.springTo(o.y),this._needsDraw=!0}u||this._raiseBoundsChange()},setWidth:function(o,l){this._setScale(o,l)},setHeight:function(o,l){this._setScale(o/this.normHeight,l)},setCroppingPolygons:function(o){var l=function(d){return d instanceof n.Point||typeof d.x=="number"&&typeof d.y=="number"},u=function(d){return d.map(function(f){try{if(l(f))return{x:f.x,y:f.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!n.isArray(o))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=o.map(function(d){return u(d)})}catch(d){n.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),n.console.error(d),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(o,l,u){l=l||n.Placement.CENTER;var d=n.Placement.properties[l],f=this.contentAspectX,p=0,m=0,y=1,b=1;if(this._clip&&(f=this._clip.getAspectRatio(),y=this._clip.width/this.source.dimensions.x,b=this._clip.height/this.source.dimensions.y,o.getAspectRatio()>f?(p=this._clip.x/this._clip.height*o.height,m=this._clip.y/this._clip.height*o.height):(p=this._clip.x/this._clip.width*o.width,m=this._clip.y/this._clip.width*o.width)),o.getAspectRatio()>f){var E=o.height/b,T=0;d.isHorizontallyCentered?T=(o.width-o.height*f)/2:d.isRight&&(T=o.width-o.height*f),this.setPosition(new n.Point(o.x-p+T,o.y-m),u),this.setHeight(E,u)}else{var x=o.width/y,S=0;d.isVerticallyCentered?S=(o.height-o.width/f)/2:d.isBottom&&(S=o.height-o.width/f),this.setPosition(new n.Point(o.x-p,o.y-m+S),u),this.setWidth(x,u)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(o){n.console.assert(!o||o instanceof n.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),o instanceof n.Rect?this._clip=o.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(o){this.flipped=!!o,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(o){o!==this.opacity&&(this.opacity=o,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(o){this._preload=!!o,this._needsDraw=!0},getRotation:function(o){return o?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(o,l){this._degreesSpring.target.value===o&&this._degreesSpring.isAtTargetValue()||(l?this._degreesSpring.resetTo(o):this._degreesSpring.springTo(o),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(o){return this.getBoundsNoRotate(o).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(o){o!==this.compositeOperation&&(this.compositeOperation=o,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},setAjaxHeaders:function(o,l){if(o===null&&(o={}),!n.isPlainObject(o)){console.error("[TiledImage.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}this._ownAjaxHeaders=o,this._updateAjaxHeaders(l)},_updateAjaxHeaders:function(o){if(o===void 0&&(o=!0),n.isPlainObject(this.viewer.ajaxHeaders)?this.ajaxHeaders=n.extend({},this.viewer.ajaxHeaders,this._ownAjaxHeaders):this.ajaxHeaders=this._ownAjaxHeaders,o){var l,u,d,f;for(var p in this.tilesMatrix){l=this.source.getNumTiles(p);for(var m in this.tilesMatrix[p]){u=(l.x+m%l.x)%l.x;for(var y in this.tilesMatrix[p][m])if(d=(l.y+y%l.y)%l.y,f=this.tilesMatrix[p][m][y],f.loadWithAjax=this.loadTilesWithAjax,f.loadWithAjax){var b=this.source.getTileAjaxHeaders(p,u,d);f.ajaxHeaders=n.extend({},this.ajaxHeaders,b)}else f.ajaxHeaders=null}}for(var E=0;E<this._imageLoader.jobQueue.length;E++){var T=this._imageLoader.jobQueue[E];T.loadWithAjax=T.tile.loadWithAjax,T.ajaxHeaders=T.tile.loadWithAjax?T.tile.ajaxHeaders:null}}},_setScale:function(o,l){var u=this._scaleSpring.target.value===o;if(l){if(u&&this._scaleSpring.current.value===o)return;this._scaleSpring.resetTo(o),this._updateForScale(),this._needsDraw=!0}else{if(u)return;this._scaleSpring.springTo(o),this._updateForScale(),this._needsDraw=!0}u||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var o=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),l=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,u=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(l/this.minPixelRatio)/Math.log(2))));return u=Math.max(u,this.source.minLevel||0),o=Math.min(o,u),{lowestLevel:o,highestLevel:u}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var o=this.lastDrawn.pop();o.beingDrawn=!1}var l=this.viewport,u=this._viewportToTiledImageRectangle(l.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var d=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(u=u.intersection(d),u===null)return}for(var f=this._getLevelsInterval(),p=f.lowestLevel,m=f.highestLevel,y=null,b=!1,E=n.now(),T=m;T>=p;T--){var x=!1,S=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(T),!0).x*this._scaleSpring.current.value;if(T===p||!b&&S>=this.minPixelRatio)x=!0,b=!0;else if(!b)continue;var w=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(T),!1).x*this._scaleSpring.current.value,C=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,I=this.immediateRender?1:C,L=Math.min(1,(S-.5)/.5),N=I/Math.abs(I-w);if(y=this._updateLevel(b,x,T,L,N,u,E,y),this._providesCoverage(this.coverage,T))break}this._drawTiles(this.lastDrawn),y&&!y.context2D?(this._loadTile(y,E),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(o,l,u){var d,f;this.wrapHorizontal?(d=n.positiveModulo(l.x,1),f=n.positiveModulo(u.x,1)):(d=Math.max(0,l.x),f=Math.min(1,u.x));var p,m,y=1/this.source.aspectRatio;this.wrapVertical?(p=n.positiveModulo(l.y,y),m=n.positiveModulo(u.y,y)):(p=Math.max(0,l.y),m=Math.min(y,u.y));var b=this.source.getTileAtPoint(o,new n.Point(d,p)),E=this.source.getTileAtPoint(o,new n.Point(f,m)),T=this.source.getNumTiles(o);return this.wrapHorizontal&&(b.x+=T.x*Math.floor(l.x),E.x+=T.x*Math.floor(u.x)),this.wrapVertical&&(b.y+=T.y*Math.floor(l.y/y),E.y+=T.y*Math.floor(u.y/y)),{topLeft:b,bottomRight:E}},_updateLevel:function(o,l,u,d,f,p,m,y){var b=p.getBoundingBox().getTopLeft(),E=p.getBoundingBox().getBottomRight();this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:o,level:u,opacity:d,visibility:f,drawArea:p,topleft:b,bottomright:E,currenttime:m,best:y}),this._resetCoverage(this.coverage,u),this._resetCoverage(this.loadingCoverage,u);var T=this._getCornerTiles(u,b,E),x=T.topLeft,S=T.bottomRight,w=this.source.getNumTiles(u),C=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(S.x+=1,this.wrapHorizontal||(S.x=Math.min(S.x,w.x-1)));for(var I=x.x;I<=S.x;I++)for(var L=x.y;L<=S.y;L++){var N;if(this.getFlip()){var G=(w.x+I%w.x)%w.x;N=I+w.x-G-G-1}else N=I;p.intersection(this.getTileBounds(u,N,L))!==null&&(y=this._updateTile(l,o,N,L,u,d,f,C,w,m,y))}return y},_updateTile:function(o,l,u,d,f,p,m,y,b,E,T){var x=this._getTile(u,d,f,E,b,this._worldWidthCurrent,this._worldHeightCurrent),S=l;this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:x}),this._setCoverage(this.coverage,f,u,d,!1);var w=x.loaded||x.loading||this._isCovered(this.loadingCoverage,f,u,d);if(this._setCoverage(this.loadingCoverage,f,u,d,w),!x.exists||(o&&!S&&(this._isCovered(this.coverage,f,u,d)?this._setCoverage(this.coverage,f,u,d,!0):S=!0),!S))return T;if(this._positionTile(x,this.source.tileOverlap,this.viewport,y,m),!x.loaded)if(x.context2D)this._setTileLoaded(x);else{var C=this._tileCache.getImageRecord(x.cacheKey);C&&this._setTileLoaded(x,C.getData())}if(x.loaded){var I=this._blendTile(x,u,d,f,p,E);I&&(this._needsDraw=!0)}else x.loading?this._tilesLoading++:w||(T=this._compareTiles(T,x));return T},_getTile:function(o,l,u,d,f,p,m){var y,b,E,T,x,S,w,C,I,L,N=this.tilesMatrix,G=this.source;return N[u]||(N[u]={}),N[u][o]||(N[u][o]={}),(!N[u][o][l]||!N[u][o][l].flipped!=!this.flipped)&&(y=(f.x+o%f.x)%f.x,b=(f.y+l%f.y)%f.y,E=this.getTileBounds(u,o,l),T=G.getTileBounds(u,y,b,!0),x=G.tileExists(u,y,b),S=G.getTileUrl(u,y,b),w=G.getTilePostData(u,y,b),this.loadTilesWithAjax?(C=G.getTileAjaxHeaders(u,y,b),n.isPlainObject(this.ajaxHeaders)&&(C=n.extend({},this.ajaxHeaders,C))):C=null,I=G.getContext2D?G.getContext2D(u,y,b):void 0,L=new n.Tile(u,o,l,E,x,S,I,this.loadTilesWithAjax,C,T,w,G.getTileHashKey(u,y,b,S,C,w)),this.getFlip()?y===0&&(L.isRightMost=!0):y===f.x-1&&(L.isRightMost=!0),b===f.y-1&&(L.isBottomMost=!0),L.flipped=this.flipped,N[u][o][l]=L),L=N[u][o][l],L.lastTouchTime=d,L},_loadTile:function(o,l){var u=this;o.loading=!0,this._imageLoader.addJob({src:o.getUrl(),tile:o,source:this.source,postData:o.postData,loadWithAjax:o.loadWithAjax,ajaxHeaders:o.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(d,f,p){u._onTileLoad(o,l,d,f,p)},abort:function(){o.loading=!1}})},_onTileLoad:function(o,l,u,d,f){if(u)o.exists=!0;else{n.console.error("Tile %s failed to load: %s - error: %s",o,o.getUrl(),d),this.viewer.raiseEvent("tile-load-failed",{tile:o,tiledImage:this,time:l,message:d,tileRequest:f}),o.loading=!1,o.exists=!1;return}if(l<this.lastResetTime){n.console.warn("Ignoring tile %s loaded before reset: %s",o,o.getUrl()),o.loading=!1;return}var p=this,m=function(){var y=p.source,b=y.getClosestLevel();p._setTileLoaded(o,u,b,f)};this._midDraw?window.setTimeout(m,1):m()},_setTileLoaded:function(o,l,u,d){var f=0,p=!1,m=this;function y(){return p&&n.console.error("Event 'tile-loaded' argument getCompletionCallback must be called synchronously. Its return value should be called asynchronously."),f++,b}function b(){f--,f===0&&(o.loading=!1,o.loaded=!0,o.hasTransparency=m.source.hasTransparency(o.context2D,o.getUrl(),o.ajaxHeaders,o.postData),o.context2D||m._tileCache.cacheTile({data:l,tile:o,cutoff:u,tiledImage:m}),m._needsDraw=!0)}var E=y();this.viewer.raiseEvent("tile-loaded",{tile:o,tiledImage:this,tileRequest:d,get image(){return n.console.error("[tile-loaded] event 'image' has been deprecated. Use 'data' property instead."),l},data:l,getCompletionCallback:y}),p=!0,E()},_positionTile:function(o,l,u,d,f){var p=o.bounds.getTopLeft();p.x*=this._scaleSpring.current.value,p.y*=this._scaleSpring.current.value,p.x+=this._xSpring.current.value,p.y+=this._ySpring.current.value;var m=o.bounds.getSize();m.x*=this._scaleSpring.current.value,m.y*=this._scaleSpring.current.value;var y=u.pixelFromPointNoRotate(p,!0),b=u.pixelFromPointNoRotate(p,!1),E=u.deltaPixelsFromPointsNoRotate(m,!0),T=u.deltaPixelsFromPointsNoRotate(m,!1),x=b.plus(T.divide(2)),S=d.squaredDistanceTo(x);l||(E=E.plus(new n.Point(1,1))),o.isRightMost&&this.wrapHorizontal&&(E.x+=.75),o.isBottomMost&&this.wrapVertical&&(E.y+=.75),o.position=y,o.size=E,o.squaredDistance=S,o.visibility=f},_blendTile:function(o,l,u,d,f,p){var m=1e3*this.blendTime,y,b;if(o.blendStart||(o.blendStart=p),y=p-o.blendStart,b=m?Math.min(1,y/m):1,this.alwaysBlend&&(b*=f),o.opacity=b,this.lastDrawn.push(o),b===1)this._setCoverage(this.coverage,d,l,u,!0),this._hasOpaqueTile=!0;else if(y<m)return!0;return!1},_compareTiles:function(o,l){return!o||l.visibility>o.visibility||l.visibility===o.visibility&&l.squaredDistance<o.squaredDistance?l:o},_drawTiles:function(o){if(!(this.opacity===0||o.length===0&&!this.placeholderFillStyle)){var l=o[0],u;l&&(u=this.opacity<1||this.compositeOperation&&this.compositeOperation!=="source-over"||!this._isBottomItem()&&this.source.hasTransparency(l.context2D,l.getUrl(),l.ajaxHeaders,l.postData));var d,f,p=this.viewport.getZoom(!0),m=this.viewportToImageZoom(p);o.length>1&&m>this.smoothTileEdgesMinZoom&&!this.iOSDevice&&this.getRotation(!0)%360===0&&n.supportsCanvas&&this.viewer.useCanvas&&(u=!0,d=l.getScaleForEdgeSmoothing(),f=l.getTranslationForEdgeSmoothing(d,this._drawer.getCanvasSize(!1),this._drawer.getCanvasSize(!0)));var y;u&&(d||(y=this.viewport.viewportToViewerElementRectangle(this.getClippedBounds(!0)).getIntegerBoundingBox(),this._drawer.viewer.viewport.getFlip()&&(this.viewport.getRotation(!0)%360!==0||this.getRotation(!0)%360!==0)&&(y.x=this._drawer.viewer.container.clientWidth-(y.x+y.width)),y=y.times(n.pixelDensityRatio)),this._drawer._clear(!0,y)),d||(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:u}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:u}),this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip());var b=!1;if(this._clip){this._drawer.saveContext(u);var E=this.imageToViewportRectangle(this._clip,!0);E=E.rotate(-this.getRotation(!0),this._getRotationPoint(!0));var T=this._drawer.viewportToDrawerRectangle(E);d&&(T=T.times(d)),f&&(T=T.translate(f)),this._drawer.setClip(T,u),b=!0}if(this._croppingPolygons){var x=this;this._drawer.saveContext(u);try{var S=this._croppingPolygons.map(function(O){return O.map(function(D){var V=x.imageToViewportCoordinates(D.x,D.y,!0).rotate(-x.getRotation(!0),x._getRotationPoint(!0)),$=x._drawer.viewportCoordToDrawerCoord(V);return d&&($=$.times(d)),f&&($=$.plus(f)),$})});this._drawer.clipWithPolygons(S,u)}catch(O){n.console.error(O)}b=!0}if(this.placeholderFillStyle&&this._hasOpaqueTile===!1){var w=this._drawer.viewportToDrawerRectangle(this.getBounds(!0));d&&(w=w.times(d)),f&&(w=w.translate(f));var C=null;typeof this.placeholderFillStyle=="function"?C=this.placeholderFillStyle(this,this._drawer.context):C=this.placeholderFillStyle,this._drawer.drawRectangle(w,C,u)}var I=a(this.subPixelRoundingForTransparency),L=!1;if(I===n.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS)L=!0;else if(I===n.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST){var N=this.viewer&&this.viewer.isAnimating();L=!N}for(var G=o.length-1;G>=0;G--)l=o[G],this._drawer.drawTile(l,this._drawingHandler,u,d,f,L,this.source),l.beingDrawn=!0,this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:this,tile:l});b&&this._drawer.restoreContext(u),d||(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u)),u&&(d&&(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:!1}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:!1})),this._drawer.blendSketch({opacity:this.opacity,scale:d,translate:f,compositeOperation:this.compositeOperation,bounds:y}),d&&(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1))),d||this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip(),this._drawDebugInfo(o)}},_drawDebugInfo:function(o){if(this.debugMode)for(var l=o.length-1;l>=0;l--){var u=o[l];try{this._drawer.drawDebugInfo(u,o.length,l,this)}catch(d){n.console.error(d)}}},_providesCoverage:function(o,l,u,d){var f,p,m,y;if(!o[l])return!1;if(u===void 0||d===void 0){f=o[l];for(m in f)if(Object.prototype.hasOwnProperty.call(f,m)){p=f[m];for(y in p)if(Object.prototype.hasOwnProperty.call(p,y)&&!p[y])return!1}return!0}return o[l][u]===void 0||o[l][u][d]===void 0||o[l][u][d]===!0},_isCovered:function(o,l,u,d){return u===void 0||d===void 0?this._providesCoverage(o,l+1):this._providesCoverage(o,l+1,2*u,2*d)&&this._providesCoverage(o,l+1,2*u,2*d+1)&&this._providesCoverage(o,l+1,2*u+1,2*d)&&this._providesCoverage(o,l+1,2*u+1,2*d+1)},_setCoverage:function(o,l,u,d,f){if(!o[l]){n.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",l);return}o[l][u]||(o[l][u]={}),o[l][u][d]=f},_resetCoverage:function(o,l){o[l]={}}});var i=n.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function r(o){return o!==n.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&o!==n.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&o!==n.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function s(o){return r(o)?i:o}function a(o){if(typeof o=="number")return s(o);if(!o||!n.Browser)return i;var l=o[n.Browser.vendor];return r(l)&&(l=o["*"]),s(l)}})(e),(function(n){var i=function(s){n.console.assert(s,"[TileCache.cacheTile] options is required"),n.console.assert(s.tile,"[TileCache.cacheTile] options.tile is required"),n.console.assert(s.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=s.tile,this.tiledImage=s.tiledImage},r=function(s){n.console.assert(s,"[ImageRecord] options is required"),n.console.assert(s.data,"[ImageRecord] options.data is required"),this._tiles=[],s.create.apply(null,[this,s.data,s.ownerTile]),this._destroyImplementation=s.destroy.bind(null,this),this.getImage=s.getImage.bind(null,this),this.getData=s.getData.bind(null,this),this.getRenderedContext=s.getRenderedContext.bind(null,this)};r.prototype={destroy:function(){this._destroyImplementation(),this._tiles=null},addTile:function(s){n.console.assert(s,"[ImageRecord.addTile] tile is required"),this._tiles.push(s)},removeTile:function(s){for(var a=0;a<this._tiles.length;a++)if(this._tiles[a]===s){this._tiles.splice(a,1);return}n.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",s)},getTileCount:function(){return this._tiles.length}},n.TileCache=function(s){s=s||{},this._maxImageCacheCount=s.maxImageCacheCount||n.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},n.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(s){n.console.assert(s,"[TileCache.cacheTile] options is required"),n.console.assert(s.tile,"[TileCache.cacheTile] options.tile is required"),n.console.assert(s.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),n.console.assert(s.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var a=s.cutoff||0,o=this._tilesLoaded.length,l=this._imagesLoaded[s.tile.cacheKey];if(l||(s.data||(n.console.error("[TileCache.cacheTile] options.image was renamed to options.data. '.image' attribute has been deprecated and will be removed in the future."),s.data=s.image),n.console.assert(s.data,"[TileCache.cacheTile] options.data is required to create an ImageRecord"),l=this._imagesLoaded[s.tile.cacheKey]=new r({data:s.data,ownerTile:s.tile,create:s.tiledImage.source.createTileCache,destroy:s.tiledImage.source.destroyTileCache,getImage:s.tiledImage.source.getTileCacheDataAsImage,getData:s.tiledImage.source.getTileCacheData,getRenderedContext:s.tiledImage.source.getTileCacheDataAsContext2D}),this._imagesLoadedCount++),l.addTile(s.tile),s.tile.cacheImageRecord=l,this._imagesLoadedCount>this._maxImageCacheCount){for(var u=null,d=-1,f=null,p,m,y,b,E,T,x=this._tilesLoaded.length-1;x>=0;x--)if(T=this._tilesLoaded[x],p=T.tile,!(p.level<=a||p.beingDrawn)){if(!u){u=p,d=x,f=T;continue}b=p.lastTouchTime,m=u.lastTouchTime,E=p.level,y=u.level,(b<m||b===m&&E>y)&&(u=p,d=x,f=T)}u&&d>=0&&(this._unloadTile(f),o=d)}this._tilesLoaded[o]=new i({tile:s.tile,tiledImage:s.tiledImage})},clearTilesFor:function(s){n.console.assert(s,"[TileCache.clearTilesFor] tiledImage is required");for(var a,o=0;o<this._tilesLoaded.length;++o)a=this._tilesLoaded[o],a.tiledImage===s&&(this._unloadTile(a),this._tilesLoaded.splice(o,1),o--)},getImageRecord:function(s){return n.console.assert(s,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[s]},_unloadTile:function(s){n.console.assert(s,"[TileCache._unloadTile] tileRecord is required");var a=s.tile,o=s.tiledImage;a.unload(),a.cacheImageRecord=null;var l=this._imagesLoaded[a.cacheKey];l.removeTile(a),l.getTileCount()||(l.destroy(),delete this._imagesLoaded[a.cacheKey],this._imagesLoadedCount--),o.viewer.raiseEvent("tile-unloaded",{tile:a,tiledImage:o})}}})(e),(function(n){n.World=function(i){var r=this;n.console.assert(i.viewer,"[World] options.viewer is required"),n.EventSource.call(this),this.viewer=i.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(s){r._autoRefigureSizes?r._figureSizes():r._needsSizesFigured=!0},this._figureSizes()},n.extend(n.World.prototype,n.EventSource.prototype,{addItem:function(i,r){if(n.console.assert(i,"[World.addItem] item is required"),n.console.assert(i instanceof n.TiledImage,"[World.addItem] only TiledImages supported at this time"),r=r||{},r.index!==void 0){var s=Math.max(0,Math.min(this._items.length,r.index));this._items.splice(s,0,i)}else this._items.push(i);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,i.addHandler("bounds-change",this._delegatedFigureSizes),i.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:i})},getItemAt:function(i){return n.console.assert(i!==void 0,"[World.getItemAt] index is required"),this._items[i]},getIndexOfItem:function(i){return n.console.assert(i,"[World.getIndexOfItem] item is required"),n.indexOf(this._items,i)},getItemCount:function(){return this._items.length},setItemIndex:function(i,r){n.console.assert(i,"[World.setItemIndex] item is required"),n.console.assert(r!==void 0,"[World.setItemIndex] index is required");var s=this.getIndexOfItem(i);if(r>=this._items.length)throw new Error("Index bigger than number of layers.");r===s||s===-1||(this._items.splice(s,1),this._items.splice(r,0,i),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:i,previousIndex:s,newIndex:r}))},removeItem:function(i){n.console.assert(i,"[World.removeItem] item is required");var r=n.indexOf(this._items,i);r!==-1&&(i.removeHandler("bounds-change",this._delegatedFigureSizes),i.removeHandler("clip-change",this._delegatedFigureSizes),i.destroy(),this._items.splice(r,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(i))},removeAll:function(){this.viewer._cancelPendingImages();var i,r;for(r=0;r<this._items.length;r++)i=this._items[r],i.removeHandler("bounds-change",this._delegatedFigureSizes),i.removeHandler("clip-change",this._delegatedFigureSizes),i.destroy();var s=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,r=0;r<s.length;r++)i=s[r],this._raiseRemoveItem(i)},resetItems:function(){for(var i=0;i<this._items.length;i++)this._items[i].reset()},update:function(){for(var i=!1,r=0;r<this._items.length;r++)i=this._items[r].update()||i;return i},draw:function(){for(var i=0;i<this._items.length;i++)this._items[i].draw();this._needsDraw=!1},needsDraw:function(){for(var i=0;i<this._items.length;i++)if(this._items[i].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(i){this._autoRefigureSizes=i,i&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(i){i=i||{};var r=i.immediately||!1,s=i.layout||n.DEFAULT_SETTINGS.collectionLayout,a=i.rows||n.DEFAULT_SETTINGS.collectionRows,o=i.columns||n.DEFAULT_SETTINGS.collectionColumns,l=i.tileSize||n.DEFAULT_SETTINGS.collectionTileSize,u=i.tileMargin||n.DEFAULT_SETTINGS.collectionTileMargin,d=l+u,f;!i.rows&&o?f=o:f=Math.ceil(this._items.length/a);var p=0,m=0,y,b,E,T,x;this.setAutoRefigureSizes(!1);for(var S=0;S<this._items.length;S++)S&&S%f===0&&(s==="horizontal"?(m+=d,p=0):(p+=d,m=0)),y=this._items[S],b=y.getBounds(),b.width>b.height?E=l:E=l*(b.width/b.height),T=E*(b.height/b.width),x=new n.Point(p+(l-E)/2,m+(l-T)/2),y.setPosition(x,r),y.setWidth(E,r),s==="horizontal"?p+=d:m+=d;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var i=this._homeBounds?this._homeBounds.clone():null,r=this._contentSize?this._contentSize.clone():null,s=this._contentFactor||0;if(!this._items.length)this._homeBounds=new n.Rect(0,0,1,1),this._contentSize=new n.Point(1,1),this._contentFactor=1;else{var a=this._items[0],o=a.getBounds();this._contentFactor=a.getContentSize().x/o.width;for(var l=a.getClippedBounds().getBoundingBox(),u=l.x,d=l.y,f=l.x+l.width,p=l.y+l.height,m=1;m<this._items.length;m++)a=this._items[m],o=a.getBounds(),this._contentFactor=Math.max(this._contentFactor,a.getContentSize().x/o.width),l=a.getClippedBounds().getBoundingBox(),u=Math.min(u,l.x),d=Math.min(d,l.y),f=Math.max(f,l.x+l.width),p=Math.max(p,l.y+l.height);this._homeBounds=new n.Rect(u,d,f-u,p-d),this._contentSize=new n.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==s||!this._homeBounds.equals(i)||!this._contentSize.equals(r))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(i){this.raiseEvent("remove-item",{item:i})}})})(e)})(wh)),wh.exports}var Yne=$ne();const hc=Wc(Yne);var M0="Switch",[Kne]=Pr(M0),[Xne,Qne]=Kne(M0),mO=H.forwardRef((t,e)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:s,required:a,disabled:o,value:l="on",onCheckedChange:u,form:d,...f}=t,[p,m]=H.useState(null),y=Yt(e,S=>m(S)),b=H.useRef(!1),E=p?d||!!p.closest("form"):!0,[T,x]=oa({prop:r,defaultProp:s??!1,onChange:u,caller:M0});return Ce.jsxs(Xne,{scope:n,checked:T,disabled:o,children:[Ce.jsx(Ct.button,{type:"button",role:"switch","aria-checked":T,"aria-required":a,"data-state":bO(T),"data-disabled":o?"":void 0,disabled:o,value:l,...f,ref:y,onClick:xt(t.onClick,S=>{x(w=>!w),E&&(b.current=S.isPropagationStopped(),b.current||S.stopPropagation())})}),E&&Ce.jsx(vO,{control:p,bubbles:!b.current,name:i,value:l,checked:T,required:a,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});mO.displayName=M0;var gO="SwitchThumb",yO=H.forwardRef((t,e)=>{const{__scopeSwitch:n,...i}=t,r=Qne(gO,n);return Ce.jsx(Ct.span,{"data-state":bO(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:e})});yO.displayName=gO;var Zne="SwitchBubbleInput",vO=H.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:i=!0,...r},s)=>{const a=H.useRef(null),o=Yt(a,s),l=pb(n),u=hb(e);return H.useEffect(()=>{const d=a.current;if(!d)return;const f=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(f,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:i});m.call(d,n),d.dispatchEvent(y)}},[l,n,i]),Ce.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:o,style:{...r.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});vO.displayName=Zne;function bO(t){return t?"checked":"unchecked"}var Jne=mO,eie=yO;const tie="Close",nie="Next",iie="Previous",rie="Search",sie="Search...",aie="Share",oie="View All",uie="Failed",lie="Copied",cie="Loading...",die="Search",fie="No Results",hie="More Results",pie="Select",mie="Viewer",gie="About",yie="Annotations",vie="Search",bie="More Information",Eie="View Collection",Tie="Copy Collection URL",xie="View Manifest",Sie="Copy Manifest URL",Aie={commonClose:tie,commonNext:nie,commonPrevious:iie,commonSearch:rie,commonSearchPlaceholder:sie,commonShare:aie,commonViewAll:oie,copyFailure:uie,copySuccess:lie,contentSearchLoading:cie,contentSearchPlaceholder:die,contentSearchResultsNone:fie,contentSearchResultsMore:hie,informationPanelTabs:pie,informationPanelTabsClose:mie,informationPanelTabsAbout:gie,informationPanelTabsAnnotations:yie,informationPanelTabsSearch:vie,informationPanelToggle:bie,shareCollectionJson:Eie,shareCollectionCopy:Tie,shareManifestJson:xie,shareManifestCopy:Sie},wie={},Cie={en:Aie,pt:wie},vv="clover",Rie=Object.fromEntries(Object.entries(Cie).map(([t,e])=>[t,{[`${vv}`]:e}]));Wn.use(HR).use(L5).init({defaultNS:vv,fallbackLng:"en",ns:[vv],resources:{...Rie}});var En=function(t){return function(){const e={type:t,getType:()=>t,toString:()=>t};return(n,i)=>({...e,...n!==void 0&&{payload:n},...i!==void 0&&{meta:i}})}},EO="@iiif/IMPORT_ENTITIES",TO="@iiif/MODIFY_ENTITY_FIELD",xO="@iiif/REORDER_ENTITY_FIELD",SO="@iiif/ADD_REFERENCE",bv="@iiif/UPDATE_REFERENCE",AO="@iiif/REMOVE_REFERENCE",wO="@iiif/ADD_METADATA",CO="@iiif/REMOVE_METADATA",Ev="@iiif/UPDATE_METADATA",RO="@iiif/REORDER_METADATA",_O=En(EO)(),_ie=En(TO)(),Iie=En(xO)(),Lie=En(SO)(),Die=En(AO)(),Oie=En(bv)(),Pie=En(wO)(),kie=En(Ev)(),Nie=En(CO)(),Mie=En(RO)(),Bie={importEntities:_O,modifyEntityField:_ie,reorderEntityField:Iie,addReference:Lie,removeReference:Die,updateReference:Oie,addMetadata:Pie,removeMetadata:Nie,updateMetadata:kie,reorderMetadata:Mie},IO="@iiif/ADD_MAPPING",LO="@iiif/ADD_MAPPINGS",Fie=En(IO)(),Uie=En(LO)(),Tv="RESOURCE_ERROR",DO="RESOURCE_LOADING",xv="RESOURCE_READY",OO="@iiif/REQUEST_RESOURCE",PO="@iiif/REQUEST_ERROR",kO="@iiif/REQUEST_MISMATCH",NO="@iiif/REQUEST_COMPLETE",Hie="@iiif/REQUEST_OFFLINE_RESOURCE",zie=En(OO)(),Sv=En(PO)(),qie=En(kO)(),Vie=En(NO)(),uE="@iiif/BATCH",Gie="@iiif/BATCH_IMPORT",Av=En(uE)(),jie=(t,e)=>{const{entities:n,resource:i,mapping:r}=A9(e);if(i.id===void 0)return[Sv({id:t,message:"ID is not defined in resource."})];const s=[_O({entities:n}),Uie({mapping:r})];return i.id!==t&&(s.push(Fie({id:t,type:i.type})),s.push(qie({requestId:t,actualId:i.id}))),s.push(Vie({id:t})),s},aR=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Wie(t,e){return!!(t===e||aR(t)&&aR(e))}function oR(t,e){if(!Array.isArray(t)||!Array.isArray(e))return t===e;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Wie(t[n],e[n]))return!1;return!0}function ey(t,e,n){const i=t.iiif.requests[e],r=t.iiif.mapping[e];if(!r||!t.iiif.entities[r][i.resourceUri])return;const s=t.iiif.entities[r][i.resourceUri];if(s&&s[An]){const a=s[An].find(o=>o[cs]===s.id);return Nv(s,a)}return s}function $ie(t){return t&&typeof t.then=="function"}function uR(t,e,{waitTimeout:n=30}={}){return(i,r,s)=>{const a=t.getStore(),o=a.getState(),l=o.iiif.requests[i];if(l){if(l.loadingState===xv){const d=ey(o,i);if(d)return d}switch(l.loadingState){case Tv:break;case DO:return(async()=>{let d,f=!1;try{const p=await Promise.race([new Promise((m,y)=>{f||(d=a.subscribe(()=>{const b=a.getState();if(b.iiif.requests[i].loadingState===Tv){y();return}if(b.iiif.requests[i].loadingState===xv){const E=ey(b,i);E?m(E):y()}}))}),new Promise((m,y)=>setTimeout(()=>{f=!0,y()},n*60*1e3))]);if(d&&d(),p)return p}catch{d&&d()}})()}}t.dispatch(zie({id:i}));const u=d=>{if(!d)return;!d.id&&!d["@id"]&&(d["@type"]&&(d["@id"]=i),d.id=i);const f=jie(i,d);return t.dispatch(Av({actions:f})),ey(a.getState(),i)};try{const d=e(i,r);return $ie(d)?(async()=>{try{let f=await d;return s&&(f=s(f)),u(f)}catch(f){throw t.dispatch(Sv({id:i,message:f.toString()})),f}})():u(s?s(d):d)}catch(d){throw t.dispatch(Sv({id:i,message:d.toString()})),d}}}var MO="@iiif/SET_META_VALUE",BO="@iiif/SET_META_VALUE_DYNAMIC",FO="@iiif/UNSET_META_VALUE",Yie=En(MO)(),Kie=En(BO)(),Xie=En(FO)(),lR={setMetaValue:Yie,setMetaValueDynamic:Kie,unsetMetaValue:Xie};function UO(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}const Qie={};var cR=t=>{let e;const n=new Set,i=(o,l)=>{const u=typeof o=="function"?o(e):o;if(!Object.is(u,e)){const d=e;e=l??(typeof u!="object"||u===null)?u:Object.assign({},e,u),n.forEach(f=>f(e,d))}},r=()=>e,s={setState:i,getState:r,getInitialState:()=>a,subscribe:o=>(n.add(o),()=>n.delete(o)),destroy:()=>{(Qie?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=e=t(i,r,s);return s},HO=t=>t?cR(t):cR;const ty={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var Zie=(t,e)=>(n,i,r)=>(r.dispatch=s=>(n(a=>t(a,s),!1,s),s),r.dispatchFromDevtools=!0,{dispatch:(...s)=>r.dispatch(...s),...e}),Jie=Zie,wv=new Map,oh=t=>{const e=wv.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,i])=>[n,i.getState()])):{}},ere=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const i=wv.get(n.name);if(i)return{type:"tracked",store:t,...i};const r={connection:e.connect(n),stores:{}};return wv.set(n.name,r),{type:"tracked",store:t,...r}},tre=(t,e={})=>(n,i,r)=>{const{enabled:s,anonymousActionType:a,store:o,...l}=e;let u;try{u=(s??(ty?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return(ty?"production":void 0)!=="production"&&s&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),t(n,i,r);const{connection:d,...f}=ere(o,u,l);let p=!0;r.setState=(b,E,T)=>{const x=n(b,E);if(!p)return x;const S=T===void 0?{type:a||"anonymous"}:typeof T=="string"?{type:T}:T;return o===void 0?(d==null||d.send(S,i()),x):(d==null||d.send({...S,type:`${o}/${S.type}`},{...oh(l.name),[o]:r.getState()}),x)};const m=(...b)=>{const E=p;p=!1,n(...b),p=E},y=t(r.setState,i,r);if(f.type==="untracked"?d==null||d.init(y):(f.stores[f.store]=r,d==null||d.init(Object.fromEntries(Object.entries(f.stores).map(([b,E])=>[b,b===f.store?y:E.getState()])))),r.dispatchFromDevtools&&typeof r.dispatch=="function"){let b=!1;const E=r.dispatch;r.dispatch=(...T)=>{(ty?"production":void 0)!=="production"&&T[0].type==="__setState"&&!b&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),b=!0),E(...T)}}return d.subscribe(b=>{var E;switch(b.type){case"ACTION":if(typeof b.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return ny(b.payload,T=>{if(T.type==="__setState"){if(o===void 0){m(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const x=T.state[o];if(x==null)return;JSON.stringify(r.getState())!==JSON.stringify(x)&&m(x);return}r.dispatchFromDevtools&&typeof r.dispatch=="function"&&r.dispatch(T)});case"DISPATCH":switch(b.payload.type){case"RESET":return m(y),o===void 0?d==null?void 0:d.init(r.getState()):d==null?void 0:d.init(oh(l.name));case"COMMIT":if(o===void 0){d==null||d.init(r.getState());return}return d==null?void 0:d.init(oh(l.name));case"ROLLBACK":return ny(b.state,T=>{if(o===void 0){m(T),d==null||d.init(r.getState());return}m(T[o]),d==null||d.init(oh(l.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return ny(b.state,T=>{if(o===void 0){m(T);return}JSON.stringify(r.getState())!==JSON.stringify(T[o])&&m(T[o])});case"IMPORT_STATE":{const{nextLiftedState:T}=b.payload,x=(E=T.computedStates.slice(-1)[0])==null?void 0:E.state;if(!x)return;m(o===void 0?x:x[o]),d==null||d.send(null,T);return}case"PAUSE_RECORDING":return p=!p}return}}),y},nre=tre,ny=(t,e)=>{let n;try{n=JSON.parse(t)}catch(i){console.error("[zustand devtools middleware] Could not parse the received json",i)}n!==void 0&&e(n)},ire=t=>(e,n,i)=>{const r=i.subscribe;return i.subscribe=(s,a,o)=>{let l=s;if(a){const u=(o==null?void 0:o.equalityFn)||Object.is;let d=s(i.getState());l=f=>{const p=s(f);if(!u(d,p)){const m=d;a(d=p,m)}},o!=null&&o.fireImmediately&&a(d,d)}return r(l)},t(e,n,i)},rre=ire,sre=(t={},e)=>{switch(e.type){case IO:return{...t,[e.payload.id]:e.payload.type};case LO:return{...t,...e.payload.mapping};default:return t}};function iy(t,e,n,i){return!(!t[n]||!t[n][e]||!t[n][e][i]||!Array.isArray(t[n][e][i]))}function are(t,e){const n={},i=[];for(const[r,s]of Object.entries(t||{})){i.push(r);const a=(e||{})[r];if(!a||a.length===0){n[r]=s;continue}n[r]=a}for(const[r,s]of Object.entries(e||{}))i.indexOf(r)===-1&&(n[r]=s);return n}function st(t){return t.payload}function ry(t,e){return typeof t>"u"?e:t}var ore=(t=UO(),e)=>{var n;const i=(r,s)=>({...t,[st(e).type]:{...t[st(e).type],[st(e).id]:{...r,...s}}});switch(e.type){case TO:{if(!t[st(e).type]||!t[st(e).type][st(e).id])return t;const r=t[st(e).type][st(e).id];return typeof r=="string"?t:i(r,{[st(e).key]:st(e).value})}case xO:{if(!iy(t,st(e).id,st(e).type,st(e).key))return t;const r=t[st(e).type][st(e).id];if(typeof r=="string")return t;const s=Array.from(r[st(e).key]),[a]=s.splice(st(e).startIndex,1);return s.splice(st(e).endIndex,0,a),i(r,{[st(e).key]:s})}case EO:{const r=Object.keys(st(e).entities),s={...t};for(const a of r){const o=st(e).entities[a],l={...t[a]||{}};let u=!1;const d=Object.keys(o||{})||[];if(o&&d){for(const f of d)u=!0,l[f]=t[a][f]?are(t[a][f],o[f]):o[f];u&&(s[a]=l)}}return s}case SO:{if(!iy(t,st(e).id,st(e).type,st(e).key))return t;const r=t[st(e).type][st(e).id],s=Array.from(r[st(e).key]);return s.splice(ry(st(e).index,s.length+1),0,st(e).reference),i(r,{[st(e).key]:s})}case bv:case AO:{if(!iy(t,st(e).id,st(e).type,st(e).key))return t;const r=t[st(e).type][st(e).id],s=Array.from(r[st(e).key]),a=ry(st(e).index,s.findIndex(o=>o&&o.id===st(e).reference.id));return a===-1||((n=s[a])==null?void 0:n.id)!==st(e).reference.id?t:(e.type===bv?s.splice(a,1,st(e).reference):s.splice(a,1),i(r,{[st(e).key]:s}))}case wO:{const r=t[st(e).type][st(e).id];if(!r)return t;const s=Array.from(r.metadata||[]),a=st(e);return s.splice(ry(e.payload.beforeIndex,s.length+1),0,{label:a.label,value:a.label}),i(r,{metadata:s})}case RO:{const r=t[st(e).type][st(e).id];if(typeof r=="string"||!r)return t;const s=Array.from(r.metadata||[]),[a]=s.splice(st(e).startIndex,1);return s.splice(st(e).endIndex,0,a),i(r,{metadata:s})}case Ev:case CO:{const r=t[st(e).type][st(e).id],s=Array.from(r.metadata||[]),a=st(e).atIndex;return typeof a>"u"||a===-1||!s[a]?t:(e.type===Ev?s.splice(a,1,{label:st(e).label,value:st(e).value}):s.splice(a,1),i(r,{metadata:s}))}default:return t}},ure=(t={},e)=>{switch(e.type){case OO:case Hie:return{...t,[e.payload.id]:{requestUri:e.payload.id,loadingState:DO,uriMismatch:!1,resourceUri:e.payload.id}};case kO:return{...t,[e.payload.requestId]:{...t[e.payload.requestId]||{},uriMismatch:!0,resourceUri:e.payload.actualId},[e.payload.actualId]:{requestUri:e.payload.requestId,loadingState:t[e.payload.requestId].loadingState,uriMismatch:!0,resourceUri:e.payload.actualId}};case PO:return{...t,[e.payload.id]:{...t[e.payload.id]||{},loadingState:Tv,error:e.payload.message}};case NO:return{...t,[e.payload.id]:{...t[e.payload.id]||{},loadingState:xv,error:void 0}}}return t},lre=(t={},e)=>{const{id:n,updateValue:i,value:r,meta:s,key:a}=e&&e.payload||{};switch(e.type){case MO:return{...t,[n]:{...t[n]||{},[s]:{...t[n]?t[n][s]||{}:{},[a]:r}}};case BO:return{...t,[n]:{...t[n]||{},[s]:{...t[n]?t[n][s]||{}:{},[a]:t[n]&&t[n][s]?i(t[n][s][a]):i(void 0)}}};case FO:return t[n]&&t[n][s]&&t[n][s][a]?{...t,[n]:{...t[n]||{},[s]:{...t[n]?t[n][s]||{}:{},[a]:void 0}}}:t;default:return t}};function zO(t={}){const e=Object.keys(t);return function(n={},i){let r=!1;const s={};for(let a=0;a<e.length;a++){const o=e[a];s[o]=t[o](n[o],i),r=r||s[o]!==n[o]}return r?s:n}}function cre(t){return(e,n)=>n&&n.type===uE?n.payload.actions.reduce(t,e):n&&n.type===Gie?{...e,iiif:{...e.iiif,...n.payload.state}}:t(e,n)}var dre=zO({mapping:sre,entities:ore,requests:ure,meta:lre});function fre(){return{iiif:{entities:UO(),meta:{},mapping:{},requests:{}}}}function hre(t={}){const{enableDevtools:e=!1,iiifStoreName:n="iiif",defaultState:i=fre(),customReducers:r={}}=t,s=cre(zO({[n]:dre,...r})),a=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__?nre:(o,l)=>o;return HO(rre(a(Jie(s,i),{enabled:e})))}function qO(t){return{all:t=t||new Map,on:function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},off:function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var i=t.get(e);i&&i.slice().map(function(r){r(n)}),(i=t.get("*"))&&i.slice().map(function(r){r(e,n)})}}}var pre=Object.defineProperty,mre=(t,e,n)=>e in t?pre(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zi=(t,e,n)=>(mre(t,typeof e!="symbol"?e+"":e,n),n);function Xn(t,e,n,i=!0){e[Fu]=e[Fu]||[],e[Fu].push(t);const r=new Map;Object.defineProperty(e,t,{enumerable:i,get(){if(typeof e[Ka][t]>"u")return;const s=e[Ka][t];if(!s)return s;const a=n.get(e[Ka][t],{parent:this.id?{id:this.id,type:this.type}:void 0});return r.has(a)||(r.clear(),r.set(a,Xa(a,n))),r.get(a)},set(s){e[Ka][t]!==s&&(this[Ya]?n.modifyEntityField({id:this.id,type:this.type},t,VO(s)):this[Ka][t]=s)}})}var Ka=Symbol.for("_refs_"),Ya=Symbol.for("_reactive_"),Fu=Symbol.for("_defined_"),dR=Symbol.for("_parent_");function gre(t,e=!1,n){const i={id:"",type:"unknown",[Fu]:[],[Ka]:{},[dR]:null,[Ya]:null,is(r){return typeof r=="string"?this.id===r:r.id?r.id===this.id:!1},reactive(){if(!this[Ya])return this[Ya]=this.subscribe(()=>this.refresh(),!0),()=>{this.unreactive()}},refresh(){if(this.id){const r=this.unwrap();for(const s of Object.keys(r||{}))this[Fu].includes(s)?this[Ka][s]=r[s]:this[s]=r[s]}},unreactive(){this[Ya]&&(this[Ya](),this[Ya]=null)},unwrap(){if(!this.id)throw new Error("Invalid object");const r=this[dR];return t.get(this.id,{parent:r?{id:r,type:"unknown"}:void 0})},toPresentation3(){return t.toPresentation3(this.unwrap())},toPresentation2(){return t.toPresentation2(this.unwrap())},valueOf(){return this.unwrap()},toJSON(){const r=this;return{...r,items:r.items,annotations:r.annotations,structures:r.structures,seeAlso:r.seeAlso,service:r.service,services:r.services,rendering:r.rendering,partOf:r.partOf,start:r.start,supplementary:r.supplementary,homepage:r.homepage,thumbnail:r.thumbnail,placeholderCanvas:r.placeholderCanvas,accompanyingCanvas:r.accompanyingCanvas,provider:r.provider}},subscribe(r,s=!0){return t.subscribe(()=>this.id?t.get(this.id):null,r,s)}};return Xn("items",i,t),Xn("annotations",i,t),Xn("structures",i,t),Xn("seeAlso",i,t),Xn("rendering",i,t),Xn("partOf",i,t),Xn("start",i,t,!1),Xn("supplementary",i,t),Xn("homepage",i,t),Xn("thumbnail",i,t),Xn("placeholderCanvas",i,t,!1),Xn("accompanyingCanvas",i,t,!1),Xn("provider",i,t),Xn("body",i,t),Xn("logo",i,t),i}function yre(t){return!!t[Fu]}function VO(t){return Array.isArray(t)?t.map(e=>VO(e)):!t||!t.type?t:{id:t.id,type:t.type}}function Xa(t,e,n=!1,i){if(Array.isArray(t))return t.map(o=>Xa(o,e,n));if(!t||!t.type||!t.id)return t;const r=gre(e,n),s=Object.create(r),a=Object.assign(s,t);return n&&a.reactive(),a}function fR(t){switch(t){case"Image":case"Video":case"Sound":case"Dataset":case"Text":case"Composite":case"List":case"Independents":case"Audience":return"ContentResource";case"ImageService1":case"ImageService2":case"ImageService3":return"Service"}return t}var GO=class{constructor(t,e){zi(this,"options"),zi(this,"store"),zi(this,"emitter"),zi(this,"isBatching",!1),zi(this,"batchQueue",[]),zi(this,"remoteFetcher"),zi(this,"staticFetcher"),zi(this,"defaultFetcher",n=>fetch(n).then(i=>{if(i.status===200)return i.json();{const r=new Error(`${i.status} ${i.statusText}`);throw r.name="HTTPError",r}})),this.options=Object.assign({reducers:{},customFetcher:this.defaultFetcher,enableDevtools:!0},t||{}),this.store=e||hre({customReducers:this.options.reducers,defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=qO(),this.remoteFetcher=uR(this,this.options.customFetcher),this.staticFetcher=uR(this,(n,i)=>i)}batch(t){this.isBatching=!0;try{t(this),this.isBatching=!1,this.dispatch(Av({actions:this.batchQueue}))}catch(e){throw this.batchQueue=[],this.isBatching=!1,e}this.batchQueue=[]}async asyncBatch(t){this.isBatching=!0;try{await t(this),this.isBatching=!1,this.dispatch(Av({actions:this.batchQueue}))}catch(e){throw this.batchQueue=[],this.isBatching=!1,e}this.batchQueue=[]}modifyEntityField(t,e,n){this.dispatch(Bie.modifyEntityField({id:t.id,type:t.type,key:e,value:n}))}dispatch(t){if(this.isBatching)this.batchQueue.push(t);else{if(t.type===uE){for(const i of t.payload.actions)this.emitter.emit(i.type,{action:i,state:this.store.getState()});this.store.dispatch(t);const n=this.getState();for(const i of t.payload.actions)this.emitter.emit(`after:${i.type}`,{action:i,state:n});return}this.emitter.emit(t.type,{action:t,state:this.store.getState()}),this.store.dispatch(t);const e=this.store.getState();this.emitter.emit(`after:${t.type}`,{action:t,state:e});return}}on(t,e){return this.emitter.on(t,e),()=>{this.emitter.off(t,e)}}serialize(t,e){return C9(this.getState().iiif,t,e)}toPresentation2(t){return this.serialize(t,D9)}toPresentation3(t){return this.serialize(t,O9)}hydrate(t,e,n={}){return this.get(t,e,{...n,skipSelfReturn:!1})}get(t,e,n={}){typeof e!="string"&&(n=e||{},e=void 0);const{skipSelfReturn:i=!0}=n||{};let r=n.parent?typeof n.parent=="string"?n.parent:n.parent.id:void 0;if(Array.isArray(t))return t.map(d=>this.get(d,n));const s=this.getState();if(sa(t)&&!n.preserveSpecificResources&&(t=t.source),typeof t=="string"){const d=fR(e||s.iiif.mapping[t]);if(!d)return i?null:{id:t,type:"unknown"};t={id:t,type:d}}if(t&&t.partOf&&!r&&!n.skipPartOfCheck){const d=Array.isArray(t.partOf)?t.partOf[0]:t.partOf;d&&(typeof d=="string"&&(r=d),typeof d.id=="string"&&(r=d.id))}const a=fR(e||(t==null?void 0:t.type)),o=t==null?void 0:t.id,l=s.iiif.entities[a];if(!l){const d=s.iiif.requests[o];return d&&d.resourceUri!==o?this.get(d.resourceUri,n):i?null:t}const u=l[t.id];if(u&&u[An]){const d=u[An].find(f=>r?f[cs]===r:f[cs]===u.id);return Nv(u,d)}return l[t.id]||(i?null:t)}select(t){return t(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}deep(t,e){if(typeof t>"u")return this.get(e,{skipSelfReturn:!1});if(typeof t=="function")try{const i=t(this.get(e,{skipSelfReturn:!1})),r=s=>this.deep(s,i);return r.size=Array.isArray(i)?i.length:1,r}catch{const i=r=>this.deep(r,void 0);return i.size=0,i}const n=i=>this.deep(i,t);return n.size=Array.isArray(t)?t.length:1,n}loadManifest(t,e,n){const i=typeof t=="string"?t:t.id;return this.load(i,e,n)}loadCollection(t,e,n){const i=typeof t=="string"?t:t.id;return this.load(i,e,n)}load(t,e,n){const i=typeof t=="string"?t:t.id;return e?Promise.resolve(this.staticFetcher(i,e,n)):Promise.resolve(this.remoteFetcher(i,{},n))}loadSync(t,e,n){const i=typeof t=="string"?t:t.id;return this.staticFetcher(i,e,n)}loadManifestSync(t,e,n){const i=typeof t=="string"?t:t.id;return this.loadSync(i,e,n)}loadCollectionSync(t,e,n){const i=typeof t=="string"?t:t.id;return this.loadSync(i,e,n)}areInputsEqual(t,e){return oR(t,e)}subscribe(t,e,n){return typeof n>"u"&&(typeof e>"u"||e===!1||e===!0)&&(n=e,e=t,t=i=>i),this.store.subscribe(t,i=>e(i,this),{equalityFn:oR,fireImmediately:!n})}async ensureLoaded(t){const e=typeof t=="string"?t:t.id;this.requestStatus(e)||await this.load(e)}requestStatus(t){return this.select(e=>e.iiif.requests[t])}getPaginationState(t){const e=typeof t=="string"?t:t.id;if(!e)return null;const n=this.getResourceMeta(e,"@vault/pagination");if(n!=null&&n.state)return n.state;const i=this.get(t);if(i.first){const r={currentPage:null,currentPageIndex:null,isFetching:!1,isFullyLoaded:!1,next:i.first,page:1,pages:[],previous:null,totalItems:i.total,currentLength:0};return this.setMetaValue([e,"@vault/pagination","state"],r),r}return null}async loadNextPage(t,e){var n;const i=typeof t=="string"?t:t.id;if(!i)return[null,null];const r=this.getPaginationState(t);if(!r||r.isFullyLoaded||!r.next)return[null,null];if(r.isFetching)return[r,null];const s=typeof r.next=="string"?r.next:r.next.id,a=r.currentPage,o={...r,isFetching:!0};this.setMetaValue([i,"@vault/pagination","state"],o);let l;try{l=await this.loadCollection(s,e,m=>{const{id:y,["@id"]:b,...E}=m||{};return b?{"@id":s,...E}:{id:s,...E}})}catch(m){const y={...r,isFetching:!1,error:m};return this.setMetaValue([i,"@vault/pagination","state"],y),[y,null]}if(!l){const m={...r,isFetching:!1,error:new Error("Collection not found")};return this.setMetaValue([i,"@vault/pagination","state"],m),[m,null]}const u=this.get(i),d=[...u.items||[],...l.items||[]].map(m=>({id:m.id,type:m.type}));this.modifyEntityField({id:i,type:"Collection"},"items",d);const f=this.getPaginationState(t);if(!f)throw new Error("Pagination state not found");const p={...f,isFetching:!1,error:null,currentPage:l.id,next:((n=l.next)==null?void 0:n.id)||null,currentPageIndex:f.pages.length,currentLength:d.length,pages:[...f.pages,{id:l.id,type:"Collection",startIndex:u.items.length,pageLength:l.items.length,order:typeof f.currentPageIndex=="number"?f.currentPageIndex+1:0}],isFullyLoaded:!l.next,previous:a,page:f.pages.length+1};return this.setMetaValue([i,"@vault/pagination","state"],p),[p,l]}getResourceMeta(t,e){const n=this.getState().iiif.meta[t];if(n)return e?n[e]:n}getObject(t,e,n={}){const{reactive:i,...r}=n;return Xa(this.get(t,e,r),this,i)}async loadObject(t,e){return Xa(await this.load(t,e),this)}async loadManifestObject(t,e){return Xa(await this.loadManifest(t,e),this)}async loadCollectionObject(t,e){return Xa(await this.loadCollection(t,e),this)}wrapObject(t){return Xa(this.get(t,{skipSelfReturn:!1}),this)}isWrapped(t){return yre(t)}setMetaValue([t,e,n],i){this.dispatch(typeof i=="function"?lR.setMetaValueDynamic({id:t,meta:e,key:n,updateValue:i}):lR.setMetaValue({id:t,meta:e,key:n,value:i}))}};const vre=t=>{const e=t.toString().split(":"),n=Math.ceil(parseInt(e[0])),i=Math.ceil(parseInt(e[1])),r=bre(Math.ceil(parseInt(e[2])),2);let s=`${n!==0&&i<10?(i+"").padStart(2,"0"):i}:${r}`;return n!==0&&(s=`${n}:${s}`),s},jO=t=>{const e=new Date(t*1e3).toISOString().substr(11,8);return vre(e)},WO=(t,e)=>{if(typeof t!="object"||t===null)return e;for(const n in e)typeof e[n]=="object"&&e[n]!==null&&!Array.isArray(e[n])?(t[n]||(t[n]={}),t[n]=WO(t[n],e[n])):t[n]=e[n];return t},$O=t=>t.split("").reduce(function(e,n){return e=(e<<5)-e+n.charCodeAt(0),e&e},0),YO=(t,e)=>Object.hasOwn(t,e)?t[e].toString():void 0,bre=(t,e)=>String(t).padStart(e,"0"),KO={behavior:"smooth",block:"center"},ao={annotationOverlays:{backgroundColor:"#6666ff",borderColor:"#000099",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",contentSearch:{searchResultsLimit:20,overlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:4}},crossOrigin:"anonymous",ignoreCaptionLabels:[],informationPanel:{vtt:{autoScroll:{enabled:!0,settings:KO}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0,renderContentSearch:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showDownload:!0,showIIIFBadge:!0,showTitle:!0,withCredentials:!1};function XO(t){const e=(()=>{var i,r;return((r=(i=ao==null?void 0:ao.informationPanel)==null?void 0:i.vtt)==null?void 0:r.autoScroll)||{enabled:!0,settings:KO}})();if(t==null)return{enabled:e.enabled,settings:{...e.settings}};if(typeof t=="boolean")return{enabled:t,settings:{...e.settings}};if("enabled"in t){const i=t;return{enabled:i.enabled,settings:{...i.settings}}}const n={enabled:!0,settings:{...t}};return Ere(n.settings),n}function Ere({behavior:t,block:e}){const n=["auto","instant","smooth"],i=["center","end","nearest","start"];if(!n.includes(t))throw TypeError(`'${t}' not in ${n.join(" | ")}`);if(!i.includes(e))throw TypeError(`'${e}' not in ${i.join(" | ")}`)}var hR,pR;const Tre=XO((pR=(hR=ao==null?void 0:ao.informationPanel)==null?void 0:hR.vtt)==null?void 0:pR.autoScroll);var mR;const B0={activeCanvas:"",activeManifest:"",activePlayer:null,activeSelector:void 0,OSDImageLoaded:!1,collection:{},configOptions:ao,customDisplays:[],plugins:[],isAutoScrollEnabled:Tre.enabled,isAutoScrolling:!1,isInformationOpen:((mR=ao==null?void 0:ao.informationPanel)==null?void 0:mR.open)??!0,isLoaded:!1,isUserScrolling:void 0,sequence:[[],[]],vault:new GO,openSeadragonViewer:null,viewerId:Dc(),visibleCanvases:[],visibleAnnotations:[]},QO=U.createContext(B0),ZO=U.createContext(B0);function xre(t,e){switch(e.type){case"updateActiveCanvas":return e.canvasId||(e.canvasId=""),{...t,activeCanvas:e.canvasId};case"updateActiveManifest":return{...t,activeManifest:e.manifestId};case"updateActivePlayer":return{...t,activePlayer:e.player};case"updateOSDImageLoaded":return{...t,OSDImageLoaded:e.OSDImageLoaded};case"updateAutoScrollAnnotationEnabled":return{...t,isAutoScrollEnabled:e.isAutoScrollEnabled};case"updateAutoScrolling":return{...t,isAutoScrolling:e.isAutoScrolling};case"updateCollection":return{...t,collection:e.collection};case"updateConfigOptions":return{...t,configOptions:WO(t.configOptions,e.configOptions)};case"updateContentStateAnnotation":return{...t,contentStateAnnotation:e.contentStateAnnotation};case"updateInformationOpen":return{...t,isInformationOpen:e.isInformationOpen};case"updateInformationPanelResource":return{...t,informationPanelResource:e.informationPanelResource};case"updateIsLoaded":return{...t,isLoaded:e.isLoaded};case"updateManifestSequence":return{...t,sequence:e.sequence};case"updateUserScrolling":return{...t,isUserScrolling:e.isUserScrolling};case"updateOpenSeadragonViewer":return{...t,openSeadragonViewer:e.openSeadragonViewer};case"updateViewerId":return{...t,viewerId:e.viewerId};case"updateActiveSelector":return{...t,activeSelector:e.selector};case"updateVisibleCanvases":return{...t,visibleCanvases:e.visibleCanvases};default:throw new Error(`Unhandled action type: ${e.type}`)}}const Sre=({initialState:t=B0,children:e})=>{const[n,i]=H.useReducer(xre,t),{openSeadragonViewer:r}=n;return H.useEffect(()=>{if(r)return r.addHandler("update-viewport",()=>{const s=r.viewport,a=s.getBounds(),o=s.viewportToImageRectangle(a),l=`xywh=${[Math.round(o.x),Math.round(o.y),Math.round(o.width),Math.round(o.height)].join(",")}`;i({type:"updateActiveSelector",selector:{type:"FragmentSelector",value:l}})}),()=>{r.removeAllHandlers("update-viewport")}},[r]),U.createElement(QO.Provider,{value:n},U.createElement(ZO.Provider,{value:i},e))};function Jt(){const t=U.useContext(QO);if(t===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return t}function di(){const t=U.useContext(ZO);if(t===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return t}const Are=async(t,e)=>{const n=t.get({id:e,type:"Canvas"});if(!(n!=null&&n.annotations)||!n.annotations[0])return[];const i=t.get(n.annotations).filter(s=>s.items?s:!1),r=[];for(const s of i)if(s.items.length>0){const a=s.label||{none:["Annotations"]};r.push({...s,label:a})}else{let a={};try{a=await t.load(s.id)}catch(o){console.log(o)}if(a.items&&a.items.length>0){const o=a.label||{none:["Annotations"]};r.push({...a,label:o})}}return r},JO=async(t,e,n)=>{try{if(n==null||n.q==null)return{};const i=n.q.trim(),r=new URL(e);return r.searchParams.set("q",i),await t.load(r.toString())}catch(i){return console.warn("Error in getContentSearchResources:",i),{}}},e8=(t,e,n,i)=>{var r,s;const a={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},o=l=>{if(l){if(!l.body||!l.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",l);return}let u=l.body;Array.isArray(u)&&(u=u[0]);const d=t.get(u.id);if(!d)return;switch(n){case"painting":return l.target===e.id&&l.motivation&&l.motivation[0]==="painting"&&i.includes(d.type)&&(l.body=d),!!l;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};if(a.canvas=t.get(e),a.canvas&&(a.annotationPage=t.get(a.canvas.items[0]),a.accompanyingCanvas=(r=a.canvas)!=null&&r.accompanyingCanvas?t.get((s=a.canvas)==null?void 0:s.accompanyingCanvas):void 0),a.annotationPage){const l=t.get(a.annotationPage.items).map(d=>({body:t.get(d.body[0].id),motivation:d.motivation,type:"Annotation"})),u=[];l.forEach(d=>{d.body.type==="Choice"?d.body.items.forEach(f=>u.push({...d,id:f.id,body:t.get(f.id)})):u.push(d)}),a.annotations=u.filter(o)}return a},lE=(t,e="en")=>{if(!t)return"";if(!t[e]){const n=Object.getOwnPropertyNames(t);if(n.length>0)return t[n[0]]}return t[e]},pa=(t,e)=>{const n=e8(t,{id:e,type:"Canvas"},"painting",["Image","Sound","Video"]);if(n.annotations.length!==0&&n.annotations&&n.annotations)return n.annotations.map(i=>i==null?void 0:i.body)},sy=209,wre={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${sy} 100% 38.2%)`,accentMuted:`hsl(${sy} 80% 61.8%)`,accentAlt:`hsl(${sy} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 200ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},t8={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:Ge,css:xle,keyframes:n8,createTheme:Sle}=E_({theme:wre,media:t8}),Cre=Ge("div",{display:"flex",flexDirection:"column",alignItems:"center"}),Rre=Ge("p",{fontWeight:"bold",fontSize:"x-large"}),_re=Ge("span",{fontSize:"medium"}),cE=({error:t})=>{const{message:e}=t;return U.createElement(Cre,{role:"alert"},U.createElement(Rre,{"data-testid":"headline"},"Something went wrong"),e&&U.createElement(_re,null,`Error message: ${e}`," "))},Ire=Ge("div",{position:"relative",zIndex:"0"}),i8=Ge("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden"}),r8=Ge("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"100%",height:"100%","&[data-aside-active='true']":{width:"61.8%","@sm":{width:"0",opacity:"0"}},"&[data-aside-toggle='false']":{"@sm":{width:"100% !important",opacity:"1 !important"}}}),Lre=Ge("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"0",maxHeight:"100%","&[data-aside-active='true']":{width:"38.2%","@sm":{width:"100%"}},"&[data-aside-toggle='false']":{"@sm":{width:"0 !important"}}}),Dre=Ge("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{[`& ${i8}`]:{flexGrow:"1"},[`& ${r8}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{}}}),Ore=Ge(tF,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% -  2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),Pre=Ge(nF,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"5px solid #6663","@sm":{margin:"0 1rem"}}),uc=Ge(iF,{display:"flex",position:"relative",padding:"0.5rem 1.618rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&[data-value='manifest-back']":{display:"none;","@sm":{display:"block"}},"&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),uh=Ge(rF,{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),kre=({handleScroll:t,children:e,className:n})=>U.createElement("div",{className:n,onScroll:t},e),Nre=Ge(kre,{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),s8={position:"relative",display:"flex",margin:"0 1.618rem",padding:"0.5rem 0",fontFamily:"inherit",fontSize:"0.8333rem",lineHeight:"1.47rem",color:"inherit",background:"none",borderRadius:"3px",border:"none"},F0=Ge("button",{textAlign:"left","&:hover":{color:"$accent"}}),dE=Ge("div",{display:"flex",flexDirection:"column",width:"100%",header:{margin:"0 1.618rem 0.5rem ",fontWeight:700,fontSize:"0.8333rem",em:{fontStyle:"normal",fontWeight:400,opacity:.7}},paddingBottom:"1rem",marginBottom:"1rem",borderBottom:"1px solid #0001"}),U0=Ge("div",{gap:"1rem",fontSize:"1rem",lineHeight:"1.47em",margin:"0","&[data-content-search=true]":{em:{fontWeight:700,display:"inline"}}}),Mre=Ge("div",{...s8,display:"flex",flexDirection:"row",gap:"1rem","&[data-format='text/vtt']":{marginTop:"-1rem","> span":{display:"none"}},"> span":{display:"flex",width:"2rem",height:"2rem",backgroundColor:"#0001",flexShrink:"0",borderRadius:"3px",marginTop:"0.25rem"},[`&[dir=rtl] ${U0}`]:{textAlign:"right !important"}}),Bre=({value:t,handleClick:e})=>U.createElement(F0,{onClick:e},U.createElement(U0,{dangerouslySetInnerHTML:{__html:t}})),Fre=({caption:t,handleClick:e,imageUri:n})=>U.createElement(F0,{onClick:e},U.createElement("img",{src:n,alt:`A visual annotation for ${t}`}),U.createElement("span",null,t)),Ure=({value:t,handleClick:e})=>{const n=p$(t);return U.createElement(F0,{onClick:e},U.createElement(U0,{dangerouslySetInnerHTML:{__html:n.html}}))},gR=({value:t,handleClick:e,isContentSearch:n})=>U.createElement(F0,{onClick:e},U.createElement(U0,{dangerouslySetInnerHTML:{__html:t},"data-content-search":n})),Hre=()=>{function t(l){return l.map(u=>{const d=u.identifier||Dc();return{...u,identifier:d}})}function e(l){var u;const d=[],f=[],p=t(l);for(const m of p){for(;f.length>0&&f[f.length-1].end<=m.start;)f.pop();f.length>0?(f[f.length-1].children||(f[f.length-1].children=[]),(u=f[f.length-1].children)==null||u.push(m),f.push(m)):(d.push(m),f.push(m))}return d}function n(l,u=[]){return u.some(d=>l.start>=d.start&&l.end<=d.end)}function i(l=[]){return l.sort((u,d)=>u.start-d.start)}function r(l){const u=l.replace(/<(c|v|i|b|u|lang|ruby)(?:\.([^\s>]+))?(?:\s([^>]+))?>/g,(d,f,p,m)=>{const y=document.createElement(f);return p&&(y.className=p.replace(/\./g," ")),(m==null?void 0:m.length)>0&&(y.title=m),y.outerHTML.replace(new RegExp(`</${f}>$`),"")});return console.log("normalizeVttTags",u),u}function s(l){var u;for(const d of l.children)s(d);if(l.localName==="c"||l.localName==="v"){const d=document.createElement("span");for(const f of l.attributes)d.setAttribute(f.name,f.value);d.innerHTML=l.innerHTML,(u=l.parentNode)==null||u.replaceChild(d,l)}}function a(l){const u=r(l),d=document.createElement("div");return d.innerHTML=u,s(d),d.innerHTML}function o(l){return new Promise((u,d)=>{const f=v$.parse(l);f.errors&&f.errors.length&&d(f.errors),u(f.cues.map(p=>({identifier:p.identifier||Dc(),start:p.start,end:p.end,align:p.align,html:a(p.text),text:p.text||""})))})}return{addIdentifiersToParsedCues:t,createNestedCues:e,isChild:n,orderCuesByTime:i,parseVttData:o}},zre=Ge(KI,{display:"flex",flexDirection:"column",width:"100%"}),a8=Ge(XI,{...s8,justifyContent:"space-between",textAlign:"left",flexGrow:1,margin:0,marginLeft:"-1rem",padding:"0.618rem 1rem",width:"calc(100% + 2rem)",fontSize:"1rem",strong:{marginLeft:"1rem"},"&:hover":{color:"$accent"},"&[aria-checked='true']":{background:"#6662"}}),qre=750,Vre=t=>{for(;t&&t!==document.body;){const e=window.getComputedStyle(t).overflowY;if(e!=="visible"&&e!=="hidden"&&t.scrollHeight>t.clientHeight)return t;t=t.parentNode}return null},Gre=({html:t,text:e,start:n,end:i})=>{var r,s;const a=di(),{activePlayer:o,configOptions:l,isAutoScrollEnabled:u,isUserScrolling:d}=Jt(),f=(s=(r=l==null?void 0:l.informationPanel)==null?void 0:r.vtt)==null?void 0:s.autoScroll,[p,m]=H.useState(!1),y=H.useRef(null),b=o;H.useEffect(()=>(b==null||b.addEventListener("timeupdate",()=>{const{currentTime:T}=b;m(n<=T&&T<i)}),()=>document.removeEventListener("timeupdate",()=>{})),[i,n,b]),H.useEffect(()=>{var T;const x=S=>{a({type:"updateAutoScrolling",isAutoScrolling:!0}),S(),setTimeout(()=>a({type:"updateAutoScrolling",isAutoScrolling:!1}),qre)};if(u&&p&&y.current&&!d){const S=y.current;if(S&&S instanceof HTMLElement){const w=Vre(S);if(w&&w instanceof HTMLElement){let C;switch((T=f==null?void 0:f.settings)==null?void 0:T.block){case"center":const I=w.getBoundingClientRect();C=S.offsetTop+S.offsetHeight-Math.floor((I.bottom-I.top)/2);break;case"end":C=S.offsetTop+S.offsetHeight-(w.clientHeight-S.clientHeight)+2;break;default:C=S.offsetTop-2;break}x(()=>{var I;return w.scrollTo({top:C,left:0,behavior:(I=f==null?void 0:f.settings)==null?void 0:I.behavior})})}}}},[f,p,d,u,a]);const E=()=>{b&&(b.pause(),b.currentTime=n,b.play())};return U.createElement(a8,{ref:y,"aria-checked":p,"data-testid":"information-panel-cue",onClick:E,value:e},U.createElement("div",{className:"webvtt-cue",dangerouslySetInnerHTML:{__html:t}}),U.createElement("strong",null,jO(n)))},jre=Ge("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${a8}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),o8=({items:t})=>U.createElement(jre,null,t.map(e=>{const{html:n,text:i,start:r,end:s,children:a,identifier:o}=e;return U.createElement("li",{key:o},U.createElement(Gre,{html:n,text:i,start:r,end:s}),a&&U.createElement(o8,{items:a}))})),Wre=({inlineCues:t,label:e,vttUri:n})=>{const[i,r]=U.useState(t||[]),{createNestedCues:s,orderCuesByTime:a,parseVttData:o}=Hre(),[l,u]=U.useState();return H.useEffect(()=>{!t&&n&&fetch(n,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(d=>d.text()).then(d=>{o(d).then(f=>{const p=a(f),m=s(p);r(m)})}).catch(d=>{console.error(n,d.toString()),u(d)})},[n,t]),U.createElement(zre,{"data-testid":"annotation-item-vtt","aria-label":`${lE(e)}`},l&&U.createElement("div",{"data-testid":"error-message"},"Network Error: ",l.toString()),U.createElement(o8,{items:i}))},$re=t=>{var e;if(!t)return"LTR";const n=["ar","fa","ur","ps","dv","sd","ug","ku","he","yi","jrb","jpr","nqo"],i=Array.isArray(t)?(e=t[0])==null?void 0:e.split("-")[0]:t==null?void 0:t.split("-")[0];return n.includes(i)?"RTL":"LTR"},Yre=t=>{var e,n,i,r,s;let a={id:typeof t=="string"?t:t.source};if(typeof t=="string"){if(t.includes("#xywh=")){const o=t.split("#xywh=");if(o&&o[1]){const[l,u,d,f]=o[1].split(",").map(p=>Number(p));a={id:o[0],rect:{x:l,y:u,w:d,h:f}}}}else if(t.includes("#t=")){const o=t.split("#t=");o&&o[1]&&(a={id:o[0],t:o[1]})}}else if(typeof t=="object"){if(((e=t.selector)==null?void 0:e.type)==="PointSelector")a={id:t.source,point:{x:t.selector.x,y:t.selector.y}};else if(((n=t.selector)==null?void 0:n.type)==="SvgSelector")a={id:t.source,svg:t.selector.value};else if(((i=t.selector)==null?void 0:i.type)==="FragmentSelector"&&(r=t.selector)!=null&&r.value.includes("xywh=")&&t.source.type=="Canvas"&&t.source.id){const o=(s=t.selector)==null?void 0:s.value.split("xywh=");if(o&&o[1]){const[l,u,d,f]=o[1].split(",").map(p=>Number(p));a={id:t.source.id,rect:{x:l,y:u,w:d,h:f}}}}}return a},fE=({annotation:t,targetResource:e,isContentSearch:n,isContentState:i})=>{var r,s,a,o,l,u,d;const{target:f}=t,p=(r=f==null?void 0:f.selector)==null?void 0:r.type,m=((a=(s=f==null?void 0:f.selector)==null?void 0:s.value)==null?void 0:a.split("=")[1])||"full",[y,b]=m!=="full"?m==null?void 0:m.split(",").slice(2):[100,100],E=`${e}/${m}/!${((oe,P)=>{const ie=Math.max(oe,P),le=Math.round(oe/ie*100),q=Math.round(P/ie*100);return[le,q].join(",")})(y,b)}/0/default.jpg`,T=Jt(),x=di(),{openSeadragonViewer:S,vault:w,visibleCanvases:C}=T,I=t!=null&&t.body?(o=t==null?void 0:t.body)==null?void 0:o.map(oe=>w.get(oe.id)):[],{format:L=p==="PointSelector"?"text/vtt":"text/plain",language:N="none",value:G="",chars:O=""}=I[0]?I[0]:{},D=p==="PointSelector"?"text/vtt":L,V=((l=I[0])==null?void 0:l.label)||{none:["t"]},$=G||O||"None",J=N?$re(N).toLocaleLowerCase():"LTR",K=p==="PointSelector"&&(u=f==null?void 0:f.selector)!=null&&u.t?[{start:(d=f==null?void 0:f.selector)==null?void 0:d.t,end:0,html:$,text:$,styles:"",children:[]}]:void 0;function j(){var oe;const P=S==null?void 0:S.getOverlayById(t.id);if(P&&S!=null&&S.viewport){P!=null&&P.element&&((oe=P.element)==null||oe.focus());const ie=P==null?void 0:P.getBounds(S.viewport);ie.x-=.2,ie.y-=.2,ie.width+=.5,ie.height+=.5,S.viewport.fitBounds(ie,!1)}}H.useEffect(()=>{if(!S||!i)return;const oe=setInterval(()=>{S!=null&&S.getOverlayById(t.id)&&(j(),S.container.className="clover-iiif-content-state",clearInterval(oe))},1e3);return()=>clearInterval(oe)},[S,i]);function te(oe){var P;oe.preventDefault(),oe.stopPropagation();const ie=((P=t==null?void 0:t.target)==null?void 0:P.source)||(t==null?void 0:t.target),le=ie==null?void 0:ie.id;C.map(q=>q.id).includes(le)?j():x({type:"updateActiveCanvas",canvasId:le})}function ne(){var oe,P,ie;switch(D){case"text/plain":return U.createElement(gR,{value:$,handleClick:te,isContentSearch:n});case"text/html":return U.createElement(Bre,{value:$,handleClick:te});case"text/markdown":return U.createElement(Ure,{value:$,handleClick:te});case"text/vtt":return U.createElement(Wre,{inlineCues:K,label:V,vttUri:((oe=I[0])==null?void 0:oe.id)||void 0});case((P=L==null?void 0:L.match(/^image\//))==null?void 0:P.input):const le=((ie=I.find(q=>{var ye;return!((ye=q.id)!=null&&ye.includes("vault://"))}))==null?void 0:ie.id)||"";return U.createElement(Fre,{caption:G,handleClick:te,imageUri:le});default:return U.createElement(gR,{value:$,handleClick:te})}}if(L)return U.createElement(Mre,{dir:J,"data-format":L,"data-content":$,className:"clover-iiif-annotation-item"},U.createElement("span",{style:{backgroundImage:`url(${E})`,backgroundSize:"cover",backgroundPosition:"center"}}),ne())},u8=(t,e="none")=>{if(!t)return null;if(typeof t=="string")return[t];if(!t[e]){const n=Object.getOwnPropertyNames(t);if(n.length>0)return t[n[0]]}return!t[e]||!Array.isArray(t[e])?null:t[e]},Li=(t,e="none",n=", ")=>{const i=u8(t,e);return Array.isArray(i)?i.join(`${n}`):i};function Kre(t){return{__html:Xre(t)}}function Mr(t,e){const n=Object.keys(t).filter(r=>e.includes(r)?null:r),i=new Object;return n.forEach(r=>{i[r]=t[r]}),i}function Xre(t){return sY(t,{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}const Qre=Ge("span",{}),bs=t=>{const{as:e,label:n}=t,i=Mr(t,["as","label"]);return U.createElement(Qre,{as:e,...i},Li(n,i.lang))},Zre=(t,e="200,",n="full")=>{Array.isArray(t)&&(t=t[0]);const{id:i,service:r}=t;let s;if(!r)return i;if(Array.isArray(t.service)&&t.service.length>0&&(s=r[0]),s){if(s["@id"])return`${s["@id"]}/${n}/${e}/0/default.jpg`;if(s.id)return`${s.id}/${n}/${e}/0/default.jpg`}},yR=Ge("img",{objectFit:"cover"}),Jre=t=>{const e=H.useRef(null),{contentResource:n,altAsLabel:i,region:r="full"}=t;let s;i&&(s=Li(i));const a=Mr(t,["contentResource","altAsLabel"]),{type:o,id:l,width:u=200,height:d=200,duration:f}=n;H.useEffect(()=>{if(!l&&!e.current||["Image"].includes(o)||!l.includes("m3u8"))return;const y=new Un;return e.current&&(y.attachMedia(e.current),y.on(Un.Events.MEDIA_ATTACHED,function(){y.loadSource(l)})),y.on(Un.Events.ERROR,function(b,E){if(E.fatal)switch(E.type){case Un.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${b} network error encountered, try to recover`),y.startLoad();break;case Un.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${b} media error encountered, try to recover`),y.recoverMediaError();break;default:y.destroy();break}}),()=>{y&&(y.detachMedia(),y.destroy())}},[l,o]);const p=H.useCallback(()=>{if(!e.current)return;let y=0,b=30;if(f&&(b=f),!l.split("#t=")&&f&&(y=f*.1),l.split("#t=").pop()){const T=l.split("#t=").pop();T&&(y=parseInt(T.split(",")[0]))}const E=e.current;E.autoplay=!0,E.currentTime=y,setTimeout(()=>p(),b*1e3)},[f,l]);H.useEffect(()=>p(),[p]);const m=Zre(n,`${u},${d}`,r);switch(o){case"Image":return U.createElement(yR,{as:"img",alt:s,css:{width:u,height:d},key:l,src:m,...a});case"Video":return U.createElement(yR,{as:"video",css:{width:u,height:d},disablePictureInPicture:!0,key:l,loop:!0,muted:!0,onPause:p,ref:e,src:l});default:return console.warn(`Resource type: ${o} is not valid or not yet supported in Primitives.`),U.createElement(U.Fragment,null)}},ese=Ge("a",{}),tse=t=>{const{children:e,homepage:n}=t,i=Mr(t,["children","homepage"]);return U.createElement(U.Fragment,null,n&&n.map(r=>{const s=Li(r.label,i.lang);return U.createElement(ese,{"aria-label":e?s:void 0,href:r.id,key:r.id,...i},e||s)}))},nse={delimiter:", "},hE=H.createContext(void 0),l8=()=>{const t=H.useContext(hE);if(t===void 0)throw new Error("usePrimitivesContext must be used with a PrimitivesProvider");return t},pE=({children:t,initialState:e=nse})=>{const n=ise(e,"delimiter");return U.createElement(hE.Provider,{value:{delimiter:n}},t)},ise=(t,e)=>Object.hasOwn(t,e)?t[e].toString():void 0,rse=Ge("span",{}),vR=t=>{const{as:e,markup:n}=t,{delimiter:i}=l8();if(!n)return U.createElement(U.Fragment,null);const r=Mr(t,["as","markup"]),s=Kre(Li(n,r.lang,i));return U.createElement(rse,{as:e,...r,dangerouslySetInnerHTML:s})},c8=t=>U.useContext(hE)?U.createElement(vR,{...t}):U.createElement(pE,null,U.createElement(vR,{...t})),sse=({as:t="dd",lang:e,value:n})=>U.createElement(c8,{markup:n,as:t,lang:e}),ase=Ge("span",{}),ose=({as:t="dd",customValueContent:e,lang:n,value:i})=>{var r;const{delimiter:s}=l8(),a=(r=u8(i,n))==null?void 0:r.map(o=>H.cloneElement(e,{value:o}));return U.createElement(ase,{as:t,lang:n},a==null?void 0:a.map((o,l)=>[l>0&&`${s}`,U.createElement(H.Fragment,{key:l},o)]))},d8=t=>{var e;const{item:n,lang:i,customValueContent:r}=t,{label:s,value:a}=n,o=(e=Li(s))==null?void 0:e.replace(" ","-").toLowerCase();return U.createElement("div",{role:"group","data-label":o},U.createElement(bs,{as:"dt",label:s,lang:i}),r?U.createElement(ose,{as:"dd",customValueContent:r,value:a,lang:i}):U.createElement(sse,{as:"dd",value:a,lang:i}))};function use(t,e){const n=e.filter(i=>{const{matchingLabel:r}=i,s=Object.keys(i.matchingLabel)[0],a=Li(r,s);if(Li(t,s)===a)return!0}).map(i=>i.Content);if(Array.isArray(n))return n[0]}const lse=Ge("dl",{}),cse=t=>{const{as:e,customValueContent:n,metadata:i}=t;if(!Array.isArray(i))return U.createElement(U.Fragment,null);const r=YO(t,"customValueDelimiter"),s=Mr(t,["as","customValueContent","customValueDelimiter","metadata"]);return U.createElement(pE,{...typeof r=="string"?{initialState:{delimiter:r}}:void 0},i.length>0&&U.createElement(lse,{as:e,...s},i.map((a,o)=>{const l=n?use(a.label,n):void 0;return U.createElement(d8,{customValueContent:l,item:a,key:o,lang:s==null?void 0:s.lang})})))};Ge("li",{});Ge("ul",{});const dse=Ge("li",{}),fse=Ge("ul",{}),hse=t=>{const{as:e,rendering:n}=t,i=Mr(t,["as","rendering"]);return U.createElement(fse,{as:e},n&&n.map(r=>{const s=Li(r.label,i.lang);return U.createElement(dse,{key:r.id},U.createElement("a",{href:r.id,...i,target:"_blank"},s||r.id))}))},pse=Ge("dl",{}),mse=t=>{const{as:e,requiredStatement:n}=t;if(!n)return U.createElement(U.Fragment,null);const i=YO(t,"customValueDelimiter"),r=Mr(t,["as","customValueDelimiter","requiredStatement"]);return U.createElement(pE,{...typeof i=="string"?{initialState:{delimiter:i}}:void 0},U.createElement(pse,{as:e,...r},U.createElement(d8,{item:n,lang:r.lang})))},gse=Ge("li",{}),yse=Ge("ul",{}),vse=t=>{const{as:e,seeAlso:n}=t,i=Mr(t,["as","seeAlso"]);return U.createElement(yse,{as:e},n&&n.map(r=>{const s=Li(r.label,i.lang);return U.createElement(gse,{key:r.id},U.createElement("a",{href:r.id,...i},s||r.id))}))},bse=t=>{const{as:e,summary:n}=t,i=Mr(t,["as","customValueDelimiter","summary"]);return U.createElement(c8,{as:e,markup:n,...i})},f8=t=>{const{thumbnail:e,region:n}=t,i=Mr(t,["thumbnail"]);return U.createElement(U.Fragment,null,e&&e.map(r=>U.createElement(Jre,{contentResource:r,key:r.id,region:n,...i})))},Ese=({annotationPage:t})=>{var e,n,i,r,s,a;const o=Jt(),{vault:l}=o;if(!t||!t.items||((e=t.items)==null?void 0:e.length)===0)return U.createElement(U.Fragment,null);const u=t.items.map(y=>l.get(y.id));if(!u)return U.createElement(U.Fragment,null);const d=u.reduce((y,b)=>(y.canvas=b.target.source.id,y.annotations=[],y.annotations.push(b==null?void 0:b.id),y),{}),f=l.get(d.canvas),p=pa(l,f.id),m=(n=p==null?void 0:p[0])!=null&&n.service?((r=(i=p==null?void 0:p[0])==null?void 0:i.service[0])==null?void 0:r.id)||((a=(s=p==null?void 0:p[0])==null?void 0:s.service[0])==null?void 0:a["@id"]):void 0;return U.createElement(dE,{"data-testid":"annotation-page"},f&&U.createElement("header",null,U.createElement(bs,{label:f.label})),U.createElement("div",{"data-testid":"annotation-page-items"},u==null?void 0:u.map(y=>U.createElement(fE,{annotation:y,targetResource:m,key:y.id}))))},Tse=Ge("div",{form:{display:"flex",alignItems:"center",width:"100%",height:"100%",gap:"1rem",padding:"0 1.618rem 1.618rem",".content-search-input":{flexGrow:"1",input:{width:"100%",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"1rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0001","&::placeholder":{color:"#0006"}}}}}),xse=Ge("button",{display:"flex",background:"none",border:"none",width:"2rem",height:"2rem",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),Sse=({searchServiceUrl:t,setContentSearchResource:e,setLoading:n})=>{const{t:i}=ma(),[r,s]=H.useState(),a=Jt(),{openSeadragonViewer:o,vault:l}=a;async function u(p){if(p.preventDefault(),!!o&&t){if(!r||r.trim()===""){e({});return}n(!0),JO(l,t,{q:r}).then(m=>{e(m),n(!1)})}}const d=p=>{p.preventDefault(),s(p.target.value)},f=i("contentSearchPlaceholder");return U.createElement(Tse,null,U.createElement(MJ,{onSubmit:u,className:"content-search-form"},U.createElement(BJ,{className:"content-search-input",name:"searchTerms",onChange:d},U.createElement(FJ,{placeholder:f})),U.createElement(UJ,{asChild:!0},U.createElement(xse,{type:"submit"},U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},U.createElement("title",null,i("informationPanelTabsSearch")),U.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"}))))))},Ase=({searchServiceUrl:t,setContentSearchResource:e,activeCanvas:n,annotationPage:i})=>{const r=Jt(),{vault:s}=r,{t:a}=ma(),[o,l]=H.useState(!1),[u,d]=H.useState({});H.useEffect(()=>{var p;if(!(i!=null&&i.items))return;const m=((p=i==null?void 0:i.items)==null?void 0:p.map(y=>s.get(y.id))).reduce((y,b)=>{const E=b.target.source.id;return y[E]||(y[E]=[]),y[E].push(b.id),y},{});d(m)},[i]);let f;return U.createElement(U.Fragment,null,U.createElement(Sse,{searchServiceUrl:t,setContentSearchResource:e,activeCanvas:n,setLoading:l}),o?U.createElement("span",null,a("contentSearchLoading")):u&&Object.keys(u).length>0&&Object.keys(u).map(p=>(f=s.get(p),U.createElement(dE,{key:p,"data-testid":"annotation-page"},f&&U.createElement("header",null,U.createElement(bs,{label:f.label})),u[p].map(m=>{var y,b,E,T,x;const S=s.get(m),w=pa(s,f.id),C=(y=w==null?void 0:w[0])!=null&&y.service?((E=(b=w==null?void 0:w[0])==null?void 0:b.service[0])==null?void 0:E.id)||((x=(T=w==null?void 0:w[0])==null?void 0:T.service[0])==null?void 0:x["@id"]):void 0;return U.createElement(fE,{annotation:S,targetResource:C,key:S.id,isContentSearch:!0})})))))},wse=Ge("div",{width:"100%",padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"auto",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.47em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),Cse=Ge("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),Rse=({homepage:t})=>(t==null?void 0:t.length)===0?U.createElement(U.Fragment,null):U.createElement(U.Fragment,null,U.createElement("span",{className:"manifest-property-title"},"Homepage"),U.createElement(tse,{homepage:t})),_se=({id:t,htmlLabel:e,parent:n="manifest"})=>U.createElement(U.Fragment,null,U.createElement("span",{className:"manifest-property-title"},e),U.createElement("a",{href:t,target:"_blank",id:`iiif-${n}-id`},t)),Ise=({metadata:t,parent:e="manifest"})=>t?U.createElement(U.Fragment,null,U.createElement(cse,{metadata:t,id:`iiif-${e}-metadata`})):U.createElement(U.Fragment,null),Lse=({rendering:t})=>(t==null?void 0:t.length)===0?U.createElement(U.Fragment,null):U.createElement(U.Fragment,null,U.createElement("span",{className:"manifest-property-title"},"Alternate formats"),U.createElement(hse,{rendering:t})),Dse=({requiredStatement:t,parent:e="manifest"})=>t?U.createElement(U.Fragment,null,U.createElement(mse,{requiredStatement:t,id:`iiif-${e}-required-statement`})):U.createElement(U.Fragment,null),Ose=({rights:t})=>t?U.createElement(U.Fragment,null,U.createElement("span",{className:"manifest-property-title"},"Rights"),U.createElement("a",{href:t,target:"_blank"},t)):U.createElement(U.Fragment,null),Pse=({seeAlso:t})=>(t==null?void 0:t.length)===0?U.createElement(U.Fragment,null):U.createElement(U.Fragment,null,U.createElement("span",{className:"manifest-property-title"},"See Also"),U.createElement(vse,{seeAlso:t})),kse=({summary:t,parent:e="manifest"})=>t?U.createElement(U.Fragment,null,U.createElement(bse,{summary:t,as:"p",id:`iiif-${e}-summary`})):U.createElement(U.Fragment,null),Nse=({label:t,thumbnail:e})=>(e==null?void 0:e.length)===0?U.createElement(U.Fragment,null):U.createElement(U.Fragment,null,U.createElement(f8,{altAsLabel:t||{none:["resource"]},thumbnail:e,style:{backgroundColor:"#6663",objectFit:"cover"}})),Mse=()=>{const t=Jt(),{activeManifest:e,vault:n}=t,[i,r]=H.useState(),[s,a]=H.useState([]),[o,l]=H.useState([]),[u,d]=H.useState([]),[f,p]=H.useState([]);return H.useEffect(()=>{var m,y,b,E;const T=n.get(e);T&&(r(T),((m=T.homepage)==null?void 0:m.length)>0&&a(n.get(T.homepage)),((y=T.seeAlso)==null?void 0:y.length)>0&&l(n.get(T.seeAlso)),((b=T.rendering)==null?void 0:b.length)>0&&d(n.get(T.rendering)),((E=T.thumbnail)==null?void 0:E.length)>0&&p(n.get(T.thumbnail)))},[e,n]),i?U.createElement(Cse,null,U.createElement(wse,null,U.createElement(Nse,{thumbnail:f,label:i.label}),U.createElement(kse,{summary:i.summary}),U.createElement(Ise,{metadata:i.metadata}),U.createElement(Dse,{requiredStatement:i.requiredStatement}),U.createElement(Ose,{rights:i.rights}),U.createElement(Rse,{homepage:s}),U.createElement(Pse,{seeAlso:o}),U.createElement(Lse,{rendering:u}),U.createElement(_se,{id:i.id,htmlLabel:"IIIF Manifest"}))):U.createElement(U.Fragment,null)};function Bse(t){const e=[];return t.forEach(n=>{var i;(i=n.informationPanel)!=null&&i.component&&e.push(n)}),{pluginsWithInfoPanel:e}}const Fse=({contentStateAnnotation:t})=>{var e,n,i,r,s,a;const o=Jt(),{vault:l}=o;if(!t)return U.createElement(U.Fragment,null);const u=((e=t==null?void 0:t.target)==null?void 0:e.source)||(t==null?void 0:t.target),d=l.get(u==null?void 0:u.id),f=pa(l,d.id),p=(n=f==null?void 0:f[0])!=null&&n.service?((r=(i=f==null?void 0:f[0])==null?void 0:i.service[0])==null?void 0:r.id)||((a=(s=f==null?void 0:f[0])==null?void 0:s.service[0])==null?void 0:a["@id"]):void 0;return U.createElement(dE,{"data-testid":"annotation-page"},d&&U.createElement("header",null,U.createElement(bs,{label:d.label})," ",U.createElement("em",null,"(Shared)")),U.createElement("div",{"data-testid":"annotation-page-items"},U.createElement(fE,{annotation:t,targetResource:p,key:t.id,isContentState:!0})))},Use=1500,Hse=({activeCanvas:t,annotationResources:e,searchServiceUrl:n,setContentSearchResource:i,contentSearchResource:r})=>{var s;const{t:a}=ma(),o=di(),l=Jt(),{contentStateAnnotation:u,informationPanelResource:d,isAutoScrolling:f,isUserScrolling:p,vault:m,configOptions:y,plugins:b}=l,{informationPanel:E}=y,T=E==null?void 0:E.renderAbout,x=E==null?void 0:E.renderAnnotation,S=m.get({id:t,type:"Canvas"}),w=E==null?void 0:E.renderContentSearch,C=E==null?void 0:E.renderToggle,I=((s=u==null?void 0:u.target)==null?void 0:s.source)||(u==null?void 0:u.target),L=!!u&&I.id===t,N=!!(e!=null&&e.length)||L,{pluginsWithInfoPanel:G}=Bse(b);function O(J,K){var j,te;const ne=(j=J==null?void 0:J.informationPanel)==null?void 0:j.component;return ne===void 0?U.createElement(U.Fragment,null):U.createElement(uh,{key:K,value:J.id},U.createElement(Hv,{FallbackComponent:cE},U.createElement(ne,{...(te=J==null?void 0:J.informationPanel)==null?void 0:te.componentProps,canvas:S,useViewerDispatch:di,useViewerState:Jt})))}const D=()=>{o({type:"updateInformationOpen",isInformationOpen:!1})};H.useEffect(()=>{["manifest-about","manifest-annotations","manifest-content-search"].includes(String(E==null?void 0:E.defaultTab))?o({type:"updateInformationPanelResource",informationPanelResource:E==null?void 0:E.defaultTab}):o(L?{type:"updateInformationPanelResource",informationPanelResource:"manifest-annotations"}:{type:"updateInformationPanelResource",informationPanelResource:"manifest-about"})},[]),H.useEffect(()=>{N||o({type:"updateInformationPanelResource",informationPanelResource:"manifest-about"})},[N]);function V(){if(!f){clearTimeout(p);const J=setTimeout(()=>{o({type:"updateUserScrolling",isUserScrolling:void 0})},Use);o({type:"updateUserScrolling",isUserScrolling:J})}}const $=J=>{o({type:"updateInformationPanelResource",informationPanelResource:J})};return U.createElement(Ore,{"data-testid":"information-panel",defaultValue:d,onValueChange:$,orientation:"horizontal",value:d,className:"clover-viewer-information-panel"},U.createElement(Pre,{"aria-label":a("informationPanelTabs"),"data-testid":"information-panel-list"},C&&U.createElement(uc,{value:"manifest-back","data-value":"manifest-back",onClick:D,as:"button"},a("informationPanelTabsClose")),T&&U.createElement(uc,{value:"manifest-about"},a("informationPanelTabsAbout")),w&&r&&U.createElement(uc,{value:"manifest-content-search"},a("informationPanelTabsSearch")),x&&N&&U.createElement(uc,{value:"manifest-annotations"},(E==null?void 0:E.annotationTabLabel)||a("informationPanelTabsAnnotations")),G&&G.map((J,K)=>{var j;return U.createElement(uc,{key:K,value:J.id},U.createElement(bs,{label:(j=J.informationPanel)==null?void 0:j.label}))})),U.createElement(Nre,{handleScroll:V},T&&U.createElement(uh,{value:"manifest-about"},U.createElement(Mse,null)),w&&r&&U.createElement(uh,{value:"manifest-content-search"},U.createElement(Ase,{searchServiceUrl:n,setContentSearchResource:i,activeCanvas:t,annotationPage:r})),x&&e&&U.createElement(uh,{value:"manifest-annotations"},u&&L&&U.createElement(Fse,{contentStateAnnotation:u}),e.map(J=>U.createElement(Ese,{key:J.id,annotationPage:J}))),G&&G.map((J,K)=>O(J,K))))},zse=()=>U.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),qse=()=>U.createElement(U.Fragment,null,U.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),U.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),U.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),Vse=()=>U.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),Gse=()=>U.createElement(U.Fragment,null,U.createElement("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),U.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})),jse=()=>U.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),Wse=()=>U.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"}),h8=Ge("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),$se=({children:t})=>U.createElement("title",null,t),jn=t=>U.createElement(h8,{...t,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},t.children);jn.Title=$se;jn.Add=zse;jn.Audio=qse;jn.Close=Vse;jn.Download=Gse;jn.Image=jse;jn.Video=Wse;const Yse=n8({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),Kse=n8({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),p8=Ge(yne,{fill:"$secondaryAlt"}),Xse=Ge(gne,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),Qse=Ge(mne,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:Kse},'&[data-side="bottom"]':{animationName:Yse},'&[data-align="end"]':{[`& ${p8}`]:{margin:"0 0.7rem"}}}),Zse=Ge(pne,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),Jse=Ge(hne,{boxSizing:"content-box"}),eae=t=>U.createElement(Zse,{...t},t.children),tae=t=>U.createElement(Qse,{...t,sideOffset:5,collisionPadding:21},U.createElement(p8,null),U.createElement(Xse,null,U.createElement(jn,{isSmall:!0},U.createElement(jn.Close,null))),t.children),Eo=({children:t})=>U.createElement(Jse,null,t);Eo.Trigger=eae;Eo.Content=tae;const Jh=Ge("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"2px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${h8}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),Ch=Ge("span",{background:"transparent",opacity:"0",border:"3px solid transparent",position:"absolute",width:"100%",height:"100%",zIndex:"0",left:"0",top:"0",transition:"$all"}),m8=Ge("span",{display:"flex"}),nae=Ge("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),iae=Ge("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),Rh=Ge("div",{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",".media-thumbnail-lazyload":{width:"100%",height:"100%",borderRadius:"3px"},img:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"top center",filter:"blur(0)",transform:"scale3d(1, 1, 1)",borderRadius:"3px",transition:"$all",color:"transparent"},[`& ${m8}`]:{position:"absolute",right:"0",bottom:"0",[`& ${Jh}`]:{display:"none",margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}}),Cv=Ge(XI,{display:"flex",flexShrink:"0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left",figure:{margin:"0",width:"161.8px",figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}}}),rae=Ge(KI,{display:"flex",flexDirection:"row",flexGrow:"1",overflowX:"scroll",position:"relative",zIndex:"0",gap:"1rem",padding:"1.618rem 0"}),sae=Ge("div",{display:"flex",flexDirection:"row","&[data-active='true']":{[`& ${Cv}`]:{figcaption:{fontWeight:"700"},[`& ${Jh}`]:{backgroundColor:"$accent"},[`& ${Ch}`]:{background:"#0003",opacity:"1",borderBottom:"3px solid $accent"},"&:first-of-type":{[`& ${Ch}`]:{borderRight:"unset"}},"&:last-of-type":{[`& ${Ch}`]:{borderLeft:"unset"}}}},[`& ${Cv}`]:{[`& ${Rh}`]:{borderRadius:"unset"},"&:first-of-type":{[`& ${Rh}`]:{borderTopLeftRadius:"3px",borderBottomLeftRadius:"3px"}},"&:last-of-type":{[`& ${Rh}`]:{borderTopRightRadius:"3px",borderBottomRightRadius:"3px"},[`& ${Jh}`]:{display:"flex"}}}}),g8=Ge("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),aae=Ge("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0001","&::placeholder":{color:"$primaryMuted"}}),ay=Ge("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),oae=Ge("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem",fontWeight:"bold",gap:"0.25rem",em:{opacity:"0.25"}}}),uae=Ge("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${g8}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),lae=(t,e)=>{H.useEffect(()=>{function n(i){i.key===t&&e()}return window.addEventListener("keyup",n),()=>window.removeEventListener("keyup",n)},[])},cae=({title:t})=>U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},U.createElement("title",null,t),U.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),dae=({title:t})=>U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},U.createElement("title",null,t),U.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),fae=({title:t})=>U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},U.createElement("title",null,t),U.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),hae=({title:t})=>U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},U.createElement("title",null,t),U.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),pae=({handleCanvasToggle:t,handleFilter:e,activeIndex:n,canvasLength:i})=>{const[r,s]=H.useState(!1),[a,o]=H.useState(!1),[l,u]=H.useState(!1),{t:d}=ma();H.useEffect(()=>{u(n===0),n===i-1?o(!0):o(!1)},[n,i]),lae("Escape",()=>{s(!1),e("")});const f=()=>{s(m=>!m),e("")},p=m=>e(m.target.value);return U.createElement(uae,{isToggle:r,className:"clover-viewer-media-controls"},U.createElement(g8,null,r&&U.createElement(aae,{autoFocus:!0,onChange:p,placeholder:d("commonSearchPlaceholder")}),!r&&U.createElement(oae,{className:"clover-viewer-media-navigation"},U.createElement(ay,{onClick:()=>t(-1),disabled:l,type:"button"},U.createElement(cae,{title:d("commonPrevious")})),U.createElement("span",null,n+1," ",U.createElement("em",null,"/")," ",i),U.createElement(ay,{onClick:()=>t(1),disabled:a,type:"button"},U.createElement(dae,{title:d("commonNext")}))),U.createElement(ay,{onClick:f,type:"button",className:"clover-viewer-media-search"},r?U.createElement(fae,{title:d("commonClose")}):U.createElement(hae,{title:d("commonSearch")}))))},mae=({children:t,rootMargin:e="100px",attributes:n={},isVisibleCallback:i=()=>{}})=>{const r=H.useRef(null),[s,a]=H.useState(!1);return H.useEffect(()=>{const o=r.current;if(!o)return;const l=new IntersectionObserver(([u])=>{u.isIntersecting&&(i(!0),a(!0),l.disconnect())},{rootMargin:e});return l.observe(o),()=>l.disconnect()},[r]),U.createElement("div",{ref:r,...n},s?t:null)};var y8="http://library.stanford.edu/iiif/image-api/compliance.html#level0",v8="http://library.stanford.edu/iiif/image-api/compliance.html#level1",b8="http://library.stanford.edu/iiif/image-api/compliance.html#level2",E8="http://library.stanford.edu/iiif/image-api/conformance.html#level0",T8="http://library.stanford.edu/iiif/image-api/conformance.html#level1",x8="http://library.stanford.edu/iiif/image-api/conformance.html#level2",S8="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",A8="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",w8="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",C8="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",R8="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",_8="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",I8="http://iiif.io/api/image/1/level0.json",L8="http://iiif.io/api/image/1/profiles/level0.json",D8="http://iiif.io/api/image/1/level1.json",O8="http://iiif.io/api/image/1/profiles/level1.json",P8="http://iiif.io/api/image/1/level2.json",k8="http://iiif.io/api/image/1/profiles/level2.json",N8="http://iiif.io/api/image/2/level0.json",M8="http://iiif.io/api/image/2/profiles/level0.json",B8="http://iiif.io/api/image/2/level1.json",F8="http://iiif.io/api/image/2/profiles/level1.json",U8="http://iiif.io/api/image/2/level2.json",H8="http://iiif.io/api/image/2/profiles/level2.json",z8="level0",q8="level1",V8="level2",G8="http://iiif.io/api/image/2/level0",j8="http://iiif.io/api/image/2/level1",W8="http://iiif.io/api/image/2/level2",H0=[W8,b8,x8,w8,_8,P8,k8,U8,H8,V8],mE=[...H0,j8,v8,T8,A8,R8,D8,O8,B8,F8,q8],$8=[G8,j8,W8,y8,v8,b8,E8,T8,x8,S8,A8,w8,C8,R8,_8,I8,L8,D8,O8,P8,k8,N8,M8,B8,F8,U8,H8,z8,q8,V8],gae=$8,Y8=[G8,y8,E8,S8,C8,I8,L8,N8,M8,z8],yae={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},vae={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},bae={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]},Eae=Object.defineProperty,Tae=(t,e,n)=>e in t?Eae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bR=(t,e,n)=>(Tae(t,typeof e!="symbol"?e+"":e,n),n);function xae(t){try{if(t==="full")return{full:!0};if(t==="square")return{square:!0};let e=t.startsWith("pct:"),n=t.substr(e?4:0).split(",").map(i=>parseFloat(i));return{x:n[0],y:n[1],w:n[2],h:n[3],percent:e}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+t)}}function Sae(t){let e={upscaled:!1,max:!1,confined:!1};if(t[0]==="^"&&(e.upscaled=!0,t=t.slice(1)),t==="max"||t==="full")return e.max=!0,e.serialiseAsFull=t==="full",e;if(t[0]==="!"&&(e.confined=!0,t=t.slice(1)),t[0]==="p")return e.percentScale=parseFloat(t.slice(4)),e;let n=t.split(",").map(i=>i.trim());return n.length&&(n[0]!==""&&(e.width=parseInt(n[0],10)),n[1]!==""&&(e.height=parseInt(n[1],10))),e}function Aae(t){let e={angle:0};if(t[0]==="!"&&(e.mirror=!0,t=t.substr(1)),e.angle=parseFloat(t)%360,Number.isNaN(e.angle))throw new Error(`Invalid rotation ${t}`);return e}function wae(t,e=""){let n=t.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!n)throw new Error(`Invalid or unknown input ${t}`);let i=n[2],r=n[3],s=n[4];if(s[0]==="/"&&(s=s.substring(1)),e.length>0){if(e[0]==="/"&&(e=e.substring(1)),e!==s.substring(0,e.length))throw new Error(`Path does not start with prefix (path: ${s}, prefix: ${e})`);s=s.substring(e.length)}return{scheme:i,server:r,path:s,prefix:e}}function Cae(t,e=""){let{path:n,scheme:i,server:r,prefix:s}=wae(t,e),a=n.split("/").reverse(),[o,l,u,d,...f]=a,p=f.reverse().filter(Boolean).join("/");if(a.length===1||o==="")return{type:"base",scheme:i,server:r,prefix:s,identifier:p};if(o==="info.json"){let[,...b]=a;return{type:"info",scheme:i,server:r,prefix:s,identifier:b.reverse().filter(Boolean).join("/")}}if(typeof i>"u"||typeof r>"u"||typeof n>"u"||typeof d>"u"||typeof u>"u"||typeof l>"u"||typeof o>"u")throw new Error("Invalid image service URL");let[m="",y=""]=o.split(".");return{type:"image",scheme:i,server:r,prefix:s,identifier:p,originalPath:n,region:xae(d),size:Sae(u),rotation:Aae(l),quality:m,format:y}}function Rae(t){return H0.indexOf(t)!==-1?bae:mE.indexOf(t)!==-1?vae:yae}function _ae(t){let e=t?Array.isArray(t.profile)?t.profile:[t.profile]:[],n={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let i of e)if(typeof i=="string"&&(i=Rae(i)),!!i){if(i.formats)for(let r of i.formats)n.extraFormats.indexOf(r)===-1&&n.extraFormats.push(r);if(i.qualities)for(let r of i.qualities)n.extraQualities.indexOf(r)===-1&&n.extraQualities.push(r);if(i.supports)for(let r of i.supports)n.extraFeatures.indexOf(r)===-1&&n.extraFeatures.push(r);if(i.maxHeight&&(n.maxHeight=i.maxHeight),i.maxWidth&&(n.maxWidth=i.maxWidth),i.maxArea&&(n.maxArea=i.maxArea),i.extraFormats)for(let r of i.extraFormats)n.extraFormats.indexOf(r)===-1&&n.extraFormats.push(r);if(i.extraQualities)for(let r of i.extraQualities)n.extraQualities.indexOf(r)===-1&&n.extraQualities.push(r);if(i.extraFeatures)for(let r of i.extraFeatures)n.extraFeatures.indexOf(r)===-1&&n.extraFeatures.push(r);i.maxHeight&&(n.maxHeight=i.maxHeight),i.maxWidth&&(n.maxWidth=i.maxWidth),i.maxArea&&(n.maxArea=i.maxArea)}if(t.extraFormats)for(let i of t.extraFormats)n.extraFormats.indexOf(i)===-1&&n.extraFormats.push(i);if(t.extraFeatures)for(let i of t.extraFeatures)n.extraFeatures.indexOf(i)===-1&&n.extraFeatures.push(i);if(t.extraQualities)for(let i of t.extraQualities)n.extraQualities.indexOf(i)===-1&&n.extraQualities.push(i);return n}function ER(t){let e=Array.isArray(t.profile)?t.profile:[t.profile];for(let n of e)if(typeof n=="string"&&Y8.indexOf(n)!==-1)return!0;return!1}function nn(t){if(t["@id"])return t["@id"];if(t.id)return t.id}function z0(t){if(!t||!t.profile||!nn(t))return!1;let e=Array.isArray(t.profile)?t.profile:[t.profile];for(let n of e)if(typeof n=="string"&&$8.indexOf(n)!==-1)return!0;return!1}function Iae(t){if(!z0(t))return!1;let e=Array.isArray(t.profile)?t.profile:[t.profile];for(let n of e)if(typeof n=="string"){if(mE.indexOf(n)!==-1)return!0}else{let i=[...n.supports||[],...n.extraFeatures||[]];if(i.indexOf("regionByPx")!==-1&&(i.indexOf("sizeByW")!==-1||i.indexOf("sizeByWh")!==-1))return!0}return!1}function Lae({x:t=0,y:e=0,w:n,h:i,full:r,square:s,percent:a}){return"full"}function Dae({max:t,percentScale:e,upscaled:n,confined:i,width:r,height:s,serialiseAsFull:a,version:o}){let l=[];return n&&l.push("^"),t?(l.push(a?"full":"max"),l.join("")):(i&&l.push("!"),e&&l.push(`pct:${e}`),r&&l.push(`${r}`),l.push(","),s&&o===3&&l.push(`${s}`),l.join(""))}function Oae(t){return`${t.mirror?"!":""}${(t.angle||0)%360}`}function Pae(t,e){let n=t.prefix.startsWith("/")?t.prefix.substring(1):t.prefix,i=`${t.scheme}://${t.server}/${n?`${n}/`:""}${t.identifier}`,{size:r}=t,{region:s,rotation:a,format:o,quality:l}=t;return[i,Lae(s),Dae(r),Oae(a),`${l}.${o}`].filter(Boolean).join("/")}function Qa(t){return t.endsWith("info.json")?t:t.endsWith("/")?`${t}info.json`:`${t}/info.json`}function kae(t){let e=Cae(Qa(t.id));if(e.type!=="info")throw new Error("Invalid service URL");let n=_ae(t);return{identifier:e.identifier,originalPath:"",server:e.server,prefix:e.prefix,scheme:e.scheme,type:"image",quality:n.extraQualities.indexOf("default")===-1?n.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function Nae(t,e,n){let i=n.length,r=[];for(let s=0;s<i;s++){let a=n[s];if(!a)continue;let o=a.width;r.push(t/o)}return r}function Mae(t,e,n){let i=n.length,r=[];for(let s=0;s<i;s++){let a=n[s];a&&r.push({width:Math.floor(t/a),height:Math.floor(e/a)})}return r}function oy(t,e){if(e&&e.profile){let n=e.profile;if(n){let i=Array.isArray(n)?n:[n];if(i.includes(`level${t}`)||i.includes(`http://iiif.io/api/image/2/level${t}.json`)||i.includes(`http://iiif.io/api/image/1/level${t}.json`)||i.includes(`http://iiif.io/api/image/1/profiles/level${t}.json`))return!0;if(t===2){for(let r of i)if(H0.includes(r))return!0}if(t===1){for(let r of i)if(mE.includes(r))return!0}if(t===0){for(let r of i)if(Y8.includes(r))return!0}}}return!1}function Rv(t){return z0(t)?oy(0,t)?0:oy(1,t)?1:oy(2,t)?2:null:null}function K8(t){let e=t.service?Array.isArray(t.service)?t.service:[t.service]:[],n=e.length,i=[];for(let r=0;r<n;r++)z0(e[r])&&i.push(e[r]);return i}function Bae(t){if(t["@type"])return t["@type"];if(t.type)return t.type}function Tu(t){const e=t.replace(/(https?:\/\/)?(www.)?/i,"");return e.indexOf("/")!==-1?e.split("/")[0]:e}function Fae(t,e,n){const i=t>e?t:e,r=n.length,s=[];for(let a=0;a<r;a++){const o=n[a];if(!o||o.scaleFactors.length===0)continue;let l=o.scaleFactors[0];if(!l)continue;let u=i/l;const d=[l];for(;u>=o.width;)l=l*2,d.push(l),u=u/2;s.push({...o,scaleFactors:d})}return s}function uy(t,e,n){const i=kae({"@context":t.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:Qa(nn(t)),profile:t.level===null||typeof t.level>"u"?"level0":`level${t.level}`,type:t.version===3?"ImageService3":"ImageService2"});return i.size.max=!1,i.size.width=e,i.size.height=n,{id:Pae(i),type:"fixed",width:e,height:n||t.height/(t.width||1)*e,unsafe:t.width>e}}function Uae(t,e,n){const i=t.width?t.width:t.maxWidth;return n.height<=t.maxHeight&&n.width<=t.maxWidth&&n.height>=t.minHeight&&n.width>=t.minWidth&&(!e||Math.abs(n.width-i)<Math.abs(e.width-i))}function Hae(t,e){const n=[],i=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},t),r=(d,f=0)=>i.explain?n.push(new Array(f).fill(0).map(p=>"    ").join("")+d().trim()):void 0,s=[],a=[];let o=null;r(()=>`Using configuration: ${JSON.stringify(i,null,2)}`);const l=(d,f)=>{if(r(()=>"Swapping choice",3),Uae(i,f,d)){if(i.preferFixedSize&&d.unsafe){r(()=>`We found an image that was marked as unsafe, but it was the best size. (${d.id})`,4),a.push(d);return}i.returnAllOptions&&f&&a.push(f),r(()=>`We found a new image that was the best size. (${d.id})`,4),o=d}else i.returnAllOptions&&a.push(d)};r(()=>`The input shows we have ${e.length} list(s) of candidates to choose from.`);const u=e.length;for(let d=0;d<u;d++){const f=e[d]();r(()=>`Candidate group ${d}: ${JSON.stringify(f,null,2)}`,1);const p=f.length;r(()=>`Checking candidate list number ${d} and found ${p} potential ways of creating image(s)`,1);for(let m=0;m<p;m++){const y=f[m];if(r(()=>`-> Checking candidate ${m}`,1),y.type==="unknown"&&i.atAnyCost&&(r(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),s.push(y)),y.type==="fixed"&&(y.unsafe?(r(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),s.push(y)):(r(()=>"We've found a fixed size image, checking if it matches the request",2),l(y,o))),y.type==="fixed-service")if(i.unsafeImageService){r(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);const b=uy(y,i.width,i.height);l(b,o)}else{r(()=>"Checking for an image from the tile source 3",2);const b=uy(y,y.width,y.height);l(b,o)}if(y.type==="variable"&&y.maxWidth){const b=uy({id:y.id,width:y.maxWidth,height:y.maxWidth,level:y.level,version:y.version},y.maxWidth);l(b,o)}}if(o&&!i.returnAllOptions){if(o.unsafe||i.allowUnsafe)continue;r(()=>`We found a match in choice list number ${d}, no searching any more`);break}}return i.atAnyCost&&a.length===0?(r(()=>o?`We found an image! ${o.id} of type ${o.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:o||s[0]||null,fallback:s.slice(1),log:n}):i.returnAllOptions?(r(()=>"Returning all options that we have found"),{best:(i.atAnyCost?o||a[0]||s[0]:o||a[0])||null,fallback:[...a,...s],log:n}):(r(()=>"Returning the best image that we found, and a fallback"),{best:o||a[0]||null,fallback:o?a:a.slice(1),log:n})}function X8(t){return(t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function zae(t){return z0(t)?(t&&t.sizes?t.sizes:[]).map(e=>({id:nn(t),type:"fixed-service",height:e.height,width:e.width,level:Rv(t),version:X8(t)?3:2})):[]}function qae(t){if(!Iae(t))return[];const e=[],n=Array.isArray(t.profile)?t.profile:[t.profile],i=n.length;for(let r=0;r<i;r++){const s=n[r];if(s&&typeof s!="string"&&(s.maxHeight||s.maxWidth))return[{id:nn(t),type:"variable",minWidth:0,minHeight:0,maxHeight:s.maxHeight||s.maxWidth,maxWidth:s.maxWidth||s.maxHeight,level:Rv(t),version:t["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(t.tiles){const r=t.tiles.length;for(let s=0;s<r;s++){const a=t.tiles[s];a&&(a.height||a.width)&&e.push({id:nn(t),type:"variable",minHeight:0,minWidth:0,maxHeight:a.height||a.width,maxWidth:a.width,level:Rv(t),version:X8(t)?3:2})}}return e}function TR(t){const e=[],n=t.length;for(let i=0;i<n;i++){const r=t[i];if(!r)continue;const s=zae(r);s.length&&e.push(...s);const a=qae(r);a.length&&e.push(...a)}return e}function xR(t){const e=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,n=t.match(e);if(n&&n[4]&&n[5]){const i=n[1],r=parseInt(n[4],10),s=parseInt(n[5],10),a=n[7];if((i==="max"||i==="full")&&r&&s&&a)return{type:"fixed",id:t,height:s,width:r}}return{type:"unknown",id:t}}function _v(t){if(typeof t=="string")return xR(t);const e=Bae(t);if(e!=="Image"&&e!=="sc:Image")return null;const n=t,i=nn(n);return i?i&&n.width&&n.height?{id:i,type:"fixed",width:n.width,height:n.height,unsafe:!0}:xR(i):null}function Vae(t,e=!0,n){const i=[],r=_v(t);if(r===null)return i;const s=t;if(i.push(r),e&&s&&s.width&&s.height){const a=[],o=K8(s);for(const l of o){const u={id:nn(l),width:s.width,height:s.height};if(n.canLoadSync(u)){const d=n.loadServiceSync(u);d&&(d.height||(d.height=s.height),d.width||(d.width=s.width),a.push(...TR([d])))}}if(a.length)return i.push(...a),i}return s.service&&i.push(...TR(s.service)),i}function Gae(t,e){if(t.length!==e.length)return!1;if(t.length===0&&e.length===0)return!0;const n=t.length;let i=!0;for(let s=0;s<n;s++){const a=t[s],o=e[s];if(a.width!==o.width||a.height!==o.height){i=!1;break}}if(i)return!0;let r=0;for(let s=0;s<n;s++)for(let a=0;a<n;a++)if(t[s].width===e[a].width&&t[s].height===e[a].height){r++;break}return r===n}var Q8=class{constructor(t={}){zi(this,"config",{verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1}),zi(this,"fetchingCount",0),zi(this,"imageServices",{}),zi(this,"knownImageServers",{}),this.config=Object.assign(this.config,t)}setConfig(t){Object.assign(this.config,t)}sample(t,e,n=!0){const i=Tu(nn(t)),r=Qa(nn(t)),s=this.knownImageServers[i];return this.imageServices[r]=Object.assign(t,{real:!0}),!s&&t.tiles&&!ER(t)?(this.knownImageServers[i]={verifications:0,malformed:!1,root:i,preLoaded:n,sampledId:nn(t),verified:!1,server:null,result:{context:t["@context"]||[],sampledProfile:t.profile,resourceServiceRatio:e&&t.height?e.height/t.height:1,sampledSizes:t.sizes||[],sizeRatios:Nae(t.width,t.height,t.sizes||[]),sampledTiles:t.tiles||[]}},!0):this.verify(t)}preLoad(t,e=!0){this.knownImageServers[t.root]=t,e&&(this.knownImageServers[t.root].malformed=!1,this.knownImageServers[t.root].verifications=this.config.verificationsRequired)}predict(t,e=!1,n=!1){const i=t==null?void 0:t.source,r=Tu(nn(t)),s=this.knownImageServers[r],a=Qa(nn(t));return this.imageServices[a]?this.imageServices[a]||null:!this.config.approximateServices||!s||!s.result||!(i!=null&&i.height||t.height)||!(i!=null&&i.width||t.width)||!n&&(s.malformed||s.verifications<this.config.verificationsRequired)||t.source&&ER(t.source)?null:(this.imageServices[a]||(this.imageServices[a]={"@context":s.result.context,"@id":nn(t),id:nn(t),protocol:"http://iiif.io/api/image",tiles:(i==null?void 0:i.tiles)||Fae(t.width,t.height,s.result.sampledTiles),sizes:(i==null?void 0:i.sizes)||Mae(Math.round(t.width/s.result.resourceServiceRatio),Math.round(t.height/s.result.resourceServiceRatio),s.result.sizeRatios),profile:(i==null?void 0:i.profile)||s.result.sampledProfile,height:(i==null?void 0:i.height)||t.height,width:(i==null?void 0:i.width)||t.width,real:!1}),this.imageServices[a]||null)}async getThumbnailFromResource(t,e,n=!0,i=[]){const r=t?await this.getImageCandidates(t,n):[];return Hae(e,[()=>i,()=>r])}async getImageCandidates(t,e=!0){const n=t;if(e&&n&&n.height&&n.width){const i=K8(n);for(const r of i){const s={id:nn(r),width:r.width?r.width:n.width,height:r.height?r.height:n.height,source:r};await this.loadService(s)}}return Vae(t,e,this)}async verify(t){const e=this.predict(t,!1,!0),n=await this.fetchService(nn(t));if(!e)return!1;const i=e.height===n.height&&e.width===n.width&&e["@context"]===n["@context"]&&Gae(e.sizes||[],n.sizes||[]);if(i){const r=Tu(nn(t)),s=this.knownImageServers[r];s&&(s.verifications+=1,s.verifications>=this.config.verificationsRequired&&(s.verified=!0))}return i}canLoadSync(t){const e=typeof t=="string"?t:nn(t),n=Qa(e);if(this.imageServices[n])return!0;const i=this.knownImageServers[Tu(e)];return!!(i&&!i.malformed&&i.verifications>=this.config.verificationsRequired)}async markAsMalformed(t){return this.knownImageServers[Tu(nn(t))].malformed=!0,this.loadService(t,!0)}async fetchService(t,e=!1){const n=Qa(t),i=this.imageServices[n];if(i&&(!e||i.real))return i;if(!this.config.enableFetching)throw new Error("Fetching is not enabled");const r=await this.fetch(n).then(s=>s.json());return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==t&&(r.id=t,r["@id"]&&(r["@id"]=t)),this.imageServices[n]=Object.assign(r,{real:!0}),this.imageServices[n]}async fetch(t,e){return fetch(t,e)}async loadService(t,e=!1){if(!this.config.disableThrottling){let r=!0;for(;r;)if(this.fetchingCount>=this.config.verificationsRequired)await new Promise(s=>setTimeout(s,500));else{r=!1;break}}const n=this.knownImageServers[Tu(nn(t))];if(n&&!n.malformed&&!e){await n.result;const r=this.loadServiceSync(t);if(r)return r}this.fetchingCount++;const i=await this.fetchService(nn(t),e);return this.fetchingCount--,i.real&&this.sample(i,t),i}loadServiceSync(t){const e=Qa(nn(t));return this.imageServices[e]?this.imageServices[e]:this.config.approximateServices?this.predict(t):null}};function jae(t={}){const e=t.events||qO(),n=t.loader||new Q8;return{store:HO((i,r)=>({loaded:{},loadServiceSync:(s,a,o)=>{const l=s.id||s["@id"],u=r().loaded[l];if(u&&u.status==="done")return u.service;if(u&&u.status==="loading")return null;if(u&&u.status==="error")throw new Error("Failed to load image service");const d={id:nn(s),width:s.width||(a==null?void 0:a.width)||0,height:s.height||(a==null?void 0:a.height)||0,source:s},f=n.loadServiceSync(d);return f?(i(p=>({loaded:{...p.loaded,[l]:{status:"done",service:f,real:!0}}})),e.emit("image-service.loaded",{id:l,service:f})):o&&r().loadService(s,a).then(()=>{}),f},loadService:async(s,a)=>{const o=s.id||s["@id"],l=r().loaded[o];if(l&&l.status==="done")return l.service;if(l&&l.status==="loading")return new Promise((u,d)=>{const f=p=>{p.id===o&&(e.off("image-service.loaded",f),u(p.service||s))};e.on("image-service.loaded",f)});if(l&&l.status==="error"&&!(a!=null&&a.force))throw new Error("Failed to load image service");e.emit("image-service.loading",{id:o});try{const u={id:nn(s),width:s.width||0,height:s.height||0,source:s},d=await n.loadService(u,a==null?void 0:a.force);return i(f=>({loaded:{...f.loaded,[o]:{status:"done",service:d,real:d.real}}})),e.emit("image-service.loaded",{id:o,service:d}),d}catch(u){throw e.emit("image-service.error",{id:o,error:u}),u}}})),events:e}}jae();var lh={},gE={get(t){return t},setMetaValue([t,e,n],i){const r=gE.getResourceMeta(t,e),s=r?r[n]:void 0,a=typeof i=="function"?i(s):i;lh[t]={...lh[t]||{},[e]:{...(lh[t]||{})[e]||{},[n]:a}}},getResourceMeta:(t,e)=>{const n=lh[t];if(n)return e?n[e]:n},async load(t){const e=typeof t=="string"?t:t.id;return fetch(e).then(n=>n.json())},requestStatus(t){}},Wae=new Q8,SR=new Map;function $ae(t,{vault:e=gE,dereference:n=!1,...i}={}){let r=SR.get(e);return r||(r=Yae(e),SR.set(e,r)),r.getBestThumbnailAtSize(t,i,n)}function Yae(t=gE,e={}){const n=e.imageServiceLoader||Wae;async function i(r,s,a=!1,o=[],l){const u=()=>n.getThumbnailFromResource(void 0,s,a,o);if(!r)return await n.getThumbnailFromResource(void 0,s,a,o);if(typeof r=="string"){const f=_v(r);return f&&o.push(f),await n.getThumbnailFromResource(void 0,s,a,o)}const d=t.get(r,{skipSelfReturn:!1});if(typeof d=="string")return{best:_v(d),fallback:[],log:[]};if(!d)return await u();switch(await(async f=>{if(f&&f.thumbnail&&f.thumbnail.length){const p=t.get(f.thumbnail[0]),m=await n.getImageCandidates(p,a);m&&m.length&&o.push(...m)}})(d),d.type){case"Annotation":{const f=Array.isArray(d.body)?d.body:[d.body],p=t.get(f[0]);return l&&!p.width&&(p.width=l.width,p.height=l.height),await n.getThumbnailFromResource(p,s,a,o)}case"Canvas":{const f=d;return i(f.items[0],s,a,o,{width:f.width,height:f.height})}case"AnnotationPage":return i(d.items[0],s,a,o,l);case"Choice":{const f=d;return!f.items||f.items[0]?await u():i(f.items[0],s,a,o,l)}case"Collection":{const f=d.items[0];return f?i(f,s,a,o,l):await u()}case"Manifest":{const f=d.items[0];return f?i(f,s,a,o,l):await u()}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return l&&!d.width&&(d.width=l.width,d.height=l.height),n.getThumbnailFromResource(d,s,a,o)}return await u()}return{getBestThumbnailAtSize:i}}const Kae=({type:t})=>{switch(t){case"Sound":return U.createElement(jn.Audio,null);case"Image":return U.createElement(jn.Image,null);case"Video":return U.createElement(jn.Video,null);default:return U.createElement(jn.Image,null)}},Xae=({canvas:t,canvasIndex:e,isActive:n,type:i,handleChange:r})=>{const[s,a]=H.useState(!1),[o,l]=H.useState(),u=Jt(),{vault:d}=u,f=200,p=t!=null&&t.label?Li(t==null?void 0:t.label):String(e+1);H.useEffect(()=>{s&&(async()=>{var y,b;try{if(((y=t==null?void 0:t.thumbnail)==null?void 0:y.length)!==0)l((b=t==null?void 0:t.thumbnail[0])==null?void 0:b.id);else{const{best:E}=await $ae(t,{vault:d,dereference:!0,width:f,height:f});l(E==null?void 0:E.id)}}catch(E){console.error("Error fetching thumbnail",E)}})()},[t,s]);const m=y=>{a(y)};return U.createElement(Cv,{"aria-checked":n,"data-testid":"media-thumbnail","data-canvas":e,onClick:()=>r(t.id),value:t.id},U.createElement("figure",null,U.createElement(Rh,null,U.createElement(mae,{isVisibleCallback:m,attributes:{className:"media-thumbnail-lazyload","data-lazyload":String(s),"data-testid":"media-thumbnail-lazyload"}},o&&U.createElement("img",{alt:p,"data-testid":"media-thumbnail-image",src:o})),U.createElement(Ch,null),U.createElement(m8,null,U.createElement(Jh,{isIcon:!0,"data-testid":"thumbnail-tag"},U.createElement(nae,null),U.createElement(jn,{"aria-label":i},U.createElement(Kae,{type:i})),["Video","Sound"].includes(i)&&U.createElement(iae,null,jO(t.duration))))),U.createElement("figcaption",{"data-testid":"fig-caption"},t.label?U.createElement(bs,{label:t.label}):(e+1).toString())))},Qae=t=>t.body?t.body.type:"Image",Zae=({items:t})=>{const{t:e}=ma(),n=di(),i=Jt(),{activeCanvas:r,vault:s,sequence:a}=i,[o,l]=H.useState(""),[u,d]=H.useState([]),[f,p]=H.useState(0),m=U.useRef(null),y="painting",b=x=>{r!==x&&n({type:"updateActiveCanvas",canvasId:x})};H.useEffect(()=>{if(!u.length){const x=["Image","Sound","Video"],S=t.map(w=>e8(s,w,y,x)).filter(w=>w.annotations.length>0);d(S)}},[t,u.length,s]),H.useEffect(()=>{u.forEach((x,S)=>{x!=null&&x.canvas&&x.canvas.id===r&&p(S)})},[r,u]),H.useEffect(()=>{const x=document.querySelector(`[data-canvas="${f}"]`);if(x instanceof HTMLElement&&m.current){const S=x.offsetLeft-m.current.offsetWidth/2+x.offsetWidth/2;m.current.scrollTo({left:S,behavior:"smooth"})}},[f]);const E=x=>l(x),T=x=>{const S=a[1].findIndex(L=>L.includes(f)),w=S+x>=0?S+x:a[1].length-1;if(!a[1][w])return;const C=a[1][w][0],I=a[0][C].id;I&&b(I)};return U.createElement(U.Fragment,null,U.createElement(pae,{handleFilter:E,handleCanvasToggle:T,activeIndex:f,canvasLength:t.length}),U.createElement(rae,{"aria-label":e("media.selectItem"),"data-testid":"media","data-active-canvas":t[f].id,"data-canvas-length":t.length,"data-filter":o,ref:m},a[1].filter(x=>x.some(S=>{var w;const C=a[0][S].id,I=u.find(N=>{var G;return((G=N==null?void 0:N.canvas)==null?void 0:G.id)===C});if(!I)return!1;const L=Li((w=I==null?void 0:I.canvas)==null?void 0:w.label)||"";return!(o&&!L.toLowerCase().includes(o.toLowerCase()))})).map((x,S)=>{const w=x.map(C=>a[0][C].id).includes(r);return U.createElement(sae,{"data-active":w,key:S},x.map(C=>{var I,L;const N=a[0][C].id,G=u.find(O=>{var D;return((D=O==null?void 0:O.canvas)==null?void 0:D.id)===N});return G?U.createElement(Xae,{canvas:G.canvas,canvasIndex:u.findIndex(O=>O===G),handleChange:b,isActive:r===((I=G==null?void 0:G.canvas)==null?void 0:I.id),key:(L=G==null?void 0:G.canvas)==null?void 0:L.id,type:Qae(G.annotations[0])}):null}))})))},Z8=Ge("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all",opacity:1,display:"flex",alignItems:"center",justifyContent:"center",img:{width:"100%",height:"100%",objectFit:"contain",color:"transparent",aspectRatio:"auto"},"&[data-paged=true]":{"img:first-child ":{objectPosition:"100% 50%"},"img:last-child":{objectPosition:"0 50%"}},"&[data-active=false]":{opacity:0,objectPosition:"50% 50%"},variants:{isMedia:{true:{cursor:"pointer"}}}}),J8=Ge("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),eP=Ge(J8,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),Jae=Ge("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{[`${eP}`]:{backgroundColor:"$accent"},[`${Z8}`]:{backgroundColor:"#6662"}}}),eoe=Ge("div",{width:"100%",height:"100%"}),toe=Ge("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),noe=Ge(qne,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),ioe=Ge(Vne,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),roe=Ge(jne,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),soe=Ge(Gne,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),tP=Ge(zne,{position:"relative",zIndex:"5",width:"100%"}),ly=({direction:t,title:e})=>{const n=()=>U.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),i=()=>U.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"});return U.createElement(toe,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},U.createElement("title",null,e),t==="up"&&U.createElement(n,null),t==="down"&&U.createElement(i,null))},nP=({children:t,label:e,maxHeight:n,onValueChange:i,value:r})=>U.createElement(tP,{onValueChange:i,value:r},U.createElement(noe,{"data-testid":"select-button"},U.createElement(jD,{"data-testid":"select-button-value"}),U.createElement(WD,null,U.createElement(ly,{direction:"down",title:"select"}))),U.createElement($D,null,U.createElement(ioe,{css:{maxHeight:`${n} !important`},"data-testid":"select-content"},U.createElement(uO,null,U.createElement(ly,{direction:"up",title:"scroll up for more"})),U.createElement(ZD,null,U.createElement(eO,null,e&&U.createElement(soe,null,U.createElement(bs,{"data-testid":"select-label",label:e})),t)),U.createElement(lO,null,U.createElement(ly,{direction:"down",title:"scroll down for more"}))))),iP=t=>U.createElement(roe,{...t},t.thumbnail&&U.createElement(f8,{thumbnail:t.thumbnail}),U.createElement(sO,null,U.createElement(bs,{label:t.label})),U.createElement(oO,null));let oo=window.OpenSeadragon;if(!oo&&(oo=hc,!oo))throw new Error("OpenSeadragon is missing.");const AR="http://www.w3.org/2000/svg";oo.Viewer&&(oo.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo?this._svgOverlayInfo:(this._svgOverlayInfo=new rP(this),this._svgOverlayInfo)});const rP=function(t){const e=this;this._viewer=t,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(AR,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(AR,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){e.resize()}),this._viewer.addHandler("open",function(){e.resize()}),this._viewer.addHandler("rotate",function(){e.resize()}),this._viewer.addHandler("flip",function(){e.resize()}),this._viewer.addHandler("resize",function(){e.resize()}),this.resize()};rP.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));const t=this._viewer.viewport.pixelFromPoint(new oo.Point(0,0),!0),e=this._viewer.viewport.getZoom(!0),n=this._viewer.viewport.getRotation(),i=this._viewer.viewport.getFlip(),r=this._viewer.viewport._containerInnerSize.x;let s=r*e;const a=s;i&&(s=-s,t.x=-t.x+r),this._node.setAttribute("transform","translate("+t.x+","+t.y+") scale("+s+","+a+") rotate("+n+")")},onClick:function(t,e){new oo.MouseTracker({element:t,clickHandler:e}).setTracking(!0)}};function Br(t){for(let e in t)(typeof t[e]>"u"||t[e]===null)&&delete t[e];return t}function aoe(t){return Array.isArray(t)?t:t?[t]:[]}var wR=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function ooe(t){if(typeof t>"u"||t===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(t))throw new Error("Array is not a valid entity");if(typeof t!="object")throw new Error(`${typeof t} is not a valid entity`);if(typeof t["@type"]=="string"){let e=wR.indexOf(t["@type"]);if(e!==-1)return wR[e]}if(t.profile)return"Service";if(t.format||t["@type"])return"ContentResource";throw new Error("Resource type is not known")}var uoe=class sP{constructor(e,n={}){bR(this,"traversals"),bR(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...e},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...n}}static all(e){return new sP({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let n=[...(e.manifests||[]).map(s=>typeof s=="string"?{"@id":s,"@type":"sc:Manifest"}:s),...(e.collections||[]).map(s=>typeof s=="string"?{"@id":s,"@type":"sc:Collection"}:s),...e.members||[]],i=[],r=n.filter(s=>i.includes(s["@id"])?!1:(i.push(s["@id"]),!0));delete e.collections,delete e.manifests,e.members=r}return e.manifests&&(e.manifests=e.manifests.map(n=>this.traverseManifest(typeof n=="string"?{"@id":n,"@type":"sc:Manifest"}:n))),e.collections&&(e.collections=e.collections.map(n=>this.traverseCollection(typeof n=="string"?{"@id":n,"@type":"sc:Collection"}:n))),e.members&&(e.members=e.members.map(n=>typeof n=="string"?n:n["@type"]==="sc:Collection"?this.traverseCollection(n):n["@type"]==="sc:Manifest"?this.traverseManifest(n):this.traverseUnknown(n))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(n=>this.traverseSequence(n))),e.structures&&(e.structures=e.structures.map(n=>this.traverseRange(n))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(n=>this.traverseCanvas(n))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(n=>this.traverseAnnotation(n))),e.otherContent&&(e.otherContent=e.otherContent.map(n=>this.traverseAnnotationList(n))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let n=[...(e.ranges||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Range"}:i),...(e.canvases||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Canvas"}:i),...e.members||[]];delete e.ranges,delete e.canvases,e.members=n.length?n.map(i=>this.traverseUnknown(i)):void 0}return e}traverseAnnotationList(e){let n=typeof e=="string"?{"@id":e,"@type":"sc:AnnotationList"}:e;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(n)),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(n=>this.traverseAnnotation(n))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(Array.isArray(e.resource)?e.resource=e.resource.map(n=>this.traverseContentResource(n)):e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(n=>this.traverseAnnotationList(n))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(n=>this.traverseContentResource(n))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(ooe(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"sc:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let n=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let s of i)typeof s=="string"?r.push(this.traverseContentResource({"@id":s,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(s));return!n&&!this.options.convertPropsToArray?r[0]:r}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let n=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let s of i)r.push(this.traverseService(s));return!n&&!this.options.convertPropsToArray?r[0]:r}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,n){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,n);return e.map(i=>this.traverseType(i,n))}traverseType(e,n){return n.reduce((i,r)=>{let s=r(i);return typeof s>"u"&&!this.options.allowUndefinedReturn?i:s},e)}},loe="http://library.stanford.edu/iiif/image-api/compliance.html#level1",coe="http://library.stanford.edu/iiif/image-api/compliance.html#level2",doe="http://library.stanford.edu/iiif/image-api/conformance.html#level1",foe="http://library.stanford.edu/iiif/image-api/conformance.html#level2",hoe="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",poe="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",moe="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",goe="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",yoe="http://iiif.io/api/image/1/level1.json",voe="http://iiif.io/api/image/1/profiles/level1.json",boe="http://iiif.io/api/image/1/level2.json",Eoe="http://iiif.io/api/image/1/profiles/level2.json",Toe="http://iiif.io/api/image/2/level1.json",xoe="http://iiif.io/api/image/2/profiles/level1.json",Soe="http://iiif.io/api/image/2/level2.json",Aoe="http://iiif.io/api/image/2/profiles/level2.json",woe="level1",Coe="level2",Roe="http://iiif.io/api/image/2/level1",_oe="http://iiif.io/api/image/2/level2",Ioe=[Roe,_oe,loe,coe,doe,foe,hoe,poe,moe,goe,yoe,voe,boe,Eoe,Toe,xoe,Soe,Aoe,woe,Coe],Iv={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:""};function Loe(t){if(typeof t=="string")return[t];if(!t)return[];let e=Array.isArray(t)?t:[t],n=[];for(let i of e){if(typeof i=="string"){n.push(i);continue}n.push({"@language":i["@language"]||i.language,"@value":i["@value"]||i.value})}return n}function eo(t,e="none"){if(!t)return{none:[""]};let n=Loe(t),i={};for(let r of n){if(typeof r=="string"){i[e]=i[e]?i[e]:[],i[e].push(r||"");continue}if(!r["@language"]){i[e]=i[e]?i[e]:[],i[e].push(r["@value"]||"");continue}let s=r["@language"];i[s]=i[s]?i[s]:[],i[s].push(r["@value"]||"")}return Object.keys(i).length===0?{none:[""]}:i}function aP(t){if(Array.isArray(t))return aP(t.find(e=>typeof e=="string"));if(H0.indexOf(t)!==-1)return"level2";if(Ioe.indexOf(t)!==-1)return"level1";if(gae.indexOf(t)!==-1)return"level0";if(typeof t=="string")return t}function Doe(t){let e=Array.isArray(t)?t:[t];for(let n of e)switch(n){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function Ooe(t){switch(t){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function CR(t){for(let e of["sc","oa","dcterms","dctypes","iiif"])if(t.startsWith(`${e}:`))return t.slice(e.length+1);return t}var Poe=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function yE(t){let e=t["@id"]||t.id,n=t["@type"]||t.type,i=t.profile||void 0,r=t["@context"]||void 0;if(i){let s=Ooe(i);if(s)return s}if(r){let s=Doe(r);if(s)return s}if(n){if(Array.isArray(n)){if(n.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(n.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";n=n[0]}for(let s of["sc","oa","dcterms","dctypes","iiif"])if(n.startsWith(`${s}:`)){n=n.slice(s.length+1);break}switch(n){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(n&&Poe.indexOf(n)!==-1)return n;if(t.format){if(t.format.startsWith("image/"))return"Image";if(t.format.startsWith("text/")||t.format==="application/pdf")return"Text";if(t.format.startsWith("application/"))return"Dataset"}return e&&(e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".jpeg"))?"Image":n||"unknown"}var koe=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function Noe(t){let e=t.match(koe);return e?e[0]:t}function Moe(t,e="Rights/License",n="none"){let i=null,r=[],s=Array.isArray(t)?t:[t];for(let a of s){let o=a?Noe(a):void 0;if(o&&(o.indexOf("creativecommons.org")!==-1||o.indexOf("rightsstatements.org")!==-1)){o.startsWith("https://")?i=`http://${o.slice(8)}`:i=o;continue}o&&r.push({label:{[n]:[e]},value:{[n]:[o]}})}return[i,r]}var Boe=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function Foe(t){if(t){let e=Array.isArray(t)?t:[t],n=[];for(let i of e)i==="http://iiif.io/api/presentation/2/context.json"&&n.push("http://iiif.io/api/presentation/3/context.json"),Boe.indexOf(i)===-1&&n.push(i);if(e.length)return n.length===1?n[0]:n}}function Uoe(t){return t?t.map(e=>({label:eo(e.label),value:eo(e.value)})):[]}var RR=0;function oP(t,e){let n=encodeURI(t.id||t["@id"]||"").trim();return n&&e?`${n}/${e}`:n||(RR++,`http://example.org/${t["@type"]}${e?`/${e}`:""}/${RR}`)}function Es(t){let e=[...t.behavior||[]];t.viewingHint&&e.push(t.viewingHint);let n;return Array.isArray(t.motivation)?n=t.motivation.map(CR):t.motivation&&(n=CR(t.motivation)),{"@context":t["@context"]?Foe(t["@context"]):void 0,id:(t["@id"]||oP(t)).trim(),type:yE(t),behavior:e.length?e:void 0,height:t.height?t.height:void 0,width:t.width?t.width:void 0,motivation:n,viewingDirection:t.viewingDirection,profile:t.profile,format:t.format?t.format:void 0,duration:void 0,timeMode:void 0}}function Ts(t){let[e,n]=Moe(t.license),i=[...t.metadata?Uoe(t.metadata):[],...n];return{rights:e,metadata:i.length?i:void 0,label:t.label?eo(t.label):void 0,requiredStatement:t.attribution?{label:eo(Iv.attributionLabel),value:eo(t.attribution)}:void 0,navDate:t.navDate,summary:t.description?eo(t.description):void 0,thumbnail:Hoe(t.thumbnail)}}function Hoe(t){return t&&(Array.isArray(t)?t:[t]).map(e=>typeof e=="string"?{id:e,type:"Image"}:(e.type==="unknown"&&(e.type="Image"),e))}function zoe(t){if(!t.within)return;let e=Array.isArray(t.within)?t.within:[t.within],n=[];for(let i of e)if(typeof i=="string"){if(i)switch(t["@type"]){case"sc:Manifest":n.push({id:i,type:"Collection"});break}}else i["@id"]&&n.push({id:i["@id"],type:yE(i)});return n.length?n:void 0}function Ea(t){let e=t.related?Array.isArray(t.related)?t.related:[t.related]:[],n=t.contentLayer;return{provider:t.logo||e.length?[{id:Iv.providerId,type:"Agent",homepage:e.length?[e[0]]:void 0,logo:t.logo?Array.isArray(t.logo)?t.logo:[t.logo]:void 0,label:eo(Iv.providerName)}]:void 0,partOf:zoe(t),rendering:t.rendering,seeAlso:t.seeAlso,start:t.startCanvas,service:t.service?aoe(t.service):void 0,supplementary:n?[n]:void 0}}function qoe(t){return{chars:t.chars,format:t.format?t.format:void 0,language:t.language}}function cy(t,e){return t?typeof t=="string"?{id:t,type:e}:typeof(t==null?void 0:t["@id"])=="string"?{id:t["@id"],type:e}:typeof t.id=="string"?{id:t.id,type:e}:null:null}function Voe(t){let e={};if(t.first){let n=cy(t.first,"Collection");n&&(e.first=n)}if((t.total||t.total===0)&&(e.total=t.total),t.prev){let n=cy(t.prev,"Collection");n&&(e.prev=n)}if(t.next){let n=cy(t.next,"Collection");n&&(e.next=n)}return e}function Goe(t){let e=[];for(let n of t){let i={...n};i.items&&i.items.length===0&&delete i.items,e.push(i)}return e}function joe(t){return Br({...Es(t),...Ts(t),...Ea(t),...Voe(t),items:Goe(t.members)})}function Woe(t){let e=[],n=[],i,r;for(let a of t.sequences||[])a.canvases.length&&e.push(...a.canvases),a.behavior&&n.push(...a.behavior),a.viewingDirection&&(r=a.viewingDirection),a.startCanvas&&(i=a.startCanvas);let s=Es(t);return n.length&&(s.behavior?s.behavior.push(...n):s.behavior=n),Br({...s,...Ts(t),...Ea(t),viewingDirection:r,start:i,items:e,structures:$oe(t.structures)})}function $oe(t){if(!t)return t;let e=new Map;for(let i of t)e.set(i.id,i);let n=[];for(let i of t)if(i.items){let r=i.items.map(s=>typeof s=="string"?(n.push(s),e.get(s)||s):s&&s.id?(n.push(s.id),e.get(s.id)||s):s);i.items=r}return t.filter(i=>n.indexOf(i.id)===-1)}function Yoe(t){return Br({...Es(t),...Ts(t),...Ea(t),annotations:t.otherContent&&t.otherContent.length?t.otherContent:void 0,items:t.images&&t.images.length?[{id:oP(t,"annotation-page"),type:"AnnotationPage",items:t.images}]:void 0})}function Koe(t){return Br({...Es(t),...Ts(t),...Ea(t),items:t.resources&&t.resources.length?t.resources:void 0})}function Xoe(t){return!t.canvases||t.canvases.length===0?{canvases:[],behavior:[]}:{canvases:t.canvases,behavior:t.viewingHint?[t.viewingHint]:[],viewingDirection:t.viewingDirection,startCanvas:t.startCanvas}}function Qoe(t){function e(n){if(Array.isArray(n)){if(n.length>1)return{type:"List",items:n.map(e)};n=n[0]}if(typeof n=="string")return encodeURI(n).trim();if("@type"in n){let i;if(typeof n.full=="string")i=n.full;else if(n.full["@type"]==="dctypes:Image")i={id:n.full["@id"],type:"Image"};else if(n.full["@type"]==="sc:Canvas")i={id:n.full["@id"],type:"Canvas"};else throw new Error(`Unsupported source type on annotation: ${n.full["@type"]}`);return{type:"SpecificResource",source:i,selector:Lv(n.selector)}}else return encodeURI(n["@id"]).trim()}return Br({...Es(t),...Ts(t),...Ea(t),target:e(t.on),body:Array.isArray(t.resource)?t.resource.map(_R):_R(t.resource)})}function _R(t){return t.type==="Choice"?t:uP(t)}function uP(t){let e=t;return Br({...Es(e),...Ts(e),...Ea(e),...qoe(e)})}function Zoe(t){let e=[];return t.default&&t.default!=="rdf:nil"&&e.push(t.default),t.item&&t.item!=="rdf:nil"&&e.push(...t.item),Br({...Es(t),...Ts(t),items:e})}function Joe(t){return Br({...Es(t),...Ts(t),...Ea(t),items:t.members})}function eue(t){let{"@id":e,"@type":n,"@context":i,profile:r,...s}=t,a={};return e&&(a["@id"]=e),a["@type"]=yE(t),a["@type"]==="unknown"&&(i&&i.length&&(a["@context"]=i),a["@type"]="Service"),r&&(a.profile=aP(r)),Br({...a,...s})}function tue(t){return Br({...Es(t),...Ts(t),...Ea(t)})}var nue=new uoe({collection:[joe],manifest:[Woe],canvas:[Yoe],annotationList:[Koe],sequence:[Xoe],annotation:[Qoe],contentResource:[uP],choice:[Zoe],range:[Joe],service:[eue],layer:[tue]});function iue(t){return t&&t["@context"]&&(t["@context"]==="http://iiif.io/api/presentation/2/context.json"||t["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||t["@context"]==="http://www.shared-canvas.org/ns/context.json")||t["@context"]==="http://iiif.io/api/image/2/context.json"||t["@id"]&&t["@type"]==="sc:Collection"||t["@id"]&&t["@type"]==="sc:Manifest"?(t["@context"]||(t["@context"]="http://iiif.io/api/presentation/2/context.json"),nue.traverseUnknown(t)):t}function Lv(t){if((Array.isArray(t["@type"])&&t["@type"].includes("oa:SvgSelector")||t["@type"]=="oa:SvgSelector")&&("chars"in t||"value"in t))return{type:"SvgSelector",value:"chars"in t?t.chars:t.value};if(t["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:t.value};if(t["@type"]==="oa:Choice")return[Lv(t.default),...(Array.isArray(t.item)?t.item:[t.item]).map(Lv)];if(t["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in t?t.region:void 0,rotation:"rotation"in t?t.rotation:void 0};throw new Error(`Unsupported selector type: ${t["@type"]}`)}const rue=t=>(Array.isArray(t["@context"])?t["@context"]:[t["@context"]]).map(e=>e==null?void 0:e.replace("http://","https://")),sue=t=>fetch(`${t.replace(/\/$/,"")}/info.json`).then(e=>e.json()).then(e=>e).catch(e=>{console.error(`The IIIF tilesource ${t.replace(/\/$/,"")}/info.json failed to load: ${e}`)}),aue=t=>{let e,n;if(Array.isArray(t)&&(e=t[0],e)){let i;"@id"in e?i=e["@id"]:i=e.id,n=i}return n},lP=t=>{var e,n,i,r,s,a,o,l,u,d,f,p,m,y,b;let E,T={};switch(t==null?void 0:t.type){case"SpecificResource":E=(i=(n=(e=t==null?void 0:t.target)==null?void 0:e.partOf)==null?void 0:n[0])==null?void 0:i.id,T={manifest:E,canvas:(r=t==null?void 0:t.target)==null?void 0:r.id},t!=null&&t.selector&&(T.selector=t.selector);break;case"Range":case"Annotation":const x=((s=t==null?void 0:t.target)==null?void 0:s.source)||(t==null?void 0:t.target),S=(a=t==null?void 0:t.target)==null?void 0:a.selector;T={manifest:(l=(o=x==null?void 0:x.partOf)==null?void 0:o[0])==null?void 0:l.id,canvas:x==null?void 0:x.id},(((u=t==null?void 0:t.target)==null?void 0:u.type)==="SpecificResource"||(d=t==null?void 0:t.target)!=null&&d.selector)&&(T.selector=S);break;case"Canvas":if(E=(p=(f=t==null?void 0:t.partOf)==null?void 0:f[0])==null?void 0:p.id,T={manifest:E,canvas:t==null?void 0:t.id},(m=t==null?void 0:t.id)!=null&&m.includes("#xywh=")){const[w,C]=t.id.split("#xywh=");T.canvas=w,T.selector={type:"FragmentSelector",value:`xywh=${C}`}}break;case"Manifest":E=t==null?void 0:t.id,T={collection:(b=(y=t==null?void 0:t.partOf)==null?void 0:y[0])==null?void 0:b.id,manifest:t==null?void 0:t.id};break;case"Collection":E=t==null?void 0:t.id,T={collection:E};break}return{resourceId:E,active:T}},oue=t=>{const e=["https://iiif.io/api/presentation/2/context.json","https://iiif.io/api/presentation/3/context.json"],n=new TypeError(`The IIIF content may not be a valid IIIF resource: ${e.join(", ")}`);t["@context"]||console.warn(n);const i=rue(t);try{if(i.includes(e[0])){const r=iue(t);if(!r||!r.id||!r.type)throw n;return r}else{if(i.includes(e[1]))return t;throw n}}catch(r){console.warn(r)}},uue=t=>{if(typeof t=="string"&&fue(t))return{resourceId:t};if(typeof t=="object"){const e=oue(t);return{resourceId:e==null?void 0:e.id,resourceObject:e}}else{const e=JSON.parse(H9(t)),{active:n}=lP(e);return{active:n,resourceId:e==null?void 0:e.resourceId,resourceObject:e}}},lue=t=>{const{resourceId:e,resourceObject:n}=uue(t);return n||e},cue=t=>t.items.map(e=>e.id)[0],due=t=>{const e=t.items.filter(n=>n.type==="Manifest").map(n=>n.id);return e.length==0?null:e[0]},fue=t=>{try{new URL(t)}catch{return!1}return!0};var qi=(t=>(t.TiledImage="tiledImage",t.SimpleImage="simpleImage",t))(qi||{});const hue=t=>{const e=Array.isArray(t==null?void 0:t.service)&&(t==null?void 0:t.service.length)>0,n=e?aue(t==null?void 0:t.service):t==null?void 0:t.id,i=e?qi.TiledImage:qi.SimpleImage;return{uri:n,imageType:i}},pue=(t,e)=>{const n=e?qi.TiledImage:qi.SimpleImage;return{uri:t,imageType:n}},Dv=Ge("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),mue=Ge("div",{position:"relative",width:"100%",height:"100%",zIndex:"0",".clover-iiif-image-openseadragon-annotation":{position:"relative",backgroundColor:"transparent",border:"2px solid #0003",boxSizing:"content-box",borderRadius:"3px",boxShadow:"0 0 38vw 38vw transparent",transition:"box-shadow 100ms ease-in-out",zIndex:"0",label:{opacity:0,position:"absolute",lineHeight:"1.47rem",pointerEvents:"none",textAlign:"center",minWidth:"300px",maxWidth:"20vw",padding:"0.5rem",borderRadius:"3px",top:"calc(100% + 0.5rem)",left:"50%",transform:"translate(-50%, 0)",backgroundColor:"$primary",color:"$secondary",transition:"opacity 100ms ease-in-out"},"&[data-active=true]":{border:"2px solid $accent !important",boxShadow:"0 0 38vw 38vw #0003",zIndex:"99999999",label:{opacity:1}}}}),gue=Ge("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${Dv}`]:{display:"block"}},false:{[`${Dv}`]:{display:"none"}}}}}),xu=({className:t,id:e,label:n,children:i})=>{const r=n.toLowerCase().replace(/\s/g,"-");return U.createElement(J8,{id:e,className:t,"data-testid":"openseadragon-button","data-button":r},U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${e}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},U.createElement("title",{id:`${e}-svg-title`},n),i))},yue=Ge("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),vue=()=>U.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),bue=()=>U.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),Eue=()=>U.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),Tue=()=>U.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),IR=()=>U.createElement(U.Fragment,null,U.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),U.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),xue=({_cloverViewerHasPlaceholder:t,config:e})=>{const n=Jt(),{activeCanvas:i,plugins:r,vault:s,openSeadragonViewer:a}=n,o=s.get({id:i,type:"Canvas"});function l(){return r.filter(u=>{var d;return(d=u.imageViewer)==null?void 0:d.controls}).map((u,d)=>{var f,p,m,y;const b=(p=(f=u.imageViewer)==null?void 0:f.controls)==null?void 0:p.component;return U.createElement(b,{key:d,...(y=(m=u==null?void 0:u.imageViewer)==null?void 0:m.controls)==null?void 0:y.componentProps,canvas:o,useViewerDispatch:di,useViewerState:Jt})})}return H.useEffect(()=>{if(!a)return;const u=a.viewport.getRotation();a.addHandler("home",()=>{a.viewport.setRotation(u)})},[a]),U.createElement(yue,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:t},e.showZoomControl&&U.createElement(U.Fragment,null,U.createElement(xu,{id:e.zoomInButton,label:"zoom in"},U.createElement(vue,null)),U.createElement(xu,{id:e.zoomOutButton,label:"zoom out"},U.createElement(bue,null))),e.showFullPageControl&&U.createElement(xu,{id:e.fullPageButton,label:"full page"},U.createElement(Eue,null)),e.showRotationControl&&U.createElement(U.Fragment,null,U.createElement(xu,{id:e.rotateRightButton,label:"rotate right"},U.createElement(IR,null)),U.createElement(xu,{id:e.rotateLeftButton,label:"rotate left"},U.createElement(IR,null))),e.showHomeControl&&U.createElement(xu,{id:e.homeButton,label:"reset"},U.createElement(Tue,null)),l())};async function cP(t,e=3,n=500){try{return await t()}catch(i){if(e<=0)throw i;return await new Promise(r=>setTimeout(r,n)),cP(t,e-1,n)}}const Sue=t=>new Promise(e=>setTimeout(e,t)),LR=async(t,e,n=3,i=300)=>{for(let r=0;r<n;r++){const s=e?e-1:0,a=t.getItemAt(s);if(a)return a;await Sue(i)}throw new Error("No base item found at index 0 after retries")},Aue=({annotations:t,ariaLabel:e,config:n,uri:i,_cloverViewerHasPlaceholder:r,imageType:s,openSeadragonCallback:a})=>{const[o,l]=H.useState([]),[u,d]=H.useState([]),[f,p]=H.useState(),[m,y]=H.useState([]),b=di(),E=H.useRef(!1),T="clover-iiif-image-openseadragon-annotation",x=n.gestureSettingsMouse.scrollToZoom===!1;H.useEffect(()=>(E.current||(E.current=!0,f||p(hc(n))),()=>f==null?void 0:f.destroy()),[]),H.useEffect(()=>{S()},[f,a]),H.useEffect(()=>{f&&JSON.stringify(i)!==JSON.stringify(u)&&(f.forceRedraw(),x&&f.addHandler("canvas-scroll",function(w){w.preventDefault=!1}),d(i))},[x,f,u,i]),H.useEffect(()=>{!u.length||!f||(f.close(),(async()=>{switch(s){case"simpleImage":let w=1,C=0;for(let I=0;I<u.length;I++){const L=u[I];if(t){const N=new Image;N.src=L,await N.decode(),y(G=>[...G,{width:N==null?void 0:N.width,height:N==null?void 0:N.height}])}try{if(I!==0){const N=(await LR(f.world,I)).getBounds();C=N.x+N.width,w=N.height}f.addSimpleImage({url:L,x:C,y:0,height:w,success:()=>{l(N=>[...N,L]),typeof b=="function"&&b({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(N){console.error(`Failed to load image at ${L}:`,N)}}break;case"tiledImage":{let I=1,L=0;for(let N=0;N<u.length;N++){const G=u[N];try{const O=await cP(()=>sue(G),3,1e3);if(!O)throw new Error(`No tile source for ${G}`);if(N!==0){const D=(await LR(f.world,N)).getBounds();L=D.x+D.width,I=D.height}f.addTiledImage({tileSource:O,x:L,y:0,height:I,success:()=>{l(D=>[...D,G]),typeof b=="function"&&b({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(O){console.error(`Failed to load tile at ${G}:`,O)}}break}default:console.warn(`Unsupported imageType: "${s}"`);break}})().catch(w=>console.error("Error drawing tiles",w)))},[u,s,f]),H.useEffect(()=>{if(o){let w=0;const C=()=>{if(w<3){const I=f==null?void 0:f.world.getHomeBounds();I&&(f==null||f.viewport.fitBounds(I,!0)),w++,setTimeout(C,50)}};C(),f==null||f.addHandler("canvas-click",I=>{const L=f==null?void 0:f.getOverlayById(I.originalTarget.id);if(L){const N=L==null?void 0:L.getBounds(f.viewport);return N.x-=.1,N.y-=.1,N.width+=.2,N.height+=.2,f==null||f.viewport.fitBounds(N,!1),I.preventDefaultAction=!0}})}},[o]),H.useEffect(()=>{function w(C,I,L){let N=C*L;if(I===0)return N;for(;I>0;){const G=f==null?void 0:f.world.getItemAt(I-1);if(G){const O=G.getBounds().width;N+=O,I--}else break}return N}t&&(f==null||f.clearOverlays(),t.forEach(C=>{var I,L,N,G;const{annotation:O,targetIndex:D}=C,V=((L=(I=f==null?void 0:f.viewport)==null?void 0:I.getBounds())==null?void 0:L.width)||1,$=f==null?void 0:f.world.getItemAt(D),J=$?($==null?void 0:$.getBounds().width)/($==null?void 0:$.getContentSize().x):((N=m[D])==null?void 0:N.width)/V,K=Yre(O==null?void 0:O.target),j=O!=null&&O.body?(G=O==null?void 0:O.body[0])==null?void 0:G.value:void 0;if(K!=null&&K.rect){const{x:te,y:ne,w:oe,h:P}=K==null?void 0:K.rect,ie=w(te,D,J),le=new hc.Rect(ie,ne*J,oe*J,P*J),q=document.createElement("button");if(q.classList.add(T),q.id=O.id,q.setAttribute("tabindex","0"),q.setAttribute("role","button"),q.setAttribute("data-active","true"),q.setAttribute("tabindex","0"),q.setAttribute("role","button"),q.setAttribute("data-active","false"),j){q.setAttribute("aria-label",j);const ye=document.createElement("label");ye.innerHTML=j,q.appendChild(ye)}q.addEventListener("mousedown",ye=>{ye.stopPropagation(),ye.preventDefault()}),q.addEventListener("touchstart",ye=>{ye.stopPropagation(),ye.preventDefault()}),q.addEventListener("click",ye=>{ye.stopPropagation(),ye.preventDefault()}),q.addEventListener("keydown",ye=>{if(ye.key==="Enter"){ye.stopPropagation(),ye.preventDefault();const Pe=new hc.Rect(le.x-.1,le.y-.1,le.width+.2,le.height+.2);f==null||f.viewport.fitBounds(Pe,!1)}}),q.addEventListener("focus",()=>{q.setAttribute("data-active","true")}),q.addEventListener("mouseover",()=>{q.setAttribute("data-active","true")}),q.addEventListener("mouseout",()=>{q.removeAttribute("data-active")}),q.addEventListener("blur",()=>{q.removeAttribute("data-active")}),f==null||f.addOverlay(q,le,hc.Placement.CENTER)}}),S())},[o,t]);function S(){f&&(a==null||a(f))}return U.createElement(gue,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":n.id,hasNavigator:n.showNavigator},U.createElement(xue,{_cloverViewerHasPlaceholder:r,config:n}),n.showNavigator&&U.createElement(Dv,{id:n.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),U.createElement(mue,{id:n.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...e&&{"aria-label":e}}))};function wue(t){return{id:`openseadragon-${t}`,navigatorId:`openseadragon-navigator-${t}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${t}`,homeButton:`reset-${t}`,rotateLeftButton:`rotateLeft-${t}`,rotateRightButton:`rotateRight-${t}`,zoomInButton:`zoomIn-${t}`,zoomOutButton:`zoomOut-${t}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1}}}const Cue=({_cloverViewerHasPlaceholder:t=!1,annotations:e,body:n,instanceId:i,isTiledImage:r=!1,label:s,src:a="",openSeadragonCallback:o,openSeadragonConfig:l={}})=>{const u=i??Dc(),d=typeof s=="string"?s:Li(s),f={...wue(u),...l},p=Array.isArray(n)?n:n?[n]:[],m=Array.isArray(a)?a:a?[a]:[];let y=[],b=qi.SimpleImage;if(p.length){const T=p.map(hue);y=T.map(x=>x.uri).filter(Boolean),b=T.some(x=>x.imageType===qi.TiledImage)?qi.TiledImage:qi.SimpleImage}else if(m.length){const T=m.map(x=>pue(x,r));y=T.map(x=>x.uri).filter(Boolean),b=T.some(x=>x.imageType===qi.TiledImage)?qi.TiledImage:qi.SimpleImage}if(!y.length)return null;const E=T=>{o==null||o(T)};return U.createElement(Hv,{FallbackComponent:cE},U.createElement(Aue,{_cloverViewerHasPlaceholder:t,annotations:e,ariaLabel:d,config:f,imageType:b,key:u,uri:y,openSeadragonCallback:E}))},Rue=({isActive:t,isMedia:e,items:n,setIsInteractive:i})=>{const{vault:r}=Jt(),[s,a]=H.useState([]),o=s.length>1;if(H.useEffect(()=>{a([]);const d=n.map(f=>{const p=pa(r,f.id);if(!p)return null;const{id:m,width:y,height:b}=p[0];return m?{src:m,width:y||640,height:b||640,alt:f.label?lE(f.label):"placeholder image"}:null}).filter(f=>f!==null);d.length&&a(d)},[n,o]),!t||!s.length)return null;const l=s.map(d=>d.width/d.height*1),u=l.reduce((d,f)=>d+f,0);return U.createElement(Z8,{onClick:()=>i(!0),isMedia:e,className:"clover-viewer-placeholder","data-active":t,"data-paged":o},s.map((d,f)=>{const p=l[f]/u*100;return U.createElement("img",{...d,key:f,alt:d.alt,style:{width:`${p}%`}})}))},_ue=Ge("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),Iue=U.forwardRef((t,e)=>{const n=U.useRef(null),i=H.useCallback(()=>{var s,a;if((s=e.current)!=null&&s.currentTime&&((a=e.current)==null?void 0:a.currentTime)>0)return;const o=e.current;if(!o)return;const l=new AudioContext,u=l.createMediaElementSource(o),d=l.createAnalyser(),f=n.current;if(!f)return;f.width=o.offsetWidth,f.height=o.offsetHeight;const p=f.getContext("2d");u.connect(d),d.connect(l.destination),d.fftSize=256;const m=d.frequencyBinCount,y=new Uint8Array(m);setInterval(function(){r(d,p,m,y,f.width,f.height)},20)},[e]);U.useEffect(()=>{!e||!e.current||(e.current.onplay=i)},[i,e]);function r(s,a,o,l,u,d){const f=u/o*2.6;let p,m=0;s.getByteFrequencyData(l),a.fillStyle="#000000",a.fillRect(0,0,u,d);for(let y=0;y<o;y++)p=l[y]*2,a.fillStyle="rgba(78, 42, 132, 1)",a.fillRect(m,d-p,f,p),m+=f+6}return U.createElement(_ue,{ref:n,role:"presentation"})}),Lue=Ge("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),Due=({resource:t,ignoreCaptionLabels:e})=>{const n=lE(t.label,"en");return Array.isArray(n)&&n.some(i=>e.includes(i))?null:U.createElement("track",{key:t.id,src:t.id,label:Array.isArray(n)?n[0]:n,srcLang:"en","data-testid":"player-track"})},Oue=["application/vnd.apple.mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"],Pue=({allSources:t,annotationResources:e,painting:n})=>{const[i,r]=U.useState(0),[s,a]=U.useState(),o=U.useRef(null),l=(n==null?void 0:n.type)==="Sound",u=di(),d=Jt(),{activeCanvas:f,configOptions:p,contentStateAnnotation:m,vault:y}=d;return H.useEffect(()=>{if(!n.id||!o.current)return;if(o!=null&&o.current){const T=o.current;u({type:"updateActivePlayer",player:T}),T.src=n.id,T.load()}if(n.id.split(".").pop()!=="m3u8"&&n.format&&!Oue.includes(n.format))return;const b={xhrSetup:function(T,x){T.withCredentials=!!p.withCredentials}},E=new Un(b);return E.attachMedia(o.current),E.on(Un.Events.MEDIA_ATTACHED,function(){E.loadSource(n.id)}),E.on(Un.Events.ERROR,function(T,x){if(x.fatal)switch(x.type){case Un.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${T} network error encountered, try to recover`),E.startLoad();break;case Un.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${T} media error encountered, try to recover`),E.recoverMediaError();break;default:E.destroy();break}}),()=>{if(E&&o.current){const T=o.current;E.detachMedia(),E.destroy(),T.currentTime=0}}},[p.withCredentials,n.id,n.format,u]),H.useEffect(()=>{var b,E,T,x;const S=y.get(f),w=(b=S.accompanyingCanvas)!=null&&b.id?pa(y,(E=S.accompanyingCanvas)==null?void 0:E.id):null,C=(T=S.placeholderCanvas)!=null&&T.id?pa(y,(x=S.placeholderCanvas)==null?void 0:x.id):null;w&&C?a(i===0?C[0].id:w[0].id):(w&&a(w[0].id),C&&a(C[0].id))},[f,i,y]),H.useEffect(()=>{const b=o==null?void 0:o.current;if(!b)return;let E=null,T=!1;const x=()=>{T||(T=!0,E=setInterval(()=>{b&&!b.paused&&!b.ended&&(r(b.currentTime),u({type:"updateActiveSelector",selector:{type:"PointSelector",t:Math.round(b.currentTime)}}))},500)),b&&b.paused&&(r(b.currentTime),u({type:"updateActiveSelector",selector:{type:"PointSelector",t:Math.round(b.currentTime)}}))};return b.addEventListener("timeupdate",x),()=>{b==null||b.removeEventListener("timeupdate",x),E&&clearInterval(E)}},[n.id,f]),H.useEffect(()=>{var b,E;if(m){const T=o==null?void 0:o.current;if(!T)return;const x=(b=m==null?void 0:m.target)==null?void 0:b.selector,{type:S,t:w,value:C}=x||{};if((((E=m==null?void 0:m.target)==null?void 0:E.source)||(m==null?void 0:m.target)).id!==f)return;if(w&&S==="PointSelector"&&(r(w),T.currentTime=w),S==="FragmentSelector"&&C){const I=C.split("=")[1];if(!I)return;const L=I.split(",")[0];r(L),T.currentTime=L}}},[o,m]),U.createElement(Lue,{css:{backgroundColor:p.canvasBackgroundColor,maxHeight:p.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper"},U.createElement("video",{id:"clover-iiif-video",key:n.id,ref:o,"data-src":n.id,controls:!0,height:n.height,width:n.width,crossOrigin:p.crossOrigin,poster:s,style:{maxHeight:p.canvasHeight,position:"relative",zIndex:"1"}},t.map(b=>U.createElement("source",{src:b.id,type:b.format,key:b.id})),(e==null?void 0:e.length)>0&&e.map(b=>{const E=[];return b.items.forEach(T=>{y.get(T.id).body.forEach(x=>{const S=y.get(x.id);E.push(S)})}),E.map(T=>U.createElement(Due,{resource:T,ignoreCaptionLabels:p.ignoreCaptionLabels||[],key:T.id}))}),"Sorry, your browser doesn't support embedded videos."),l&&U.createElement(Iue,{ref:o}))},kue=()=>U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},U.createElement("title",{id:"close-svg-title"},"close"),U.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Nue=({isMedia:t})=>U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},U.createElement("title",{id:"open-svg-title"},"open"),t?U.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):U.createElement(U.Fragment,null,U.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),U.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),Mue=({handleToggle:t,isInteractive:e,isMedia:n})=>U.createElement(eP,{onClick:t,isInteractive:e,isMedia:n,"data-testid":"placeholder-toggle"},e?U.createElement(kue,null):U.createElement(Nue,{isMedia:n})),Bue=({activeCanvas:t,annotationResources:e,contentSearchResource:n,isMedia:i,painting:r})=>{var s,a,o,l;const[u,d]=U.useState(0),[f,p]=U.useState(!1),[m,y]=U.useState([]),[b,E]=U.useState([]),[T,x]=U.useState(0),{configOptions:S,customDisplays:w,contentStateAnnotation:C,informationPanelResource:I,openSeadragonViewer:L,vault:N,viewerId:G,visibleCanvases:O}=Jt(),[D,V]=U.useState([]),$=!!C&&t===((a=(s=C==null?void 0:C.target)==null?void 0:s.source)==null?void 0:a.id),J=di(),K=N.get(t),j=b.length&&!f&&!i,te=(r==null?void 0:r.length)>1,ne=`${G}-${$O(t+u+JSON.stringify(O)+T)}`,oe=()=>{p(!f),x(ye=>ye+1)},P=ye=>{const Pe=r.findIndex(we=>we.id===ye);d(Pe)},ie=w.find(ye=>{var Pe;let we=!1;const{canvasId:Me,paintingFormat:Fe}=ye.target;if(Array.isArray(Me)&&Me.length>0&&(we=Me.includes(t)),Array.isArray(Fe)&&Fe.length>0){const $e=((Pe=r[u])==null?void 0:Pe.format)||"";we=!!($e&&Fe.includes($e))}return we});H.useEffect(()=>{$&&j&&T===0&&oe()},[$,j]),H.useEffect(()=>{j&&(J({type:"updateOpenSeadragonViewer",openSeadragonViewer:void 0}),J({type:"updateActiveSelector",selector:void 0}))},[j]),H.useEffect(()=>{var ye,Pe,we;const Me=[];if(I==="manifest-annotations"&&(e==null||e.forEach((Fe,$e)=>{var Ye;(Ye=Fe==null?void 0:Fe.items)==null||Ye.forEach(fe=>{const Ie=N.get(fe.id);Ie&&Me.push({annotation:{...Ie,body:Ie.body.map(Le=>N.get(Le.id)||Le)},targetIndex:$e})})}),C)){const Fe=((ye=C==null?void 0:C.target)==null?void 0:ye.source)||(C==null?void 0:C.target);Me.push({annotation:{...C,body:(Pe=C==null?void 0:C.body)==null?void 0:Pe.map($e=>N.get($e.id)||$e)},targetIndex:O.findIndex($e=>$e.id===Fe.id)})}I==="manifest-content-search"&&((we=n==null?void 0:n.items)==null||we.forEach(Fe=>{const $e=N.get(Fe.id);if($e){const Ye=O.findIndex(fe=>fe.id===$e.target.source.id);typeof Ye=="number"&&Me.push({annotation:{...$e,body:$e.body.map(fe=>N.get(fe.id)||fe)},targetIndex:Ye})}})),V(Me)},[e,n,C,I,O]),H.useEffect(()=>{if(!i){const ye=O.map(we=>{const Me=we.id,Fe=pa(N,Me);return Fe?Fe[u]:void 0}).filter(Boolean),Pe=O.map(we=>{var Me;const Fe=we.id,$e=N.get(Fe),Ye=(Me=$e==null?void 0:$e.placeholderCanvas)==null?void 0:Me.id;return!Ye||!Ye?null:{id:Ye,label:$e==null?void 0:$e.label}}).filter(we=>we!==null);y(ye),E(Pe)}},[u,t,O,i,K]),H.useEffect(()=>{d(0)},[O]);const le=ye=>{ye&&!j&&(L==null?void 0:L.id)!==`openseadragon-${ne}`&&J({type:"updateOpenSeadragonViewer",openSeadragonViewer:ye})},q=(o=ie==null?void 0:ie.display)==null?void 0:o.component;return U.createElement(Jae,{className:"clover-viewer-painting"},U.createElement(eoe,{style:{backgroundColor:S.canvasBackgroundColor,height:S.canvasHeight==="auto"?"100%":S.canvasHeight}},!!b.length&&!i&&U.createElement(Mue,{handleToggle:oe,isInteractive:f,isMedia:i}),!!(b!=null&&b.length)&&!i&&U.createElement(Rue,{isActive:!!j,isMedia:i,items:b,setIsInteractive:p}),!j&&!ie&&(i?U.createElement(Pue,{allSources:r,painting:r[u],annotationResources:e}):r&&U.createElement(Cue,{_cloverViewerHasPlaceholder:!!(b!=null&&b.length),annotations:D,body:m,instanceId:ne,key:ne,openSeadragonCallback:le,openSeadragonConfig:S.openSeadragon})),!j&&q&&U.createElement(q,{id:t,annotationBody:r[u],hooks:{useViewerDispatch:di,useViewerState:Jt},...ie==null?void 0:ie.display.componentProps})),te&&U.createElement(nP,{value:(l=r[u])==null?void 0:l.id,onValueChange:P,maxHeight:"200px"},r==null?void 0:r.map(ye=>U.createElement(iP,{value:ye==null?void 0:ye.id,key:ye==null?void 0:ye.id,label:ye==null?void 0:ye.label}))))},Fue=({activeCanvas:t,annotationResources:e,searchServiceUrl:n,setContentSearchResource:i,contentSearchResource:r,isAudioVideo:s,items:a,painting:o})=>{var l,u;const{contentStateAnnotation:d,isInformationOpen:f,configOptions:p,sequence:m,visibleCanvases:y}=Jt(),{informationPanel:b}=p,E=y.map(w=>w.id),T=(e.length>0||E.includes((u=(l=d==null?void 0:d.target)==null?void 0:l.source)==null?void 0:u.id))&&(b==null?void 0:b.renderAnnotation)&&(b==null?void 0:b.renderToggle)===!1&&f,x=(b==null?void 0:b.renderAbout)&&f||T,S=b==null?void 0:b.renderToggle;return U.createElement(i8,{className:"clover-viewer-content","data-testid":"clover-viewer-content"},U.createElement(r8,{"data-aside-active":x,"data-aside-toggle":S},U.createElement(Bue,{activeCanvas:t,annotationResources:e,contentSearchResource:r,isMedia:s,painting:o}),m[1].length>1&&U.createElement(Ire,{className:"clover-viewer-media-wrapper"},U.createElement(Zae,{items:a,activeItem:0}))),x&&U.createElement(Lre,{"data-aside-active":x,"data-aside-toggle":S},U.createElement(Hse,{activeCanvas:t,annotationResources:e,searchServiceUrl:n,setContentSearchResource:i,contentSearchResource:r})))},Uue=Ge(Eo.Trigger,{width:"30px",padding:"5px"}),dP=Ge(Eo.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),Hue=Ge("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),zue=Ge("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${tP}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),que=Ge("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),Vue=()=>{var t;const e=di(),n=Jt(),{activeManifest:i,collection:r,configOptions:s,vault:a}=n,o=s==null?void 0:s.canvasHeight,l=u=>{e({type:"updateActiveCanvas",canvasId:void 0}),e({type:"updateActiveManifest",manifestId:u}),e({type:"updateViewerId",viewerId:Dc()})};return U.createElement("div",{style:{margin:"0.75rem"}},U.createElement(nP,{label:r.label,maxHeight:o,value:i,onValueChange:l},(t=r==null?void 0:r.items)==null?void 0:t.map(u=>U.createElement(iP,{value:u.id,key:u.id,thumbnail:u!=null&&u.thumbnail?a.get(u==null?void 0:u.thumbnail):void 0,label:u.label}))))},Gue=(t,e=2500)=>{const{t:n}=ma(),[i,r]=H.useState(""),s=H.useCallback(()=>{navigator.clipboard.writeText(t).then(()=>r(n("copySuccess")),()=>r(n("copyFailure")))},[t]);return H.useEffect(()=>{if(!i)return;const a=setTimeout(()=>r(""),e);return()=>clearTimeout(a)},[i]),[i,s]},jue=Ge("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",lineHeight:"1em"}),Wue=({status:t})=>t?U.createElement(jue,{"data-copy-status":t},t):null,DR=({textPrompt:t,textToCopy:e})=>{const[n,i]=Gue(e);return U.createElement("button",{onClick:i},t," ",U.createElement(Wue,{status:n}))},$ue=({title:t})=>{const e="#ed1d33",n="#2873ab";return U.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},U.createElement("title",null,t),U.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},U.createElement("g",{transform:"scale(0.1)"},U.createElement("path",{style:{fill:n},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),U.createElement("path",{style:{fill:n},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),U.createElement("path",{style:{fill:e},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),U.createElement("path",{style:{fill:e},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),U.createElement("path",{style:{fill:n},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),U.createElement("path",{style:{fill:n},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),U.createElement("path",{style:{fill:e},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},Yue=Ge(Jne,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),Kue=Ge(eie,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",span:{fontFamily:"monospace",fontSize:"0.8333rem",fontWeight:"700",display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center",color:"$primary",opacity:"0.382",userSelect:"none",pointerEvents:"none"},'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))",span:{opacity:"1",color:"$accent"}}});Ge("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"});const Xue=Ge("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),Que=()=>{const{isInformationOpen:t}=Jt(),e=di(),{t:n}=ma(),i=r=>{e({type:"updateInformationOpen",isInformationOpen:r})};return U.createElement(Xue,null,U.createElement(Yue,{checked:t,onCheckedChange:i,id:"information-toggle","aria-label":n("informationPanelToggle"),name:"toggled?"},U.createElement(Kue,null,U.createElement("span",null,"i"))))},Zue=U.memo(Que),Jue=Ge(Eo.Trigger,{width:"30px",padding:"5px",marginBottom:"auto"}),ele=Ge(dP,{h3:{color:"$primaryAlt",fontSize:"$2",fontWeight:"700",margin:"$2 0"},button:{},"& ul li":{marginBottom:"$1"}});function tle(t){const{vault:e}=Jt();try{const n=t&&e.get(t);if(!n)throw new Error(`Vault entity ${t} not found.`);return(n==null?void 0:n["@id"])||(n==null?void 0:n.id)}catch(n){return console.error(n),t}}function OR(t,e){const n=[];if(!t)return n;for(const i of t)if(i.id){const r=e.get(i.id);r&&n.push(r)}return n}function nle(){const{activeCanvas:t,activeManifest:e,vault:n}=Jt(),[i,r]=H.useState({root:[],canvas:[]});return H.useEffect(()=>{const s=n.get(e),a=n.get(t),o=s==null?void 0:s.rendering,l=a==null?void 0:a.rendering,u=OR(o,n),d=OR(l,n);r({root:u,canvas:d})},[t,e,n]),{...i}}function PR(t,e){return t.map(({format:n,id:i,label:r})=>{const s=tle(i);return{format:n,id:s,label:Li(r)||e}})}function ile(){const t=nle(),e=PR((t==null?void 0:t.root)||[],"Root Rendering Label"),n=PR((t==null?void 0:t.canvas)||[],"Canvas Rendering Label");return{allPages:e,individualPages:n}}const rle=()=>{const{allPages:t,individualPages:e}=ile(),n=t.length>0||e.length>0,i=r=>{window.open(r,"_blank")};return n?U.createElement(Eo,null,U.createElement(Jue,{"data-testid":"download-button"},U.createElement(jn,null,U.createElement(jn.Download,null))),U.createElement(ele,{"data-testid":"download-content"},e.length>0&&U.createElement(U.Fragment,null,U.createElement("h3",null,"Individual Pages"),U.createElement("ul",null,e.map(({format:r,id:s,label:a})=>U.createElement("li",{key:a},U.createElement("button",{onClick:()=>i(s)},a," (",r,")"))))),t.length>0&&U.createElement(U.Fragment,null,U.createElement("h3",null,"All Pages"),U.createElement("ul",null,t.map(({format:r,id:s,label:a})=>U.createElement("li",{key:a},U.createElement("button",{onClick:()=>i(s)},a," (",r,")"))))))):null},sle=({manifestId:t,manifestLabel:e})=>{const n=Jt(),{collection:i,configOptions:r}=n,{informationPanel:s,showDownload:a,showIIIFBadge:o,showTitle:l}=r,u=a||o||(s==null?void 0:s.renderToggle),{t:d}=ma();return U.createElement(zue,{className:"clover-viewer-header"},i!=null&&i.items?U.createElement(Vue,null):U.createElement(Hue,{className:l?"":"visually-hidden"},l&&U.createElement(bs,{label:e,className:"label"})),u&&U.createElement(que,null,a&&U.createElement(rle,null),o&&U.createElement(Eo,null,U.createElement(Uue,null,U.createElement($ue,{title:d("commonShare")})),U.createElement(dP,null,(i==null?void 0:i.items)&&U.createElement("button",{onClick:f=>{f.preventDefault(),window.open(i.id,"_blank")}},d("shareCollectionJson")),U.createElement("button",{onClick:f=>{f.preventDefault(),window.open(t,"_blank")}},d("shareManifestJson"))," ",(i==null?void 0:i.items)&&U.createElement(DR,{textPrompt:d("shareCollectionCopy"),textToCopy:i.id}),U.createElement(DR,{textPrompt:d("shareManifestCopy"),textToCopy:t}))),(s==null?void 0:s.renderToggle)&&U.createElement(Zue,null)))},ale=t=>{const e=()=>window.matchMedia?window.matchMedia(t).matches:!1,[n,i]=H.useState(e);return H.useEffect(()=>{const r=()=>i(e);return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)}),n},ole=({manifest:t,theme:e,iiifContentSearchQuery:n})=>{var i;const r=Jt(),s=di(),{activeCanvas:a,isInformationOpen:o,vault:l,configOptions:u,visibleCanvases:d}=r,f=["100%","auto"],p=(u==null?void 0:u.canvasHeight)&&f.includes(u==null?void 0:u.canvasHeight),[m,y]=H.useState(!1),[b,E]=H.useState([]),[T,x]=H.useState([]),[S,w]=H.useState(),C=ale(t8.sm),[I,L]=H.useState(),N=H.useCallback(O=>{s({type:"updateInformationOpen",isInformationOpen:O})},[s]);H.useEffect(()=>{var O;(O=u==null?void 0:u.informationPanel)!=null&&O.open&&N(!C)},[C,(i=u==null?void 0:u.informationPanel)==null?void 0:i.open]),H.useEffect(()=>{},[C]),H.useEffect(()=>{const O=pa(l,a);O&&(y(["Sound","Video"].indexOf(O[0].type)>-1),E(O));const D=F9(l,t,a);s({type:"updateVisibleCanvases",visibleCanvases:D})},[a,C,t,l,s]),H.useEffect(()=>{(async()=>{const O=await Promise.all(d.map(D=>Are(l,D.id)));x(O.flat())})()},[d]);const G=t.service.some(O=>["SearchService1","SearchService2"].includes(O.type||O["@type"]));return H.useEffect(()=>{if(G){const O=t.service.find(D=>["SearchService1","SearchService2"].includes(D.type||D["@type"]));O&&L(O.id||O["@id"])}},[t,G]),H.useEffect(()=>{var O;I&&((O=u.informationPanel)==null?void 0:O.renderContentSearch)!==!1&&JO(l,I,n).then(D=>w(D))},[I]),U.createElement(Hv,{FallbackComponent:cE},U.createElement(Dre,{className:`${e} clover-viewer`,css:{background:u==null?void 0:u.background},"data-absolute-position":p,"data-information-panel-open":o},U.createElement(cB,{open:o,onOpenChange:N},U.createElement(sle,{manifestLabel:t.label,manifestId:t.id}),U.createElement(Fue,{activeCanvas:a,painting:b,annotationResources:T,searchServiceUrl:I,setContentSearchResource:w,contentSearchResource:S,items:t.items,isAudioVideo:m}))))},kR={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function ule(t){return{ok:t.status>=200&&t.status<300,status:t.status,statusText:t.statusText,headers:t.getAllResponseHeaders(),data:t.responseText,json:()=>JSON.parse(t.responseText)}}function NR(t,e=null){return{ok:!1,status:t.status,statusText:t.statusText,headers:t.getAllResponseHeaders(),data:e||t.statusText,json:()=>JSON.parse(e||t.statusText)}}function lle(t,e=kR){const n=e.headers||kR.headers;return new Promise((i,r)=>{const s=new XMLHttpRequest;s.open("get",t),s.withCredentials=e.withCredentials,n&&Object.keys(n).forEach(a=>s.setRequestHeader(a,n[a])),s.onload=()=>{i(ule(s))},s.onerror=()=>{r(NR(s,"Failed to make request."))},s.ontimeout=()=>{r(NR(s,"Request took longer than expected."))},s.send()})}const MR={"@context":"http://iiif.io/api/presentation/3/context.json",id:"https://example.org/iiif/content-state/specific-resource",type:"Annotation",motivation:["contentState"],target:{type:"SpecificResource",source:{id:"https://example.org/iiif/manifest/canvas/0",type:"Canvas",partOf:[{id:"https://example.org/iiif/manifest",type:"Manifest"}]}},body:[]},cle=({canvasIdCallback:t,contentStateCallback:e,customDisplays:n=[],plugins:i=[],customTheme:r,iiifContent:s,id:a,manifestId:o,options:l,iiifContentSearchQuery:u})=>{var d,f,p;let m=s;a&&(m=a),o&&(m=o);const y=XO((f=(d=l==null?void 0:l.informationPanel)==null?void 0:d.vtt)==null?void 0:f.autoScroll);return U.createElement(Sre,{initialState:{...B0,customDisplays:n,plugins:i,isAutoScrollEnabled:y.enabled,isInformationOpen:!!((p=l==null?void 0:l.informationPanel)!=null&&p.open),vault:new GO({customFetcher:b=>lle(b,{withCredentials:l==null?void 0:l.withCredentials,headers:l==null?void 0:l.requestHeaders}).then(E=>JSON.parse(E.data))})}},U.createElement(dle,{iiifContent:m,canvasIdCallback:t,contentStateCallback:e,customTheme:r,options:l,iiifContentSearchQuery:u}))},dle=({canvasIdCallback:t,contentStateCallback:e,customTheme:n,iiifContent:i,options:r,iiifContentSearchQuery:s})=>{const a=di(),o=Jt(),{activeCanvas:l,activeManifest:u,activeSelector:d,isLoaded:f,vault:p,visibleCanvases:m}=o,[y,b]=H.useState(),[E,T]=H.useState();let x={};if(n&&(x=zB("custom",n)),H.useEffect(()=>{a({type:"updateActiveSelector",selector:void 0})},[l,u]),H.useEffect(()=>{var S;if(t&&t(l),e&&u&&l){const w=((S=m[0])==null?void 0:S.id)||l,C=`${u}/state/${$O(w+JSON.stringify(d))}`,I={...MR,id:C,target:{type:"SpecificResource",source:{id:w,type:"Canvas",partOf:[{id:u,type:"Manifest"}]},selector:d}};e({json:I,encoded:U9(JSON.stringify(I))})}},[l,u,d,t,e,m]),H.useEffect(()=>{u&&p.load(u).then(S=>{if(!S)return;T(S);const w=m_(p,S),C=l||cue(S);a({type:"updateActiveCanvas",canvasId:C}),a({type:"updateManifestSequence",sequence:w})}).catch(S=>{console.error(`Manifest failed to load: ${S}`)}).finally(()=>{a({type:"updateIsLoaded",isLoaded:!0})})},[i,u,a,p]),H.useEffect(()=>{a({type:"updateConfigOptions",configOptions:r}),(async()=>{var S;if(!i)return;const w=lue(i);try{const C=typeof w=="object"&&w!=null&&w.id?await p.loadSync(w==null?void 0:w.id,w):await p.load(w);b(C)}catch(C){if((!w||!w.id)&&console.error(`Failed to load resource: ${C}`),w!=null&&w.id&&(w==null?void 0:w.type)==="Annotation"&&(S=w==null?void 0:w.motivation)!=null&&S.includes("contentState")){const I=await p.loadSync(w.id,w);I&&b(I)}else w!=null&&w.id&&["Canvas","Manifest"].includes(w==null?void 0:w.type)&&await p.loadSync(w.id,w)&&b({...MR,target:w})}})()},[a,i,r,p]),H.useEffect(()=>{if(y)switch(y.type){case"Annotation":if(y!=null&&y.motivation&&(Array.isArray(y==null?void 0:y.motivation)?y!=null&&y.motivation.includes("contentState"):(y==null?void 0:y.motivation)==="content-state")){const{active:w}=lP(y);a({type:"updateActiveManifest",manifestId:w.manifest}),a({type:"updateActiveCanvas",canvasId:w.canvas}),a({type:"updateContentStateAnnotation",contentStateAnnotation:y})}break;case"Collection":const S=due(y);a({type:"updateCollection",collection:y}),S&&a({type:"updateActiveManifest",manifestId:S});break;case"Manifest":a({type:"updateActiveManifest",manifestId:y.id});break}},[a,i,y]),!f)if(r!=null&&r.customLoadingComponent){const S=r.customLoadingComponent;return U.createElement(S,null)}else return U.createElement(U.Fragment,null,"Loading");return!E||!E.items?(console.log(`The IIIF manifest ${i} failed to load.`),U.createElement(U.Fragment,null)):E.items.length===0?(console.log(`The IIIF manifest ${i} does not contain canvases.`),U.createElement(U.Fragment,null)):U.createElement(ole,{manifest:E,theme:x,key:E.id,iiifContentSearchQuery:s})};function fle(){return Ce.jsx(Ce.Fragment,{children:Ce.jsx("div",{children:Ce.jsx(cle,{iiifContent:"/sample/manifest.json",options:{canvasHeight:"auto"}})})})}PN.createRoot(document.getElementById("root")).render(Ce.jsx(H.StrictMode,{children:Ce.jsx(fle,{})}));
